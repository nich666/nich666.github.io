<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>数学学习笔记</title>
      <link href="//OI/%E6%95%B0%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>//OI/%E6%95%B0%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>神仙$wfy,Dyd$来讲课 %%%</p><span id="more"></span><p><del>因为菜，大多数会只贴代码</del><br><del>由于进度快，听不懂，习题咕咕咕了</del></p><h2 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h2><h3 id="快速幂-1"><a href="#快速幂-1" class="headerlink" title="快速幂"></a>快速幂</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,(a*=a)%=mod)</span><br><span class="line"><span class="keyword">if</span>(b&amp;<span class="number">1</span>) (res*=a)%=mod;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度$O(log\ b)$</p><h3 id="矩阵快速幂"><a href="#矩阵快速幂" class="headerlink" title="矩阵快速幂"></a>矩阵快速幂</h3><p>多用于优化递推</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> f[N][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="title">Matrix</span><span class="params">()</span></span>&#123;<span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;N;++i) f[i][i]=<span class="number">1</span>;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">inline</span> Matrix <span class="keyword">operator</span> *(<span class="type">const</span> Matrix &amp;x,<span class="type">const</span> Matrix &amp;y)</span><br><span class="line">&#123;</span><br><span class="line">Matrix z;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;N;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;N;++k)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;N;++j)</span><br><span class="line">(z.f[i][j]+=x.f[i][k]*y.f[k][j])%=mod;</span><br><span class="line"><span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> Matrix <span class="keyword">operator</span> ^(Matrix x,<span class="type">int</span> y)</span><br><span class="line">&#123;</span><br><span class="line">Matrix res;</span><br><span class="line">res.<span class="built_in">init</span>();</span><br><span class="line"><span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=x*x)</span><br><span class="line"><span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=res*x;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="光速幂"><a href="#光速幂" class="headerlink" title="光速幂"></a>光速幂</h3><p>基于分块思想,要求底数一定，可做到$O(\sqrt{p})$预处理 $O(1)$询问<br>设底数为$a$，模数为$p$,设$k=\sqrt{p}$<br>我们预处理出$a^1,a^2,a^3…a^k$<br>并预处理出$a^k,a^{2k},a^{3k}…$<br>然后把询问$a^b$拆成$a^{ck}\times a^d$就行了</p><p>没代码，只会口胡</p><h2 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h2><h3 id="质数"><a href="#质数" class="headerlink" title="质数"></a>质数</h3><p>判断质数</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>,k=<span class="built_in">sqrt</span>(x);i&lt;=k;++i)</span><br><span class="line"><span class="keyword">if</span>(x%i==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>分解质因数</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">div</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">tot=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=<span class="built_in">sqrt</span>(n);++i)</span><br><span class="line"><span class="keyword">if</span>(n%i==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">prime[++tot]=i,cnt[tot]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(n%i==<span class="number">0</span>) n/=i,++cnt[tot];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(n&gt;<span class="number">1</span>) prime[++tot]=n,cnt[tot]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="筛法"><a href="#筛法" class="headerlink" title="筛法"></a>筛法</h3><h4 id="埃式筛"><a href="#埃式筛" class="headerlink" title="埃式筛"></a>埃式筛</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> st[N],prime[N],cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sieve</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">if</span>(!st[i])</span><br><span class="line">&#123;</span><br><span class="line">prime[++cnt]=i;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=i*i;j&lt;=n;j+=i) st[j]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度$O(nloglogn)$</p><h4 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h4><p>原理是每个数只会被自己的最小质因数筛一次</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> st[N],prime[N],cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sieve</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!st[i]) prime[++cnt]=i,st[i]=i;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;i*prime[j]&lt;=n;++j)</span><br><span class="line"><span class="keyword">if</span>(prime[j]&lt;=st[i]) st[prime[j]*i]=prime[j];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度$O(n)$</p><h3 id="同余"><a href="#同余" class="headerlink" title="同余"></a>同余</h3><h4 id="扩展欧几里得"><a href="#扩展欧几里得" class="headerlink" title="扩展欧几里得"></a>扩展欧几里得</h4><p>解决$ax+by=gcd(a,b)$<br>写一下学长的式子<br>$<br>\begin{array}{c}<br>ax+by = 1\<br>\left \lfloor \frac{a}{b} \right \rfloor bx+(a\ mod\ b)x+by = 1\<br>b(y+\left \lfloor \frac{a}{b} \right \rfloor x)+(a\ mod\ b)x = 1\<br>\end{array}<br>$<br><br>所以等效于$a’=b，b’=a\ mod \ b,x’=y+\left \lfloor \frac{a}{b} \right \rfloor x,y’=x$</p><p>即$x=y’,y=x’-\left \lfloor \frac{a}{b} \right \rfloor x=x’-\left \lfloor \frac{a}{b} \right \rfloor y’$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;d,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!b) <span class="keyword">return</span> d=a,x=<span class="number">1</span>,y=<span class="number">0</span>,<span class="built_in">void</span>();</span><br><span class="line"><span class="built_in">exgcd</span>(b,a%b,d,y,x),y-=a/b*x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h4><p>若$gcd(a,p)=1$，则$a^{b}\equiv a^{b\ mod\ \varphi(p)}(mod\ p)$</p><p>扩展欧拉定理: 对于一般的情况，我们有$a^{b}\equiv a^{b\ mod\ \varphi(p)+\varphi(p)}(mod\ p)$</p><h4 id="乘法逆元"><a href="#乘法逆元" class="headerlink" title="乘法逆元"></a>乘法逆元</h4><p>$ax\equiv1(mod\ p)$，则$x\equiv a^{-1}(mod\ p)$</p><p>若$p$为质数且$a,p$互质,因为$a^{b}\equiv a^{b\ mod\ \varphi(p)}(mod\ p)$</p><p>所以$p$为质数，$x,p$互质时$x$的逆元为$a^{-1}\equiv a^{p-2}$</p><h5 id="线性预处理"><a href="#线性预处理" class="headerlink" title="线性预处理"></a>线性预处理</h5><p>记$inv[x]$为$x$的逆元，$inv[1]=1$</p><p>设$p=k\times i+r$,则$k\times i+r\equiv 0(mod\ p)$</p><p>同时乘上$i^{-1},r^{-1}$</p><p>$k\times r^{-1}+i^{-1}\equiv 0(mod\ p)$</p><p>$i^{-1}\equiv -k\times r^{-1}$</p><p>因为$k=\left \lfloor \frac{p}{i}  \right \rfloor$</p><p>所以$i\equiv (p-\left \lfloor \frac{p}{i}  \right \rfloor )\times r^{-1}$</p><p>然后就能线性预处理</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) inv[i]=(p-p/i)*inv[p%i]%p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="积性函数"><a href="#积性函数" class="headerlink" title="积性函数"></a>积性函数</h3><p>若$gcd(x,y)=1\Rightarrow f(xy)=f(x)f(y)$,则称$f$为积性函数</p><p>若$\forall x,y\Rightarrow f(xy)=f(x)f(y)$，则称$f$为完全积性函数</p><p>性质：</p><p>若$f$为积性函数,$n=\prod_{i=1}^{m} p_i^{c_i}$，则$f(n)=\prod_{i=1}^{m} f(p_i^{c_i})$</p><p>一些常见的积性函数:$\varphi,\epsilon,Id,gcd,\mu,d,\sigma,I$等</p><p>积性函数的逆:对每一个$f(1)\ne 0$的函数$f$，都有函数$g$使$f*g=\epsilon$</p><p>一个积性函数的逆也是积性函数</p><h4 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h4><p>定义$\varphi(n)$表示小于$n$且与$n$互质的数的个数</p><p>即$\varphi(n)=\sum_{i=1}^{n-1}[gcd(i,n)=1]$</p><p>计算方法:</p><p>若$n=p_1^{c_1}p_2^{c_2}\cdots p_k^{c_k}$</p><p>则$\varphi(n)=n\times \frac{p_1-1}{p_1}\times \frac{p_2-1}{p_2}\times \cdots\times \frac{p_k-1}{p_k} $</p><p>即$\varphi(n)=n\times \prod_{质数p|n}\frac{p-1}{p} $</p><h5 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h5><p>1.若$p$为质数，则$\varphi(p)=p-1$</p><p>2.若$gcd(x,y)=1\Rightarrow \varphi(xy)=\varphi(x)\varphi(y)$</p><p>3.$\sum_{i=1}^{n}i\times [gcd(i,n)=1]=\frac {n\times \varphi(n)}{2}$</p><p>4.$\sum_{d|n}\varphi(d)=n$_</p><p>证明：</p><p>1,2显然</p><p>3.因为$gcd(i,n)=gcd(n-i,n)$</p><p>每一对和为$i+(n-i)=n$，这样的数对有$\frac{\varphi(n)}{2}$对，和为$\frac{n\times \varphi(n)}{2}$</p><p>4.记$d=gcd(i,n)$，则$d|n,gcd(\frac{i}{d},\frac{n}{d})=1$，这样的$i$有$\varphi(\frac{n}{d})$个</p><p>由于按$d$分类包含了$1…n$的所有数字，所以$n=\sum_{d|n}\varphi(\frac{n}{d})=\sum_{d|n}\varphi(d)$</p><h5 id="计算"><a href="#计算" class="headerlink" title="计算"></a>计算</h5><p>1.$O(\sqrt{n})$询问$\varphi(n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">phi</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">div</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i) n=n/prime[i]*(prime[i]+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.线性筛</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> st[N],prime[N],cnt,phi[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sieve</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">phi[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!st[i]) prime[++cnt]=i,st[i]=i,phi[i]=i<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;i*prime[j]&lt;=n;++j)</span><br><span class="line"><span class="keyword">if</span>(prime[j]&lt;st[i]) st[prime[j]*i]=prime[j],phi[i*prime[j]]=phi[i]*(prime[j]<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(prime[j]==st[i]) st[prime[j]*i]=prime[j],phi[prime[j]*i]=phi[i]*prime[j];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="莫比乌斯函数"><a href="#莫比乌斯函数" class="headerlink" title="莫比乌斯函数"></a>莫比乌斯函数</h4><p>$\mu(n) = \left\{\begin{array}{ll}<br>1&amp;n = 1\\<br>0&amp;n\text{含有平方因子}\\<br>(-1)^{k}&amp;k\text{为}n\text{的本质不同质因子个数}<br>\end{array}\right.$</p><p><strong>性质</strong></p><p>$\epsilon=\mu*I$，</p><p>即$\sum_{d|n}\mu(d)=\epsilon(n)=\left\{\begin{array}{ll}<br>1&amp;n=1\\<br>0&amp;\text{Other}<br>\end{array}\right.$</p><p>证明：<br>$n=1$时显然成立</p><p>设$n=\prod_{i=1}^{m} p_i^{c_i},n’=\prod_{i=1}^{m}p_i$</p><p>则$\sum_{d|n}\mu(d)=\sum_{d|n’}\mu(d)$</p><p>因为逆用二项式定理$\sum_{d|n’}\mu(d)=\sum_{i=0}^{m}C_{m}^{i}(-1)^i=(1+(-1))^m=0$</p><p>所以得证</p><p>线性筛</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sieve</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">mu[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!st[i]) prime[++cnt]=i,st[i]=i,mu[i]=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;i*prime[j]&lt;=n;++j)</span><br><span class="line"><span class="keyword">if</span>(prime[j]&lt;st[i]) st[prime[j]*i]=prime[j],mu[i*prime[j]]=-mu[i];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(prime[j]==st[i])</span><br><span class="line">&#123;</span><br><span class="line">st[prime[j]*i]=prime[j];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) mu[i]+=mu[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数论分块"><a href="#数论分块" class="headerlink" title="数论分块"></a>数论分块</h3><blockquote><p>求$\sum_{i=1}^{n}\left \lfloor \frac{n}{i} \right \rfloor,n\leq 10^{14}$</p></blockquote><p>板子，直接上代码，时间复杂度$O(\sqrt{n})$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>,r;l&lt;=n;l=r+<span class="number">1</span>)</span><br><span class="line">r=n/(n/l),ans+=(n/l)*(r-l+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>求$\sum_{i=1}^{n}i\times \left \lfloor \frac{n}{i} \right \rfloor,n\leq 10^{14}$</p></blockquote><p>还是板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>,r;l&lt;=n;l=r+<span class="number">1</span>)</span><br><span class="line">r=n/(n/l),ans+=(n/l)*(r-l+<span class="number">1</span>)*(l+r)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="狄利克雷卷积"><a href="#狄利克雷卷积" class="headerlink" title="狄利克雷卷积"></a>狄利克雷卷积</h3><blockquote><p>数论函数是指这样一类函数：其定义域是正整数，值域是一个数集。</p></blockquote><p>定义两个数论函数的狄利克雷卷积$*$</p><p>若$t=f*g$，则$t(n)=\sum_{d|n}f(d)g(\frac{n}{d})$</p><p>容易知道狄利克雷卷积满足交换律，下面证其满足结合律</p><p>$(f*g)*h\Rightarrow$</p><p>$\sum\_{dk = n}(\sum_{ij = d}f(i)g(j))h(d)$</p><p>$=\sum\_{ijk = n}f(i)g(j)h(k)$</p><p>$=\sum\_{id’}f(i)(\sum_{jk = d’}g(j)h(k))$</p><p>$\Rightarrow f*(g*h)$</p><p>另一个性质是两个积性函数的狄利克雷卷积也是积性函数<br><del>证明请自行百度</del></p><p>一些常见积性函数的关系:<br>$\epsilon=\mu*I,d=I*I,Id=\varphi*I,\varphi=\mu*Id$</p><h3 id="莫比乌斯反演"><a href="#莫比乌斯反演" class="headerlink" title="莫比乌斯反演"></a>莫比乌斯反演</h3><p>$F=f*I\Rightarrow f=\mu*F$<br>即$F(n)=\sum\_{d|n}f(d)\Rightarrow f(n)=\sum\_{d|n}\mu(\frac{n}{d})F(d)$</p><p>证明1：</p><p>$f*I=F\Rightarrow f*I*\mu=F*\mu\Rightarrow f=F*\mu$</p><p>证明2：</p><p>$\sum_{d|n}\mu(d)F(n/d)$</p><p>$=\sum_{d|n}\mu(d)\sum_{i|\frac{n}{d}}f(i)$</p><p>然后将$i$提到前面，因为$id|n$</p><p>所以原式$=\sum_{i|n}f(i)\sum_{d|\frac{n}{i}}\mu(d)$</p><p>因为$\sum_{d|n}\mu(d)=[n==1]$</p><p>$=\sum_{i|n}f(i)\times [\frac{n}{i}==1]$</p><p>$=f(n)$<br>还有一种倍数形式的$F(n)=\sum_{n|d}f(d)\Rightarrow f(n)=\sum_{n|d}\mu(\frac{d}{n})F(d)$</p><p>$Dyd$说莫比乌斯反演分为推式子和函数式</p><p>推式子就是先表示出答案，然后通过枚举变量，转换枚举顺序，反演等方式将其表示为一个容易得到的式子</p><p>函数式是先构造与答案密切相关的函数$f$,再通过$F(n)=\sum_{d|n}f(d)$找到$F$<br>并找到$F$容易计算的方式，再通过$f(n)=\sum_{d|n}F(d)\mu(\frac{n}{d})$得出$f$的式子</p><p><del>还有枚举倍数比枚举因数简单</del></p><h4 id="常见方法"><a href="#常见方法" class="headerlink" title="常见方法"></a>常见方法</h4><p>1.完全展开预处理无关项</p><p>2.改变未知数使得两个$\sum$分离，预处理其中一个（也可以看作将两数积设出，继续化简）</p><p>3.注意卷积中的一些常用等式</p><h4 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h4><p><a href="https://www.luogu.com.cn/problem/P2522">P2522 [HAOI2011]Problem b</a><br>先将式子差分，转化成$solve(b,d)+solve(a-1,c-1)-solve(a-1,d)-solve(b,c-1)$</p><p>$\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)=k]$</p><p>$=\sum_{i=1}^{\frac{n}{k}}\sum_{j=1}^{\frac{m}{k}}[gcd(i,j)=1]$</p><p>$=\sum_{i=1}^{\frac{n}{k}}\sum_{j=1}^{\frac{m}{k}}\sum_{d|i,d|j}\mu(d)$</p><p>将枚举约数$d$转化为枚举$d$的倍数</p><p>$=\sum_{d=1}^{\frac{\min(n,m)}{k}}\sum_{d|i}^{\frac{n}{k}}\sum_{d|j}^{\frac{m}{k}}\mu(d)$</p><p>$=\sum_{d=1}^{\frac{\min(n,m)}{k}}\mu(d)\left \lfloor \frac{n}{kd} \right \rfloor \left \lfloor \frac{m}{kd}  \right \rfloor$</p><p>然后数论分块做就行了<br>从函数的方面来说，我们构造$f(k)=\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)==k]$</p><p>$F(k)=\sum_{k|d}f(d)$,则$F(k)=\sum_{i=1}^{n}\sum_{j=1}^{m}[k|gcd(i,j)]=\sum_{i=1}^{n}\sum_{j=1}^{m}[k|i,k|j]=\left \lfloor \frac{n}{k} \right \rfloor \left \lfloor \frac{m}{k}  \right \rfloor$</p><p>反演回去可得$f(n)=\sum_{n|d}\mu(\frac{d}{n})F(d)=\sum_{n|d}\mu(\frac{d}{n})\left \lfloor \frac{n}{d} \right \rfloor \left \lfloor \frac{m}{d}  \right \rfloor$</p><p>令$d’=\frac{d}{n},N=\frac{n}{n},M=\frac{m}{n}$</p><p>$f(n)=\sum_{d’}\mu(d’)\left \lfloor \frac{N}{d’} \right \rfloor \left \lfloor \frac{M}{d’}  \right \rfloor$</p><p><a href="https://www.luogu.com.cn/problem/P2257">P2257 YY的GCD  </a></p><p>先推式子(默认$n\leq m$)</p><p>$Ans=\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)\in primes]$</p><p>枚举$k\in primes$</p><p>$Ans=\sum_{i=1}^{n}\sum_{j=1}^{m}\sum_{k\in primes}^{n}[gcd(i,j)=k]$</p><p>$=\sum_{i=1}^{\frac{n}{k}}\sum_{j=1}^{\frac{m}{k}}\sum_{k\in primes}^{n}[gcd(i,j)=1]$</p><p>发现此时后面已与$k$无关，将$k$提到前面</p><p>$=\sum_{k\in primes}^{n}\sum_{i=1}^{\frac{n}{k}}\sum_{j=1}^{\frac{m}{k}}[gcd(i,j)=1]$</p><p>$=\sum_{k\in primes}^{n}\sum_{i=1}^{\frac{n}{k}}\sum_{j=1}^{\frac{m}{k}}\sum_{d|gcd(i,j)}\mu(d)$</p><p>$=\sum_{k\in primes}^{n}\sum_{d=1}^{\frac{n}{k}}\mu(d)\left \lfloor \frac{n}{kd} \right \rfloor \left \lfloor \frac{m}{kd}  \right \rfloor$</p><p>此时式子已十分简洁，我们可以枚举$k$,然后就$TLE$了</p><p>我们用$T$代替$kd$进行枚举，式子就成了这样</p><p>$\sum_{k\in primes}^{n}\sum_{k|T}^{n}\mu(\frac{T}{k})\left \lfloor \frac{n}{T} \right \rfloor \left \lfloor \frac{m}{T}  \right \rfloor$</p><p>将分块内容提到前面</p><p>$\sum_{k|T}^{n}\left \lfloor \frac{n}{T} \right \rfloor \left \lfloor \frac{m}{T}  \right \rfloor\sum_{k\in primes}^{n}\mu(\frac{T}{k})$</p><p>对于后面的式子我们可以预处理</p><p>然后这道题就可以在$O(nlogn+T\sqrt{n})$的时间内解决</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e7</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> prime[N],cnt,st[N],mu[N],s[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sieve</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">mu[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!st[i]) prime[++cnt]=i,st[i]=i,mu[i]=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;i*prime[j]&lt;=n;++j)</span><br><span class="line"><span class="keyword">if</span>(prime[j]&lt;st[i]) st[prime[j]*i]=prime[j],mu[i*prime[j]]=-mu[i];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(prime[j]==st[i])</span><br><span class="line">&#123;</span><br><span class="line">st[prime[j]*i]=prime[j];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j*prime[i]&lt;=n;++j)</span><br><span class="line">s[j*prime[i]]+=mu[j];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s[i]+=s[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>,r;l&lt;=n;l=r+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">r=<span class="built_in">min</span>(n/(n/l),m/(m/l));</span><br><span class="line">ans+=(s[r]-s[l<span class="number">-1</span>])*(n/l)*(m/l);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,a,b;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">sieve</span>(<span class="number">1e7</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">cin&gt;&gt;a&gt;&gt;b,</span><br><span class="line">cout&lt;&lt;<span class="built_in">solve</span>(<span class="built_in">min</span>(a,b),<span class="built_in">max</span>(a,b))&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="组合计数"><a href="#组合计数" class="headerlink" title="组合计数"></a>组合计数</h2><p>$<br>\begin{pmatrix}<br> n\<br> m<br>\end{pmatrix}=C_{n}^{m}=\frac{n!}{(n-m)!m!}(m\leq n)$</p><h3 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h3><p>$<br>C_{n}^{m}=C_{n-1}^{m-1}+C_{n-1}^{m}<br>C_{n}^{m}=\sum_{i=0}^{m}C_{k}^{i}C_{n-k}^{m-i}<br>$</p><h4 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h4><blockquote><p>有一个长度为$n$互不相等的正整数组成的的序列，第$i$个值的取值范围为$[1,a_i]$，求这样的序列个数</p></blockquote><p>由于跟位置无关，我们可以将$a[i]$先进行排序</p><p>对每个$a[i]$，他可以选择的方案数为$a[i]-i+1$</p><p>所以$ans=\prod_{i=1}^{n}a[i]-i+1$</p><p><a href="https://www.luogu.com.cn/problem/P1350">P1350 车的放置</a><br>我们可以将其划分为$a\times b$和$(a+c)\times d$的两个矩阵<br>枚举在第一个矩形中放置$i$个车，则方案数为$C_{a}^{i}\times C_{b}^{i} \times i!$<br>则第二个矩阵中可放置的行数为$d$，列数为$a+c-i$，车的个数为$k-i$,方案数为$C_{d}^{k-i}\times C_{a+c-i}^{k-i}\times (k-i)!$<br>此时方案数为两者之积，加起来就行了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e3</span>+<span class="number">5</span>,mod=<span class="number">1e5</span>+<span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> a,b,c,d,k,n,ans;</span><br><span class="line"><span class="type">int</span> jc[N]=&#123;<span class="number">1</span>&#125;,inv[N]=&#123;<span class="number">1</span>&#125;,jcinv[N]=&#123;<span class="number">1</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> x&lt;y?<span class="number">0</span>:jc[x]*jcinv[y]%mod*jcinv[x-y]%mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> <span class="built_in">C</span>(n,k)*<span class="built_in">C</span>(m,k)%mod*jc[k]%mod;&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::sync\_with\_stdio(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;a&gt;&gt;b&gt;&gt;c&gt;&gt;d&gt;&gt;k;</span><br><span class="line">n=<span class="built_in">max</span>(a+c,b+d);</span><br><span class="line">inv[<span class="number">1</span>]=jcinv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) jc[i]=(jc[i<span class="number">-1</span>]*i)%mod;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) inv[i]=(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) jcinv[i]=jcinv[i<span class="number">-1</span>]*inv[i]%mod;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=k;++i) </span><br><span class="line">(ans+=<span class="built_in">calc</span>(a,b,i)*<span class="built_in">calc</span>(a+c-i,d,k-i))%=mod;</span><br><span class="line">cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="容斥原理"><a href="#容斥原理" class="headerlink" title="容斥原理"></a>容斥原理</h3><blockquote><p>有一个长度为$n$互不相等的正整数组成的的序列，第$i$个值的取值范围为$[L_i,R_i]$，求这样的序列个数</p></blockquote><p>先考虑所有都取$R_i$的情况，再减去其中一个取$L_i-1$的情况，再加上两个取$L_i-1$的情况，之后套容斥原理类比就行<br>时间复杂度$O(2^{n}nlogn)$</p><h2 id="线性代数"><a href="#线性代数" class="headerlink" title="线性代数"></a>线性代数</h2><h3 id="高斯消元"><a href="#高斯消元" class="headerlink" title="高斯消元"></a>高斯消元</h3><p>高斯-约旦消元<br>感觉只能练习打字<br>讲一下自己的理解：<br>1.选绝对值最大只为了不损失精度<br>2.$c$是代表消到了$x_c$，$r$代表以第$r$个方程为主</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">55</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps=<span class="number">1e-7</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">double</span> a[N][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> c,r;</span><br><span class="line"><span class="keyword">for</span>(c=r=<span class="number">1</span>;c&lt;=n;++c)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> t=r;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=r+<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">fabs</span>(a[t][c])&lt;<span class="built_in">fabs</span>(a[i][c])) t=i;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">fabs</span>(a[t][c])&lt;eps) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">swap</span>(a[t],a[r]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n+<span class="number">1</span>;i&gt;=c;--i) a[r][i]/=a[r][c];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">if</span>(i!=r) <span class="keyword">for</span>(<span class="type">int</span> j=n+<span class="number">1</span>;j&gt;=c;--j) a[i][j]-=a[r][j]*a[i][c];</span><br><span class="line">++r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(r&lt;=n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=r;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">fabs</span>(a[i][n+<span class="number">1</span>])&gt;eps) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::sync\_with\_stdio(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n+<span class="number">1</span>;++j) cin&gt;&gt;a[i][j];</span><br><span class="line"><span class="type">int</span> opt=<span class="built_in">gauss</span>();</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">printf</span>(<span class="string">&quot;x%d=%.2lf\n&quot;</span>,i,a[i][n+<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">2</span>) <span class="built_in">printf</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DP合集</title>
      <link href="//OI/DP%E5%90%88%E9%9B%86/"/>
      <url>//OI/DP%E5%90%88%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p>好玄学啊</p><span id="more"></span><p>好玄学啊</p><!--more--><h3 id="区间DP"><a href="#区间DP" class="headerlink" title="区间DP"></a>区间DP</h3><p>这个应该是最基础的吧<br>从小阶段推到大的阶段<br>有迭代式和递归式两种写法</p><h4 id="P1880-NOI1995-石子合并"><a href="#P1880-NOI1995-石子合并" class="headerlink" title="P1880 [NOI1995] 石子合并 "></a><a href="https://www.luogu.com.cn/problem/P1880">P1880 [NOI1995] 石子合并 </a></h4><p>经典题，一个trick是破环为链<br>贴个代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">205</span>;</span><br><span class="line"><span class="type">int</span> dp[N][N][<span class="number">2</span>],a[N],n,s[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],a[i+n]=a[i];</span><br><span class="line"><span class="type">int</span> n1=n&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n1;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n1;++j) dp[i][j][<span class="number">1</span>]=<span class="number">2e9</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n1;++i) dp[i][i][<span class="number">0</span>]=dp[i][i][<span class="number">1</span>]=<span class="number">0</span>,s[i]=s[i<span class="number">-1</span>]+a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> len=<span class="number">2</span>;len&lt;=n;++len)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>,r=l+len<span class="number">-1</span>;r&lt;=n1;++l,++r)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=l;k&lt;r;++k)</span><br><span class="line">dp[l][r][<span class="number">0</span>]=<span class="built_in">max</span>(dp[l][r][<span class="number">0</span>],dp[l][k][<span class="number">0</span>]+dp[k+<span class="number">1</span>][r][<span class="number">0</span>]+s[r]-s[l<span class="number">-1</span>]),</span><br><span class="line">dp[l][r][<span class="number">1</span>]=<span class="built_in">min</span>(dp[l][r][<span class="number">1</span>],dp[l][k][<span class="number">1</span>]+dp[k+<span class="number">1</span>][r][<span class="number">1</span>]+s[r]-s[l<span class="number">-1</span>]);</span><br><span class="line"><span class="type">int</span> ans1=<span class="number">0</span>,ans2=<span class="number">2e9</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">ans1=<span class="built_in">max</span>(dp[i][i+n<span class="number">-1</span>][<span class="number">0</span>],ans1),</span><br><span class="line">ans2=<span class="built_in">min</span>(dp[i][i+n<span class="number">-1</span>][<span class="number">1</span>],ans2);</span><br><span class="line">cout&lt;&lt;ans2&lt;&lt;endl&lt;&lt;ans1&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="能量项链"><a href="#能量项链" class="headerlink" title="能量项链"></a><a href="https://www.luogu.com.cn/problem/P1063">能量项链</a></h4><p>我们枚举此刻的长度，再进行转移就行了<br>方程是$dp[i][j]=\max\limits_{i&lt;k&lt;j}{(dp[i][k]+dp[k][j]+a[i]\times a[k] \times a[j])}$</p><h4 id="P1040-NOIP2003-提高组-加分二叉树"><a href="#P1040-NOIP2003-提高组-加分二叉树" class="headerlink" title="P1040 [NOIP2003 提高组] 加分二叉树 "></a><a href="https://www.luogu.com.cn/problem/P1040">P1040 [NOIP2003 提高组] 加分二叉树 </a></h4><p>由于中序遍历一定，可枚举子树根节点，转化为区间DP<br>这道题让我们记录最佳的状态，转移时记录即可<br>方程好写 <del>Latex不好写</del><br>$f[i][j]=\max\limits_{i&lt;k&lt;j}(f[i][k-1]\times f[k+1][j]+a[k])$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">35</span>;</span><br><span class="line"><span class="type">int</span> dp[N][N],n;</span><br><span class="line"><span class="type">int</span> root[N][N];</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pr</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">cout&lt;&lt;root[l][r]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="built_in">pr</span>(l,root[l][r]<span class="number">-1</span>);</span><br><span class="line"><span class="built_in">pr</span>(root[l][r]+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> len=<span class="number">1</span>;len&lt;=n;++len)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> l=<span class="number">1</span>;l&lt;=n-len+<span class="number">1</span>;++l)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> r=l+len<span class="number">-1</span>;</span><br><span class="line">dp[l][r]=<span class="built_in">max</span>(dp[l+<span class="number">1</span>][r]+a[l],dp[l][r<span class="number">-1</span>]+a[r]);</span><br><span class="line">root[l][r]=(dp[l+<span class="number">1</span>][r]+a[l]==dp[l][r])?l:r;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> k=l+<span class="number">1</span>;k&lt;r;++k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(dp[l][k<span class="number">-1</span>]*dp[k+<span class="number">1</span>][r]+a[k]&gt;dp[l][r])</span><br><span class="line">&#123;</span><br><span class="line">dp[l][r]=dp[l][k<span class="number">-1</span>]*dp[k+<span class="number">1</span>][r]+a[k];</span><br><span class="line">root[l][r]=k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;dp[<span class="number">1</span>][n]&lt;&lt;endl;</span><br><span class="line"><span class="built_in">pr</span>(<span class="number">1</span>,n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P1436-棋盘分割"><a href="#P1436-棋盘分割" class="headerlink" title="P1436 棋盘分割 "></a><a href="https://www.luogu.com.cn/problem/P1436">P1436 棋盘分割 </a></h4><p>二维区间DP<br>同理，枚举两个维度的长度，转移较容易,用二维前缀和优化</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">16</span>,V=<span class="number">8</span>;</span><br><span class="line"><span class="type">int</span> n,a[N][N],val[N][N],dp[<span class="number">9</span>][<span class="number">9</span>][<span class="number">9</span>][<span class="number">9</span>][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> c,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> val[c][d]+val[a<span class="number">-1</span>][b<span class="number">-1</span>]-val[a<span class="number">-1</span>][d]-val[c][b<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n,--n;</span><br><span class="line"><span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> dp);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=V;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=V;++j) </span><br><span class="line">cin&gt;&gt;a[i][j],val[i][j]=val[i][j<span class="number">-1</span>]+val[i<span class="number">-1</span>][j]-val[i<span class="number">-1</span>][j<span class="number">-1</span>]+a[i][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=V;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=V;++j)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> p=i;p&lt;=V;++p)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> q=j;q&lt;=V;++q)</span><br><span class="line">dp[i][j][p][q][<span class="number">0</span>]=<span class="built_in">ask</span>(i,j,p,q)*<span class="built_in">ask</span>(i,j,p,q);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> xlen=<span class="number">1</span>;xlen&lt;=V;++xlen)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> ylen=<span class="number">1</span>;ylen&lt;=V;++ylen)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> xl=<span class="number">1</span>,xr=xl+xlen<span class="number">-1</span>;xr&lt;=V;++xr,++xl)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> yl=<span class="number">1</span>,yr=yl+ylen<span class="number">-1</span>;yr&lt;=V;++yr,++yl)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> p=xl;p&lt;xr;++p) </span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k)</span><br><span class="line">dp[xl][yl][xr][yr][k]=<span class="built_in">min</span>(dp[xl][yl][xr][yr][k],<span class="built_in">min</span>(dp[xl][yl][p][yr][k<span class="number">-1</span>]+dp[p+<span class="number">1</span>][yl][xr][yr][<span class="number">0</span>],dp[xl][yl][p][yr][<span class="number">0</span>]+dp[p+<span class="number">1</span>][yl][xr][yr][k<span class="number">-1</span>]));</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> p=yl;p&lt;yr;++p) </span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k)</span><br><span class="line">dp[xl][yl][xr][yr][k]=<span class="built_in">min</span>(dp[xl][yl][xr][yr][k],<span class="built_in">min</span>(dp[xl][yl][xr][p][<span class="number">0</span>]+dp[xl][p+<span class="number">1</span>][xr][yr][k<span class="number">-1</span>],dp[xl][yl][xr][p][k<span class="number">-1</span>]+dp[xl][p+<span class="number">1</span>][xr][yr][<span class="number">0</span>]));</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;dp[<span class="number">1</span>][<span class="number">1</span>][V][V][n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="树形DP"><a href="#树形DP" class="headerlink" title="树形DP"></a>树形DP</h3><p>可以看看<a href="https://www.luogu.com.cn/blog/BreakPlus/dp-on-tree">这篇blog</a>，讲的挺好</p><h4 id="10155-数字转换"><a href="#10155-数字转换" class="headerlink" title="#10155 数字转换"></a><a href="https://loj.ac/p/10155">#10155 数字转换</a></h4><p>我们对每个点，他的约数和和自己中，小的往大的连边（若相同便不管）<br>然后会形成森林，我们要做的就是求所有树中最大的直径<br>代码找不到了</p><h4 id="P2015-二叉苹果树"><a href="#P2015-二叉苹果树" class="headerlink" title="P2015 二叉苹果树 "></a><a href="https://www.luogu.com.cn/problem/P2015">P2015 二叉苹果树 </a></h4><p>树上背包板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">105</span>,NN=<span class="number">1e4</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[NN],ne[NN],f[N],tot,e[NN];</span><br><span class="line"><span class="type">int</span> dp[N][N];</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span>&#123;to[++tot]=y,e[tot]=z,ne[tot]=f[x],f[x]=tot;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dp1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dp1</span>(y,x);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=m;j;--j)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=j<span class="number">-1</span>;~k;--k) dp[x][j]=<span class="built_in">max</span>(dp[x][j],dp[x][j<span class="number">-1</span>-k]+e[i]+dp[y][k]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y&gt;&gt;z,<span class="built_in">add</span>(x,y,z),<span class="built_in">add</span>(y,x,z);</span><br><span class="line"><span class="built_in">dp1</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">cout&lt;&lt;dp[<span class="number">1</span>][m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="战略游戏"><a href="#战略游戏" class="headerlink" title="战略游戏"></a><a href="https://www.luogu.com.cn/problem/P2016">战略游戏</a></h4><p><del>是个人都知道分类讨论吧</del><br>记录$f[x][0]$为$x$节点不放士兵的最小代价，$f[x][1]$为$x$节点放士兵的最小代价。<br>那么，就可以得到：<br>$f[x][1]=1+\sum\limits_{u\in son[x]}min(f[u][0],f[u][1])$<br>$f[x][0]=\sum\limits_{u\in son[x]}f[u][1]$<br>树上DP即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">3005</span>;</span><br><span class="line"><span class="type">int</span> dp[N][<span class="number">2</span>],n;</span><br><span class="line"><span class="type">int</span> to[N],ne[N],f[N],tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=f[x],f[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dp1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dp[x][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dp1</span>(y,x);</span><br><span class="line">dp[x][<span class="number">0</span>]+=dp[y][<span class="number">1</span>];</span><br><span class="line">dp[x][<span class="number">1</span>]+=<span class="built_in">min</span>(dp[y][<span class="number">0</span>],dp[y][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> x,y,k;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;k;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=k;++j) cin&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dp1</span>(<span class="number">0</span>,<span class="number">-1</span>);</span><br><span class="line">cout&lt;&lt;<span class="built_in">min</span>(dp[<span class="number">0</span>][<span class="number">0</span>],dp[<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P2458-SDOI2006-保安站岗"><a href="#P2458-SDOI2006-保安站岗" class="headerlink" title="P2458 [SDOI2006]保安站岗 "></a><a href="https://www.luogu.com.cn/problem/P2458">P2458 [SDOI2006]保安站岗 </a></h4><p>这题我们要设3个状态 <del>至于为什么上题是两个我也没搞懂</del><br>分别表示被自己，儿子，父亲看到<br>剩下自行理解</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[N&lt;&lt;<span class="number">1</span>],head[N],ne[N&lt;&lt;<span class="number">1</span>],tot=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ne[++tot]=head[x],head[x]=tot,to[tot]=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[N][<span class="number">3</span>],a[N],n,m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">f[x][<span class="number">0</span>]=a[x];</span><br><span class="line"><span class="type">int</span> res=<span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs</span>(y,x);</span><br><span class="line">f[x][<span class="number">0</span>]+=<span class="built_in">min</span>(f[y][<span class="number">0</span>],<span class="built_in">min</span>(f[y][<span class="number">1</span>],f[y][<span class="number">2</span>]));</span><br><span class="line">f[x][<span class="number">2</span>]+=<span class="built_in">min</span>(f[y][<span class="number">0</span>],f[y][<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">if</span>(f[y][<span class="number">0</span>]&lt;=f[y][<span class="number">1</span>]) f[x][<span class="number">1</span>]+=f[y][<span class="number">0</span>],res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> f[x][<span class="number">1</span>]+=f[y][<span class="number">1</span>],res=<span class="built_in">min</span>(res,f[y][<span class="number">0</span>]-f[y][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">f[x][<span class="number">1</span>]+=res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x;</span><br><span class="line">cin&gt;&gt;a[x]&gt;&gt;y;</span><br><span class="line"><span class="keyword">while</span>(y--) cin&gt;&gt;z,<span class="built_in">add</span>(x,z),<span class="built_in">add</span>(z,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">cout&lt;&lt;<span class="built_in">min</span>(f[<span class="number">1</span>][<span class="number">0</span>],f[<span class="number">1</span>][<span class="number">1</span>])&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P2986-USACO10MAR-Great-Cow-Gathering-G"><a href="#P2986-USACO10MAR-Great-Cow-Gathering-G" class="headerlink" title="P2986 [USACO10MAR] Great Cow Gathering G "></a><a href="https://www.luogu.com.cn/problem/P2986">P2986 [USACO10MAR] Great Cow Gathering G </a></h4><p>如果以一为根这题就很好计算<br>设$s[x]$是以一为根时$x$的子树大小,$sum$为总大小<br>$f[x]=\sum\limits_{u\in  son[x]}f[u]+s[u] \times e(x,u)$<br>但是不定根。。。<br>我们考虑换根DP<br>我们考虑$g[x]$为以$x$为根时的答案<br>对于$u\in  son[x]$，$g[u]=g[x]-s[u]\times e(x,u) + (sum-s[u])\times e(x,u)$<br>即$g[u]=g[x]+(sum-2\times s[u])\times e(u,x)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> head[N],to[N&lt;&lt;<span class="number">1</span>],ne[N&lt;&lt;<span class="number">1</span>],e[N&lt;&lt;<span class="number">1</span>],tot=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n,ans=<span class="number">1e18</span>,c[N],s[N],sum,f[N],g[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ne[++tot]=head[x],head[x]=tot,to[tot]=y,e[tot]=z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[x]=c[x];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(y,x),s[x]+=s[y],f[x]+=f[y]+e[i]*s[y];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line">g[y]=g[x]-e[i]*(<span class="number">2</span>*s[y]-sum),<span class="built_in">dfs2</span>(y,x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;c[i],sum+=c[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y&gt;&gt;z,<span class="built_in">add</span>(x,y,z),<span class="built_in">add</span>(y,x,z);</span><br><span class="line"><span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>),g[<span class="number">1</span>]=f[<span class="number">1</span>],<span class="built_in">dfs2</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans=<span class="built_in">min</span>(ans,g[i]);</span><br><span class="line">cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="状压DP"><a href="#状压DP" class="headerlink" title="状压DP"></a>状压DP</h3><p>基于状压<br>有两种形式，棋盘式和集合式 (似乎还有基于轮廓线的)</p><h4 id="P2704-NOI2001-炮兵阵地"><a href="#P2704-NOI2001-炮兵阵地" class="headerlink" title="P2704 [NOI2001] 炮兵阵地 "></a><a href="https://www.luogu.com.cn/problem/P2704">P2704 [NOI2001] 炮兵阵地 </a></h4><p>预处理状态，DP中记录前两行状态，若无矛盾就转移</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=(<span class="number">1</span>&lt;&lt;<span class="number">10</span>)+<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> m,n;</span><br><span class="line"><span class="type">int</span> g[<span class="number">101</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;s[<span class="number">101</span>],sum[<span class="number">101</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=<span class="number">1</span>&lt;&lt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;p;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(j&amp;(j&lt;&lt;<span class="number">1</span>)||j&amp;(j&lt;&lt;<span class="number">2</span>)||j&amp;g[i]) <span class="keyword">continue</span>;</span><br><span class="line">s[i].<span class="built_in">push_back</span>(j);</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;n;++k) <span class="keyword">if</span>(j&amp;(<span class="number">1</span>&lt;&lt;k)) ++cnt;</span><br><span class="line">sum[i].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[<span class="number">101</span>][N][N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;m&gt;&gt;n;</span><br><span class="line"><span class="type">char</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x;</span><br><span class="line"><span class="keyword">if</span>(x==<span class="string">&#x27;P&#x27;</span>) g[i]&lt;&lt;=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> g[i]=g[i]&lt;&lt;<span class="number">1</span>|<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">pre</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s[<span class="number">1</span>].<span class="built_in">size</span>();++i) f[<span class="number">1</span>][s[<span class="number">1</span>][i]][<span class="number">0</span>]=sum[<span class="number">1</span>][i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s[<span class="number">1</span>].<span class="built_in">size</span>();++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;s[<span class="number">2</span>].<span class="built_in">size</span>();++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[<span class="number">1</span>][i]&amp;s[<span class="number">2</span>][j]) <span class="keyword">continue</span>;</span><br><span class="line">f[<span class="number">2</span>][s[<span class="number">2</span>][j]][s[<span class="number">1</span>][i]]=sum[<span class="number">1</span>][i]+sum[<span class="number">2</span>][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;s[i].<span class="built_in">size</span>();++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;s[i<span class="number">-1</span>].<span class="built_in">size</span>();++k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> p=<span class="number">0</span>;p&lt;s[i<span class="number">-2</span>].<span class="built_in">size</span>();++p)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[i<span class="number">-2</span>][p]&amp;s[i<span class="number">-1</span>][k]||s[i<span class="number">-1</span>][k]&amp;s[i][j]||s[i<span class="number">-2</span>][p]&amp;s[i][j]) <span class="keyword">continue</span>;</span><br><span class="line">f[i][s[i][j]][s[i<span class="number">-1</span>][k]]=<span class="built_in">max</span>(f[i][s[i][j]][s[i<span class="number">-1</span>][k]],f[i<span class="number">-1</span>][s[i<span class="number">-1</span>][k]][s[i<span class="number">-2</span>][p]]+sum[i][j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s[m].<span class="built_in">size</span>();++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;s[m<span class="number">-1</span>].<span class="built_in">size</span>();++j) res=<span class="built_in">max</span>(res,f[m][s[m][i]][s[m<span class="number">-1</span>][j]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(m==<span class="number">1</span>) cout&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;res;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P2831-NOIP2016-提高组-愤怒的小鸟"><a href="#P2831-NOIP2016-提高组-愤怒的小鸟" class="headerlink" title="P2831 [NOIP2016 提高组] 愤怒的小鸟"></a><a href="https://www.luogu.com.cn/problem/P2831">P2831 [NOIP2016 提高组] 愤怒的小鸟</a></h4><p>集合类状压，对每个状态，找到其没处理过的第一个部分进行暴力转移</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> NN=<span class="number">19</span>,N=<span class="number">1</span>&lt;&lt;<span class="number">18</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps=<span class="number">1e-8</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">jie</span><span class="params">(<span class="type">double</span> &amp;x,<span class="type">double</span> &amp;y,<span class="type">double</span> a1,<span class="type">double</span> b1,<span class="type">double</span> c1,<span class="type">double</span> a2,<span class="type">double</span> b2,<span class="type">double</span> c2)</span></span>&#123;<span class="comment">//解方程</span></span><br><span class="line">y=(a1*c2-a2*c1)/(a1*b2-a2*b1);</span><br><span class="line">x=(c1-b1*y)/a1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dp[N],low[N];</span><br><span class="line"><span class="type">double</span> x[NN],y[NN];</span><br><span class="line"><span class="type">int</span> line[NN][NN],n,t,T,m;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;T;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;i&lt;(<span class="number">1</span>&lt;&lt;<span class="number">18</span>);++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> j=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(j&lt;<span class="number">18</span>&amp;&amp;(i&amp;(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>))) ++j;</span><br><span class="line">low[i]=j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(T--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">t=<span class="number">1</span>&lt;&lt;n;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;t;++i) dp[i]=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;x[i]&gt;&gt;y[i];</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j) line[i][j]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">fabs</span>(x[i]-x[j])&lt;eps) <span class="keyword">continue</span>;</span><br><span class="line"><span class="type">double</span> k1,k2;</span><br><span class="line"><span class="built_in">jie</span>(k1,k2,x[i]*x[i],x[i],y[i],x[j]*x[j],x[j],y[j]);</span><br><span class="line"><span class="keyword">if</span>(k1&gt;-eps) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k) <span class="keyword">if</span>(<span class="built_in">fabs</span>(k1*x[k]*x[k]+k2*x[k]-y[k])&lt;eps) line[i][j]|=(<span class="number">1</span>&lt;&lt;k<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;i&lt;t;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> j=low[i];</span><br><span class="line">dp[i|(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)]=<span class="built_in">min</span>(dp[i|(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)],dp[i]+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k) dp[i|line[j][k]]=<span class="built_in">min</span>(dp[i|line[j][k]],dp[i]+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;dp[t<span class="number">-1</span>]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数位DP"><a href="#数位DP" class="headerlink" title="数位DP"></a>数位DP</h3><p>顾名思义，就是在数位上DP<br>我第一遍学的时候也不理解，第二遍就发现记忆化搜索是个好东西<br>引用一句话</p><blockquote><p> 递推本质是瞎猜，dfs本质是模板</p></blockquote><h4 id="P2657-SCOI2009-windy-数"><a href="#P2657-SCOI2009-windy-数" class="headerlink" title="P2657 [SCOI2009] windy 数 "></a><a href="https://www.luogu.com.cn/problem/P2657">P2657 [SCOI2009] windy 数 </a></h4><p>板子,注意前导零<br>因为接下来几道题都是板子，我不会讲解</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">25</span>;</span><br><span class="line"><span class="type">int</span> cnt,s[N],f[N][N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> len,<span class="type">int</span> last,<span class="type">int</span> done,<span class="type">int</span> qdl)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!len) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(!qdl&amp;&amp;!done&amp;&amp;~f[len][last]) <span class="keyword">return</span> f[len][last];</span><br><span class="line"><span class="type">int</span> ed=done?s[len]:<span class="number">9</span>,res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=ed;++i)</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">abs</span>(i-last)&gt;=<span class="number">2</span>)</span><br><span class="line">res+=<span class="built_in">dfs</span>(len<span class="number">-1</span>,(i==<span class="number">0</span>)&amp;&amp;qdl?<span class="number">13</span>:i,done&amp;&amp;(i==ed),(i==<span class="number">0</span>)&amp;&amp;qdl);</span><br><span class="line"><span class="keyword">if</span>(!done&amp;&amp;!qdl) f[len][last]=res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(x) s[++cnt]=x%<span class="number">10</span>,x/=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">dfs</span>(cnt,<span class="number">13</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">-1</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">    <span class="type">int</span> a,b;</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">    cout&lt;&lt;<span class="built_in">dp</span>(b)-<span class="built_in">dp</span>(a<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10166-数字游戏"><a href="#10166-数字游戏" class="headerlink" title="#10166 数字游戏"></a><a href="https://loj.ac/p/10166">#10166 数字游戏</a></h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">105</span>;</span><br><span class="line"><span class="type">int</span> f[N][N],s[N],cnt,mod;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> len,<span class="type">int</span> sum,<span class="type">int</span> done)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!len) <span class="keyword">return</span> !sum;</span><br><span class="line"><span class="keyword">if</span>(!done&amp;&amp;~f[len][sum]) <span class="keyword">return</span> f[len][sum];</span><br><span class="line"><span class="type">int</span> ed=done?s[len]:<span class="number">9</span>,res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=ed;++i)</span><br><span class="line">res+=<span class="built_in">dfs</span>(len<span class="number">-1</span>,(sum+i)%mod,done&amp;&amp;(i==ed));</span><br><span class="line"><span class="keyword">if</span>(!done) f[len][sum]=res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(x) s[++cnt]=x%<span class="number">10</span>,x/=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">dfs</span>(cnt,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> a,b;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;a&gt;&gt;b&gt;&gt;mod)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">-1</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">cout&lt;&lt;<span class="built_in">dp</span>(b)-<span class="built_in">dp</span>(a<span class="number">-1</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P4124-CQOI2016-手机号码"><a href="#P4124-CQOI2016-手机号码" class="headerlink" title="P4124 [CQOI2016]手机号码 "></a><a href="https://www.luogu.com.cn/problem/P4124">P4124 [CQOI2016]手机号码 </a></h4><p>注意特判$L=10^{10}$的情况，此时$L-1&lt;10^{10}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">50</span>;</span><br><span class="line"><span class="type">int</span> f[<span class="number">2</span>][<span class="number">25</span>][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>][<span class="number">10</span>][<span class="number">10</span>],s[N],cnt;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> len,<span class="type">int</span> done,<span class="type">int</span> c8,<span class="type">int</span> c4,<span class="type">int</span> ky,<span class="type">int</span> l1,<span class="type">int</span> l2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(c8&amp;&amp;c4) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(!len) <span class="keyword">return</span> ky;</span><br><span class="line"><span class="keyword">if</span>(~f[done][len][c8][c4][ky][l1][l2]) <span class="keyword">return</span> f[done][len][c8][c4][ky][l1][l2];</span><br><span class="line"><span class="type">int</span> ed=done?s[len]:<span class="number">9</span>,res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=ed;++i)</span><br><span class="line">res+=<span class="built_in">dfs</span>(len<span class="number">-1</span>,done&amp;&amp;(i==ed),c8||(i==<span class="number">8</span>),c4||(i==<span class="number">4</span>),ky||((l1==i)&amp;&amp;(l2==i)),l2,i);</span><br><span class="line">f[done][len][c8][c4][ky][l1][l2]=res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x&lt;<span class="number">1e10</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(x) s[++cnt]=x%<span class="number">10</span>,x/=<span class="number">10</span>;</span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">-1</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=s[cnt];++i)</span><br><span class="line">res+=<span class="built_in">dfs</span>(<span class="number">10</span>,i==s[cnt],i==<span class="number">8</span>,i==<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,i);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> a,b;</span><br><span class="line">cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">cout&lt;&lt;<span class="built_in">dp</span>(b)-<span class="built_in">dp</span>(a<span class="number">-1</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="恨-7-不成妻"><a href="#恨-7-不成妻" class="headerlink" title="恨 7 不成妻"></a><a href="https://loj.ac/p/10168">恨 7 不成妻</a></h4><p>这个题就有难度了 <del>因为我菜</del><br>我们发现 $(x+y)^2=x^2+y^2+2xy$<br>我们记录后面数字的个数和，总和，平方和求解即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">25</span>,mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;<span class="type">int</span> s1,s2,s3;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">md</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> (x%mod+mod)%mod;&#125;</span><br><span class="line"><span class="type">int</span> cnt,s[N],pw[N];</span><br><span class="line">node f[N][N][N];</span><br><span class="line"><span class="type">int</span> vis[N][N][N];</span><br><span class="line"><span class="function">node <span class="title">dfs</span><span class="params">(<span class="type">int</span> len,<span class="type">int</span> done,<span class="type">int</span> qdl,<span class="type">int</span> s1,<span class="type">int</span> s2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!len) <span class="keyword">return</span> node&#123;s1&amp;&amp;s2,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">if</span>(!qdl&amp;&amp;(!done)&amp;&amp;vis[len][s1][s2]) <span class="keyword">return</span> f[len][s1][s2];</span><br><span class="line"><span class="type">int</span> ed=done?s[len]:<span class="number">9</span>;</span><br><span class="line">node res=&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=ed;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i==<span class="number">7</span>) <span class="keyword">continue</span>;</span><br><span class="line">node tmp=<span class="built_in">dfs</span>(len<span class="number">-1</span>,done&amp;&amp;(i==ed),(i==<span class="number">0</span>)&amp;qdl,(s1*<span class="number">10</span>+i)%<span class="number">7</span>,(s2+i)%<span class="number">7</span>);</span><br><span class="line"><span class="type">int</span> k=pw[len]*i%mod;</span><br><span class="line">res.s1=<span class="built_in">md</span>(res.s1+tmp.s1);</span><br><span class="line"><span class="type">int</span> val=k*tmp.s1%mod;</span><br><span class="line">res.s2=<span class="built_in">md</span>(res.s2+tmp.s2+val);</span><br><span class="line">val=<span class="number">2</span>*tmp.s2*k%mod;</span><br><span class="line">res.s3=<span class="built_in">md</span>(res.s3+tmp.s3+val);</span><br><span class="line">val=k*k%mod*tmp.s1%mod;</span><br><span class="line">res.s3=<span class="built_in">md</span>(res.s3+val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!qdl&amp;&amp;!done) vis[len][s1][s2]=<span class="number">1</span>,f[len][s1][s2]=res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(x) s[++cnt]=x%<span class="number">10</span>,x/=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">dfs</span>(cnt,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>).s3;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">-1</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line"><span class="type">int</span> a,b;</span><br><span class="line">cin&gt;&gt;T;</span><br><span class="line">pw[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=<span class="number">18</span>;++i) pw[i]=pw[i<span class="number">-1</span>]*<span class="number">10</span>%mod;</span><br><span class="line"><span class="keyword">while</span>(T--)</span><br><span class="line">cin&gt;&gt;a&gt;&gt;b,</span><br><span class="line">    cout&lt;&lt;(<span class="built_in">dp</span>(b)-<span class="built_in">dp</span>(a<span class="number">-1</span>)+mod)%mod&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="基环树上DP"><a href="#基环树上DP" class="headerlink" title="基环树上DP"></a>基环树上DP</h3><h4 id="P4381"><a href="#P4381" class="headerlink" title="P4381"></a><a href="https://www.luogu.com.cn/problem/P4381">P4381</a></h4><p>基环树直径和，找环方法是跟$Dyd$神仙学的</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> head[N],to[N],ne[N],e[N],tot=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> v[N],in[N],fa[N],fw[N];</span><br><span class="line"><span class="type">int</span> c[N],ed[N],s[N],d[N],suf[N];</span><br><span class="line"><span class="type">int</span> q[N];</span><br><span class="line"><span class="type">int</span> res,ans,cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ne[++tot]=head[x],to[tot]=y,head[x]=tot,e[tot]=z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> in_e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">v[x]=in[x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i==(in_e^<span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span>(!v[y=to[i]]) fa[y]=x,fw[y]=e[i],<span class="built_in">dfs</span>(y,i);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(in[y])</span><br><span class="line">&#123;</span><br><span class="line">++cnt;</span><br><span class="line">ed[cnt]=ed[cnt<span class="number">-1</span>];</span><br><span class="line"><span class="type">int</span> sum=e[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> z=x;z!=y;z=fa[z])</span><br><span class="line">&#123;</span><br><span class="line">s[z]=sum;</span><br><span class="line">c[++ed[cnt]]=z;</span><br><span class="line">sum+=fw[z];</span><br><span class="line">&#125;</span><br><span class="line">s[y]=sum;</span><br><span class="line">c[++ed[cnt]]=y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">in[x]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">v[x]=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> d=<span class="number">0</span>,d1=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v[y=to[i]]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="type">int</span> d2=<span class="built_in">dp</span>(y)+e[i];</span><br><span class="line"><span class="keyword">if</span>(d2&gt;d) d1=d,d=d2;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(d2&gt;d1) d1=d2;</span><br><span class="line">&#125;</span><br><span class="line">res=<span class="built_in">max</span>(d1+d,res);</span><br><span class="line"><span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(i,x,y),<span class="built_in">add</span>(x,i,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(!v[i]) <span class="built_in">dfs</span>(i,<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) v[i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=ed[cnt];++i) v[c[i]]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=cnt;++k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> size=<span class="number">0</span>;res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=ed[k<span class="number">-1</span>]+<span class="number">1</span>;i&lt;=ed[k];++i) d[++size]=<span class="built_in">dp</span>(c[i]),suf[size]=s[c[i]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=size;++i) d[i+size]=d[i],suf[i+size]=suf[i]+suf[size];</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=size*<span class="number">2</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;=r&amp;&amp;i-q[l]&gt;=size) ++l;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=r) res=<span class="built_in">max</span>(res,d[i]+d[q[l]]+suf[i]-suf[q[l]]);</span><br><span class="line"><span class="keyword">while</span>(l&lt;=r&amp;&amp;d[q[r]]-suf[q[r]]&lt;=d[i]-suf[i]) --r;</span><br><span class="line">q[++r]=i;</span><br><span class="line">&#125;</span><br><span class="line">ans+=res;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P2607-ZJOI2008-骑士"><a href="#P2607-ZJOI2008-骑士" class="headerlink" title="P2607 [ZJOI2008] 骑士"></a><a href="https://www.luogu.com.cn/problem/P2607">P2607 [ZJOI2008] 骑士</a></h4><p>基环树上最大独立集</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 1e18</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,ans;</span><br><span class="line"><span class="type">int</span> head[N],tot=<span class="number">1</span>,ne[N],to[N];</span><br><span class="line"><span class="type">int</span> dp1[N][<span class="number">2</span>],dp2[N][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> sm[N],w[N],v[N],in[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ne[++tot]=head[x],to[tot]=y,head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> root;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> f[][<span class="number">2</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(sm[i]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(y=to[i],f);</span><br><span class="line">f[x][<span class="number">0</span>]+=<span class="built_in">max</span>(f[y][<span class="number">0</span>],f[y][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">f[x][<span class="number">1</span>]=-INF;</span><br><span class="line"><span class="keyword">if</span>(x!=root)</span><br><span class="line">&#123;</span><br><span class="line">f[x][<span class="number">1</span>]=w[x];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(sm[i]) <span class="keyword">continue</span>;</span><br><span class="line">f[x][<span class="number">1</span>]+=f[to[i]][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">v[x]=in[x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[y=to[i]]) <span class="built_in">dfs</span>(y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(in[y])</span><br><span class="line">&#123;</span><br><span class="line">sm[i]=<span class="number">1</span>;</span><br><span class="line">root=<span class="number">-1</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(y,dp1);</span><br><span class="line">root=x;</span><br><span class="line"><span class="built_in">dfs1</span>(y,dp2);</span><br><span class="line">ans+=<span class="built_in">max</span>(dp1[y][<span class="number">0</span>],<span class="built_in">max</span>(dp2[y][<span class="number">0</span>],dp2[y][<span class="number">1</span>]));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">in[x]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;w[i]&gt;&gt;x,<span class="built_in">add</span>(x,i);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(!v[i]) <span class="built_in">dfs</span>(i);</span><br><span class="line">cout&lt;&lt;ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="单调队列优化"><a href="#单调队列优化" class="headerlink" title="单调队列优化"></a>单调队列优化</h3><h4 id="10180-烽火传递"><a href="#10180-烽火传递" class="headerlink" title="#10180 烽火传递"></a><a href="https://loj.ac/p/10180">#10180 烽火传递</a></h4><p>$dp$方程容易得到<br>$dp[i]=\min\limits_{i-m\leq j&lt;i}dp[j]+v[i]$</p><p>$ans=\min\limits_{n-m+1 \leq i\leq n}dp[i]$<br>然后上单调队列优化就行了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> q[N],l=<span class="number">1</span>,r,a[N],dp[N],n,m;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line">q[++r]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(q[l]&lt;i-m&amp;&amp;l&lt;=r) ++l;</span><br><span class="line">dp[i]=dp[q[l]]+a[i];</span><br><span class="line"><span class="keyword">while</span>(dp[i]&lt;=dp[q[r]]&amp;&amp;l&lt;=r) --r;</span><br><span class="line">q[++r]=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">2e9</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;=n-m+<span class="number">1</span>;i--) ans=<span class="built_in">min</span>(ans,dp[i]);</span><br><span class="line">cout&lt;&lt;ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P2216-HAOI2007-理想的正方形"><a href="#P2216-HAOI2007-理想的正方形" class="headerlink" title="P2216 [HAOI2007]理想的正方形 "></a><a href="https://www.luogu.com.cn/problem/P2216">P2216 [HAOI2007]理想的正方形 </a></h4><p>二维单调队列，<del>但是不会</del></p><h3 id="斜率优化"><a href="#斜率优化" class="headerlink" title="斜率优化"></a>斜率优化</h3><p>可以看<a href="https://www.cnblogs.com/Xing-Ling/p/11210179.html">这个</a></p><h4 id="P5785-SDOI2012-任务安排"><a href="#P5785-SDOI2012-任务安排" class="headerlink" title="P5785 [SDOI2012]任务安排"></a><a href="https://www.luogu.com.cn/problem/P5785">P5785 [SDOI2012]任务安排</a></h4><p>对数组$f,t$做前缀和</p><p>暴力式子可以推出以$f[i]$为以$i$的结尾的最小值</p><p>则$dp[i]=\min\limits_{j&lt;i}(dp[j]+(f[n]-f[i])\times s+(f[i]-f[j])\times (t[i]+s));$</p><p>去掉$min$，展开式子</p><p>$dp[j]=(t[i]+s)\times f[j]+f[i]\times t[i]-s\times f[n]+dp[i]$</p><p>然后我们可以将每个决策看做每个点$(f[j],dp[j])$，每个方程看做一条形如$y=kx+b$的直线</p><p>因为我们要求$dp[i]$的最小值,$f[i]\times t[i]-s\times f[n]$是定值</p><p>所以$b$也就是截距要最小</p><p><del>见代码了</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> dp[N],n,s;</span><br><span class="line"><span class="type">int</span> f[N],t[N];</span><br><span class="line"><span class="type">int</span> q[N],l=<span class="number">1</span>,r;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">X</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> f[x];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Y</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> dp[x];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">K</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> s+t[x];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">check</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> (<span class="built_in">Y</span>(b)-<span class="built_in">Y</span>(a))&lt;=v*(<span class="built_in">X</span>(b)-<span class="built_in">X</span>(a));&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">check1</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> c,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> (<span class="built_in">Y</span>(b)-<span class="built_in">Y</span>(a))*(<span class="built_in">X</span>(d)-<span class="built_in">X</span>(c))&gt;=(<span class="built_in">Y</span>(d)-<span class="built_in">Y</span>(c))*(<span class="built_in">X</span>(b)-<span class="built_in">X</span>(a));&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> ll=l,rr=r,ans=l;</span><br><span class="line"><span class="keyword">while</span>(ll&lt;=rr)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> mid=ll+rr&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">check</span>(q[mid],q[mid+<span class="number">1</span>],x)) ll=mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> ans=mid,rr=mid<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> q[ans];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;s;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;t[i]&gt;&gt;f[i],t[i]+=t[i<span class="number">-1</span>],f[i]+=f[i<span class="number">-1</span>];</span><br><span class="line"><span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> dp);</span><br><span class="line">dp[<span class="number">0</span>]=<span class="number">0</span>,q[++r]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> p=<span class="built_in">find</span>(<span class="built_in">K</span>(i));</span><br><span class="line">dp[i]=dp[p]+(f[n]-f[p])*s+(f[i]-f[p])*t[i];</span><br><span class="line"><span class="keyword">while</span>(l&lt;r&amp;&amp;<span class="built_in">check1</span>(q[r<span class="number">-1</span>],q[r],q[r],i)) --r;</span><br><span class="line">q[++r]=i;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;dp[n]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P3195-HNOI2008-玩具装箱"><a href="#P3195-HNOI2008-玩具装箱" class="headerlink" title="P3195 [HNOI2008]玩具装箱 "></a><a href="https://www.luogu.com.cn/problem/P3195">P3195 [HNOI2008]玩具装箱 </a></h4><p>首先对$C$数组做前缀和并使$c[i]=c[i]+i$,暴力$DP$式子容易得到<br>$dp[i]=\min\limits_{j&lt;i}(f[j]+(c[i]-c[j]-L-1)^{2})$</p><p>我们使$L++$,并将式子拆开</p><p>$dp[i]=dp[j]+(c[i]-c[j]-L)^2$</p><p>$dp[i]=dp[j]+c[i]^2+c[j]^2-2\times L \times c[i]\times c[j]$</p><p>$c[j]^2+dp[j]=2\times c[i]\times c[j]+dp[i]-c[i]^2$</p><p>然后对于一个确定的点$(c[j],c[j]^2+dp[j])$ 斜率为$2\times c[i]$一定且递增</p><p><del>没有图tmd不想写了</del></p><p>则我们应为维护一个上凸包……</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e4</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,L;</span><br><span class="line"><span class="type">int</span> c[N],s[N];</span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line"><span class="type">int</span> q[N];</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">y</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> f[x]+s[x]*s[x];&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;L;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;c[i],c[i]+=c[i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) c[i]+=i;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=n;++i) s[i]=c[i]+<span class="number">1</span>+L;</span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">q[++r]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;r&amp;&amp;(<span class="built_in">y</span>(q[l+<span class="number">1</span>])-<span class="built_in">y</span>(q[l]))&lt;=<span class="number">2</span>*c[i]*(s[q[l+<span class="number">1</span>]]-s[q[l]])) ++l;</span><br><span class="line">f[i]=f[q[l]]+(c[i]-s[q[l]])*(c[i]-s[q[l]]);</span><br><span class="line"><span class="keyword">while</span>(l&lt;r&amp;&amp;(<span class="built_in">y</span>(q[r])-<span class="built_in">y</span>(q[r<span class="number">-1</span>]))*(s[i]-s[q[r]])&gt;=(<span class="built_in">y</span>(i)-<span class="built_in">y</span>(q[r]))*(s[q[r]]-s[q[r<span class="number">-1</span>]]))--r;</span><br><span class="line">q[++r]=i;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;f[n];</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P2120-ZJOI2007-仓库建设"><a href="#P2120-ZJOI2007-仓库建设" class="headerlink" title="P2120 [ZJOI2007] 仓库建设"></a><a href="https://www.luogu.com.cn/problem/P2120">P2120 [ZJOI2007] 仓库建设</a></h4><p>同理 <del>主要是觉得码风很好，贴个代码</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> d[N],p[N],c[N],n,dp[N];</span><br><span class="line"><span class="type">int</span> s1[N],s2[N];</span><br><span class="line"><span class="type">int</span> q[N],l=<span class="number">1</span>,r;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">X</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> s1[x];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Y</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> dp[x]+s2[x];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">K</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> d[x];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">check</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> (<span class="built_in">Y</span>(b)-<span class="built_in">Y</span>(a))&lt;=v*(<span class="built_in">X</span>(b)-<span class="built_in">X</span>(a));&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">check1</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> c,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> (<span class="built_in">Y</span>(b)-<span class="built_in">Y</span>(a))*(<span class="built_in">X</span>(d)-<span class="built_in">X</span>(c))&gt;=(<span class="built_in">Y</span>(d)-<span class="built_in">Y</span>(c))*(<span class="built_in">X</span>(b)-<span class="built_in">X</span>(a));&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">cin&gt;&gt;d[i]&gt;&gt;p[i]&gt;&gt;c[i],s1[i]=s1[i<span class="number">-1</span>]+p[i],s2[i]=s2[i<span class="number">-1</span>]+d[i]*p[i];</span><br><span class="line"><span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> dp);</span><br><span class="line">dp[<span class="number">0</span>]=<span class="number">0</span>,q[++r]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;r&amp;&amp;<span class="built_in">check</span>(q[l],q[l+<span class="number">1</span>],<span class="built_in">K</span>(i))) ++l;</span><br><span class="line"><span class="type">int</span> j=q[l];</span><br><span class="line">dp[i]=dp[j]+d[i]*(s1[i]-s1[j])-(s2[i]-s2[j])+c[i];</span><br><span class="line"><span class="keyword">while</span>(l&lt;r&amp;&amp;<span class="built_in">check1</span>(q[r<span class="number">-1</span>],q[r],q[r],i)) --r;</span><br><span class="line">q[++r]=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">9e18</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;~i;--i)</span><br><span class="line"><span class="keyword">if</span>(p[i]) <span class="keyword">return</span> cout&lt;&lt;<span class="built_in">min</span>(dp[i],ans)&lt;&lt;endl,<span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> ans=<span class="built_in">min</span>(ans,dp[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数据结构优化"><a href="#数据结构优化" class="headerlink" title="数据结构优化"></a>数据结构优化</h3><h4 id="The-Battle-of-Chibi"><a href="#The-Battle-of-Chibi" class="headerlink" title="The Battle of Chibi"></a><a href="https://www.luogu.com.cn/problem/UVA12983">The Battle of Chibi</a></h4><p>设$f[i][j]$代表前$j$个数中连续上升序列长度为$i$的方案数<br>则$f[i][j]=\sum\limits_{k&lt;j}f[i-1][k] \times (a[k]&lt;a[j])$<br>我们发现可以用树状数组优化</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e3</span>+<span class="number">5</span>,mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n,m,a[N],v,c[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=n;x+=<span class="built_in">lowbit</span>(x)) (c[x]+=v)%=mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) (res+=c[x])%=mod;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[N][N],T,te,num[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;T;</span><br><span class="line"><span class="keyword">while</span>(++te&lt;=T)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][<span class="number">1</span>]=<span class="number">1</span>,cin&gt;&gt;a[i],num[i]=a[i];</span><br><span class="line"><span class="built_in">sort</span>(num+<span class="number">1</span>,num+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(num+<span class="number">1</span>,num+n+<span class="number">1</span>)-num<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(num+<span class="number">1</span>,num+M+<span class="number">1</span>,a[i])-num;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">2</span>;j&lt;=m;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) c[i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][j]=<span class="built_in">ask</span>(a[i]<span class="number">-1</span>),<span class="built_in">add</span>(a[i],f[i][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) (ans+=f[i][m])%=mod;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Case #&quot;</span>&lt;&lt;te&lt;&lt;<span class="string">&quot;: &quot;</span>&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Flowers"><a href="#Flowers" class="headerlink" title="Flowers "></a><a href="https://www.luogu.com.cn/problem/AT_dp_q">Flowers </a></h4><p>我们令$dp[i]$为以$i$结尾且取$i$的最大值<br>$dp[i]=\max\limits_{j&lt;i,a[j]&gt;a[i]}dp[j]+a[i]$<br>我们发现前一个式子可以用线段树维护</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid (l+r&gt;&gt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> f[N],n,h[N],a[N],ans;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r;</span><br><span class="line"><span class="type">int</span> tag;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].l=l,t[k].r=r;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid),<span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].tag=<span class="built_in">max</span>(t[k].tag,v);</span><br><span class="line"><span class="keyword">if</span>(t[k].l==t[k].r)  <span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">change</span>(x&lt;=t[k1].r?k1:k2,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k].l&amp;&amp;r&gt;=t[k].r) <span class="keyword">return</span> t[k].tag;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k1].r) res=<span class="built_in">max</span>(res,<span class="built_in">ask</span>(k1,l,r));</span><br><span class="line"><span class="keyword">if</span>(r&gt;=t[k2].l) res=<span class="built_in">max</span>(res,<span class="built_in">ask</span>(k2,l,r));</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;h[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> k=h[i]&gt;<span class="number">1</span>?<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,h[i]<span class="number">-1</span>):<span class="number">0</span>;</span><br><span class="line"><span class="built_in">change</span>(<span class="number">1</span>,h[i],a[i]+k);</span><br><span class="line">ans=<span class="built_in">max</span>(ans,a[i]+k);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="矩阵快速幂优化"><a href="#矩阵快速幂优化" class="headerlink" title="矩阵快速幂优化"></a>矩阵快速幂优化</h3><p>由于矩阵满足结合律<br>在一些转移方程恒定，转移轮数为$n$且$n$巨大的时候使用</p><h4 id="P1962-斐波那契数列"><a href="#P1962-斐波那契数列" class="headerlink" title="P1962 斐波那契数列"></a><a href="https://www.luogu.com.cn/problem/P1962">P1962 斐波那契数列</a></h4><p>板子 构造矩阵<br>因为$\begin{bmatrix}<br> f[x]\<br>f[x-1]<br>\end{bmatrix}=<br>\begin{bmatrix}<br>  1&amp;1 \\<br>  1&amp;0<br>\end{bmatrix}<br>\times<br>\begin{bmatrix}<br> f[x-1]\<br> f[x-2]<br>\end{bmatrix}$</p><p>$\begin{bmatrix}<br> f[n]\<br>f[n-1]<br>\end{bmatrix}=<br>\begin{bmatrix}<br>  1&amp;1 \\<br>  1&amp;0<br>\end{bmatrix}^{n-1}<br>\times<br>\begin{bmatrix}<br> f[1]=1\<br> f[0]=0<br>\end{bmatrix}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2</span>,mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> f[N][N],m,n;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">m=x,n=y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;++j) f[i][j]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> *(<span class="type">const</span> node &amp;x,<span class="type">const</span> node &amp;y)</span><br><span class="line">&#123;</span><br><span class="line">node z;</span><br><span class="line">z.<span class="built_in">clear</span>(x.m,y.n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x.m;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;x.n;++k)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;y.n;++j)</span><br><span class="line">(z.f[i][j]+=x.f[i][k]*y.f[k][j])%=mod;</span><br><span class="line"><span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> ^(node &amp;x,<span class="type">int</span> y)</span><br><span class="line">&#123;</span><br><span class="line">node res=x;</span><br><span class="line">--y;</span><br><span class="line"><span class="keyword">while</span>(y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=res*x;</span><br><span class="line">y&gt;&gt;=<span class="number">1</span>;x=x*x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,k;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">if</span>(--n&lt;<span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">node a;</span><br><span class="line">a.<span class="built_in">clear</span>(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">a.f[<span class="number">0</span>][<span class="number">0</span>]=a.f[<span class="number">1</span>][<span class="number">0</span>]=a.f[<span class="number">0</span>][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">a=a^n;</span><br><span class="line">cout&lt;&lt;a.f[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P3193-HNOI2008-GT考试"><a href="#P3193-HNOI2008-GT考试" class="headerlink" title="P3193 [HNOI2008]GT考试"></a><a href="https://www.luogu.com.cn/problem/P3193">P3193 [HNOI2008]GT考试</a></h4><p>暴力$KMP$转移是$O(nm^{2})$的<br>我们可以得到以下暴力</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">21</span>;</span><br><span class="line"><span class="type">int</span> mod;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">md</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> x&gt;=mod?x-mod:x;&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> f[N][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="title">node</span><span class="params">()</span></span>&#123;<span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f);&#125;</span><br><span class="line">&#125;g;</span><br><span class="line"><span class="type">char</span> T[N];</span><br><span class="line"><span class="type">int</span> n,m,ne[N],ans;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> *(<span class="type">const</span> node &amp;x,<span class="type">const</span> node &amp;y)</span><br><span class="line">&#123;</span><br><span class="line">node z;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;m;++k)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;m;++j)</span><br><span class="line">(z.f[i][j]+=x.f[i][k]*y.f[k][j])%=mod;</span><br><span class="line"><span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> ^(node x,<span class="type">int</span> y)</span><br><span class="line">&#123;</span><br><span class="line">node res=x;--y;</span><br><span class="line"><span class="keyword">while</span>(y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=res*x;</span><br><span class="line">y&gt;&gt;=<span class="number">1</span>;x=x*x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>,i=<span class="number">2</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(j&amp;&amp;T[j+<span class="number">1</span>]!=T[i]) j=ne[j];</span><br><span class="line"><span class="keyword">if</span>(T[j+<span class="number">1</span>]==T[i]) ne[i]=++j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="string">&#x27;0&#x27;</span>;j&lt;=<span class="string">&#x27;9&#x27;</span>;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> p=i;</span><br><span class="line"><span class="keyword">while</span>(p&amp;&amp;T[p+<span class="number">1</span>]!=j) p=ne[p];</span><br><span class="line"><span class="keyword">if</span>(T[p+<span class="number">1</span>]==j) ++p;</span><br><span class="line">++g.f[i][p];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m&gt;&gt;mod;</span><br><span class="line">cin&gt;&gt;T+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">pre</span>();</span><br><span class="line">node a;</span><br><span class="line">a.f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">a=a*(g^n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line">ans=<span class="built_in">md</span>(ans+a.f[<span class="number">0</span>][i]);</span><br><span class="line">cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们发现每一次$KMP$相对转移的下标是相同的<br>我们就可以构造出转移矩阵，然后矩阵快速幂<br>时间复杂度为$O(m^{6}logn)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">21</span>;</span><br><span class="line"><span class="type">int</span> mod;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">md</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> x&gt;=mod?x-mod:x;&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> f[N][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="title">node</span><span class="params">()</span></span>&#123;<span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f);&#125;</span><br><span class="line">&#125;g;</span><br><span class="line"><span class="type">char</span> T[N];</span><br><span class="line"><span class="type">int</span> n,m,ne[N],ans;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> *(<span class="type">const</span> node &amp;x,<span class="type">const</span> node &amp;y)</span><br><span class="line">&#123;</span><br><span class="line">node z;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;m;++k)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;m;++j)</span><br><span class="line">(z.f[i][j]+=x.f[i][k]*y.f[k][j])%=mod;</span><br><span class="line"><span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> ^(node x,<span class="type">int</span> y)</span><br><span class="line">&#123;</span><br><span class="line">node res=x;--y;</span><br><span class="line"><span class="keyword">while</span>(y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=res*x;</span><br><span class="line">y&gt;&gt;=<span class="number">1</span>;x=x*x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>,i=<span class="number">2</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(j&amp;&amp;T[j+<span class="number">1</span>]!=T[i]) j=ne[j];</span><br><span class="line"><span class="keyword">if</span>(T[j+<span class="number">1</span>]==T[i]) ne[i]=++j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="string">&#x27;0&#x27;</span>;j&lt;=<span class="string">&#x27;9&#x27;</span>;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> p=i;</span><br><span class="line"><span class="keyword">while</span>(p&amp;&amp;T[p+<span class="number">1</span>]!=j) p=ne[p];</span><br><span class="line"><span class="keyword">if</span>(T[p+<span class="number">1</span>]==j) ++p;</span><br><span class="line">++g.f[i][p];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m&gt;&gt;mod;</span><br><span class="line">cin&gt;&gt;T+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">pre</span>();</span><br><span class="line">node a;</span><br><span class="line">a.f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">a=a*(g^n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line">ans=<span class="built_in">md</span>(ans+a.f[<span class="number">0</span>][i]);</span><br><span class="line">cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test20221231</title>
      <link href="//OI/test20221231/"/>
      <url>//OI/test20221231/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="可以问本人" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="f9a55ce185b75879d46bcdfca1ca680db68523b7d096e82f53d6ac7cf0a434d7">d5e3718bcc770231b783de73051b8484b0ee65bb797bd11acc5ce6f6edc7077694522efbc934f796325791f63c4918c6088a1f726a97bfc5eda4771bea6674fb328626236f5acce4caaf6f543c3703813e166a07ad662f068173de489426c93fee518c12a5cec9f726663bd7f6e6ffd0f4f3513266803486195e0d247eba6385bef6247af4dacb88589992fe1d4d271e9220c84f40f9b4cfad28bb7b97ed535215f0c028e0bfbc5983c1780255d40934b0db4abfce823d1dc0b4b3b4a6a615ebe030b308dc19275930b215d935663a7425448550d07a66fabdb1a54f3fcd25da8b77760d87011dbce1518d7092f76891352a1a2911ebb3dcf831323a47841f3f594f1ae151198d13f1795659fec29b15bbcfc72e134e1b51f82bfe84a22a17747d1efea115a96828b46ad42496b1d8573ca54f66d0e8166f32064b9574a98abc711e3e55073906f87fdd4704d931b38656581e65bd23729017ff5108d5b3da0973d40ec5e11512ad00ecd328797edea9548a95ae0e398181cbad8e4991b80b77444b10d1419a5ea2f7de8147f1b7cd264a765d181a49fa5b81dae4ba3670cd9f05046b5c432a9c3f5acc8159727b509c8ad0d86874f50f2d4488bc0645d2f95994df29bba2f79be2f309c0092240992ceecc1ccf0c401430584cb0d5d0984be00c0ce8eb94d2a0025ede46a6684ee149b494bdc9d100b11d4650b5d63cf0f378dae9fd595d650c77845f5dac3d61ceeeb75f7eea4addbb5fe3cb099aedc4b944f38f66fe9fc7b129a3261066512a0a8be304c0d5570393738b3d83f7d9d98ac0a7bc8f12a194924e9cebd508d789ca83d76613bf08ef0b114478d839f1d7193c8a1e68af68a5f74a5fe159869aa37a7b616f7e99d58aa017fe49c3b811ee32b252170d722b2e341d56e5b09be2fe07b5454d268c96accc96fba2791a40e3822c384769ff39554bf0da6e2da79cb23464f770ab49938f9d47a1cc2f2711c587504c35d3bd5a27bf3f943f8a3e30287d2c59bedd1cf96d534a83da4c68f698bcfc0684ac8f11f38619b51481616bc01b63c45d3e54ee9f667ff44116f3140a4cdaed6144bf8ae421e2d318e9278c1f665ea241d42c98c961d7162d406b864cbb16eeb7758da01448c24bac6cc4761909dd3c3cebddc622e424fafc2be850fcef05cfc7eca7b82924e4dda9473181291a97c8efc364512483f2ca950b7566f233c37386a978acf91c90fbaac0f6bd1317901ff869d2cbfa37c46f114fca23cc50ff03a390f499d11f01b360485555c7ea6f4942a7282452f8705784140519c8ec8ec801bec760da89f39d2ad196331187449e2b1882c1dbf479ac2f4c6272ba6cdc8bbb30e056facc998e68b86bd5b03c2f45f14f302f7597370cd84c287d26407425ba11bb9ef6bcd2c197298d06d48749da8bf5fbca3b06d943d0700fe25a9a2dd74f33077e5a8588f019a8e9b6d8a6085722aaaaea75e95a6488f9b900bc31c64d00f0b5a076ea5a6ffb6410922375e6cf60c98615eac35a80fc85a858ec7216f9963b45fa900094eecb1e983b9953917c7132ce6e8d4e11f5c664d3e0293f8cf199bdd3829fe5ee400f9f80609bb5443449d6ee92de549c9f51bf81b51d6772f1d6b798dd0343c9a6c9257eab7cbbddb6920eff7d66ae52389f966b4870be78f1869f5a8084bf05a4643b7d79a3400cdfa460b15e281209c0e8c7aec0cd5e93ee943db98a3dd5e3f0bb80fda6461cd544f0acdc37509c8f6b677b3e86cc9fb1b8c6f42614777b17010d803b826e3f05080139c229ee6086c461c4753b199bd44db75777d6d64ff4709d02f164b8765b95dacacc3bac0f0ea6a615a10f58c6a2adca1162e6224220c14ccf0f7f1e71149cceb92fad9b98f46b186b28fd48867054c4214531bd1db1a0ae3dbcf1f087d6d4f701ad6c7689b61c37ff6f4135ee45aeb3ded80d1a88e9d10ea4029c94437492f7e00d94e8d617b4778985bc69d09830b6acd8d58242456d41e190b4f3ca7c992e5f91c97acc2736388670887234d9707a10c5b9158f555683c86368aa37a95128ddb3d8d70804efd3c5ab967fc9314e6994a0661ec0b288555a0fe7c7d9a06f22a2081609d319262b465b277913ce0465163181b1b98305eeb9f8dda4940df94b96cd1b7513d9f20b483a95650fbd1d825021c4d61f03c16cd544ea306c94b0287451554169e68bc087469bffe79abf95e52d0c5c298f162185c11ef21d97767e569c63ed9081a62fed2cbace1b0d9a421588679fa83fc38e69cc000004b465ac8ff1b263e1fe6a73fa66a1efcb5bec5d6da48d895556babab96dcac1a39fd109f3634d8e7edb1824be1443872e7e709a8cbbf6a195e24eff2bb18e5bac24a8b1aa66ce39a85df7192fd11d6dfe8b2fd7f367a7da7ffca1320042a2b13f7d024c7ae034ce0c0824a2f1448ac4e21594ad4523a789340ac1c8ab235299082a8f3a68cf62fd07d976637e31b965684cf3892fe4e7655852746c0ef4085c261aa7d5a690113a0dabde3ef84c9f586e722686e3114346a6319aa8c2633d69dd4647ee06307078822a7c02eba9d2bc8eedeb0ad2cd4388634e1ae210ac042855f6a092ee35d9bf0beb45113daba0965665c8f14ab0fef58f9f222876d68b1713bb3bdcdcfc350a672e6fae738ba3db37faca0d0899221c811bfe77c32bb71fb95a8d04c896b9d67087ce39ada3ca236e6f1e26ed765a8444ba169f2fecee3996bcf1bb0652c626c85cd9a882a4adee5ca8233c2cf9b1e1afd778a8b4238ad51be4cc339d6a1f2dcfc8b5ff5963441ac384d542aa1d896a8e4544c65ea1e42d14c4d08604381bcbc676073bc94495fcbee3abc79f737ceb1ffa59a7a4ed1fb4a9435c2b2ee6ce38fa4371d50cf2f17be6fee3c0f8f2a54a724315e65efb0d2bb8e148c6e9a41e99cc86a2cdc30d13d5de3381a618a6e3c4a6ea9f108b0f057953ceafb2bd98b94ac568c51597060072578ba162e5706779e80c177fe4eadd79a5219945d9730c73ebc5812af83cf0b17408e4186dc19c0245e4bf6a0c0245bb73efbd678aebd646420d5c04904aea981c0b507bfc0d1c6e5b806d3c9c36f42f9445faf791d63d5275355acf85f054e6009e9ddea2ce32862ff75e45ea845cc810cf8b68b3bfd3b0846748f168374ba548d0756aecaf12643e1e35dfb098ef2ce230c45a62e3162f09b51cd63c8ba3954a4c2398c23da64402256f768e1c142a9bc7b75a294949e3979528524f34fb1c0f1feaf6b86f7bd8e927592781d40f0e2b90b89b468337ba28967200cd2082b028dc1abda7a060b4d11e3fb7c682621fbdd33346fceb71bdaf4f6fe3fcc08a6bd9ebf8d58c175e9650affd2bca6788b4fee7413424d533c8ac8fcd52d78ff98be4bc08411c552b9a069ed37701a260ef250bc16f744c84d8a20537eb0d95f3a3f37050e147d60f2ab5bf521dc191396b896aa418b80edf90b805930b57e3ed6fe5e881130919f35ff912ddacf534c5f77f2b7ad8a26710d6299aaf5be9089dd693d118842dc4cea603d7209b0e483d2ef5e8a42d3956ceb52371c159778b439a02677d882d61995329aee86d635f517e4a93a789cfdea89888ec4f80f5e1121c628778f22344bc1e8084a9b202336de8e42317d8491b6dfad8ecf84e298ad3012066331114de5abbe89b17ed187ac879c50cdf09ec076454f6aaea2f1756caa7164d24c50ecaea629d7c1e78a499613b6ae1679ff5319118d9ca524ab54a7a9239a3b01983ecfd37c3a33f86a2c6946d9a83833aa704426a054eab396ffcc58ad5cf5c47b0f4bcab492f066ab97cf970194b3b24c3578f23498ca78cfaf5ebeccadeda61be1c2cde0863ca64c778878f8c6ae13cd91848277ee2212c1491ee2a4f22a65ba1a36d6d1fe89c825f827cf25b48bb78618c42bb15e800455e04f676d7b5388bc8dc0132f6366d34304f264a2a61abe5bea85bd5f5fac895ac3fd38c4c34dd233c111d1faac2903a527934f6607fe8e83d0aad180f277c4a96f28fe8729fc5426efe1571806796fbf25a8d64b71595676c3c73a69f459224bac1d530e269fd858f9eeca8f69e9fb2bbf5c30de099880d7e98cff204e3a01f3330f141f7b6f9f863019492ea420fcbb6d297269e10b507c7206f2ce866694e0d8ebb9aed35f91baea6223d50000b6843e6a150f85ee989cd144bf1a31e8edcd0bd5f8a975157b58e0d16ac4c8faea31a0f99b2ad714d680aa744d3c8d3345eff76d213ae23070b1a20afa99c2eef3c2796d3aa2c3737f2883d744ea2cc9fea8b5adf97fbdc82ac1be71088f0e63454de7547fa1e75686fc83f14a37c5f622f8c751cb382dbaadebd1fd00feb46699372b0e0785eda33dff4301f32577cd89b4e367fe2c3c328517ca954d42974ca5a34e0023d6ee8385cefe2936954b6fff9a99183805dfe308f74f446b19b5aa2956ce59604cc45d128d1b2cdcbe17e518984bc1a3ce55195245d90a455871cdd4362725a48b1ec2e89885c1fe8e7247628caec8ff5d6847cc147ed257516392b0ee785e3d7442e77f4e7c070e60ffcfe9c5c9c81fb99242b8454b584bc008fa77bda6c831fed55a375ab6c003909c88fdcf1512a9c1d1e2a08aaa79c4380bed556a07a925a8430c37b05bc5438b2878f71a21e78571499fa26dc6e25e061da85e8bfbe5ee8a2f3eca4b83fbf84a0c903c04aec4c78594424ec7863c60d216d387a1c9f8eaa847b11a94c3174f0ba14133774eb7ab90d59937ffaa86d09be58a334d023fbe56718903137751e2ba06df19604d4f42b67ab4b748ae0c9da3edbf1ec7853f7f4adf7e083fb0f3e7b4699a8affd7b8531a6c4ce5bafa30807eecb61faf03f2edcda8f2a5d742ca23f0b126e61245d6354a184a1701209f8cd10c153305588ffa8c01d4388b0b04c688b53e697fad8edb88be37159af3dbb9261f10f32ac60302a0f75ce13106cc34bb80c42ee2b8a3d0b3ba0cbb9a7d577021a4bcfa69ac54eea645d7451fa0c5aeebc43e3310817e7af7475b887df2d47e358301509333923a23014c1bba99c8c3c8d87f2787a331ffcfe37803ced07c211f4874d2099bbb076406b20a2ee33ec461924660b86b2c6293cb63b6afc01346b98dcdc44b6e7b86055b68f9e28b2557629b41fa477831fa967b862eb803c88ec22fae72b2093bb26451af9d58179f08ff57bb0e0312105243b8a7268987c98abeb9729ed9e2d569a3d5959c183953ef164398db64e0f0ff2c523102cf480753234bc4e2aac58b17eae9326180a0b3afb10a0c9e2a803e05e81bd0381c3e62b9d9355be21fff8052c29083573517cdb63dae5ecf87a6e4d1cbae76a9e83235327fc96cd74adb7067c8ea4687450aeab5339b3b393879c2fa09b54032b5dd1f8225ae8ea700dc6d3af861d3cb6e7acc315804916056088da2257754d59ec6e869b380ccd4b57fee938300d27f60b2f88bd465b5a4ce6c2c23380b99f84e5e7b67e74198a78f6d50b01aaaa91016baa9262266918d8c19af20da12486cb12099c29db04229359f1b64fa6f51905a5bf6f59632bc615b314eb52116a241a783955c36bf48aaa9b142dbcb087a684cdc2bf2491f9d3711480676d4ac90182df4eed2b33e8a8fbcb10bcf6d5b0f19451d64cf68db5707c091c27807d78d60db7e4c2db2b6bebf074d9c7e5643943bfcbddbb24e80ebe8e9f13f44833956f33adea18d5cdbaf95515511e912887e81ab0f7885721012bca93093bc0da6bc763170474bd4da780e819c6b5757fa85971c4fc76772b61edc06bbf6201fc6314161808be98fa47e2a70bc857ba85740772c59948d2d2e3cfb4963188e330592d506a08cc04a822ff26db929226208382d5fcb83d480805be1079dae72f15aeea37f0638e67e764f7c196139455623568edfcd20d341a1b72e8637e9058b37e9e0d19f3c1ef1ec0672f41c21b457b68a01049e5a3e493e0a409b70a3b432ed7c6658c29dfa63ccb83ecee85e451086a4fc319d8bdabc83b84e3379619d1483712a63e5200faf711ba44f68050e9d7ffec15a77344c001eec7a955459bab82aeb9b7a6abb55bbc9250b922f66029177ae5f31a7c18cf615814751a982738849e75d87ce228a97653af01f488e9f235eb6a5f2fb6939481951d9aa18367eeff617083de3af77d739ea4ede82548c9b3cedbe825d6923c6305042fa9fdc5870bba55797c0caa19f590ab09ee3851ca9986fe28bc06002ea9c9976a0b8a87b4be16c5e14efc4039f4b6849d228f8f0fa2c46d0d0be9a83cb190966bd632ec13693e3de49a13f614557a615aba7947f8ceaf77e0a564ed2f656afa153e4d7996a0139958f6b978955dd82a5c41c97d4ed262a1a5090289798ff4e85cd0e0127436ff8e4297e658fecfb60cbe45ce594cc2f1d8686c1fb863c38bcbbe99aacb1b65c57a4b6a013dd4719f965cee97b151b8e9b19990587faf6276b6cb40a0b57fcf8fa1d89e5b1d99ad5c6776a46c5deae2676c4eb950d4342b8c525299ad64ae32c49bce7cba4211e2eda6601db2438a0358de0f341961b5795262caf869242e159a9863294746c0d946af35a97225bcfe8f776e4769aa36a4dccfe8f6f94a4310319871a7a410081ecf1b139557edba17037498274492972ae602798311b2d7a0fd9eb53722235ded8ba514c938e1dd186fc4835a104f2b9215c7a20632141d25bbac65bb81e6afc6c6d2a434f548c3ed4d504b75e7694a3b740cf5b2bc7acf89a73d272de35a718df914d1f89a06fe82b70d9bc1cd0b9536c5b4c1a36424248f2c5b8b92e4d4686b1496a942015457cbca9e9faf273712220e839fe3931f3b1ad6aa768651f3c0b995c65eadf3f92628ee5e5867ea5890d82693360080fc8166e4c46e1823a7250b3efbcbe1f33c113ffc233b4c0dd5f0a8daab714c024e946077052da38188eb779728aa147f975d977681eab93c22a3f47417a3fd917960d169cc2da353a3031712afbe01c6704847ad3a4b70aef684abc066e0dfa0a375c49c61c52271cb01ad7e3688f6b51e63ea9fccb4134eaaa26bf9b2858014b94a5319c3c2b0c672a94ba8b244dd06675c21543f13987b387203efbb737516319f7e0a0c7f5f6018b3389bb860eff2147d8c34dc09539e54fa23393e47bbbb74d08caa87882703a2bc68af6593f1720b493f10c854fa7f20fa3875281b79649e2c8b0a367a48bd31502cb8a27dcc64f75815785d2cec1736dc5e3e57f0a1187eb0818310d18fdf8ed8ed399b1582d0736640eb80adebd30a94a7cf0885c2d74bc1d9277ca5753ee17754824567f8a1c418c744767f05c017449b3cb09f91d8aecbc79bc2a8c550799fce15b27f8db5d5a465822593fcbfe4bf1fe1662e6d74ff2abff53ffc6076b56773053c9cce77d53975be5ad0126a45902ccad5f0a0d2827451fcb14c0d58ecd41a2eaf334bc7e3c701f372061603ed1b71fd5a730da249374e07c7c07d07be0c3f8eaf899876106c9ce40b3bfc9fe216b5d6f951b2c2f8ee0e72202abe5610d7e65cb42af0bcb00d18db3da16c31ff980b0fa8ff092b315adc2aaa70d20e440ba9ec53259bb95ea3caaf92619f9a5aef1dd1b8131dedd969502d8f80d5963e76dd85f0f40a6ac4c7ddbd28939f2f1a6651a145cb53aa1fa3cdf2ffd9ed376c006cab0e3c00608c944e77701bfff5a2d5a25468cf4ff74538bf3141972873c6c6d92a3c3eb74d73900947fb9a6813be07fc7e2a6eb5b69468bf3eb52aa09284f12f0a6e8957e6af8b3702cfb7a03b823a642e8e73e1374a8f84c1fdc33ee6a25525b21be9024105436eff1746462fb17c933ac32eb848f3e6b8b62baf76ac3f5cceb21cd89afeeec6ecca1be471197eea4d216ba3d66a1211856fbff508409e6397d68cca03a1411f42a6124d1b312d05d93834e9807307ca5831bcc93e768b0b2f1904b34eadc5fe8155b839ce9ae562af7d3197f40dd2e3f58d7ebba5d03df85b0f4970188887391fbd73181fac5c871d7ef435cb282e6377e25480577033a0987e3c037717ca3d9a6691f960ee340205ffedf2a3b7b5d478b5bf25d22fc2765f704ca600fdbaa04128a268a6b732384fe72d0e36862851d741895cdbe179e665144cec40e8c0dc7909019ff5d8beb1d9d21f8b8d9a49925568d05f92af14d2510d0b7c907eee77df1d727eb93c0584fa366df43af6feecac03b8f155384b1b851cb8932344c044b83caf60d715a54c366bbbc69ed39d31e9caae33248714ea5e3048d90a2a5e03f637a3372f903a4a40af4bb30ea80efd985c01287fe0b96770cbc1b15d48b331b3ff3d3184556f1848a81150f5ce39712726a876e15167e4bc5ed75b429948725629c88984d1819dd9db094f5e01143dab874375e9e4ce6ab4761299c9f0bf373abcb15cb2ccdd8faf593b4b79a1abe72027c929bbe5a4a683c4a652d2bd3a943553e0e644b938698f45e3a150b4dac6441878206e76eb2662780b519b85ee3a145d05a83d8c05f54f6cc51ed50f0d231b4a66b56f9d8e129dd2e743f609ef920d9db85db97f28439b6c958959dbf806971014d96895a5a706b2c106e316083eb0eca7bc2f94d319d10ff342bd61689d55de65d672990edfaf31c6dc2e294e6ba12e97f9c3aa664c435c67cfeb649e5e70e2a5d872f46ad1da468cfe2e19b3bb0a4b5327fb24a78ae6168339543b75ca8b123038f2e437b284dcfe26307618a38411a2d1159168f15023d2b995bfea4253f24e95b09b026344a47bb0a71d3ce535cf988a67ac18f28b5ec2dd1f1e7ea11cc0a9b8efc5a5d4f5eef1b0805524b4bc81f05b0c3973f68b17f17d7614337adf65e63e47a40f71b56e7ccad2ccfefe64d99e4ae738e7a381db848f3c468b312db95b64bea3108118275eea117da06c058b22ba780248b51551bbb019423b3750a0b1c5911a7fd4a24f121e4c9e474f95ba1e00c97f801573d1bc32f76eac2ea0626debc1d9b0f353b9a25210565069cab15cf95799e64b313c5e927b7b7469d8ce20ec697354ce5f2edc99ab6423566e2f94e670f0fd9a9fd0d54c99762d6332f540a373d74db8f128ef31dab55e734413e68f9e1f097ebdee0a86f291b5160bf7fa8b4990abd8822a6cfec7d5b7e8d438f79660fc9b91c5c08230fee1c0a767d45fcf99975e79b925929095cfbce2c2777e350d671f3922f303038f36ef70c2dbd2c2a87a25060356590ba818688509cbb3e5360b8a1a421aca756759ef404b6926938c6eab0528a6474f8ff67e72b30a3f3994b0c2fc5743a22698969f3686ac1278e3caeb5637e98dbd3bbc38d3d5700acf6825063fe2d04b93713ba383628984d8624a0ec43ff2caf68fa4dd0bc26872d04a96cadf67feb432004146d762f1ce3682a1998752797bb184741859711d087b88d8e1a9056d4d828628ac56701f9737e89841910e49d179374e6a9dbaadab2410d2f13398250ee0a440beb90ca93ea5ea31014a57092385f9feac838854fd1a72bbc8443e053287a30ed777aefe96420bfcdfd43757f5e3ae8d901ac6d5d80812ea7f0832988ec51478f275e3200f196faf9a4f3b5b799cbff7dc8175dbc645d4f85caff357150c2057df3a6986db09e4ca4529ae02aba779cdfb8548f996d6bdcf27ee72075bdb863cb5d5f7cdee090d6694f8c6b31b67b20fa01505facaff282d528b0e2aaa731e54ff7e83b98703b5a37919a70c9e88dd0a0772e92d8e2793eed59bbf31666552d44ffed1a53491fd8f9b84ed4ee813173e0914fa2457b71ebe5cd43e9d3a038b33be0006333c7761bfb43c43b2cfae7fd8eee8486a5bd396110d90eb3f6146905a6fcb8d21edcef837e29c757c93a0d238f95e1eab0bc1b585e479f1b2d983b6d43f4cf1a0aa9dd09937dde72f4bb004f545d7be232678950fd52ae675a56fdaedcd2fe405aed238c5e955fc25dd03410d27d739c48ef9588ebfa5d3363f16132dcf1362075fc244c875bd43b3ac5fc3c6324f908eea4c7d9a6c44adbc8de76886360586cce26df6971653fbd9170b3e052306c86d3076f89eb3af60978e8ba6e85874d686502ecdcf5f1c1a3cd1a78a78a7c8a13fe078800be77753a554368782c84abc309982b957487a3f044253c7e0e0a84074c69a72e529a34c043cc69259c93e56ab79a96fb34fa73ce9e6e69dba0dd4d7a29dd62ac0d0d22d7fdd4f3a2238854efc02c645fa8e39116c498b2dfc2c32c898cb2da6ff44c74304f10e75132f79c56db7ae0a85b0cd89908db88063782a3211655c7a01d21bb573190c90adf8fd17588156a261253e15d501d92d7882f0e84951a117d8cafefb7d39ad46574044611b7b809e264356f542645145c10d861c80e52da448da3e4e885ad3cd8031cdb71ce53ccef511ffe9be3114450eca15176d86e96b8d5f6267b9b7bf662fe02f1953d1ca1f2967c6c2c08ed7d16646ce515ac75489e0e8c1aace47eb9ac8496497fa2a4acdd1b527bc70af7dea9613bb9bc2a49c62a3059d61bdfd5e8923a0ecdc98f77fcfa462241ca975f39693823b2d4152f12c32693a367379b328e7bf68059a42780b2c5d1a984b834e354816f9c9f63dabe4e61a765eb592a8008296a8fc248ba21b3a2a0656c71d6bd9cfeb224cfb6fb9dd29b1923beea19cf5f050de20f7abba4f5ecc7a494fa7b32805e57ab019fdf7a9d0341b42fd65a59f6607c78a310240196f0675e13e8cee1280984fe4f404e66cc435979e86cdeb6c13bab7a42fd2663e5c74e0dacabde0245f11fc0f86cfa625ce2c06bbf0bd7041c4a6dbae18e539a3cdb7f730243453450c9d9ea861a5979b4e69486c4b4424381f0c924dbe344e3bd3b04d92fc51dddf1bfff99215c2d53af7cee67d4c464955fa139b1ce9bb952778a9e19d98799d7cb742ef1716b172dd8402e0bef468cbc5657080402aabf5616b0f3bfda6342bebb421b5a1bb774ad0f0b548ce0110ad26438d8d2acf2c8bd1640077e1f6311cd6c7caf249af4f70e53beb6a77d2ecf495836d5b313279cb9d1173d7f289cba51531c1b235b2473e5aae6abeb5065bc8275d96e16651421edd2fd333c27a91cc994194dae06eef415a924d8628b5ac7ab9e3a95dfd741c0277a3c862f3d3417f647e54e2b3e3c7d2ae32055406497fcf7c0f8b860b1652fc0c1ff20781dc07675bff29f7b920277706567f104f46988f642d3f8262dde4e87490b98cdf5d57417d089e817541863f916398381075079147362bce78a6242f3c425c3fb44789398c4277602f00d3ff749781a1691720ffac1bfddb71eb0acaa533c5d5567ca35125d2d06a23aa58b1bbd32683402a7be774dee5bad20a077ebabb4f79f878d251ea96705bc3616292906835c613a4d054c280ed8b9469f79f63d1877f69f44bfbf0a6b57197a6a4f63a928e6872b3c3cb1b7da4fc56bf6ac09f66181ccfcdbf82b6d815fa71736218a5992f1e69ea5325e1af9374669840ffab50bbb5756da8d914ac4ddcd721f1ad205cd883f222e0638b70e23f19586954e62ce0a86a50114c5d44672dfb459006c22690d3f4911c63a4f7755f1a17825e4c67a49e5b9cc358cb43adc13e2ac1fbe1cc7e0765e1cc16a6646c4235ea0f865ce3ff3c166d657387db396e53bf061e2014ef352eb04d35c01deb4390b56dab9ff164703b00aad95844aafd69c077612b59f3d2475e163cc2ead7d44be689073538a002871433f55d687804464a41f57346cef5d04d15cdbe97a2e8f3a0e3b64ab58326a8218b7500b08bb82dd665b76d1ec7f5cb64ae26bcd598309b9531611891b3cef20759bb613a8078967e422b95015c74e6c39f57a525399d92fc11b9e2cf35d17e8efe8f15a0f5539fd21711d50cc458e906231554a3d408c06b3a7fd22400a4e6f02dae4b8237aef82271d7643f3eb89f7685d2b8d07c187b44b296368ff90f85ee4a6b9c52964271426caba682e38c06742d7ed861ca740084122c584dbe17a705d4b9ab1737b970405e7a301da42997089a0359c7062c7c9f86d07151e17054bf252d204634f0a32905fc461129bf474848531cb4a6fec137b9ca9c4a9c9c09fc24dd3a7734c06288671d523a295ff4a5420aa103d560f171584e8191a7d0c8a6661ea8ae77fe87f74a27cba378568d4062b9f5b31c14f59927c0d2697e739b6276247d4f70c745297a5d0b262cbed42707871d2a28a6364885b2590f3876a3724f7475d98ab7c70b721a003859ca933753cfbb423f5f58b632442d365c0ba665f8167a3814f406325090ef104217509e681e48037d1410dc1b1d981dfd4841f0eb17f65c2b5e9f8506fc7841a4798e732be5f264ae2d176ad114c44e3c5dbed396a14681ff885db7d3f4965c9961d6d421099aca0b01bdb7c26eac3df293a7d8ce61ed59b1ea6251c06748e9db9cddc739ff16a252859956a56a106d4eaca5888839753420b6a8f0b97cb8ee45f41288e41f4cdcfcc5c62395fd69ed0cfe9b9e1689a142e0271a1f1aee1cd493f8c9271fbb9982a8ebfefc81ab3097b9d8eefdfa273658263d19db8565683860fa8adf480c298dd4844a031a97b965cc1c183255442df6815a736de8ac09548d46a1c57b772a8b63225c85c9d079f98701d1fa57798dc06af4b5d04a59d5cadf60a8af4ed3ed693e780c5b5477e71935a12d71a4b47a90d165023f30331bd29db8dc833b0a71dca863bbc113fb23fedcac2804be86e6682652150104323be43e5cb46116d240ea2392720d17a39bdd1253c6916f312eb41515bf2ffc7b07576c02d45320d314cbc1242a5bd43d93ea6d47d422e211cc557a867782295066513e705d6f102a93f8f17dec71ae9ef4b05f7b98793672c1ee8f22e7108e683fbc788357a0c87c3ced0ea44cb031ef3c0ad3bac74650f1f77856b473d8cfcf7184e7ddf3687bb6c202235e500a7d28e9376532ede1b1576e05ed94d56c5f890ee6bc593205dd29071f363dc4277c2d4799fc5b239059a43dcc5a97cf636a0090eee91806686166b31308facf854525f148d201df012c067a317d2b37d9f2e7f6337a7522a891451ffc47c5686a67ec58bfb03050e802a0de0b4469dde6f64af391154a2a7ca43edce6a137d61c63695834e3a4a6e79da686140b7b98832b56d8f3b8296881ba8b8e7c78c102b2595f729a4ce5bf641d4772a08226b1f1a9b051dd5a5488e3e071b30c851d116f63e81d5387d9ec037c980bebfddada5dc11b164ecf244a2fbf736db7541f5d42a76d1d36236c4243d4a93fa4702109e0a9a37119bbaa0e55d8c2d7c05b07da852c6ac1356bac2e17c3d0a50a54036b4a7c1533f5966486d143fc7b8699565f56fd689a041063ba9bdfbbab4d77a32399b5ccbb761e32249ccf968ae9ad7a556a641c2700aaae48176674606150a705881d416bb79889e4e245766b6643e9c04cdc1a98d4487bbcb79c61851c88d6bf462a8aad6184df274323e4678835d271eb856df2f1ae4a1d1923dd6a6cb791d0e7523e3b5a35a959f71edfb5299870dee067577ae15fadb3ac9fb6b0cf1f5a98ff836eccfe6e636e8036013bb424f94172df6877437571ab9098d1a83be7af44e85f976732df6f27b3554a365d5c670abbf64a3db6f6fc22f2c84fd374b32e9052164b5103babc9eeaaffe2a028128b4fffe42b52a0ba6ec38bc776ed04b91e27b91aba344589e294f8ba2aa5cf37558b5e55af2c3d1fb21d5d6129847004dc99faefc652c82fac5613126d8bf123001ec5cf08442aa157887703907e7afb89fbbca00d0cd249d980999047f7a03117d6013290aede946bbbfacedca89266fb242c2a8971b8c8d16aa16d15ccea7dd0ec639e12bd002d62ed7b2f569bf7d70c0d78444df80c27149aac5b1b99172624fd67fca3c3a6a56527b16121302fdd8d21f570430fcea45c5a822963f4585279266ed8de7d66eb39820b2eb7faeba30ca8c961ec61e33c787d3087679afc9b946f11e23493b2b640b10afc965619136461960fdd215ace52a72de453f818c2ecb1003924144141adbad3aee99530b6f6cf629a2418b8805137fe10ee218b0409b9a10681826a994386b5c84f2eeb9cbda040bb93e406a61d96ad40a94ac1162b1321174e74a1b171cae56bc7cc4e27b71b6518e64a89d9a5b3b826fe85028defcef47427bf66c757de513877c09269a0abf336c5b69327398d2b58ddc4455583245b94d65611a64256e3d7935cad651515bdd7892b7317df3d61c53616b9076d581c984333d1013c8dd1b8d1cef9f67b8edf0f4331d2a05b25f062134ede0496a038bd6004fe292dd4d8152466c1e0d70c4d552326c62e3ac6ab41d5ba500e79460c9146ec8bacdeb491ed9024141ac8c8e8c80a7ec3fa7591f36632ed6a82e93b633c9cb32685747dd8e6f7b3962c56c158771d699a2a15085e054488012529bae1ee21d5d125104581ae6a90cff9b54f58edd1d0bcdf6c2b2f0e32633d61c9579141aa43f239a50427fd3f6d0bb64173567bce13c0260f74f59cee967a97911d120fe5ffcb8c70f33c410780819ddd3e347f6521bf5975f09b5831fba65da22c62dc6815e6285875cd41f4d32321e3dc6f73623f701568715254c154e4c990290b8fbe17a00b9aad9544c420a3fbcc7f5d4c3c8b9b1c44a3fe42ab2d88a1487dde840eeff23c487c33c304f6ecd697eb2c1fab5578192bafb6e66a76e5bc73e3befd103c2ffaa0bb50800bb92fb77b34892ef847e81319231b83a1a94dd229112da258b8c74922bbf4debdc617a3d91fedb7866aa1834a8c8d55d055e354c2407369e3b373a50ae805364f728a597e1ec81ba04adae1cd3d3f5ff01e05736ec54e9b1f829b61b174fb2638ba880851475a7c460c5559db2d69dfddb265ceb521a8a25bd6618ae59b4ba4865fc28a889f58a269432864841fd4f37e0aa70fd15fbc6b11e14bbfccca40e27a04ec777cbf768015771b2fe54343f50ef256eab01faee9efa04e447d8d89f264a5bb28e441c2470aa2ca9312fb911695fde6f8f03170ad2dc118380c1029c053ab8c8f8a00686afc76ce4140acf6613e55b3f4851895db5dc25ec448fcb5de2c576a87428ada890acf29aac639fec4de8e5976614112cf0b223dbf6f64bbdf11b254f3736a8ea361bc94e41e2585fb7f08de1de44c840b7bdbd79b017725366d081eea472ef783b369a95deab8071c02dedbd40f482bc9b60adc254611aa16723962cc61351e961ca100463d8ac6b49272b0582c503f337ba0072756aad51e91f4d178659ff0a13d926886159c7f67971bb7aad2d322f665140930649e2942d0b0992215c78fec21893e7fa5aa7733a4d1e6d30a8237382de737eda842a5ac5ac6a853b77e9f9a33cb0d580f5282c4337a24e969fa9e10dc826af8311ca705f96685021716338d0ba1daed6e8a699df4f6497f026f51e53f83bef04178818aefe8f64cfd2f0512a1762414d7ee131049c06b902050a5d4da325d7c60152a2cc42e73a120ea9d24993f2cd9585a679332f71ffeb1de044201a275372769f1296204062e27e13fb7498338b1dc6eff674389057794efc1ef88626d7354ff5399542d003c22381299db9ee3d4c6f48241d6d8865af98ca8624d70c175efdbd681686d5e00d71b0fbf00098c4121b7700af1cebcf63e24c262ebe7fe027406694e6288cfb360074fcbc67d75d3d6fde4184a25e701ae3d4b6ae2f1448bf0cdc570538b86b352d38d2e5e8be4946d3df5e294751cfe240b623bd40a7e0c416fd5c08f8fc1b38dccbd3465874882d6749f968d32639b76e52b6055cce49405612dbd789625a73e8110a685375d16d226e5d67fe8ec3096d1ebc47ece6ba5aa82c08d2b5711c964d88</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Score of nch</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 考试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test20221228</title>
      <link href="//OI/test20221228/"/>
      <url>//OI/test20221228/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="可以问本人" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e1f1f00b0ef31ce74ad41226fcf91e50a2755f4148888786b92e8380988830c4">4916dfabe1787c4ee5fd6ce7fa1c1d5307a308ddaaa2dfd19b78b6c8def80eda3aeb3ed9276424627c97004ff42ea055235feb3456bb8b5044ed1b7e2387418282b6f69f2b0d45e961770eeab030220a68d1470b42927a2714c44f570e09b931a1458d249eca339a3f1f616f6517ea8e5c67e44923c57fe22952afe64c12b85a44fa796a80363ab6ced25c2ed0b09a62b7524703e8e695ebb061b1ed1a1dacfbb14ac056156e5e998bd8954e3f9cb9aa61aa143ebc0a29ccd92f598ada96613ddd200fc04fd0cbcc31bdd83faff7ae36ebb00188246e8d662db8dd6075805deb92c8d07fa612d792a667239d32dc6e37dbad262c69234c67d2178e78d3cec33fa866a1f800348fbdb7b3927e6093a5e209af0f27c85abfe684613ecd57fbb2ee47e963fd2c24bd66e2baaf2fd0d9a97340fc4eb189f4ade5b792b42d1c28a8eef02dcbb4a25bfdd76105b376d1ccd471b9fc510ce2e443627672f6732ae6b8594d847b51183294879a51ad36ca7d90221cf7c09a7cd8b28dffb52bf6e38a603930fbe5b94ef8b757bf52a40d078a54f10991bc3de5f885510c37474dc55cc53a11c871ec7526df27018f5dd422b584926ee36e6a3824ad625e55b692fd09fb50566bb8a8b38c262ebe5bc6b1100b7bbfde416db64f9767c8db771c6b715f763e20c826d6a18e49ee24b6ace2e349ae5151d9027015285ab5b6d2677a423a592b98320eeaf3eb6ebb86f3ba6ec6fd6cadb3ab8320fed41766e280475fb92d28836a48b304adabf2dfc5adf0cc0c870df2277746175ace80b97ea212876a446740d624544df07a5affa0efbf5428e7441982038cec01f3a18ff86e68dfa8307257140e50efe287856144d6d1e166710eb39a1d4304a48c10f0f96a90e97cda4ce68a365ee36125a72728e486e99881eaa3ea5094678aeb7b9189288d80702dbf1f720a50ba51456b35361c923903f80bc7764956e3016b7b6bfee0c887c4862ad81d34a433c2bacdaaf4497633291d43686ad380fd6fbe681f2343151930ada4da8aada625613f8bc4cb194076fcce90bbf1704bf2b731dfee824cb9f4618cd229d4d7df4328ddc0d2a320a944d48654615b20878d15ef248ad7b9afc0e910af572532e5adf989863b92d4894008c0e50a8d2b112cb8bd5b3f7b5e044ff1e6f1dca9fbb244f7efac9c3ec7264b6a13d306d27be424e163b6b5a9d69ce74fefa2cc404c5589c22cbb962e3cc6abd2ee4a178945e30de32bf2274d50b48b0bfdedc1f1ddc4e4f7614ecf65f44d993f193b267ce2cc1fc44020359aaee19e3797b85cfec79a9140e06cb2d26235548fbb83f41e3bd6469509afe92ef1e92c86f21c8069e0c6bb0141dc453f64c83a546b7cc4db586265bab276231234943b737b80e6c643195a83d648ce0fea28890e9b52609e18b8106e47732fa52108cae1fbb17fea1eb0604ba03474e9760b701fa52db36f146d571d14394cb2f15f27e070144ecff62be060bda06327b76f89378084226e13ed1a5fa9c9433a90ea297346d5bdd84be77cc29e7aead52be7a6d9ecd4b3f9b942c0a5606542df572d47d78e2824ce6193310d9febe21e84bc9bf49dd1bba0e4e12ac75757ecaa2789f682a0e4aa7f21f3685b70429d69cb43ca70f0586ddf15929f040d0e20c0701693f27e000e31f82c480cd22329c32bfd9e257c96103924ee2da2f3fbc62ebae82d19a64faac0528c0c30d50f63dcde7a2dd73c24d15681d443a05bf93d6cf89164c92d1d2846e2f52066563a70787c68727075e4d004c19f631ed02a5ee3c0d859f11abe273083c08c534167fd7ad0e1ccc23d511a17db09514a1370aafb85f4207c27101195ded7a191ee1490c6c3fda982bf8bd33cc3680a3b37ba677e2275dba230a7298630e8ddd803b865ea661b88510e15f7e268cce55daca93bd8a5bc1bc240468b82fd8c50e43353f9575b458003abbba04de9733490dd1ea92c78422db8fbb3abaaaf5eb5c30c808d8d6a1511c210bcc51f412ee215ce2dbee46ce312afea6b63b9de1cff892cebfc8e2b52ac2fd466320efcdb698a1b6d07e522ae0ca7b8d1649d1560d08a6ed28122dd180a0121907ca8262c5046618bf93df552c661b3742197d8650ffff21528cfe85e4156d60e3342edef58185e80f811913e8ee2dab21253060afff99a417662e9325c8193ef8b306ac2e420fe748888347b4bc3c2d7e627587c44dd65eb9407fe3a09c3b8946fc7a9e0eb404ea69ec8d92d915c18d2d20c700edf1bad73c7412bf77e2075eef03688732aacb36326f4052079124903c8718ee335568df4b2a47b531139c6c55f5393076c3ab6ceb27685e1d78aab87f499b3198eda315c4dab80dd3ffe12afe9352702f9de1f46046bfc9d3ba8e1d8698dd73d46277e193b0299baf6443de91394bcf3e6efdad5b9d8fa5b05e4b1e84eb978eeb19f6db748f48198807725a6097f76308143a67f917ac7f60bc5923231557dd279a5edd18e1c8a1150593004b5da23756461708dfe726289b3533a5ec3c23e8675933df9989c221cf8dc6d9a9afa94867b26774f3b2a13567f564eec99701cabb6faa84d55b584736f3d67d9457bfbb9454506bdd893ebef2d41672f1ee1cdbf2f80b237543e329b94f84ca1fdc1ec6c071151ce940662b6c20eb97e7edf50b30f5c995429d61fb93b5184c19791627728372585135a5ea4cf992aeed3b03c41e90bdca77f1cd0070ab534725193fdbd5db9ca6e97f6db7bcd12ffaafc5489669d4e71183b7f87ee2dd0dab1b851c23eb1e4c858fde1c94b5c68ea8bc79565d7fb61af5784778b432b1b4acddebc610ad88a0d1a4720e5bd6adb572fd6ac49fb464dd72c9863451fc370d2f6e2d4c36752c38b254b77a386d080ba8efeb979bd8384dea273fbf711256e98642c5d9eff6e07ea3fe36a45eee37685d0bc405ec35a2777259bdaa15c08abf356a1463567afd1a97c1f213c18f8c54f48646f700898915a7b4c17ad73c190df61f806897ef458700568855cb43b2e442f849405d1e4f902bc508ac57ed301fa196e2d4427516de6f74e524a0d57bde97c2c499d0290b66d8bb9f7ad304d3c02bbbbe6de95f8ea5d441cecacaaad3556a45b74edd0ee14924befddab60956063ef4c5cc4d88c5cc6f19d8a1b8bb86574b0682e87ace8896e5af8068178a76c3e9c7e7dd713601fc08edc573cc96a0281c14a49e7fa6d55ecb21f844c3c7761296ae397cb7b9b78be09d245f1ab7f51751fa15ed2d2d7086af929ad0a5795835a8ef03c32c23603678c198792a0563a08cf64a643e70f313055c650d879e0fa46ff0c8c225d66a512365d2fae3ae7df7d1d8e0349aec6485e248b93fd968860f110f1f3e98f6d7c8aca97a54c9a75fa67a0951fa1ca2610cc772436c2b501ab92a199acdce5bbc229ed91a5c76fea51dcf0af79d9963fea7e2a2d7cae5ccd0077c39c605eb0c79a667bec718c75d40be572b61e573bca249eb8f52ae2add93a81a565bcbafc67cea97aad133aa8ec6c27db01ea98911f1a5dd00ea55b833aa127aea52a3d4378e2f84cb544ecef58be207b383dd8e4893f7144824aa6265cdd430d9f10352628ade86f8c9a924a180ee613295cccd62294f46c19c3efb0b53f3990529b47e1312e88ce8cb2ad5ffe84628d46601118b43cf9b1a7e4efc7492edff158675ae9ce2d182a3f2f9c0d62230e2d03c3a21c88e0a2b54ab1fa60b6635384ded477d3dd0d6ad271cf52aea328ab6e629a54f18ec10bf74d944601b2f81abf51539c9eb32681d989d794fe1c7111e171b47ff95be90bef4f7317b2e7a763dbb1335e019cd40a01b795f75f854f526144d93500d5a4336673472eedf13bbd33d26e4d98c76b4ea07f3bbd26c01c3429cd9c568b245fb8206f0124f15a938c26bc6adf6647cd128ce115dd4872a05bff9b9260d74a3cddb197bfef532701feeb5fa5a430a6611f8a50a2080d836f215746b54079991f952fc9f9e61f588f4f0f3c1c0b93bed6e34b6bd333fa19025df6e60fcc33c2211302b94d3657dffb818df4ef48758dff8877503aec09ee9b0b483c279609036516d933f1d726a20d1c8a76930f633b607991adb8921665fae6e63da74d5fd04ac8e2de4eb7ef127e6953314c9f39ef1c1982b92a9536e154cf33de837136e23fc009f9244ec4fe61a0fc956330338cd1e0b7c51319d4032d1b14bd82bd471e2c00e4be3f80c6e8daa27e94b57f8eae8292eeaa753d2af508ff1f0affc78b52f6c8f1da0d8393e0fe2d206b7f76411b9dbc39ec9e8b747b3564710d6aaae9b44b0a3594e2c743f847f8f9e74fb019e23e22186e39d9cf510354f4b840944c48f493dfb0cf3afd39312db02d3a422f73215928b4254abaf6b76c2a8664f49c98de0f84d89842f0d743afa11334c7a29538990626e6bd8cf62d062b73592a41fad89f1fb1fe74c77c805eab1c2db8c5a461345a3887a18df31056d6e88d8b4209de177ba224b199f104c19286a15a1078d0a59690e5e82e1aafc532e4b89946b5f89582de8a7a1e199790b26704b986a2c63054ea79abe43e97153367da4557b3d8a3ed6055c740e944645ac21b4ec1072b945a93da4292fd805ce2288cf522be798e156ffa1809ed9f2d94873871982643d2cce65164f8eab5ef65e38e181ccfd4905a4c1d1ced2b828db08f68d57d492e2685db6d19fa706b48d2ac02499dc3ddcf097111124dfa07cdddee4f309f5c08942c1cac6d639d3703ca758308e7990006d58bb23d064c91667d06b75e407179a15b8c9814d2f0c9da0c06174f3dcb4fadce35ddb691c7cb6e674ced4cc2e7e485d1e2a118489c20a7da99428efd5be38bfda09f898aa47077519fe87b44275156cc224a6369020aed0c83074aad9f155bc40440fe66924bdee71e1378c2cee762b6863acb0805a8cd290448915957b818dec6917d51ee04fa14df1e0090e3656d4be6d88f0b4660210a68f95be1f91d70026c891690ea79755c6c14e9e150b9fd95066990451eaab33e2eab3a5fdb25f4a958578beda36c9f9b4e2f413b1a7feef590fffe73c1065fb3c7eb78082df45bd6203ff8c74d00f60176857201e97a5390b2cc5a460752c886a37bcbd33a51c2d4271d5469cbb8cb2e6fbd43195f10628bed69b716d0146c772d6270b74025662fff9eedd29560d363b6afb719dd87a10f36dc8ed12c16b8738a5c937d952f166def9bb7f81e9bbabd3db708186564b17eb6ffe6504b6cc70772afc8dbc1dd9821627823ed18830b71fae618f25949f0019e53d019dd4d4dcdd034d3709f22ca8e01637209be3b981500078bf6e0fd9b8d1fd2078b023c038a6162f870b2a02a921cca6386a2761ce2221124d0df919328cc174dacad2058aeb6a051f6c1a2a1d1cad65d54b508be876e10502909cb5acc5c1d036d8bd94543468d2e843f0387ee8678c64497219e5f949315cfd23e5faf4cf33ad923217e33dc87800c39bb3e6ab520e5f6cd056005b0da3a8d15a9e3a218ea4519fca2bc357b2dc47a7ebed6e6f191b08529a62efbd3ae7a39eec4da31e067dcc3ddd39d515d99e7a62da84709f365066c4fa1691fca5bf2fbfee9a25d88f877c525773a3d4af7b41835c8a3222145f7876dae84b53fb478ed16b73816c5a600f32ab7c6c90e5a5fcce86db00f18d38ac28aa43c5f8aedfc13060ff52b4e091f74d54a2bd4b1ffe4783caa80403f9b0cc4a40c9f302bb84d6d916f8059562ffdea76249eaf4e0e6a296bfaa89e77c572bf99e4b4620d3f6f0f5c4708809dc6fda891dd7b13f94bdf50ff6b08fe0f237c168a9c3737ebda05bbaab14e4ef3780883c631d5b0d7afb4c180e9be926a5abd11acfb0312d804c524698f845e28ccbc9f523ba1cd7ee82c1e7ba48d53d9f3d628f57c69c66d33312929978d75632453874cd2e69a315f55bbbae50d24117ab2d1dbdfcdac5ea32b602a94133d0996173379ef9232d53d51741ad32af9bba09a32faa27d5e237e72f9c68abc3854548263eb9ee1e3e4647333a9151d38ab14714d49bfcf3c661e337f7e8b6dfce5663760bd3bf499da1c2d0c45b72fa58c2608d4908a9fdbb113d08e1abdf699d2d59471abb49e2a0a72a763cba6f9bb49d1f9b45b63f1a7598e5cc100e8778c99fdff94bc133c41fd51350b1bb763a6febd9c8a9e06903b758c1da27d25ad6d54e111454e2cc029f12102d9ee7804b457e4356ac2e5d20252f8f31b00a9c3e6776b2a8e914e7b0af2664238a87230088cff73591140082c4f8fcf86a1cfef121eecd08fdd21747042ed734ec92b17aa946248bc27fa145380a3871072c53c2077de7316f1a74ceb6053005319ea70c4b586d27b36fd4aef4cddadda442f41649384f410ff32f44ad0690f354c76e08dd337b82fad01d60b55102e7c4ff4f7639bf649bca5049c5340d0222740763341b509cefc0eeb81971ab3f1732363620a55b37b0870075f02bace8d4e6480fecfc1e5df83d675b0c9ad4c625ebb622e0627d6eb3bab1973b09e4ee0771a27deabcd1944de0274c808b47f691074f6506293981ce283354cfb3a99f5dbbfc386111ab1ad5c84d735e5e63673b933f6ab7b552fbe0cde7b7a5746725d3eff1a9dd99170b3dfa4cd43910122cc232d98f3cb452b427001973f89caa510a064ea609e66613067e3d0fbaba7625894bb97e996d1871c13e8bb51b0c1723c01146f851040ce064f5af1595ce32b254056fe1311f55f606d686514f94696faf55b4e334381cb35b61e3c1bb34672997e06a75d8fbdef81d1a034c8817cfaf78ad54bdf490931880a1d343667348ac886acae1b2a869811a251050b404fa89f17d830eb3c41ee27055cb2c15a03c8044eeb3edce76fb4ffebdc661db27373f7ac56b63eda14ab2b1f32d60ae49c48d92e5642781f4708b2b2a1939790f100cb9d38929f6cd698058b23230584af1d2aee020fdf92033d29ad3fbbe06ba010e220151fe299573a3d566888877a6d2342369bb76c34f675331829acd851c89503248c14218879f24582520ffa21d96a3e9c8fc06d20ec37bb447ead007b82db776669afc8d4c713fbdda1ec5edb1d8425abd52deb36d28278abe100193301acebb9ab66352379b1aed55e335e955766219a2848c1bd4e11c9f57f91c6986a5bc01e97d62a14bc69972eb3138394295788fffc75c8cf42bc55b464351453816b04895f97adcfd992b80121d45b343dbd9f57c1bae26a46cf75eebb4fda3c3e89f1627041ec9cc7e79442fd958de0b1a64844ec585e11821fefd74b346b971c501ce3e101a19cfd0370a2060d236480c3ddd4a1d39622caa48809cafbd652c780af1e1d918d4a2b5ac7da67e3f85e25065c18c1ca01a29b6d23df0ded2bd5487ef37da98de5fb19eaebe1a13faf30cd424e7bb736979df308514403d8a6c5055c10c197035230e77856d9ce95c5224e38b910d4a9a53253cc06f57d1e930bcfac5e05d74e5f91104cd49a7d36bc888a3e55c41ca5f10e9dbdd815506f3406095bb43a5eab619d4ac9542e2921208b1f9668f710b25f67e6870a5da8272aef8b509ebde167dc1417a257ef9e754354d0354f6b93489b8c500701eb8cee006d18078ec065f27bba3d1b17e77bd2c9e42d5819779b1f2a8306c7d671b46b44cb1e2cfb0b1f9d2bc9c03cc18fe1cfffb3a01815d18e7abe6a4b249c7aeec97cdf078619b91b6a56a34cdc4847c11f1f4c5dfc775be7ccc7f986b04ffc0f3a0cf4b215c2d46490f5a5e126934b4c1cd3bc2769a2c5b79b54befb8c5d0eaa51e8f1d190800fd6512afc1d422346350eb995de80db96ded28a5541ba94655d9ae0d57b4e15e1499b9bed8aff61a53ef6e3bd2914df8b3160da52e23bf5fd1f2d9a1155be794aa3404d7d8e879bb7480002c7f57c53a9620fd858b3ab7d1c33b9b7f02b978384fa652e0d285ad0f3fec8504f9905249a800ea5f6b50d7f36f35c09fad83c46f582e26d1655da03220f04016b0c90b643ce8cec99c037d05ddb38b03286d63892befc14aa1a80d62088f22256a2ff823ebcae91539c02db501550684a28499b9803fa1191038e78ae1d9c843a50669e5968afaf02aa8547f700c9e6f2a4e7ccc3e0be7b0e9d791f38681ab74c99e2b71ecb1ad7c8755f16c8b6dc60f90b4900bcf47c535f63fd7720fb8bbdff0ff6e87bb0f481302fc40858dcd655451419285892c8ac2000d86aea062dc7c70a6c0a644a86469664867b0e5a8c44ccd203752abeaec22b91b6340910c1223f9cf4c61964e741dd5b551cff985a087415dd7b6ccbaa8b0bcfef9cd82e60cbdb54d2fbefe629fbb9f96b38782a0929455ed069387725cfa2876fad662ae2580adb6a1b2ff1ed45072448430e90b36f529fb8b9b6bfdce320bc8f9fc6ec5bedea86fca3826c8d2cc9a70ce40319712404fef084fa367e82dc864d76ff8117900b075ab6319f323402fe6cf587ad8b5696882fb33b33875c166b07f6bb41ceff3f942532de831e043ce8df4ec438673c51089606b48702419fbf5ffd729418b32a6402c86f535ff67b6eb026cec62ffd50c011cbba8267b6d99640306b3b8ffad88d6c6e8297dea9275d6edada422647aa6d4e0777fd59cb24686854913efe7924f93b0f1f53f3553ef1010ff7250e3f98fb07646470e05685b3ee9e421896c0c2d8ca9588ea14d9b326f08a14856c32868596add60781985da088bd6fc0c25431f5b138406c581c8fda839dfc04e4cc720acdda0b2c29b0dfdba25094db9d004f09fe3f62a05e7ec8fea5fa564aea80cfa5cbec5586744941c6ed2676e7a3ab68ae2c03e35d78ca970e0562310e6608f6a6c6f15fb0787e0eee2a4ca9ad326c140f8de99766091e244008d7d1afc0e914a030f350de8ed4d977d4c87fb6833d4549aa0687e2458338edd6c59eec40d119f8c14322b2eb6c481534aa49737e7037be2406f6eb80a126df3744021b0cbfe544ded2b8e30b74482680ab4921d7765c2f5efba649bb63306b92c7c3e102831336dd33254355c205ebd5c1a529e6cfeb119cbc4bfc09f89071b4d85a191cca8f9ca87b7951bc85b87064d1180a37a7964207a8b178b4da69d308ac3f54f14de57301b724c05e8b622032aab672b050da27e6d778f18c23cbffd3a9fe3d4228b2b6918fd378b33b43259551f021d924d64030da31e11a239e45e356ed3165a07a1109289cc362618bb2f312db625f4df9650e21b0573b3df357d7c00feb58350bb2e49da6ca67d2ad16dd61abd1522bf3fb992dfa7f23fe8f5efbea77a383adbcd6eb3731335f176864a11cd5a44d5df63dc61009151a3fc1c5eb8899779c2038b2a0300ddbed235e6d6ffee2cd9bbadbae1c04f300ac123fde3b0f95cc4247f9ce843fdf22e13412a32f8979e5677529928134fb1d7ae6f2332863e29ba42399c431ea4bf9f4aef9fafb51d7b44e817755e3d006e599a642661e0a8c2c8d6e07740489a365a3570a04fd49f059214daca1e1c0a2d5f6d60dd842b1aadff1855027619fdd45292dc205aae48e526a1f67ae290f09478e0dfb6c84207aa0b5586466d77904e2947c160f2d56f89ee6e7e228ea6d49c586e48eb184ce4a17d8f56690bd8cc906aeab2c0341fa6045316343b0810f67777efaed120fc06ba9399c83ed4c496d93943580700de437f1e96e642af4a03d9c053a3953b616836c85595e06263e9cf43fa5565534eea7f1576596ac79727aa889b18b711e94ec8f83b09f400ef84cb4d4609c7852406702fd96820ee47199e324e639a0c8f6b5622dbdb27d3467b4ae6ce7723c36e7a7316bfd7d8ef45cd0df721d5ac1e0ed7d88ca2b658461834af487f3a71f3c9841ced852e6b18d013a344eb25bb847e1df1e891d0876bd34467bf1c7c4d013d082e131fed17e7537bdc5ac8ad41090e773553fffb0cff7b8e6e32caf676a9d9fa5d0a1b8e6f40e7e9bdb622206d5ba407f94078c4ae85a5a0cacfc4c505afc980bb01b5c8e78fffeb6e4f91b1f4e6beb03b7f62fa9eb7cd4874153243f75f452e808ec4c92d36ba8fdaf8d8f0af8fe86f6e0bfac581bcc53619667185dc2d13876da227c18748a0d207a614d0d55a6c4c8dc6f420a96546583080e2c210fd66610c01c4b29ef20a4b72e2f0a6eaffe2f0a5c1515c8e10667dd01ebec39cd50c59db296b6e6db63fbc72fb22a54d2eca11b7428d0274d16838ed93a2886d4786daa059248afb1b996ecb626803311296640c108fc61b0bc6a79594bb135aeab8f5e573024c5d4b5a4a78178f219a20e43efb151280f186b8e56a28efc20b0703daefbf52b5176ae1957935cf4472408f0bd3164a52f15da49c87089506125f5c657ac75d4ffcf7fa251e52e30adc04a3f0c2ef1d1a406fbc2ea245bc3b629de670dea6d592cc82af53964992364483f04038eeb9514c0c8f4bcca76badd3fcd80a766fc1789c0d811da115db5c50f13cbab3f221b11eeb95e75c02f81fed2adc6210d3af907ed99a59b3a74cc68e15252912580d0673c8aec3e7060afb61a4a5e090c7234bf3f39179f4d458b82224baa76ce4edaccc74de05595bacc5ffe7d4d94e480d94ffc6ef3fff98856a6175532223f86e524e3c0c3672b8cc4606279d8cc64ba8e221ea6ce78922528b02b987aa8564c723e7e4b6b3320cf54252581181c0f1dcf19c77817ba9ecb2e52159a3f095bd0083029cefe16f503aeca63d63ebb728aa736bd0bf89fd70a1224257b3987b74f62e2e18cd025e5b24cea8a4c4fee48661e60aa745ab43e5e731895dc9d8f92f18c6b3cfa99c4d959942192ed61d4936b6059a9e47796b7dc396e14c76b3074ee23c45ae0731df4d1ba5b6866a460bd55f7f31e29d2ddd29b4abbadc4c134c507b5bfc88d7c2962cecbb01d9b62bf78380569d4ab3aae453f1cbe4fbf66fdba9179cbfe4c043e9f3f098d269542ee8ebf5084dccadab52a072ee9ce75a08183efadaa707b73d46f0af917d3195bab9448eb0d1ac6255acb7c98f51bcd90de2991c95d3bd29fec9b968b21c304b297547d8290ce8c823dff4f11ca753b47579c99945bd842236ffe0bc807ffb1ddadbd442e983814d8c87b3cd06dab8c15f28d475fd3d4b678d6660d89800f1ae536eebb2107e93a49b0ea8e1a1959f35b52e6ebf07865ae546dac1501b97eb690f7c09a9ac805ee024ecb48cee7ccfd8347c50330444fc87b0fcca0c094cdb86443eda10589bd648dcc6ffc0bba081ca19742409f29cc9f406332e15f864fa0bc70c4a4725dbc894c94b54bd809a5f8dead5c301a50e88b8ed89ed3aaaa914fd449cd26dd548c419010dadce89109a1bc541fe22624ba368faddc2ec546f712c072f78ebfc348fce2d686c4c669024a537dd049cf24978ad04b6318a06ae5911bf6971e01af4a1363828cc9895091c476f2c25affb988ee70d0b042f86367370d0278b43f2c5590490727b6655c207cd09ded6e5e5d624d09fcbcb366ae117cc2266e62b80e729eb371f972164b746107c8988384b6e0732e87a0f4a753494ee74d81673cb0ae1ad3c4eed32911c79da62c93336f47f7c822bca3ff9cff173905f30d2a4576bcd57fee166609cb0f73f7dc01053cca9888bcce9a4d4097b5e4912fad3072c01c56bb84036ccb439668e0412feaed7087de9ad96c63453c3e5890ee892041cd42c5d0fd6cd01bb5f88ca885f6bbcdc5f9340b0827ea7705dc07de60c13aad7675afe3308188da090361ad8852ca619be66ad73eb4591a1903cc318c68461df4860242a9ea97c14e9aa11b957475ce2de79ee52481eeb7a453aae27ab1391292c9bb81a5008fb78d30ebbfebe5ad28b25f0c36514eaa3844604a0409b28cbc34de1b7d18808a6cb9d2eee8d1ddc7b0c27306169d12b2880670c739c56cf4d54c90453defcd14313acdaafe7811fdf1177b60ba05b0c86618b1bb4f9da9e9b61c9534fb3a466656a56d01f13b6044254e580e3904dc8d60c315288d42d8c28ca06f4b9ae292421c5eec68d0d39c62fd932a1b88a059e72dc934d96cd6f003bd3684cd2d291de9e2676d265588e18bbb90bd627096a4cd7d756ee45d98e3e1922baa7b00320d61f6da0f32359a020936bbe0d4cd8fa84151528faf3483b066c8d4bc0c629d0e27bd875e97be2482f15a5c8492e392c712dd0d5c03cf40ebae30e32fc6e28b2215e3c5795754a029516252b815a939f80193d1ba9884cf3e32894c59c5ebba34e8c1a7bd720f1a63ee2f6f16aab366a4645a235926b6787b53f10e74909e8dff3a4e7d29b10a19195f60fc11da77c8e413c83d87981dadbcfb90cd716a0357fbce3bacfae7e4885d8bddc8710c78bf6143a2b10e1beacd50a9fb6656fa25d3e10acb0f17ec5daaa5e284ace9b880430cc840cb8385a1141a3cc844067553e87ee28d2052347005c7d16945bc72ec3b42498594967599a606a11fea0d341501391a975cf47eab824c63e7549cfa0c9dfa6762aa0092b94a4486c12ed04ebbc64d1e80ab3a92d1d36ac2f5fba96a5addbe44b644157bbfb5662db4e90ede32df6c740c7f90781976e18e2d744c3b09a7a86b83877e84f18b2c15fda18a38df86d5e8a701eb4b3aabb8fd33fff600b375c33f02c82ff843a4d310f597431dd8be3e26adc19c30d0bfc3dab5b3b6a3836886415790280d23d48d2739b5adc1deb875a33a77421266a1e8ff6b4c55b8e1e7032dd6ff6ccf03404309ff6f3e52ea6b55af9fdd23ae1428c19c4cba5b3213eb946dcb2f1b9ac71806b531716755b113205ee100063e2b9ced3c7107fcd357717066027ff01eef3484d623826c469f5f5c1d920e4f836655bc732cb249254c2ea7961d6c7f15fe9797015e7e1b7e444c51bb673a34706a52430d40a153e7425a5938ff9803230626117bf75c600b4cbaa5e6f6823f0e904440da21742d415d3c8f125cb4912a5137e484f5b1d7f3f1b59065d0b2a13ec3d1faea1060e0ecd73e3778ea5480e82e13279fdd4c67d86f349dbefbf554223d70d80592470009b05476e7715bc104d9dceecdef9473a2213b0186141a56247ccf412bf39b2b4fc2db476421ffb32aadd95db27acb99e5c4cbb43211c3e1d1639a5d3ada60850c6bd3e292174f834ad86db8be8c15dd60f8abd8e0c2a52ca25ad292692e13c6de83e061e31f5430924573e6b18452a3e12726f906f0afbb0f8831fd00899870e9f38380f72238057b5dbc113ebb02086f3f15ea21eb221da33aa72b8ac22e3f7320323052cf871d8634ea7f2bca2d202d83c192390e2a8c3e3bff2bd57de3481f406883c72b14a1a158c1618349c91f793e03015917a84c1ea1c399deb8807867a877db92b69e99878ef917aab812ef3de8813b85f61b507f20ba329e46da8e1aee6b3b92b716a120b51ebdb7a99a2ae634ea2cbe18dd98f498563d44cd53247b1061e4704db9430dee72692b62616fbd6d3cd343ec77ae22d6baa2705867eae9bd969f93e99807367d9c6b7729d546ea3775eb223473f6170cd7af186990a40b4564bdeeaf3d146538a6d7d47b45687f81a1dec8f3e48cff2851b2edcc5169c637a8fb32377feddbf95aa184ab6336363472030b23e6e0ca53a0c6584c00785f614b3b2087da3abe1e0c56996d9a84b281f2d6ba9aa0a9972a4df08cd1b2a7bd1bfb6a14e10f5d496fdc03c64bf800839b17bbec6581d23ca98a7a9db1d9be8774b96b2209487652027b7d40e2f34112c28c6ff6a5b873358ff4bfa593460fce284df3f172f35a07917f39f738b3be7a1cfdafab27b3111eb472bf41bc9aeb750bb344c03e06e4a9c12d6dcaa01842b13e5ea8ca129a635bd7023b6f519d3fabfef53a63e54eb539cbfe21541b4756abc51753cd12cc7a9ad571ae43d633e310dd165f7dee4da549be5721e5b1cb8100f0ae4f601f96331405b72de795f9c98785e62f97389cad102fbaa1d038ff17d8a0eae7efc393e941a9a19522696a5ec57c2e45b1ff9929b6b838f9ffbc7ceab488c4b805da39f82058af70b65f96c8e40339b06b2b6dea7e199833344d315217087484da324e221fafb99708fa2bd91e034b65e0178561e904ca8e74c00aa3a6b95c00b1f89626364ea0d6386f779b651cdb8e31bd86c68187ad7858d9400ffd79e82cc167a11df44ef24b5e763b2dc17c94e78dcf41cf4fb9e9ccb91219063a919aeadba22ab4048e9b8316d58b80a708b4f27ecc1bc5925adf076ac3283aed4631340aff1fc38570d52c4b12c3de5a7d92f3b681391432ce69097cbdcff2954ab1cbaccb21538940fb69325ebdb0657f5764247563f415510a88d20a342b2c33475015c5cd0278f312e9aa7543c0a6644a3ef85476deff267223c9a9fb6282095febb126c4a30c2fdd2df9a52ad3d8f5691ef4720bb11ef70794140996803de0b2807ff59dbf584f1efa241762b62ff91f6a09571a775ac342b4d7f3e491228c8dfa3f59e6d9d3208cfd8bab6ee33306b44bbd31ba03c0475b74c949a5d03e3ebc2489bba79c43d4d6bb59ae6abb79eb3687a3e6e162ce56c9f34b08e8eaff9b3f1cfc7a2b42d1d46719aab58bac275fc5ca271db51bfa90ebb01373f02101cb431cd0ddab8647b87ccde28713352e759478817c798b10b03315f0f2df74d6313ff9b821414f6ab6ca4658f0079c043fd818359d65032d36b3d4a1a86f2a2aa3172f47c527df8087c0318fc1acfd67c1731e70b3c1497cb24763a60d9d664f3c469127da1b4703049a7b17b36886dfa89f744b9d360ac453d6eafad299b7d67ce2adce2a82863a27595391f0a9a4f02486e4a0f4e1f7580bcbd6793f5cb9bf1a5dc195e1abf66180877240370eadf86f51d2973aa5a62d62f2709c86f0e4fc5633e87c68776f1665df5ac48dee46d586ff7a4f5aa552f6a126390eb38992c90821d4577d22f36b881c01b6a22196c1b7acded13bfb1d5e77919297f413abe53bcd747dafcd1206171ce82e93b00f921cae235e28427287eec8d7318c4d788a88b58d1085c43dbe2521165922f5ab5112600d811e7dde861810b5b85629f11a7f13986db60d08d909c36eca72b84ae7ede6b34d098307bb7b5d054c825f78a29fd1cf8bc8c39da7a206f4e17fe2d553af947725a144c7063aa0fc2713740e71ab18cd2b0f0e04b35bb292c8786606f326ce9a980b24eab6ea3f6972dc4ee3829066dcdcc00bfec94deabf353722c8991694ab2e1abb657a0547e11ab9c9020efecf4874b10c42a23e65ae61516247829f73a6472ef7167cb09066ed536f052f0e13d99cce9537d8ab980c832284894aa5ee705fc0ee8795a657328cd810ff57cbacf77600eeffaf7d80b20b79c6e6c1e4ce11f09cba66ad8fc27c9a6f8df62d5e2845cc26ebceff42eebf7c5df37f2e51f26ecbb7a8f4c2def2c864482be8ee063cdaf9f705353dd852fb06c116d9a7908a631f481549bb024e9a011a2dbd8084e0abeeed4f50ae0197a32d9f517813df0adda41540960d915e22179e08a2cc6e119c17ea2e09b1c55491c98bc030787d27ad2faad60e14ea234404f56f8d8cd8748461cdd2bbd44a552587691563925161b83e9e3aeb2d2b182235b8c851b7801d9ffc1313961482cca6cb9681b3e82958c243bcc44409a01755ebd65e5604da1f7552e20dd75d8f2d488e8c417130f3eaf3bb65676e616a6f6d13e0e54b21dd1357299b82e7d593987392bea29446c40e1e7fca04a33969aa6adc8b712db7fe300bf8efa1c1177ae5c75f0f39a9291c0031bc7bb91998d3b8941800fd32a244beb6f6c527780839176393276f2fb0c1d44f01efec1fd3691bb78170f4ea4b13cec735fea3a114d1a2dd87132f1f84951313c310040d41cd19a1ccaa1772d6aa3fbb4190275129fdfe78702670a709395a3f8f35f357685dead5a52557bf779e710fb650bff1c8304a747f6179fd81d1d80a0e3a0a3bd4c1b6f5599ed74ad0d5ee573f9d4aea65dfb50d943f1e671c5a5124d69a0d07a49d14577210015cbe3ee3968ff2aafd58228e8ae8d35d856e77e7a04b51fbcfca0c8dd0ea3a5cd6f35fd4253991a790b0b98c165d1236e9c2bf9d7c1187aec456f58c1740b490c0bd89b524a79d9796327454a08af3f395e9ea9820343bf706bbdbbb517b1fbcadffd27e4a9293ecd0473e9d2eed318111c1a7dde5488f1b1d7c0438d997d9d097adcb98aeb82797b2758e9cf339081a2b1b2c1fd75a0d42e390d692faa6ef65bf40166477a69a09830e460ac0ded2c40e69a6f7998f946bec203a8524465b1563e7754c603feac8a9d8a9d13bf8dbf2fc0185c657cd2a3598e9d2a95cdbce542c7bc30679665ce79fc129e3fa19d6435a72e66ba4d2bb2c1cb6d838e57921083a342f902cd9c35395d499fe916b9e088acb7e62cf03f1f6b14e2d125ff35b165a47f8475a9c2db06ff65ab02619d424590317374b476fdeb4d2cad33df07aa6919fbad40bff1d5501f2be4836cfd9844cd92093b23129ef95b19837b554e4ff779f67ef8426be02190e0280b6e9c05dbbb7ad8e9678d478cbf641c06b5788de122fed5fa9db62116c137fe13f7ce1172280ce524decb49a439ac2cc8410dcc60d307b185a3431ee86b11cb9aa946005010a3282c4fc36ae65d8c9252897b7a34636d4051ca5ff94676f97a1361475140d1d1d003356e2cf7858be2e615c83a3707c407ed3126dfb3ac6548a7367e6c8ea619ad55a73d552a317f5e030b3b2089764b9632d600db6ef2b70e065929a3ed21a811221742b7157b569c9afcd0794a21dc666dec7a801e9fd103df20bb24d7812926ee8505ef07cfee1d3321caa2dd70427fb861cf3af997f0446adddb8e4da10986a7f770edeacbf90fee3c0c58fee4b23998744bcc3ae24585ddc76f7581ee14de5042540d825a97ec2282bba5bbf06d8e1068ba93eb0162cacd7b153af90e148cd20033bc37d6775c66fb3aba81b009d950b0cb961acb32c319dc604e72c2c118a981d44c2ca953d9de1585dc76d4417b263a18feb39eefcc7c61035c456822c44bc20aeed080ae55f33663d6fb96247b55b36cee46220738a66b946e0c2b51ff1e2f8349edfc1bd8247d681f1ec098063aa68dac17875a4ce347cc682ed2186019177b4bb3b59ba9a7a92d66edb5e5f981eb79c88e66c41a236a7ece2a0e510d2b04d4abdc2c39f82bab8169eccc4f16d29d4da010a7e04b785436a8b866b584c2e996b5afb7db7ad2a07d3984e698b6f453087e27819cf894b61e93993331c27a4684e7e13098280c7842c42aa603ec18a302d862d1d42655f9c50b66d32b5a4670fae12fde4d63c6a1475374fd2b9773a86a211a277152c29c69a72e92f3f6b8dce7397fa6a70701e97c848708c37ce9d474bd5dd4a63cc866d125d9cd4e34dca9966d5280c9d227c9ee0e2f2274039754ff74dca7097df58c96a48ef65e2f5960a953cf6da750497859f8dd4eb21e79146f38a70b74f7be863a802773198de9b5df165411a067d8c1140fe3c0363e0611dd040c0633e93d543454048fd28da1600000aae929d2f21be3a08d81663d3686250a8190b92755d02d70454b9f77640bf2e3a18d0bc237773a68463d064f2539426fd8464c9e635532804eb9d886f57da67a2b4cb1e555217dc9e3c849516e2ce020fbc4c4854e7009d8d086579e83c98156584beb4c456c56597d90284c418d78c4186825dfa53a821d1012c0f011062e646ac344441ba34a5749bdf8be9fee3fa496aa1182ea3387bda1032023793f6dca192de17c3ff1e4f35bbf24da1b92fcbeeb4a21981332949de4331399d0e658d67a4af7203984931fbe5684da6eb55149a3dd9e0ec32ded3aeb2d6fef74835c4984b982ad94de547e2ecdeb44605d07caea1faadf57d04fc3fc76a92994e0e1f666b32330e23c876e7b0ba4f943c2d76f9f7d7c75962d8f56a29299c3b22f2dca5edb92d8d36b85fbca3d3ea9f46aa0b1a6fbd63e900da57e4aace7aa0529f33b0584021b5711da00ccd43758357d559c34755beb83c3d990b784cb5bb99e92550a4dd21f9f7c01a403cc358d27711e6a76f3e1173d96ca7de2ef6c526bd455b16bad3bf484553a6731673dc3e08f5f8bdc76607d35d25501094fde8b33356d39c8696dd7e1f35d3f7593ffc06638287a15ab520f57878016cd5954052a7af6d9a8f9ee6f4e889e50121d3b3ed3a1d6fedd9ce495440305e754cb4c0d6b5ffdfb941ca961781c2c6530e7ee8bd247c48481c9e36cbe6f0441afc8361d9433798f2fcb29affd743f041efd5316f9d804d1526691792cece239e3756de4ad1c0bead6bb96384ec4706be9662ef22806d228159bd02551e996623b6e830d2553194902d081b907cb544ad7aeb9fee19fa8ce649adb426c2f7615aa1126ab6e8e9e5ad1834fb765324b0fccd632018df80e361c2ee0edd668d1b8d3a2064dfc3098083324528e09a41c427a031a3a483d72dcb94f46ad74668c7bb2ec5aa6792c3b5bc6e630589d5d30182f6e493673ccfc1e6daa7b42b323e5a3c39b4d4767dad6192aa1093b907980030d1bd2c3536e2cbc9abde4e87e901d9cf07b58107d8e2cb6541f51180bd020e3ca371a158893ab587c75b1572587ea157540e5b2f29638cf28151f7cb8be5f4f636e2e991f75a133fe738ef6777885e4fe012a5d82e7305563bc9a7af82ddfd809deb2f6afeed62042d55265ab51e9a091c184f5dab04e42c8bed202ae69a081435770629ff37a6f77f360347e5b6767d0b1659ad06b300a6923ff14040c5b6fa9b28479b18e4e80e2b117ebb387a95b3b3cf7a656d855eb6af370a509c92f4ee82e299645e4b9e481e3b6d6677f8bc19c132a205f3e8ce10fb37fafe5492cf770919451905a70a782c4ac3aae6be0d04cf6980f21b40ced27b8eac53880a0b6e897c1151d5bf629591556f030cbba658d9571f30cb4116d7f5b3e9340b3eabb10e1283988231690319ee8433ffb8541dfd6393af53e402b733ab047e0fc2fb9508820ac8b6e09b65abdc058e46b0dd18f0649b199217e6eaa80794889af0297a43c403c70bfbbf402f028173c0d5ce89f305d189aa16fdb8301cb86de831a570399097d6e610adb30f888eae85fc0478918ebb95d0e809896be82fa6f242494accf26f46e4fc7a9f2fefda30ffd84381b3ee1091ffe025982d8e8ac3d977163ffeb34b53e84fb570cf37edd5ee733dba005bd5ddeed6da5c4e5cf9a95fbe284249384679f991864e70734bc8823bee44b43f938511c292ef1b7917961084df90b181dded9ba4b12327dfbbb30782d1dcacd9d055b1dfa141f84707ed2d84c833de9bf565d4a514679f69b01026f9ccd43de924061c38add8cab99659430c2f3c553c3123b2726d35d217aec27dd2ef672db8ce9d6e5a97eca940ce432cfa33c24a4d3bf72ba37adf9fee0b62feac6a59a4e9624652113dca8a77adc76dfc55b88ae52e32b92733a12b3876a32125b351eb07c09a6f2685509e829b89619703159da289b2214bb66c4619529842535dc42492f506493883bcbb95b30e14081690535edbd4165be5b5ed9de007e9c851a0768fc4ca5a9383c1b3b8fa0a3ae05204c4cbd42a41c302a7be0b0fd5ee4c93feda9c8594f25738fb4c8d79731d7db6986d95049a504e83dce907c7b671aaf4c07d5515f427e31a895149b757c27b3a21744b896e61a0ccf6db02ab615ecdfd824fbf1322a4cee7895f2fa797e8e5d5e2a8a560e8282baa569c3a9bce1f6efb41e5334ea73f259167d386c29df67473a105083e7a2081ec937b6148689044a680f63d7e937d2d2b83d00d30bb0e1500f2d675447dad1ece456c2bc36ba78cf6c1ebd3be025de3ecc35f01bea4e816f32522be523f18c7edcac26563fb6372c3f9d39301f567de0618bd027b798df4175115f9e56872eebddb47c33e973070612896964568ce0526f6ac5d88c9c65fbcb640acaac9af17ad99dcbd8665aaa924db6fa4d6b98cae9cb2c402a0a532cfdb814cec93d364771cf0121d169838e9b5252eca72fa4337e5bf3d549263e9230803c4f4a94e32e9154870af75b793bb4bb0b9e0155c7c43124b5a6a214e33801d48ae42ea7a327dd06f1da541cdae555fa9001c452a03593a8a691290fe28101dd8ebe4f1bffa1e2206c2afcb13b8146faab2717e97bf022f1f54394d032cb12cf919f31d4c4b63fa21b0159596061eeb698b49b415db63f34158887be24f1095d8cc33df067e101ed1913016077fff6022dba22c532636e68c1c38a284417e5eb3c5aaf68bee5917114efef3f9c7ac66cb2abc82ac7d47cfb81b8a3f8cb9df3daf9331c95974a9d49a3bf604bc81330701f046fa954d6c79d7385178c0de41bf381d3a3806ae23bb1b3c4487dbd0ba428d56734b9db11261b3ce6ccf74ff00812dfdefd4faff21be1d276e74ed41207faffe7babb7e6199040adba74d7471bd1759a3637618012cf42b5e86a6bcf0ce7aa011e9d30f79550052021ff7a38f5613030dbeec1f65d2a0a6de43ddcfea8a4bdcff198f5d5c27683e2639e538fbaf5f1d61365561ac38624e3ef5b80a5c2487154cad3117b9c27701eb6173eaeb4d31af345cae7bd078f253ba23bcde891e74686f65702a922a10960d0b8f4aeb6ac52775566e3afe65ea2a7d3680410ea8e763f68c952c1994aacf6bcc599196354a2457fe272cf2814b6667606f7a1364601cb19739d3abe3bc25733bc9f9865cd76273bded293d62114de3537db949c2f6fdd2022c19ca6a1b37fcaea79634a5002872f4c5bd8bb18db9e7f7d2029e29bbe26bf5a5bc0d89688776b96a4417dcb48d762041372134b59d8c033bbc44e5790a1780966609c7b98df8814d7fe145c69dbecc3284bc48d80e0aa367fc674228189915504265fe7baee52b75d43ab5d57587b935e46608f5e93f1b9400d0e5c728693be0c8ecec71669c1899850a632fae8f577fb39783bcf319e2b0e659bee1f4b878dc2dda942fd2fe4529f58457eaabaf40f2d7251770a6e23c74ad74a58d443f2bff98b07638477ec9bd4c97a42405a0847d6baa5354498f3d697e8f620a51c8769bc0d792c4e7f4833595879209c578d9ae3a971c7297195ad832daffbed0014693fdb3d7447bdbc443c955bdfd51cd6c24385860592cf1b3349445971e800e67ef23d06aaa2705a40d7d158f723235c5a223e5966767131936a63e59728531f139f73f5dc908c045b738c8bc038cb4af1db953a979d6aa9ec7a4ea576c0b5849a74c79488a3582a8a95d02a82d37065466a41b00f132e1206d717dc83944ed62031402f65f116d1738fba4d79653b5fb0d757c9a6ca8fd65aa2bf7f97aad0426d99721954c1dd2934b4dc9fa05dab759f411480942ffdf8ad5f1e8cbc6b63746e3ba86b1b97bf10dcc1e87ad024924e918ac3d7938d76c0c9879783dc4885ef3ea61a3caa5e1ad27c875f39ee9fed9d3a211613baf2a6245a95ddb9089872a30058ad500bf7e986908f7601c7a692204d89d10f7c43f60dcfff865b4452c9cd2ac66a6d5bde3f40766d428dca9a4bf9aa283d42da26624cfd43d86bda18c12227b07aa2ffebe14bf122e33ed29eead90061bc2646c3c469cd113112fe96b3df73d50c9b4d61f53bff3e74525d3719041fe57068872d1ef2fff874949332a287db3ede6f392144b6ffe16030259874261e36a1325a2ff2500f184e0d45ad020cf535c488acc98252ee2fb68fe887e74dd551aebaffbf4d133bc4e0b7f282b57b718ac74243a7e5fa54f08d1c69de05c963e34af814e717901077c192da1a8959222479efd94a0a7d3be067cccfb5deca729d284d9265907d94854ce413d7de946194629feef82dc0e76a41646e170b2e337f7a428dcfdfca546360986865397db7913b2534872d87c8baebb0e6e66c1695788c2565e4d34b7c550e50bda0e824e8d49be80d6ba8647379775773a632c8cbc730d04cb5ac834dcb721ccbbf4a96e46632b19dca5d181abc7b0ff4a1c08f050535e8fc8332f226237f7c78010989980539d83456666f60ba2bf8a939be98cdfad376af513713487ce686c3ec084c06a5128c87003e7ba67f50783fcc9040a6ccc182fd61ac4e280022ba90fe5a44cce96f63e668673f7c64cd63bb1e40e09c9bfb7a3e8ba5ddfad40ded42def9f08fb4fbd2e80d520faa8725b70c30145a00e82af6ac8a371e4b887b51e0142e45310c27e9add592e2e4d0300304014dc30deeb14005e23c65f90dea5550deeedbb587f4e53f066d91cbdd4c414c23f24a6f93f02a7a24b59e6895f42951ca2ad304b61dda9e3628b42f29ee21d717ee70348afb9e4c59c84039d2171f23d4eb645b4dede7a21022125525fae93dd6925ef9268f0dc78e110ea44a76064e2bfecfef18e1bdcff36d59c4c5fe7bdbf339b9a9f0eb6ca81504f757e27acaeef13bd437bc7bfd43b6417edd8bbf85d300c075b389e80258a5ec0e81861008afed148a30ddc561b155a1308cdca3875600b5162357c9f9d2d1dcc561d8449912f3faa304dfc2c6dc346a8baa016b3fcc2817dd21b6f801284d592568e5a54091608b9b8ca42a23eae4a1bc9825875178ef75ad11164a18fc6fc6b1b6946018556be8bea33cba075fc75f6f2dd3b31fa1a6fc440dd41c23545850f42e1babb37c4aab44e9f05342b5af3a72ed4d14466a34888e400411d0933d38c50372b2cad0dbd81a0d38737c00e5bf560d5ecd4b3a69f4fb915d58c7aad4e0e968b80bbbc3cb760a4657d19f07f5efc08fe7372d6a9e877fc0c662b68ca6383a85a6898656c96b44b35915929fd318eeb94e1eb83a179f656c84a9851e9d9aeb343510beeeff1eed2f225512cf396df3c0f577d5276242b073d76da96b279ceee8bcc656aee2c60216e670cb0cd0670d9c89a3c5d7f47314f099946a235869653dc7b0eba06d779eb35c02d63c0efd1cc97e3007415fc9f9c14f5be01301ca875001821577857b5265df2ffa3d8ebe9a074bdff4848f88081036dcf41c3322306509a79e5f981c92f57e7461d0bf6575528e0dde9568252677be31218cb36834a7b9bd5522d7fce4c7921bfc8a7c0fc90bce9f0abed82b812a5bce3cd9f9f191fa7e476f571318213df680c513efd6fe0c1599eb7e3666d4692a572984e13fa9b2c636ea3d97191ebbb93f4d7990f2cc374e6e383325bc0d38ed37e95591cdc5d8cb914b00f81cfad8f3e47e1c9bbd839bbea265939f792e8dcb4b3df93f354e2447b6da2a9d47503bba685eb6a4a4c55107520c234ba79885acfe8fed5e357965bc74bd002645914bbc68671a1460fc12237689709fb08eae149bff40298233f109edd7fb3a24c7a48d539f5104a074cb62a56f3c8f45221aa9a60f55a7a83de176355651174871961f46843369e7bb275e42de07282584779683e2ddb0ce3cb30293bbba47ce181620c634deb30694bcc48d78cfe0acc2bdcc7ba6b9f72042af7943d11b097f7baf73a0de216a38c4858e1602d33b3101e55848cfc23719e04ba24d6343eacdd76a08646526a1eb936fb494ca80758f3e59f02c97d2dae196a970e7d0fa1afdf4fbc1a33713f9415a1b8b1b78aa09570caf8f5d69ffb4c62508d11014717a73f1d7e1e7f8337c9d76fb685544d6c4044869644a1a11b4e364bf41b1a1bdcfbe181db6f4930bd6e4796bb1173cbaafae5013ccf5e49fc69e0659ae327aeb2f7f718c54ed2d129461638fdae21cf31f2eea98b4049d0728d73499b9ade106d9fe8f6e97242fc8046bd8d8021abf00245972c8827496ca05d9b8741a233abec3af20c15e3d8fa959d8018c76f1a7a0b08c111da3a975406be1b8afba0c225593925f07fceffa5ef837f6260dc66250a2c4eabd6dae14f3939c726fba5224ef4248e53c94aa06a9ff5af655b196a638b54349d50b59ad188c417af26a965d14e43c5d731c222c3fba086e91bca02aa263b74b8c5477b599d5fa9221569fab156cf041df91a7a5348f64a7dd7acfdc30c3287f8cc7a3f1aab1ccbd2af344234e30c3c23a3abed54d6aeddc00de9dcd3c2cbdb8e981e1016eaddc6f57f8927dc30f1d2cee5e122eb70f79eadddce2d44fb6c28067ff087e6b9ec31469ba9c8d637a13d13ab0adf27cf1b1ee1fba2e80e1720172d440281454881e24fa5516a312001a7a1b441f7d125cc092494ecd046e3bafccd751256a093ff7b0a03dd7903b3fc073e3daf46410ec6aa71809eea10763a97999c0fb756d49a7e26e3bb500b17f1a4cd98820ce392404499ffcf133e1c7a411d185837acfc5dbc8988215a6eaed5de00f5b1b7da57aa4e7874f6b38fb3fc39f01e4af9fe5c3d68a1232b5a5e3995099f249270c9e8c28108f2158423f6855ac5f4f615ada1e835b142296213a864058403342517b85dbd0731c3f04d86b85509e7d5408c8590326686a00f6e240316e8771a42dab6251c850684b21f2509b762a68c60dd74e8c2845c1bef909b812efac76b3a9842de0c8c198878358f442169a34a09d0f3142123b91025c8e059b2032914f9b7f01720f1f4d2ef6c49fee304d4827bbb36ef20366d9882f893e4d39bf18c043a64d86b8445c33d8793b2207b3d388e5d15c9921ad3ad2e10a22b6490029a588a47012fbcdc67b24c4460eda04159a34918c5e7faa6ca5d5104d2f00ac9166dd756c935e81c3e060c5b8ca8dd6649169873de47ef3a4a3a8d9c3e232bf5f2e279af268392256eb96fb855ac4905e29188d653f5b7b96aa7982d539679d723afbf729e04e40e728a11aacbcb40bc097ff2e5998aec2a511c309380ac676b2cbe983a3da16bd439de63f4321038da06523647756484c2d017974ad5486b444c3ef1a44c5389d2ca224d9169b3cdd3360d369e076681f042364e1525b3f11cf2374c42576838f35aeb43487521221ef3699145a8e6b3aacc292ab33d6e34852f0adddab715fac0d3854ee02a776ea03d5b24a4b0dcca1fd87e79106fd94d1492ee2690175ff39c345053e97a81c0ecb991aad92d2a8553f244ba7ec524292d0b9678ecdb840a47caeae44f62f3713550c916ef88b3bd5478ae6a80fd40aace9aa8a60e47894175cef2a826f30e7b4d15c3f8eda2be61935e52730575d6f870ee545e32577070f0571cde8792c14a557923b98ccd43661b766e21c93255f7266d8af0d01d65a45715fcbb94bdb984f60ef3b69284fc47ef745c6bdaa37af8c1cd9a4c416b6bfb290058b5ed0f40c39b35798809b514a3923bf919e78530771ec5ca8cc057fdfcf962a5ad5f422d19ca2a0f22801d572d7b5a28c883e69590c375acd37f45199650e610494d3e73cb89ffb3b6b6af93d0d765dd8572ab4086b20afa0119cebc471c63ce56e085dd87159947f910f639443443429247b6533c2541fa5e49589fd517db7286795f873cc2344cee0b1b7bd8ab6cc020df10f1d77ea6c9bf8adf9542261a234586adc1a49195346c14f08cf0c331a1b2219e848e86c2e59410836e854f91385c10499f78b3339f8843fb85e1f5352731f7547adc28b4dc7b4e40fb434655151da6b1a00873f5715227a6ac5d14aba1f99b0666f3cdc499d49bb21e3118f5474ce7cd3a3f2b393ecbc707e2cc0229912d579a83dcdce1e1242ce5bb8694ae726f2dee28ff0e633fd70011345129e69143de5ee7aa897dacd97d2c88202160c045684fa8a647ea0c310e9a37128045f543e40edac74776947bf86707cd47210f5fdeaa1f8d5401b0f3fb525d8edd08731d86ecc69a50b66f13aff76f74fe036074b9606278b154b4b06628148ba9c5d2c3b519aecc7fe0542209a362791cc11c1d0996a0bc890dec274bf70974662f0949df0ac35452035d76484e44642e39255a0d7484e9cce3d19fd1bd234f7d7bf5c773c985bc53e42259373ef0aa940bc78b0c234e285823957fc84e5b2f6f22fdbfa85ef00f13045f7c5edf7c835b3c520fb72b9fd2fe17cb79329a40bb9bd61a98f593a5fea43b60a58f89805eb86cbe82ed077821b597c0acd06a84ec9126ab1ad2403cef36d68fd30dbbc2bf429a39ec7708e94aeae548deb7e180ea01cc20254518eb092f8401009be21d64c23ff042e4d2cd690568b20211452f8612d7cbd136eb6a6f4896f547d09329f8bb93de5956a24d5e7d077c6851595a0de53f238998e5986fbcaa369f565729c51565101c8791435b446d83bf942455c2af009be25006fcf1351fdf1145b551d3b71e9448a7eb5464e9c6034b6e3e0c77f21462847c07734f0eff1182ecb56a7d5c823258329468c0ba584ebe6c4b0f0734c0d89ad3a898294751fc54f6330aca0fd2cc9bc99facfb7c3660515641aa343ecd62510576bff4010272c6af6c0fa61c87ce9191b7422e9c7b57eb36f0f2abcba8903554c1efe54951ffedb1682e1599c689d0b7eee322121847a85e6b6b258dfbe9750553be6fe1e4f92b5df975d1bc2807a47992f8638aeb362d6ea626531d8e2027cca6c1ad7b6aecd2d60226eba8cc6185fe3c7b9b8d5f31ebefeb7fe3b12379872c16a052109561807d017056566a160aa9c610e63c65ddd49421b340d7fe4206bc8356af71b80d77815520554036f22cdd5879baf17c467bafb9848c933d18e4113f0183ab150d279e3f337afd896cedc03b26fbb83ba72fb6c2e04c8d8c4fb618aaeb0e023e27c98073d20196fb7648b7af689e0188a18f4dd901a4a800abcc53cf77f2f078121a9ba1da7315c877da4d5066c8bfd12bf1d9ac49dd3326f21ee9270f3d767ce7db665be6146d2e4db42dd3d286e6528623497f239bf7727a64ad6032d7144cae754a7b16cb344ff708c357991c30f9d710d1686b500cc886050a83cedd2ab3757661b58bf65fa3088310222ea8eb036081e641942b071551aca5e91803002ec90650f9aaae1fbdbc3a5a844a6adad3dc1141ff0da7c75a5a9e33895862eb36dc02233564936fcd9927d009f76fbfadbcfa92f423a0dd68887a67fb0353381dc5b2dc4db79f77b72162cc287dcadd42c69e50acabb703f0ffdf674eee92d64401c53ddf54ba71a1917c8065a2c062d311ce0d2ddd0a5ce83fb81a010dcce2f917d12ffd3957e39e4a4b82b17076fb9d3fca47d631d6da1f096446ce48432ea976f25416b8680ed4d2b5a987383d138a67758d5e9d80e1c55de4d221beba4220535d55942f6b43a8000c6de7ea9b09ca964f40c9689b4f0eca45abfb5a6d03eef02e89df54c421dc306cd9e5d936e523e41b2da39a6aaa714f14c872530dfc3678d55b52793a56b106d0e078233d0684b67d01dc9f4e1073bbcfc47f4aebfd05065b003eba9b65d46ac1e53539e5fa4a1650828d849890e1932cc5cb56082e707599b7043a9d41b5dbaefa38e8578458874aa5b0694c19a45a43cbed2f86074ff2b0dbd95eb141caa1eb6247583a3aef63ed1978ab281104f988359707dedeaba0e1788038b68a6de1b74240162ea87b8f9b5bbc0d2d9ec4a968ea0b58c69b0da4f77af083ae05bfddbffcb7fb3669ab8cff2635bb8fd8a24ba35345e413d658f6cfbf3e3c5f48265a185e33a774e27cc697903eb59e389417a1dbb32b9f8bc8fb412da405e553dcb2130d3ba23bf5f3096d57cbf2bc341244aa6c35ebc96c0e41a42eb6678292da1fbffae2e481b92bafc1f6699918c47ce747372a8f05d64166d4f08cf0ce922b7c0db1c918d858e7418223d13d80a716cedb8c3697b5172f46e4d0485f1a610f4654c89c5a632459c07bad03e3335d6cc1aae4b75e231d39cd18b6ac29493c8c45a134c7920bc152a4e77f28e0d29e57089cc7e2821639f2436f8a7cd75c4bda0e56f6c0585fffaaba87d4f8357144d645bd2898ff5164e68d7826cab42eaf80f8202076bbf78fa13922a7211df7fad7721925c5bd4e12f11dc1053d05db047a00b76ccc7643d14e65b875c57d4c465a94f88018a6cde436ed2ea53f549796d9f0f2b59706d4444f74bd17988674c95693dd0b6febaa90a2813fc44ffc3a85e0af173abb70776b52796435e3fa24fb415e3eaf7ba568d2ce33b4d34ffe7e040f5bd6cd26853c786fbce144b88fcfec5e0a6db1e4d8ccd30119ec51b7c241e276fb086070c0ed3c8ec341f70df793fa69f2948c463c5ae0e1c5015df41bb6cab5158d113fadf80afc6967940c450e55a7ae9d2db8926cfa7e0dd8dd760df72269bf491fab1ca4ead4925b3ca4cccd9e9be411fbacb8642ac72b76f3cb17c56507e9906d2a9efe29c402e32155d33d17b1d18ca319d89f033c75324e6f7d8963c93ddfdba5dd851454894909be9a1b56b22cb05f0d2e71a625e3b6b9d13ae5fc2890d6dffceb73258feb552c1478f9bb79f543415ff054571b5e7dc714027e2a00d5926310491e907fa68194b41b6cfd03c11323ca72d34ef63665512394a9140f4b126e48e970f7d23b6cd86d86decbfa819911f8dcce9b3ff87a5e027d5621907b3bca3993ae4e0a873802aad92757e9620262eed7ebc5016387646f2f6037db24a9c863e7ae5794cd54dc223f07afb2531a0bc837bf0ba4b884f024ceef980f10ed583ecd2675b7173348c95318829d7bea6eb835318a4a5f2abf2788d7413f508084ad9f722543af7f76f958632a4acb522bd9d3f71274e529d201f6f944ab663dce22907cdb841c57cc9f64dada5712f9f790e8458e1831d89a374cde16f71a98cb8482f6c653995f19fa82072fe874fc97a965c8f6bb05bebe70f4e8a9abb902085062907ab85d80b5442301b811f4892f69d2aac62ff6ef87cfbd50e7ccb2d0b583bac1c68744ab6acc3fd8657f972f7f11f769ce806f578d69a28c65ad1f10d66e8eed9776dd4bab4b9310edca58e6ddcb19fc90d4065ba21001a0a9b5105d6411398ebbc641a26733791c3b934e6eb5292a1d226ed1778c310872c9feec573fc3d045647f14d6384d3f7855b093a2d9a9948ebfb5873db580bfd2459e8fbaac2f75e02420c660442bed1ab97f2368510c3928616280b9282012f9d3ae6187069df2cd90568d48ac86fea2417a623966a6be2742c5d35d2938c8fdf67700cf88035dd55b624c912a72fe7a93f9b3b14a3134cbc41d7a61908fb66add511d3590730ecb01c280996fdaa21c9daa5e40ea1f1790cc2d6c58911cb0a68f8a4257a57c9bb01bb91270ffeee77cd75dedd36149eb1fcd9bcc52ef1f6290a37d36d69e6a727689b15bf91598ec4b8aeebf9d2bbf1a07bb53b8f0888c1a9162ba6ae60be61381d9ebab4cfe0988473b8f4584704c67d6198df7d5aaf1a8697a64398cbaa12a41f7e5b7b993f054873da70cfb5b99e512a41072920847952e03b4600886d7fef42ad701007eedcf65461a3e9e84526416120e8a0249423542176155e9af96fc23f5a8f4625fa0c7fd4c37f6c0ab03e22941b3fa571b3a9a192fb51e8aef966fba17036170b2ecaa1491ecf5f14e6ca37de8dc46d13836a9cfb90c78040ce054238e8298985ad492e7656bc5958c23fe8f1bce803554be5b1e313d06c4d617bbe746cb2de1cbd6914d2f45b92f883b19d6453b0f68ccd14989e173a9cb7061a496a1e7a79fdc0d34e0586e3cfc1264f754bccac8d23022f95f7df081bbfc01c8a607bf3052e7353cd13652666f9f5b2da9be4e07173bb6f3c75d9828b2f88c2bf4bf925a8c358cad078a579325ee560b37c5e4dbd0dbc6970ed66546a0c0a56e161d85dfe85c509d34fad17ac14a637c33a8f70309f21b3cfcc0e9c9e295b61174fffe7aeb19ad470ae73027c18348a8018dc4ef96e0e6904ba8b41c8536b6554f218cea0ffaa6504c665df2f952a12e0929780fc942e94d1b235a74066cf919f07e01e1c4f02f072731419ae2f19a6a4e393ccd6973894bcc5e6079bae65ddf7a02a207f3548371db92fb30d012ac65dcdd18bccdc0220d8ad00066aec842529a5b93035a65f3e2e7c712e7241d676587eeab7e30a8121e23a33b2177b22e2a4dc85a837370c4be2d5d01958fb6841876006543620af9f414ba5d0ae48cdae2419d5144c36cafa364b08bceeb92dd31490e3c6aa4d047b8f3304c98556c529c821d5fcc7eac13924a795de4a1dad6d099f4c5234847177a26fdba9f7895ff8431aecba79a60bbb67badca22b6f0852bc86153254fa3611d9d9a5960eb4b05c1ec10cc97c51ab76b65bbc5406c3c317b3cb8b82ee69cda3ba8f21167afa251584b5e6e3a1574bd6800e209b9b6411dad8ffbafdcb5d56b423785fef312527f6c61fcfaa9be4be0fef750f59e935d984dfc3b83a5bb5d4c435ee1a71bc4af376a5d6edcac7cec17bed70acfcd41793cc21157940b975562059248ab44cfd34001ab77c4192d7b67f028e2f7f6f7f6e72f3bd77a5dd5b795bf7de179fad6c0849563b86adb6249bcd5dd013e35e2a29c749f7607f70788d532346831b7bf474435cb6c169c97bc476ed443522053a0b0e8977d6f462934f292493f44e61c21be991400a517c5752e7477b894c0e334c5fccd657daa99af120d5eb76d017020a1991206f26d8ec7bd63328976c3f1a7379dc375b161ffd150a9de38b48c9e12128196cec715c12bc46e37edc9f41847b3b10c56d3f673391cf94218c85b618b48a93fe3475921fe5659bc27836c03eb7bb98f38edef03ebeaadb93c3d8e33c9c60a243bfa4cba49b3537647e6fe8674fd25a0ca861a8d60630b84c0156858b3878a19668188065a5569dba3ba80c1e61fcd3b33093a61bffd8ab91fc5b6105713ee0d02a45b9bb15700534adeb90a2749461a766f93d3bb17242c01ca8931b0fa97f9df26266a48a68543690d213841ba09bd5d97fdf2fae426f55525a405b16de0745a94fb86187ddec021727fc4f8454b363d4fe8f810e3884e2a21a1416f622917a8f3dba216db0096b017020f8611fdef2dcb59372d9a73df6d5823b2bbea732af6bd3927bd22a4714c470e278132aaf85313e8d841921352693d6a76c53f45747cb8bfdb2ca154de35e0be67acb5041919a1a055b6ae3d6c16d39b1f94bdaec218a3067c0b69e0f403cc564c1fda42ea530942046ce27916ebedb86a3caa5b9d3c7be00622684d78ab3ce14d3a9b0f8236da164efc5cc71cd994764361a73a50a31491ed931b09cd963d644f83f186b7c41100a677371929cdc38ffc7a8ce5bfcca5944fa62fa05f360094195f4c6db18b557e5af69388e2c8dbdf8b33774e99b18517944dde555c0911eedb06b211e6e9cf0bcdeb2b644bf140d799eb784e9318729bff945a47ecf411e0d68ce146cd9596b46f791b1ad7edd418c4b867298fe1b6d9829142b5e7cd8aed9c328215355742ee6f1f648050367c0adb4f550ac632d0c0aaf76a7ecc58c27b27efe374b388f43a45dba9615834f6b6d817b05fe42bd18350bced5f692b197bf798ce1462def82d1e1fee0b479d4469affa8cfacecf7f894f0731750bd4eb15f97d8c65bb411c3b327d7488e329b55f86df06a87b266d7693ecef0097dba63a98f8a7d5d540cf68d8e6a202e630466f6a61bdd6a78ee5d572ac7d488602afb35288aa56777e476e9f34a9202e7ebe5c39967fd9d2f25c6e984d932bbb379b5eaa7e7bc1717ea9695732fedfa34a859f069022744b358d07666b8c6843063785d6ae322a2ba76e333bdbaf8e368af2a13f9922d1afd2691693d770ab97707fca50fd512f302b7ccf00754052a3cf4b74f34f01dcb9b454a5fcbd679a727af26cab0a84c5873796d05a4640690fcfe70527836d0dfad9af04abecca19b32b44aa4bd68c566f8aefe951e152e670ba59d09745e2ef85bbecc4ca7a1ff393497acacf119bcb2bfbb4e31637d184e7f6e180923c79d05c3a6340812b38781427372dd60c32c3e05e5c37c2bd791430b1e40cf2e4373cde426d563c2173f25c380ae0d70c6e3ffa060fd4171908e9533db9a79b51ffadde4bde5eb12a7b157259d573382cc85aabeeea7d2fdaf10fb2cb42dd45c64175ca3ca17b89eac2cd55ae6d8bd0c0e64528d78d5d7b0fb19716220335566f35b5d45807eeae5dbcd18d10370fada0c88f59ec4174ed0b311f94478080ed47c8df830b37f2710068844e96550c25653355e2e48bcf9d3df5c874708e3268cd8329d95e01823cdee99af391f13e92bc9660bafac5ff0a7bf46ae11c12f39eae36d4cf9ccf5afd1dccecb63453a3fa5a48c0fd985018195aea814dd4f8b7d7989aab68a206d77f769ca9decd17c7401232cd8ec499e0eb7530d3575db2e52d53c11fd98cb61c350f7c5055d6700daa3ce3dfd604ce1feb52b255defeafa00aa85e9460e030aadda80b3ad7cba323b942ada30d4b3d5bf2f93cf8e159ebd41f098d2012a8ee5d7e8460e8131123d77dec1cf9f3fba058d668e33ea9edc4a853957af02f2f767922b4d104ed0d9da4184ce6697dbc9919110032efaabc6f6cea410ec05a0f49c7fff4b52cb89e9439e87e87d32fb1c7858e41f1cb2811efa0e896b26a817b4d5c2e93fd0d83890bf36629ec98c009f1a5a8716ec50e91a40e3321659784a2522ce6f9ecc591203513c2f7993f7d4527fee05fe1df78913f8394280d7300a42cd3922d673bf561d74c39e51e7319d7738fcf28ce571c1c422872fcc1b8eb36d3be3adbe55734e8e19971fe534b9348b5b6df57bc1f91cd1949bc681806e37c2072baa9cc17ed101fe379d5783786b62954a32c0710075d141e67ddaeef913f105495784ce53873f7655453e892d1eb409da424ce013db06bbed79801fbd7127b28e4019544bf0c3937ba2e13385cf86d1f07b602fbff2bee89423cf9377719fb3f1568cb7487d3f2e2c6e91cb82815cf561d5ccc4a156d12b75bc99dc53c3b29fa7e7f94e39bf4f039c6dcfc63e0f1ce331787ae2edc36a8844edf5c908d2da5ddc466d663c5615f9fd8ec49d9148677023ee6c5de92a36050081c4627dbbaedb9e11c3fb993b3b01b1276c6697afd86715ba5f2e96dd1265c76bbcf76bf1705cb1507df0578cd95be73e5467f310145ca3dbbf9f43d27aaf6ec45f77af0a1ee770e7311607ed6cb78b9503feb1723e3d2c053f1a121fc06537611e24a26a5ebbb3f4c41c893172fc1639737ae41f36f0ac47dc47a7711b54f5e7b33afc0631479f01fde3b697ed2b9f0681dee297ac699ea952ab5f78bef61ccee603da105e182e7fa8f729abe95a920ad351d68547cd8edb8f85158143d75c3bb5fbddab51db4fc333b2b36754a0bb5801412afbab99b7d8a04218502365f345a2230d06f93dddc3570ad6e4490a02f995da32dfaf07732c6283d3228015c40de2f3d7f0350958f73d0b2ead2bb2b8b04e2ad7cb768742612c8048be57c68ca9e536b0a2ce5a6510dc8e2421919fdafe51d6089956103b9fc7585f3f2722818bce30c681f5154f81bb318c05744aa4e9ebbdffce3858b8a51eed371edf15ff26ec4eb2c4823d579296f329e13ffdc6a6d8b28a45f0e1ee0f02bbee3c1ec6afd62b47f11208de99a434f0ebad88a6ca5c51b202321f37c526fb371970450d1c2e806b383287078eb75c29e919df7faeaa060d2d3f05ebfd79e78e9d93b086c4f1203dd104b0d05264c1947119ed45b6125acfc2de32f5172aa765101c1fc5dda06fba1b9c344fa614e1368c7cdf36ebf1b967cb1a88f3ca7d763397efa0fef9d55b51badc96ad6b69b79eaeb76de1960537e2a15ea49ccf111c1cda88b8ab2a50262ad338253c75589dd5464ade03bf058ed279cfd391d53933071a4c5c5e55d020019cd1683cae1c6752bcd175275710def34e35f11018bfb5f0cf9fe51233f12ac9667b9be4ccd0d38ef2049388995cd58cba54ae9c6bb34bc2d8e4f80ad6788d7da32c9ebca0c281cdd8e1015e2fcf9f7ed1a68ee089af25753d7f0623d51c4088949cf0058d50360fa11d70719aa8adc9514a011e1de14743d122ce0ce544693bc048c90feca321e80876d82c1547d1e1b5a2c17dfc35343c2872fc446eb32a6aacbaa0ccdd91998d1d2e348dc9b8bb5bfd8f5e57bea532eb48a47a2faa5ba22fc0aaa0682091d2fd0fed04b8c3987955a6d7fb26ac0593cd5ad54e70cad16e75439f98cae2724dac0726db282648f8f72647054314b1392b8b06b2efbc72e44837d1b735f5bc39b7b8a6552ee4c79c6064a2889b5da21de56df60c18ca8096bab5afee4625366f2183e925f1630efea6be4345f31416058df0f93abe177b8f80cb9869caaf41324bda36b8e7afb5cd333ff7c2027a1d49493f06fbf84a85ae0786de5b0839077348702f2a647c702893e0fb0e0824ef3e73ba25f1d73d2c18b1d591e8e3eea3f54372830cad3fe584c9bb91582fa7f8cfb6344a46605fd4d49a86fbfbab61b910cdf59d4387f834e180d8dc69a67b75269df6fa5fe2f50464e988bafd4cdca7224d040c4180c2e7507d380264c0d93ec06c1c620916dc3315e58987a3e940703c245534c296921f3afa54b013e1dc3804cd954fda53d01c812dfcd75657e8ee0a4e7b5f910c6e3445c6cc53b53dad3ccb930f1d93e39ec24a378da8eca7fee8e74f945fc0a7c48d707a5ba3be37cbdc1d48ceb40f6b154aa56c7d272beb748269d233088373b7162885bb103dbb17f98ee0445e2ee52f7cf324b23217890762e4a9cb67c5f42b261dded507b856d69ae1d9f8e56977905429d1fc0d1af631cf22192c303e2cf190d7d967a6ee87603676a2f56b271a904bafca7cbd55f5985a71b662913d512e8d6c6c44fae74e060f33e9251113492456d7a4910627b13648e01110afb032301e72ffae877d768a3a5344077e6cbc90e16eb7d1a36ba94a71f62f2f5a463c15c25bbc24ace72aff3799e77398ce9f50080e3cb321dc1c7aa148626a20b0144fa3f5208231cc3ec81505172ff920913f307ac9bce98c6453f586c09903586b9e789703ed1647e3e511ab84c3c7e32c4a4a02bd5a7d897140e3a7292a48aa67ba6ba534d1d2b5a5b608c50f502c28090db45a62ea2234fd301563157c70c7453e016743ab8256a34295da061430c239115eda8721ff72e3cd767c61e4a1a0ffeb1d52289eef1157390ad49a2aea57319804138a328a1d8c2aab0209cdb9a44e4a20e0e893fd7aab205c2f1250a1a390a66c604a902b61d016aaec5764764e0cb7da1ebd9203df5cadc21a4ba46b3c07a10e30733e28c3a14760545758f65df80ae9c34200e62e8fe48934a826b7dcfc658e5cec34fdd94fa2bb1ba3bf1f168e0eef2df24068222c5284c54bf8ce04c0e4af4a98cb8573126c37e22db97f8f24917d9cb077ee9dddfcab74b3eb2522ceac60edebffb237e5bd3c4c645c5749db2f1cc15325d11246cee984d7143e77c8ce80253ba9853739fbf9d7833250b80ceb8be9c1d717e9633bd07df7f6638ecaf0ecc7b0696cda65e9c76a9779d4e402e9f1ee767cf8b65100f983de9ee31ac0a32e0aa4c24cabcd87594654b4efaf33a064375bd91b27eabe5b06f6cd1df70e7d9b60ba790b83c2dc1baa0e198acc107efb3e068224afe17a0a3c354d053a88bc229dc9f2e8d7697197b4a193f401540b8da614346f0a5b1899c8f5a51137ac30d6547cc8f6c944418b5639d24dd8cac28cb77653d3ab98bbdd21f1d39e5f650b75cfbbc1d8f59ddeec8bca0966ebee0a97f584600a9fa7b1740ecf6ae9e3f8910d7bbb38b970e4048661bf7e925ba94ba352aac150f716555fb385b38ddc732340d2750210764a7029fe5098f4f2d580a0547a0c141d60139d2997961fd1ad03359b81a1c01c3fa612d10477209b8c6c8964e780d37dca6fcce77648a29fd39bea528d982160a386872e70c34eca1da6b060cb9e710e06fdc1a6cb0e40c1a6fe791894ac79fc53200441240199826fe6ffbd0f2528f86bb3e2141c99fcf9f94a6a80db7054d243401448a4ee543f1025b10ae90e498fc01f2a9c5fa9d1b2ec0e8ace701ecd5901a5c05c93d4cefe54d0deecd4bc3043ae83762208eb67ed13db04314d9ba8abc2782ef0e9c2b4b41f4125f928470644e2125d557a4b22c479b111c51c76a005d11f716ed4df09c3d2ef5ec07ba5a2c2819b935fd1805649e42b017221f2dc20ef2f40b6671c1a551f69b626729683e64fe6c106d84ef912695bf9e12c97520bf2dc9bf7807d28e495f2c40efe972381402bc6d71a648fa8f6022b51753018c32301c5cf50e55cc606b39775d8f7d3c5028ec1fa8109d5b12cb83180e74731be0d591c1ef23e0f6774c7a48e98c7ada651fc659284acb93c5c9fb1b0c1bb74b70a38194c4e566966aa485c4445442bbd22bc7b92abeb1402f3f37e6963529f94df5397a657e674c07573d8164d0626cc8e5c68dcbc22312315f80e3ed503d1381ba9a9923a3c0e69900f1f9d04a6fc6d4927bc49539b228ed376643d9f085c145fbfb9ec63cac7ec86517b0cd4a692af70f6e7c56ed13b58a9d55d029b5f9670a550eadf7745ce8873ef2cf561a2985322512f4dd518b0fb3700575c3cf7c1197e74b39d8f79ded0b886be74bb9e51dd027a13ebf4e49e6899a806a83a4eae4e125080620607cec3681d5b87c8bc85f41d0bd96b516e331c08967c49d7ad7ced77128da7ca993625759680ac2c2e71603b7d429286c4af3d48658008222e204ba0d8dd80335dce35155f1d39eb99f50d110162456ed5f766fdd8981233491cc53dfab7d98643df46193d3680e32a328f67a482d46ecfd914327925c27b759d26a00d0261acc9302f3a17de3cbe3adf8e77bdf78a9ab80c22bef171fc52d005c01c02a8423e9b41e60c0e42e7880f5a5e6eb23cd035440b2b7cc57b6cacb1f4d768abd8fdb9b9399a1e845b3d4aab7399612b5bbf04a31ff2ebb78e73836742218b09f43d279e0c0e11da1e333061520bca3a6d475148f65be3993d1c2ac41d3602cb1ceb9344a22b74c44cba01d84f5a0eb10915ab8f70b32d599e044d44c2e497f9b51ec66feb3c2ddaaa421229558491f561d2b1462c52a2fa1806e6150a5e40f15ce90df7985561f2100127188a2fffafb37b59479b13e6778a09bfed40b927468c6cb710dfa9498ab97daa1f48434943184c3d5048a849a0ae7a4eedcf54df553cca7f2d38581977982740697981f8558f56772bec66bd2aac7e9f53b07964e48941a1fe3eba16fba773a224511d727a76db40e7d9ca30bf7aaea9c9fcb665fc6d0c815a8e427d30f68a9b7fdef9d8fefef041877b5412405a7f2a12bf433ab23cdbb0f8918188da9759743050f0c13c3eeb3be04962f81732df6166de59b1b8ce5258dfe7a9120a99528db35208d5a6c6f5960c886d500440e4eced9d2f1fe5c74f491a7841d29cbbca6adda15cd4acf1358b4f2a62330e4fd4619f69a40c9836ea9425dca6c6adfa8cca8672df8d69d78a7c5ea6d0c04cc3f6f7030678e4772f82ba7a72f4ea8ce77cfefec708935fa7de16568aa6ba0224356b32c73ea0a39311e7f18069e02b63c1002f60e415f5637b8a76cbb3b3fc2d940f89bcfa5cd7fa5928021958310e9b2eb82ff5ae5d09defcdc66df14c53de21e8aaacf03a14cdc73fed93a0c062bf76977ad3d7b9f9d72866a97a58afd11ae91cdf7850ca6023aa778d0b6290f42d2fe43e155c66365b30f4a9d2dbc32ec58aaf03b0284dba84cd5f5e0222372dcddaa68abe679bb1406c1139c155d535316dfd349e2e4d4fc84e9b9b97634ac798aab51f3a5d9a14f27cd78227e53ed5d1b1c5c4a0d8f388ea60fd0f810ebe779418f003f9f38c7156b07a1d8af9eacb440485b60e8a3c591117f97d88e7616e5da5f93568c407302062e23149f85a793d54ecafa0d35bc3769187eb00eeaecedb05b61166198d6c9b6ed10eeed9c826c535fe075832d41445348e86406cd664ad02f6f79bdb86507b6b9a631fe6b182812a6d2822c6a24b25e0bc5beef22b74f1cbc95c916cd807ceffa66b40f769dfc84a88bc8f3d879f2656d8d96b4ad57effd568ddeede8c81ec93677fe6b2451259c260ade81f80efeb8df89b5d76e4635074d0a423516a8a3c5abbc2166c752c849189836f8ad00ebc9f00f9207e953f73a577b75489b0df69822084770fe373428a520546989e7e5f28cdf4f4e41a4a1d22bb1c3aace7ad37317373d845167c26259dd0b8054573b67cc2c3f5a57377e50b96e9edd08906c8d6e1e9e32b7db601c10b8eeba6241f3e94a32fe7ebab6c80d5bdc1ba96b284eed797a66026829afc1c0e52ab51ecb58c9ebcd0eb0326099e0e4d755b3fe204dc309593e9e7c81008161650489a97ba2936338ea88564238707a2e442cf932c494c484cff1ed25d80fbf75bd37ef509b6fddf28dd42f53f382b688de70108338c4c195680f3ba301689fb7ddd0eba1da93fd87f04983652b85d6eae8f1eb2edff984cd45439d929db3ed3e7a687392becbcc91acb53a09f37988afa0ae10989038b31a1647e039c4ade7c0d124b12101c999897d8ba696514f0b26cc1e9cf545fba1dd819c2f834a5cbd96239d9f7c0f75e09820f3765e140af3da69422a6747e8d70e36ad2c1053b8c10e8815afb96f3a68c59f54975944a22aaa8311691a0d959735c27ef0aed0ac3af193657beed4ee535d9adfab391fc3872ce41c16e4e933091ab99b76528b5f9a1625e4bf911d8f5417feea2f43a2c504d86316d578e38d4918c32db68b51ae116d28ed093783e1414cf817777e83db3b8cdb7e1144d3e48dd5244d9e38ba51ee52627124eae28061f2d380aa59d6a7855d478ab377a71825ce2a3c9040b0f1fd234bdcdb5b51d42c644a6d5e876d95aea50058d709bfce68d7f4bdb5b0fd6bf3818f0722ffa762f211371d8d18dc9ea2f19d71f8fd8f991b535d98e56b3a7fea474bbc808232a58700c4b97449f53b895e50fc03ce0d3c386d543949345ae08ddbfa9ee21290abf25d1797fdce7d87abe4d02ef113366422ef7911501dd6a282d48f1fbbb6a4becba6e98f82fb1b1e94cc314a11505f15ab374046522119f530396f936f176b13f8758e5d4a61312e18f1c85771eb0c226670326196c56abdc8eb1c70438a37daf72192991e49107d686d6c65260f8a8ac7489ffccbb600edf7900ceebc08b37e9344ba47160cb8fddbe0d48e6b21306e127bffb36faaadb1972036ba93cdbc29abc1115e0f010ce3129f0cad56c2d898ba50701bd45753a964332476dc1af598e5a479b6eb5cfccabc1131c43ae95ba273413d33754990a1e18e6fd91acf35e6da42033bc6d4f1613e254ad8ec7d0ee886e4d505ce0f580793b6c888d677e345fe3d70ef30f817b1151d109c1f838115115396ab0e7004f130dc80d7b7f2d84b47e1de0e8807b0b7ac7f191fcafc786479e904f371bea43292ba3ac222ef6a39dd91ec578f461edd1c60665a710b059ffe1dbdd613fed94969854c4e6f1b64f65579dfd49ba0d7754dfc44f8f02faacbef71611fb0f960588131581a8c893f9eb3f2cf839e2649bf0f6f428cb5cab40c3695671db99ca65db7eeb5d72b6f8d0904a7f34ae15e6bc9de7f4c0e0e0d86516e9d85380069bc961d0feb5b520447e0118094576fcee36c737d3782ed990d67bca67dcedd029aba4edf77bbd42b245bfb2a22fe5f50aed986c6247381b5dec85dca115fa3af157b2668665c352cb87e04e48a929a15d8d31ed3657a767295722c7d56b409d5da09fcfa4530118271dda7992dd778186b96cca7af530675b07a60e0e00334a09176e1cf7d68d807717a4672fb009dc75ffa8906c861714f3582b31528967c7b3eeb5db5cf0eaccc7b438dbf389770a5f0d012e3497236261d3a950cf81072dd052cf19c9a803daa6207d4884d5ccbe035d614ee48c3ffbedf618b55e60b897fbb1eb4a81a0cd8989fcf4f8eef9391b31acdfbeb4c5a26c810352aa3b6e63f74ef6ce6168b15e5a09474eed053e6b3811e04e7d5f974ed61815de41a725bf6271a3831e83a2d26d532cecca74edbb1b894546aff4d7a6401edce3e4f803a1312e3bf5e44ee2d8c1557d86f3532dda7f84d87785efe9a4124f91fb883bad9b5f6ab107a28766845c651fc78af06ad5f1cce6b2a15aa314eb6ded20356bb8f465455f60a6b9b30d3f35006e81fcb414388694c96d492ea0e508527b1022a1b2e7cd68d6b47c67629cc05dc8ad9c6f50e9c36bd8541318717c00b027aaaeab8a90e3b7bea78b8cbaebf23cdb96a4a16bbece4572babbeb8130e75b0c16ad1d1ce9ab65a9386fc73d61ca84626356e4b33ae5cac9fa0fe6adadcc100c890fab8bd3dcea874443402adb1c8babf7c40eba4efb43f563795ad30bfe1f7362d0d00d40363f377037fd422b3160e99e434b069e1eb8c5138c743dd487eb46bc511d209af5dfc9950d1baba4a0be86845c4f99ec1896b18f5c9e621921cfbbfc57b0a8ed182b032d4f2988bded7a2f1c2a7ce59993117767faeac4ccdb71e5d53d79380aa4d421542bea089157be876291e24c60c93572ddbf4e88816a8a8ac07499a24d08c3ddc6449f85f33ac57f88e7dcbbf43089c9a60d2ce7213bfc7590d3b5af01c3203420c7a821c04cc1a8d53c433260f6a5e1e7f7e2c0db43019069a549a46f24c99f32a542c147b8a88cafb96351678a8458c96c4b454b980b9ca15d07465975fdfca9ced499e36d9e8f87a1f04de7b248e28f15ea3286edf327e6d07e145b09a1664065a7f21cf8e9f42455e13d5ba46a268496b1aa9aaab5ac83de7ad0e6dc8c20c35a586683260460ac0becc7f03ec5355dbba6dc9d9c5d8290cd61473b3292adf0004ba769a1dc06ac76528c7366c7d4ce1dda09f7e1b4d0c277e6f9e761d6d144e4e5a127c1a57b22bbb77cba2f203ef5ff08e8cf1724917ac7925816cad63f103775c893cb9b7b08f3b4eab50b7be95e610b90dd6e3c232edfbf489fceac531247dec6feff5e2ec14e54fed7730bb9765554fd55aec3307c3aaf55a4b16cef481810451382c24559c6f83aa8f1ac0cbf9b2d49d0e25510e0c0476dd22d741af8383b3853e22c2b8c1dfb04bd60107ebbbe1b9d9ef8b718f190618131d4e7908c96b94038b8e4e51989b36c2d1fe710a3be2b08abed37053f8a9bb90272cbd2f9ba61e8baea2775703040417330bc55c4d5e7560dcf3ad4a1216900707f0faf25467e14de25d80a8d680d9af02fe34bb47b0e0f27307840889c0f9df2da5f39bbd5506e67d870075ab37b664adc8e05366d158d532e9b40e5af1b70a08f05577f70d9292e1858753a7469bdfbb3142b880343585de9d38f83e14c970a4583316b84a5f2730758452b62e777c05e57c04267b4699ebf04f70aac583b9bfa015f622c1dc183e8026f574269c9087d8de3c047962068ff5c47c914af534cd10f3d2093c191e25532d12fd46d0f34e33072e610c19199be89419be7413c4457c3c091259acfdec247db5aa6fbe0cf350c7aa74ddb982c3931428b918639c47d8b87d7c76abdff9afedbefab41c617bfb2cf099756892374b06122ee03202edacb583c826d853ff51204d600e1b41021bbcf7a95528e06c2a4927580eab4b2b69ea5488baf9ca06ac3bfc7a1380f5508e370d65de62e7635b95a3e9dd9aceff8ae5a28f8d00e85419dde45e7bd4865b5802ada9e13b95f7a07e06e392cc90b709cbece7853ac240e56fcf5b0df95452ac789fa02789e1d2b55d8564d8f3ed3aaa5a94d2a8fe9de744e7e8ad926a181f5749b0881a9456fdebf259d1997f8c5c7f71308113d1a375f08ae576cb0c5a256665e1cbd1c64d695fa26b7e82e5d79cd864f378afd13bdae330dfb2d787ce15e556eac6b29ed2611e92a97169a1cf8c9356bca70b23ec71cfd1b8fe511b4140a9c9c99e2eb2746cebf560001b58ce6fa85589728d9433c25bf7fa2629606be0bc0b94047fd08aa2e5d5611d9865fba289ef18dd03ab0a88b910ece1ad5bc24347763128e00f3f7978f76c2799f4ad9c27be41ea5bfc77517aff80809773807a54d76e5274a62458e0b9921f58397ad05e87fe8cc6d6bbb6552ddb51e320a21a5f0b05b4f3ef4614faedf84bd748fdb30a95f69a23a9826ecbc5e4ae49145a08fce76b347cf749f70f81378137634eabe32f3fff603ff0bc705ef53ba357f3eb9102a1f0ff189f295a1ab19113575948cf826bfd375407715d452e9f098f02e8425bec8126169335ccc2335f8e554e19f7883996aae9a68d0901b21df380e14feab1a90f311f8b4053c0332f876f9c5218ec364e95a09ae60a2572bf4998c3287d4057848af8591e3d6c90efb817757da3348b35b2062035d7f09a539d4ee2ff42cacd1b77704d5fc762f9cc9aa5c50322805734c98db6a34e5d8fc7599228719a8bfeec55482567ec6791f4e17784f85fcf339a396ff55a6c86b2221383891c90a299a317415dcddfa0841c643291da38df12d8a8a23586caf260556c2c51b4a28c9bbe0b51ec928f53904f4f5b7cf15f93f28e0c345397aa3fc9d1838053cc0592b32d0c5a94e29f9fd99befe1e0a4955c00f1fbfc0bc9ed2093a6188fd7c66007f62570f3565015eed95c8c258eb54f80c174a36104d3f7994459ce0ffe48ca3001850d85e6399f71d88c31454f7434d1b79989a561323790090b023001395175a9431852174c64284b45419d088f2e36bcecce4f8f89d4003a37af2490e72f433fb2e57c78f1b13fa9e4d3de3be37f53cbef37261a8e16a3607a81d09c060971f105c02ca65e75ff9aac4f6eaab8334872a132ff3d131b465af51f72ff9674c1afb28eb2ccd295cdcede40547d3d76cf74db40363764fca88b98ce6518f12d0e075c79ba93dbb1e55c24e878282afb969890137e56305ab0e46b02f40ef7086616e02908c5a84b0a4b00504b5b91dcf1eaedab260ab7aaf64da111e87eb42d679a974bbb427d9d29efd33f183e3f21ab030a46afca7fb0d7a9336d1ae1cea660b17cddfbbbee5b7876ba0fb2c0be0ec36624ec4742a2b0ce085cf6c161451b4cfe2093c7c4b7edab5caea2fa1e160d80c0f7a9f83fdebec3acc0b010c212b316c5b724b8e3110fb9e2fdc65e29ced951e28f38c49d8e364370247d855cccecbb9a4f5cfdc1c2b8c8e6ccf19264066ee198190db3a25bcf20bfd44e229d7b1015608ad54c9a2b435bfd537b5bd2a27fa0616b1b8bb00d6b8e2170210b5e20bd68216e7d63546e1555c28ce294322772bce74e29009fea7dc961018839eb37b031526ba35351150d8312ebe26c8eb58409632077b4000cb903ee03e6589a553fe96bbf5c6b6be4cb20bdbc6d35188cacc8acc52a055e3960a6981910fabf3194f8dd6fb1424893555b53dc88b2b2fddf5d2c8618adf472267b80af3cafcb2bdc198b0bbacaa5f5dab25bd9f1433d4773cc3cc5179921a11e98b8c79c868492ef608c8df5a7e98164535d30371355de565de2de8c5bade28dd9a713a83851a8d99c1dfda8ec5840b27fdf73745910fcbf185ba1bd7e8b0d1907e897dd74849cba77e840f43778fb625450c9543b42108529463201a947910dcc55f2ee063cfd7ad20860092aaad6617ad8b338f1b780197dfad661da4c38d60f20ac53b5af1b7d98364a3c7797bd2e14f97e2abb482a040a1772c05074c4e089fc0c9e5a34e95693e04a3cfdafd73b3ac5a551ec498002b0a6ddabefe77ea5ad97fd112db5211c76a5d295111ee4f7cef789d6372a99829969551eeb70fe3453a3b3a1de31912474b8d1f23ff41fbb686a8e649e4ad8cc911c1b85d5eb4120524acd8a5182090633d4f69e5f8cbecf878b84f1aed876f9f165db2821905fcc173adf736c29fa94701310a4e60ed2c72e44d008d0dc820315c5e3736568c09c6a4026e53c844c6a6005bedbcb71d71b1341cb0655856dc4bd2a1cfae51d2fc8c222db49d00e536782e7f27fd12610c4a161d8c385aca57c3602c0e8162dd02710038a52586052f6f0d4d03fcc3f88500805986b3a08b3a45d6a0e8f07482f0146be8890009d9b3887bb471ea9b637436694755dbb1f894c7fcdca9684cf76156fe407c329ab9064a3c440907596d98e7e1f07d0d3d41cabe380e30b183d2ca72a24118e3c0d7e2ea8af33fbf90973a7dd02cf094f4b94a97aa674c958a262c983314099883e199333433b61ecd05267f6bcebef7eeb8c9cb1825c0bcd0edd31c2ed57a762f9594091c54fdc0bc837b2620da360ead323cda34248c59e1482a07f7da8d29d8748528e483caeca0da8aec75a6ba8590698eda06e296263978ff6ce9e093347f1c65162846cd46a0d862fc77353e65cee455f26ed3e0175decf82c25ac977764f66afd6e951f14c1d233155ac207a9313354893dee202e04dd55bb2639df581fef4665593c5029949ece71ce6564b248c3936f0bbe2da2cd8409be8bfd376913b23fa9e88cf18ff8fb5a158ac0ea3b1960a9805efe742d5d536ce361554b143ef9b94843aa91810de162e6fc8d979159afe39ee6f907926110872e5ab9744c0fbf2a9be0365851b3ea6ea624a006eb46bbcd8a4c5908e82302d61c2c278c04a792624cecf9df7a8953b7dba2411d271eb3c72ef11a1de52740fb43fd4d3ebab55849a079f1a91fce4eead8bb41bc1f94db3040bba71fa350c613de9957ec47bc955303d35e503b40e6f21630c8044cb868fcd94d0b563f75f7f4b68a8e8de5e31131ac330438d52a362916717645137551704ed7d6cf311fb539276b4c96d20f39ccbb37d52334c6213e6da33ab46dc570f6a7db5d663950b00c43aa55a9d41b83ec6dde89579d83fbed4f488cafabc6efc1d645b371cbbd66d70d9306db0592b7c952367a72527a4d335e3f6f8d0f9822e5be1492e34c1c225c56e40137f4564602f11fc772fd7152da5e2b578ab222b5a4d7238189543356c7a343184b1d7476a9811b43a02f03f5259db9bf339dd1d8724e3f049ecd706774b08dd254628dfc04a5cd91edee838458ff6f1937e80f82069a6f39d753268533ae825255dd7be7486fceb1a06681c7a0d8e474e388ad41000c0947516770c1e74582b3214f5ee63df63476d8d8e6d815d4fd9a326709b29a24a42fda0200f58449ab742aeea5718572d31e6e7a4de882ba644b049964bd5427b9fce6187ead8403218fcbee54d72347bb1454d3774043c737e6a436f74bba4ee313be6014e00cd58311a5e4481da371c921513efedf927b59de74b31d5221ce20486131d455d9b1ac2948468c45c98b724fa5e2cabbd011b078b38a84455542d556dc76d05843ecbf6570ed02e927c1462b3df83abfc0598d750a1b06a691ace56c45e882f395608c61a5ce4b4b41ba9dd43ab58f888c5dc48063b46e19a090fe74600f68bb139c814b3ca2b042ad05ae0e2cb88209f0ec21e6d9bcd9db55c2a4e8591473d4b295bb04810080763cde5f57b54ba9fa0eeefcc1b0a359ccf8b128ea30982c24347a7cd154ce2df6ebaf80c40d8feb801eff04d6a7f86f8a8eef276e09a579c36045ce9e08b5dd49e769dcedc4049b92c9b0b14caf775dd9ee5d3ed812672f806098804562141858b21bef556ea02a62f0162ae1d6b063514d5d8d1da75ad8f227a837ee4971fbcab1d9e204b5f2fc011bc2c9477b5a43c08b1523aaa42312e27656e1ab77360304e24a39ec600d44c1e217e868d2453c6acb64442f5d13ef9a607f16431295f3cfdb065243458bd371abe114c19229719a138e01a592622ada2c0cafa1761bf031b8d815cf92421434ccbc8668f6f124603e48fa2501cd7c8113aa506ba730a09b256b092ec9fdacab165a9509f1bf08f4973ac602a6965292f0b2b91fbb2a0f1b930372e072cb5e5780de5a948c2740fe60959a7297d2a0c0ea9969aa13931a0319d287a04b2c4e6064740880e6e1b090bd9097b56a6d2552a300769bae96ac9a3376004a5b94ba3cf1d9c80999aea42bab6fd4e940b9c42bee1a72ea10f74b407baaf23a76474009e7c9e66f46ab270b19a240243fa031d194843c82ffae29522d374c4192837a49f8eec8d96d99e3dd22bf11128008045fbf67bb5967d31cd7ad2510add1dccd7f9208247b790b6fc4fc8d6efe5c7e248b1a714a3e436bdcfa61ff499cfeabe095f05090c4c4ed8d06ed97610cae0e7aa092ac7b43e74d0b2f7070f28c323797de9e5a94fb1443d5e4e1fb2e81e0b654fbae7f3f5f239cf390a1203e927101a0d09337a3414bd676d80d7221997c0c08a960fad8eab3f86608941bf14f780c6d3b4867d64cc89f831938bde50e7305790579a22c06996fff28adf4eb28428780e7958af6b612d955a8bb75881e571e60693718ee2d8b82e7f2bf065b826c5bfdf0ffad505d593fa1a590ed033a17a64c1d3323158a4c01df1b2753b0e6dec2d77a84370d1787621696b15d9f2258d4865f0f5894cbc7376db53ce3fd8b224f7bb3c36d21701bae795a303a7e55a6b8dfbe6a0c25b33af5c9ea2047f9f6e0b50ad92c98212fdf8fac2ab397ca5c203099e4a584c194db042daf91b5abfc7667ba1d6227272dec2a99f5c02d83dc2c43c52be9de5ba15df45c363fb7c02c142a677a21b60106c9a6966a117eabb2c58a2d15548b9d3aeb8c3bf5f996638abaa4131a6e8cc025662e7ed4b9af9cf2fe6b17e67e39f4df966367f0907de041ba21c676c31448b2ff75185adabf132810b6f15bc3293561251028a624769a9d7f83a66d4e62fc5a3f744a24d6adee8c0576e17bf430f39ae5e574e80ca744e8ee069ffb62ff9ab5cb1d7d5127b2b8db0b23e9e1427ebbd535d980946f04806c60e08ad4c30a5ec03820c38bd135cdac90229540c952e8d7c0712d65c9790576e9ffb9f571f88cb724c7c653b5d78c3bb4836257ef690ca0915bb44326fbb7748e09f5a4367518ffd7443c20ceed14d4a3f6c9b737a1abc9c7ea6132bb33c44a4a29e1d437927c7153c5f13ee566144815aa6dfc18757640cfa44c24f80efe4b605454b25c0a2155b0d05cf0ea4b8109d7409b5598ac13ac74e398bcb4c42e1f6d439a2e57612f72ad02dec231d22bcb48f083cc394bcb68b50d3f392719a949a604741df958645836b7c3da45489a0d1cae1e53b3da96b8b5e27de9515a38582f698898eab59424afd4edaa679a6d370af4b209a48a327d2256725fd195cc1f8d38c4cdec4ff9eb181ad6be37a0a4e4789e6a2630e9e06006b9cbfea7482e7ab2a8b734108a47c15a05bc1e23ca47c0dedef558f007e68f8c3551c0af66dbff4a69895ef70e5f22a65be72846f21ece424cd78ce3738a0ed822c29463f49f9e40d736e89f3b9b05d33af737999fd16b1a792ffe3e3a6c17ea55efdb611347dd66c8d295d4d9884044cac895a0e49a15924276364d622e917c87d640fcec9d3e9ad50b6549b84863a6ca250b96538e514f86b367965455a63199fbfd6e7f9493f6a8bb1aec0404bbe3018e877f2907ed5300c7a6065302a5eb410af6c487085420642404e5fab8bd6be65bdc63aebde62fee334747f33a18eb6c7f54412b1ecfcd86a201374d177d0d2d42cf2943621ce05b88e598d1d1a9a66e08af3597d7177976c2b45c8a8604977d9daed622f1849be409a6f8b19c77eabd26ba713d6911a3f4ef17f2cb3a6e379941df81bde97b8eec6b5b48819a6d8a9e1c59a3c574f6bade5694e14074d556ca12593b3fe83a9b3022249b5def8b37b509fa4b3addbdef965e14406f50b343e83659538d677d13b206a3fff950f5223d7451892fe82d4d4a7f40ce4441579e7fe65d22fc148de8ac654135d11932247f2b988b443a6100dddbf3f4490f5a102de7286f2497c7fd3063e5592a1685dbf8d21801f3704fd0890c39dd98e19a2f9f297c46ec860cfc58519d80edb604ba4d220f021189dc5472aa08bace359d825a1ee6e5379661f147abf9b7e35a7b10d8c41032361e3ba418539b437734f9c7c144e512fa47a03780ade888c741d2aba41e77933e8aa0bf442f9817965c838997ae74f0c29d6d0677ba1a2eca2332fa3d8cad58db6abf8d892d0fe1e5913029f8084ae8ec2000480f4452a31d51f8e2f2011555ec29079b72e82ac3f68792ec382f077d2aff148475113239005362f77f318543c19a6d60d3b3e616591015c7292457b5c763548cc53fcc540f3596df303fbb7b8fc712a31026ea9b1e1e5d79de556b6e4c95871bb64907cb1ffe7c69ecc44777e6ee4eac3189705effcd06cf632b8ee0475253db81edfc8b576075a94978051306458e7f446540668fb9ec207a8d24abf962abe422b0292db007d4fe0c54301caa5d974ab3f4e52cc3ea119d4e226faf8ca5f1a7b8f6014834bd002cc708c6afbd686dfe338ad0658535776edfb75a8fd7dfe138bd4d0e6d93d4c5ea5bc7a0e612095c415948bb540aa5f53d1a10e0b55fac5e2b08936a6cf0fa695ff9a7caaf8cd733cec417425aee627563ba836858be4091efb17af0166490bf65d261ba61a970e8f68bbefe34d9bacb4295b8369c0c5537306fadfab8d8d2f0cff5b1bff0fb0715de156c46803acc55ddc13df9f4b8a6ae40ba67971249bfa2f67daa39e8c519dffbf5dd3912b36a3d32d145a51ac669070ae0e853038961c84174d584268b3df246b3dbc3516c3678691c71670f06b3cf4000d60055849f1dcac52a37373bc630dcba69bed47fd0e8b2b2fad1e439a3c20807cd58c7bf81f46c581d877e26ae3de9eff21b89068c722f07d159f23bc735929f9e74347936c28a5767f08c8aaed8bbc1f4c9677830ce05a92c6281a193010aaac8f99d2c14b41ddf23aa2c576a9d65d1526b9fc8d7f9e39d61fe7f9431274fa784498571372e3c29bfc7e6c810754dfacd8cf890296d254d604202101454935a1698f4660dbf4fe97c460980d693626489c660f5e680e1914ee29d9da693029e68054e94fccee04db0a9a11891b816099bc3806905416f1a597ac1663653413a4eb2451472cea4bfee4568480f64fae077acaceec2418eb917772e5939c109b519fb684ffe1f3c97c014a85f6ba33d6d5e8a65d2ca22c6cf53b49c72e56b6205ab668b31dd2bce1a2efa7d37aed540ef97b3dbb4f7c696a900f5be87e205e297d386eec031b59d3565e7ff6f5018ef392a91636432fd460af2d255f4d1143e7ccebb32e8eaa9ea9c12e4918f2327f1a09576abe0a2a1b9365f8c5d1bf90be6d725b264ada9a137ad18bb40540c26ac7e8f62ba6eeebd3e9ff61ea8251ddd418cf3eb1929f2aa2670dd9924b3cead49dbea233469762af6ebd834c2d677d2bbb76ce174a3e663c472bf946da0ecccc719e467d0de5780de7a9d578ee38d21f563789304e2e6b72b8c772593babebad0c2c4493f1723ccc47df5730a37ddd867c825564da71759f21e8f9f752a2263779e9481345fe7697e4e0e108c582cdb43ab4a4d432a5d2a574e74a491114d84325ea02981ba7e2e9e0ab4f06ce5d7494059038e9dd6e8c2b740023494593c8ef5428510560d46f0a82641b4c8dbce2c2f49660f6ff1f1c0786c716d09cf8a1f307c0a889601d8ecfeeda0b40b7678fc9bb50beaa4c60e4e6359afebf21ae802804e98850dc7ae66f3708061114595e59ca21a20f78f74b934bd0faac298d36de0377f23fb2b7c4c0b3d9748d1f51d7ba1bc72190ea424b7ac37c32a016beab996e891d4eb05584fa30ca2e85f1b13c76816180e50d0122270c6b74c9effcbe9636d248efa2af7e2715c4e8c585d14f9a0ac8c010a344c4e987fb113d52985c1f3f4c1cfe83d03ddbce4f3d82e9176c0c7feb7866bded7a848911fedb0bdba56d481e71c7d00adf34eb78467110496225695b081edd071d85e5e38ae9651e362fb660bdf2e4af4e66fa6f5b073adf81695075e18c50491b2ebc634d5c4d27e8b66c5e6d728544fa636312b5e3b2acd22dc94908ae6d73c3e2404201bcca9de56685290f7edf639203d1da61a8ca10d87b6da9853beae84e6755e741c5a5ed68888c980365ff1d292fd797ab9a81b3713269341b03f3bf8f20debfff7e2cf9345f596c3e0b9ee1aec9b81425ed7b3b0105bbd2a073f8cb2ba4d8af1b1b35b1914db015c4712c9ed87dfb21519e5eaffe2bd1511a53ef99964b378d629aee482c5ffbb3fcdcd6cad0c6428f79a4f1087a984e415945968319ecfe47cf110f87c6ad516ae0289833b933d874c0569c8d0ec487ff01bcc63acb73c24e2c106b73ac324347b76e0577b429bc7464e19a140bd691c022f5eb22cf90b0036f3e701fb14d08450769c476f53d308d52db0956afb639c0d737b739a3ec53fef2f416c219d28a6b0736ed8010e0806359b7b637d6e9aa88b1d2979d5e2335dd99b9b275eb86b627e58c77b53a46f74639f49bcd85ea2670bb8f9b0820333f9d487bf76ecc353cc4781075a52becf94097657224d7cc9988b9a62227938cd547247bfab0cfcc1efaae62625e235b03809f48bdcdc8d7de201b5bdddd056007b0953c65e98ab176b63a9ce1fe2eba66b5745a579cd5345411ba1b7f572539decbed453eddb5e9d4a7b6ef9f4216cba966e0f34fdac47dcc925a658a437bb9ed74e5f03b36e358e17e6c5192592f35febbc17a8f7e849248ca8b4a7de329873e91762b9d14eff8f2462d02695b2b4a4b1aa7092cad0b83590bd46c4d6bd11a69432d32182ca0f4bcb9be69b1fab9efe189909c40a572c98395cc19ef0fe5a8af637b9fb221d167cf90799f9075d89b5840ede099eeacb2042a011e2e78c8f06578655528accdc474756d1318fe1c4940089571daea90a872ced111d67eb3c5cdb680cf2fbbeae471e8ae9c143eda5be8634528b9054aa554cb4b297cb06d84f72d97b45a2e96a2c3d400e599303de0dac0d1ab33a25d8866d882d73e6f3c37c2af7b7d049d78bed703e5b01bd9ef6dec6f0d2cd17b495d16fec3369e13eca227c92dd5b8b250f091296d493ce157ef7184dbd0c330db42de07a995d05824c1d49e1a1931b69552fc9fba857cb5a9a4040f93872b72bec2fea8469687d1ce89e8d0fd81fcaba5079e38e2b8c926a8a2a591816c13a5d4a4a9a3d42ac291c8528cbd0c67f406c151e78148be860c3b6658b3afe2f070832ed65226a5433233cf36a5c87962333eeb7035fe53df42675d16dbc553d60372570720930de59b55354ad93e9f2f77b5ee600fad014a60a1834f334c21fafc9ddd79978c463357f06a36c1fdd8da66d913815230ff58f5c0a461a8d9f2abf518335ac2fecfbe996670604b75207f8a52d1bcac5a3e0afcdd8f68977e9bcd79d953c1a8e17d2ea7583a5f84589f1be0f88505813f3b2ecc8e838e0e092992d68452c61c909f813f2d2c7a74f4a61643e2064a69b1f3ca07073c48427041d505a4d5f133d978dd44c156630e693dbc4974b1853133fcd89da39139f543338b8894d58dc35a5c2315d1d345b1ef1c91ab90c7929f9f999ac4a5f8b19166e170707e5a88f1654636ff22c522a644a304091053ee51b49a0e4091c1ff8733d977bae9b96d194f66077fd24fc4324a049539d1de59eea2902ea9f43d4d8f340d6d0c9c50b202f4b4462b0878f26de1caa26b61eec79796cb5af1fb7d883fd733400bdcf3424fab7afe79ede32343436a9687f1fc3dc4d7c9f56d0079840484dd52f2e479001322f6015096735c6de41c6db8c92afe8634487ab9df33ad288893f6f28907a7aa4624b42458fe5f4bf31335acff8d807f906c69dc21495290a1e27624b8663c96c23d8b2fd1b4a399af5b3219292d0d64af7b4f6ebdc2ddde907176bd8162159e071f2616e70e77d63a99767ee0b350b509673141576b81f1b774d18f20eb496ee3f3748a53c1289a9ea6a1e7ae1c1285ff76cc4ec890631924ffbb213ad2d39611cb6d05a88a67087ebf5a110f623400c3b15f7e421941c1bf84976ab106b357036ec4496a95ca8095bf4e54a5ce2ee447a28debea8279f6258e133e2f32be379e5b10e13df8f0c8274edf1228340446e2832641581ce7d9efe22843f5d0716aad9209fa4af45722c36c18c3c36d6c09bd48632ba5d2f181399137ed42d71fd7871b7088856f6ae9b8e73ccb048d6117502203c78752eefce83fcee6beb6f16f4a7ede3c217137ef5be0caeef5db99f7a794b5199b70f809e8f6e6de136cd116bdd9fbc0c56ab0788047d106d0d69b8a4b9955609094076a122a10a53afe6533169a2d8b6091b41ec6a653f60bf44d58aaaade09d360e8a7717c4f37532434aa3b474caf022ea3d2f58298e505a2ff0ac3ac5adf6a5f8f2e36fabc0a81907c7197707e9f3cf88111407bd519f4aa77b5446669c02ee263367447fb04e52a47ff4492887f5175e22342f6e2b7df2a891df9dcec023bedf87191b23f3d9b9aa869d42ec8ee132b84693baec4a624e32675b24c14cd1f2f9acc2b95f6d02d25383c8dfbd5907e182c14425f55201e69fa469295bf73942990036062e3c957c3f0af3a5baf78aedc353d9b43b51975b9fdb16c05e5af18dcc85932abd37293b166c9c1171d35e689ffa3036bbe7bd015dddcdf3e1449c77ba1c119d8f898403aad352fc7d860eeda454d4a28250285e0bbce7e514236aee858351f743372df93c9d2c18ddb5e5cd27bff858b9cc61dceca73e306745b1579d8dbf06611dc1f73aba3767ac9fe4b69c8e0460aab96eb052ea5d4f2a0b08a73c4537e1858c5297c7f0d97f5227d4fbe82210dff9e064c2a39094139e8bf63e7496ab0fdb0614dbf37bc3d32dbd007e284f6df53131f39d3fe0619aab1577c5019d5514d545ad96836ece72b0352caa2246e048f510b466832d4c0b650d5de13949b6be05b21260693d9fe828a3a4b8aa0eff473d5783b93c81bb5925c225d8dec6d431730db08b7080efdb11903c98790005bfc26654f04d75e447daae661f925dcc374db21f9441da7eec869fe101b06c70f840b1d97c5dcb90cea1237f3c175025f07b9965d56bc0509feb90973997c65b9e1d046441c807169ee8913710f72ad50c7c6c340545fe5c3db5b21544f71797aad4abab334916db1bf6d4c25945ea86a5004ba05afd9a9e01545ffd8dcadc20371053f3a62b69897ac335b579fa4949c0e6d7016815feeb81b9b31d10caedaeacff02ad0b0ff9ccc57998ef7f0b88499692eb90f059aa3cb427cff5699f68c257068c427bf84fc7045b846a4a136b02742933e3aa597c80553066ebdc66b69f092ac880e5edda2b377408cabdb00ae89cc00781a35a4f69d97d7940f218ab031e14ba2b242003640e7689572bd21d9a56c4b701adf70817fffe4eb5b1e67f2730163c8ac13866d98474bf15c38ac0f1daed13cf762a2567ebea78a631f2aaccd22140dc59bbd0a51bd6c2318749a603b64da6df6839a9d731b29554d91fecb982c2b1b1b1f2d755d28934a98211ca5ed5c319ddd4139442541e04dd5b7b7e9a918d678c52ec4304a9e37ee8a5cbaf0744ecfb16e4313502a1ea99feea9cdea6f3c167a413ade87a2a73e646b05219a0af4b9882cfe45acb0b4e2cafe21f815306ac86cebc1eb4681cf84343e32b460b4d997ba9eb9af04e3759a1de754bc45ef9500176c8ff8193fd5c4665632092e59ebec5ffce971f7f21bda1ebf2c10f12c32e702210bfb897353597b5d9727f3a07114b1836b8baa58758549b7c97ffd6b5d51b0fc44803cce254ec8047ab545a8cb59a0ad87053fd7478a4159779fdc51dacd94f5058cee8ced9d781b80b0abee8320bb8cf6b1b31f69fb1c4a11bf584291581f3646bf227f584369d036884992d2d246dace710df4bc705faffee83c88ffac3f66fd12a5e8f21d4a38c56023718784465a09fab6b27c36572762e92c0d0c7dadcf9825937150138712acb1255c52168fa0c0f154d60b7e9ceb1fe9a71573bd0bf7af838ede490a30aafe44ae7e9bc07f7d75e6337b3982a56153f553e265f78374a884758f621166816f44b9e943269c59b703a3c478276e384637b9c15929948d1b584bcd3e4a24e0171d7b824849c3677b016b44f1633ba82f64726bc206478319321b73cbb781efd81365f968539f34065c25161e41b5dd9e34f0a73ed8627d5e0cdb754c4177bf7245ca447ff5c31b86b592e39a448a3266ccba25b7c24e5e5e766d0acc66fede604e6776ac2e66d9b5702ae55ea712c4f4b89c14623ecd4f673a67f4974fa50b06d278386ef9277828c7e329a0aea75d7fade691dec942e75b3cb70b1c630bd7850130fdb733600d9d72254685015b0e522dbed2f438600a0382b7f714c7b4c9dee50001893fb6831954503466dcefc335c5234c97289447cc9f21caac0aede051b5dcef27e07213b6c1991d76102ebabf4739c30857f59ca1d0216f0471c24107df2913661ce4bfb49149ca01bac5f4032de6ad8dfb12839f736760918f7dc2d344e480e8174cc25c296ca7621fcecd3c98bacc2821a68a6d034dc49cacdcb41a1cfb40667664ae8200f52d818853bd687c1c1939a48e6e20721b8a94dbc94d5ff254519d5ea76e0ad40f911e3637b6be6073f68838cccc7f9fb78dfcb37f1611daf729a50a99045f6291babcc9ab13bbb35992b26a7b0ac9d039c86badcb531687c96079501568c19720260fc407a99392d99123c7b24ea8899491382a4db47bdd0c966afc27e3ca0b7da4c584589bab2f38afa0eb2d9d4c3ce5ce998b54b8ebc4b991fe92054b054b1a75541a21fc08016b43da57b3e01684bd1dd22c97ca6ee577c3fa81e7725bc6b7dc474be998aa783f423e4d7b5d5f0238d1efcf7e90a4fbdcde181df5ba6551af41d782ddd446860f54aafb0dc2685dfa87365e4fe22fe308d31afb8ebc9c7642cf6f37618361ecdf63ffdf9c846214b73dd140a72b32fd39df93e811f21f2d04906b2557b4d5af51cd67061436eb84049d8f9ea2702bd76b493b6ccfe42da0c283af0aa668dc812a9e35184f68c686a864d04e7814082523f2074bb2a2e4c61cf6e7e24fc1d087a8fbab83ea543eecdb56b4a0cb8fb60dd7ea8ecb044ef20d4e753fa1b932b972502f1be3f76b2769d83172917146c59d7f2907f5a0bfabeec2be55a6aded62ce1a3fee9f1e8dae5a5a7160ffa3e0757eb28066471a94794c7c1303fc579ee21fdbef070a51bf8245396f6ffe74c1ff0d413d23871873c844348db79e765b5c873f87e96a4d617833f91967cd15f939dff8f2bcb613c275c45ae1b570758c3fdb275121fcbbd261115a46ed4ecce60e85e97921d45c3c89d1151e4a263846eab7d9c478895b9ad011b8fc530365872b3d7707cf5f60a4c58ca5133efcdea45a27e9522fdb28835c1c818c420bc73dfd63d47471b34a87ab4d52dcb344a282021baaba5758084cf354518ab9332c733451ba776d8a6efcf3f65c7cd05bbdebf6364d64765356cf2b446a49c4cec512f3d6dae6f357389d6838425d33ce9a00fc2c1a3c121a6006c9467f8b35f8aa2f84bb6116c981a6e58b6639b675cff15cf6aa0d7defdfa91c8937ba910404dbef8a80c0d37aa3df0af1461b96a453981ff4990a8e1d7cfd4c4c60453f11579df195440a5bd35b630ca556da3d6b2468ad1b6686a2ad1e588271f2c5a6796f200036a8de7e52940ec842dfc5ef3336fc9b26c47b0173efeeaf9d56a207a1c0e07711ac55be6b747875e12c201f71625fefd6502d1e8cb69432bfbc4a7ede5c2b7467d262b498e6d9bf165fec9de75428bdc03aa9acec20077eb071506d0d9b34d0bbce81c599971c86a9d643e9b8ea4d3f268b55040f11099602bad0a8bc6956524c67b90992cfd6b899687f170a7abfab4bafaef1471c1a65bb95d683528dbd7fe92f0aa591e5c627a66bb0039d1ea7513b3e95a63c6a83fe1e7074d8b57574d14f05811435c81ba04544bb9d5e69eb21394f678145098ae5c4b54b4c0b8bdc9ebd3c43a1304dada34f62b9bb0f9f8836ea0a979e82429b40aeedced5d3491bafd1e5e4b83f1111260e5ef1850cb32cdc82e8b2f36f993b34f1e8b8dac09afd93a71f667837012db7fd406897bd1d97e409927f7012d404e1cd5e9cdc0d91e27e042aaea4ac711a1a64ccd51d621d0a8d9af94c78421ecf92f2fa7c7aaaa42a748c7c954851f809ed681ff1a4fbe3c595616bf7bff620e810fc1c6e0bfcae8128ea25ad8c9a2ed01ebed0953e38fb24ecdb9ac4dcf4e86e696df5efef425c9a0763091640a0c82145fdbf571cd9fda26b9f863f52931668862ef5309eff51d9372da75fed7b08da0f561f754f7b9bea72894c2ea9bae0b48d8b49f723a8b8fcba23f8b69a9590bafae22d68239dba195eba4bafd0ae9a8821ded55c4d8cb25c4580ea967b4b6bd46061584d9594ec6367531d6245dc3d5faacf7ec7065985a27384a6a568d5383e7b23bff7c789000c20bcdeb9e198b357f386d2570996fae4ae96d9ef6beaa1c738bcd4dff37d1316f5acc9284564c86b38a4a55ba123629ea6e9967fd4659a7cb483226b47c28767107462747514529f96543aff93c0ca25af3f33b7c66fce876d8a5fd6f5eb981cff565bc4a492602e9dece5d4742bab6fe69f2d69d846b1e69d01411bdfe8ce0634a853b02e73785b26695823efaba2a1d562e0c34cd3104b61540487f1fa4e95e9e99e6b0d9bceddabaebcd9d669ff69b93d732ee3034342d37c52c5b036748eb20412222a0e624c0e4b1d53bf4c25344b261e469efd1e0045050a573b1c7672e3e62d9549555c1ed152d7e5fd3714cd11a3ada179be5e74b15ab1d4dafb098c6b0ea5372f56bbb29a522a43b0e65a2ca7dffcf2144eb8a157b347838d6e8d67c4fd5e870e3e1a85ac45ac5f175c33cd987184118bdd474efc96ca2c5046fd5d127dbc9d87f9b91086371ede93e7cb695edae1e53d71c5acb156602bb99fe17236b1b4d676ac322b84a091b6d4bb67b000ef49432fe0190307ed15b61d6d6327499559f6a60007a086aed12165e0586550473f14570b5951803af5ed8da70577bdbdc978c0b4000755cf4ec9139eaa7a33664f55285ee60277e2cf3d4204520daa0cf4e7c600a5912bf0ed1062fcd6010b20a20666ccef073c729c0e7af52eb1e228a2702f27d503e0f50a39cf8e4ed5aee0a45944193e4f768d07530f5ba58c6c8fba3da2ea5965888f1d1ee2ffebcf55e94a8fb436ea1d6740fd5a9691cd3626b9fd8f35f3ac0132d3aa28647dd0d3045dcc16ca26a41712e0a717f05fd1cf0b5a673e30892fde0012facfe8b4658e84490ffa7cd6d5fd5591540a6e97889b723e2521e21859165abd709c2026971e882654ab3cc5acee3559b7124a8f59383db21e6e948cfe10a33d5775e01ab40d30329d7e64911b47550e853c4854d6191b309fbe3eae09543c0eeade50c87729364cb3453f73a96d9c01e9fef98d79faad388889b39872ede3c97a46899bb93d207c12233da0699977df04c15023c95e190c95da13d6c6b9e79d51429d2b1090909b3b9b4716540ce6d462d5e1c01ca05c4f922885397165eb116a939a7526ef43311db94a76be386b05a4f94ab61e1736e0ac2022e652d1fcb9053b4138125c048a4c682a5c4683ca61510110a2f758f34dc612113137e5208d93664753c97766775c06fce02f0229b462fcc7da9bc0ff6045a21b768a44ee15ade48e1de2b1dcc9b621abe5388a2fbb17ff9db1b5e90a992ec36ddcafd4cb4082df884c2889163ca0c4925f81409497ab1c9088d21f4fd4a927b8bc54c0c41511e51100e37fd2630d5b2acaa9768a01074c4e5030bd74b59c55452be079caae054bef93202f0edf98955a6d3cadb5e656e37d01573796dc9705837568efdf09b56565b0b8021b7f0bef61a3d63bd7e9adc08c30783e394fe90fe55db82bcc2603dec240f6f5538498e5c1eb61fae6d7467bf54c22d771f51af0a0c64b139b623b6e3ae22b33bd961dbe8c0de1f1bdc6a6454205744192cd726f12695d9059828bccfae5096db6354249879fe67125a4faea64193f6b3d9824c18ffa779c7681766cd34793929dda1f9cc7e5ba1cfaba24651d84de96a163dc0f76cfdab54a522a01e8c248f75f9211f4597e30c6d617eea3cc3173372853cbc4ffd17d43095e1cd924a14aa329d920216964a44bd992bfa0f610c0dc4547a2f80683d8f0c9bec75b07f92a03f5bbc0fa605e86173b3112e4563e2d861086b54a02c9e4b492c4db1f7fa2ad5f976f1211bdc5b7cf92c2dbaf6ec8ae3dae565632a4d34eb971d23c631c352ef51162ff7747fb8a5e19c8ac9c6509b1c9f77ed3ec8c50c321c756c454ff573ee59017c1957f68cd54e04f22e45f6673e109b20dc497628c8613dc5266615c1ccba2791092128a29f7f3a2444c4afdee4bfad3154567a3c51fe440a46acff0ca154505d3ae2c97646a3a0d855f785fa3f4bc0ebc7987487e9f22e67e59e9104cbf062a1e1a8287219670526ac7349493a6e251be2d080b4d95bfd1b6ad1599ffe43f9e5ee1c576bd4f873496c3f0b0cdb2e09c41b90a71966164e5d446f589531d3b08537b8906135bf94b70f5150263fe20f42a66beffc4ea9b67e0d033fe8c5560eda2e75fb3ae857d7364b932f9aceaf78d018963fd779d72c90c0a8cbf08bdd02a3760a1fb8e66ae830d681180a4eb9f10bf29696f79a4c71bd21436a1db3a6c11f50e601a6b2def5ec9584e9a0eab5523a77527e76b59a2ea628a296d63dcd0926b4d104ef2a5830ebbb99f9a8c173c1674d42159f6d1b468876297723133e0ae7d1c9e9b8f0b7648f17998070a3ecfe1b5888cf13ada2b0c9322b31be0397d84f06c72c7d0e25ac19c7e405b232e4bccdd047bc1228159a05c4294fe6ee9b547ae6d9a4591314f206ba26f42603f38384ce497bcce7a48e729779442cdbb760e570da4e1654f31e20e127d6294744ec4bd6950990b3fde2e5533bf9f638498eb338e61da2dc7179b933538fadc3347cdeebd12acac67ef257199357edc719985c277ac8d5c3ae8fbf9cac583fc8410afacd35134b5fa79871740e9592380ff44f4de90c245db8934ab44293b3fa616989f08efd0764e10c35c205151fd72c4a12668f57dab3aa736277b0c82b20b993067fe09be6e75b7ca19fd278e630ef08514f08d5a45d04d18363be080c6aee7708907dd382f639cd2fc28672fc918972176f866a8ed9829c8f5c14a325e4a126121d6af6cebb8e089f67cc78860aeba073c526b499b58c6071d8083134345a04dccc65fcb1f4081d8dae1066b3d8c1696896fc2c0cd116c9c37eab27664ab013a7b663a63c812e0dd91113acd811b9a4e6e8c8926c499f370f2ac19f627db97913912817a093e1ebad888cee6a241fb7923ecb44395ea8a754f3c7fc12e4dd53b19ad2425cb5769e2db9df155afbbd6a796e8ffb39de45b4a9172633b4ae76e60742586b810a57fa45aa86ad80b81778e876d18feae1a4a5c7af7b3a347ecf7eb7597910ffcf818cd7f6c579a562b93d86dcd97485fe14966bf7fbd50caa725b1345fbb850a5ce1ca69e3a04fcedc71034853ae0d10a15c0e4b7853d7f1c77b792947d79194672d0f04b95eb09dee51336cbd844ed6cfff96c3e6689672f6857f1351a2c2349af3e9e5b788a39c2f42ddc41dc380e44f96d66eeb0e555ea63058d40705cfc81b40668cb047125736300713eede5876180e2daa7ff98883ce1d9c045230e39566c104ffa008187f0dd8d621b90327ee29ef25dd96f99732f629f3d20da11ce7827e7fc0c5b72556542ed0ee5c20630b9a58a1031667ddf043a55966c08a1a6e42c6e58b8bbbf2d4786fd79281a3981c6a0b4cc0febf63de4f31b804c1eedbf4602cafc075bd09ccaea91bc7d365322e4c814f24d0889208315e9f5c36d0402ff6c178a47bedade2cb203b485c7305d999e7a30327f57359c920b2802c08955b06814107a4eb97a34669713802dc187ec67842caddf10dd5beca5bf0a85535775bcd4a0faa0684c396662de82cc97108cc61e480da0a0bdf51160d0c54a783aea7b51b1ada602a76f8c3c708fdb7b49ed2e0706a9631d022234b15a3a77259544a2d6dd6f218445f8648415444addfcd0439309e1014c337ddefe0e931babcf8c3ee61d20bdc21fff3587370d911f27cdb92e141d844dc321638bc1f42969c5dd5498482c8a8c0497224b99362bf05085d0f96e964a5e88f7dd0a1951542b6d92b142e13b30e8459a1fb629429ba789f7556c5b555a49825a5abbf34cdc91e5eb77b7aabdbd86caa3dcb17378b4ed6c975a5f45cd18b4b17b0675b60a3d183df153da41d513f0e2b530a13992a60718161462a72c17e5c465ed2d8648b26f4cdb49b528df7a840624477cfeb1d564b86007aa98561d3f4bc219b3abb683a88ce0ea3fe37b62a36970416916d3ecdca0d8572fe0b8751b188aa69c3e857282d461eada706f49891de7c8b4b4b9eff90889018f644315798d1a77a5cab4b896546b9a3dfe885e8fc8e08bab97d3700c1842d29ea62d24ebefe0bd7f9c320141f33b62ad037d5ec6758794865322e535859c2cad4d06100f7bb597d82b03269220a21284b237516cfdc4afe9626af8c1e56b56e0beb498c7994209fa89cba99a21bd8a2c67493d0eac8c6d8cb255887f2afc7b5c882fb8ec32ba818ab8f488a7ea29cfb84d280711e2e1bff535502816bd4850be6bbebd7a00d4ffb308d1bd0c72b1e2687c87e1de81eec372f128b214ab4a000c8e9101d4ccd272deaa45719c8e758468496ca8d2ad97b2d36b3aa0da265c4c65060b0831931748e587302a21c7e228b96d94dc0327f3f1e930555517f28b7cad4c9f77da828772c2b47a3948b8cc34065f89d40e74fe62e29a0298852e1f0b9d1686bd729f25ff9206690e28d0c7a0c9da468593e354400882c94978fde374ec514a82d9b0d43b9915ba0f3356e6bd0977c9c906a160a2ed0e10a71c1efc24203acbbd86079f8bb615870a1231eb5890acc7b5b4093b373b7a8e3b0a4b4e79d8b2ab9d0b96af8c0cde1cfd27aef302b2d3cc2fc0cd11d6812ad31b0ee7d5fe5cc6633e7ba3d2f338878f8ac34212de6a03528e7aabf921a83cdc538493412affd7e3d4667adde5f6d39b785557dbcb6d6d60559e8351ede9d7eaaa2980b036b6f4059a9f124e3edfd342fc7e5068c043f18d80a9e1f88fbf6fbb39f96ceb8641072f7e4f52c64f567e50615bd4162f1daec73bb848dced2a46d63b332f2bcd9f4d297f3a367d34d91408fea08e6bf091ff2943a17d92b089cd7d622669e72fb481c7dbc511678817659eb9b106b1be16d66fb96d6f24386fb0ed1b9da350c536888fe2c68f71dc1df05d120dcd5ec08d237d0faca219fdff17b925d396868c573f6b2965115a62d084f73ceef121063a41bdf77929d8bcbad6efb296f84d12457606b9c7ad4cf2e476796aa9325ca2e40abfe38cf72638c8d6208abde8bf4162ae53d1b51d139529cae37b1a98e7325eb5eadf5526f6e716d4875a9e0eb5f28b1126a5b903225d40ca1754384e58d50eeed8c5eebe1fa8b3ee404f0c7bb2fcbad5db02959d6f4e04aca0e29ef1adb2bf84b71ff7c9e23b2eb5a5030a439e1925b6fe3613d9110f03daca440afd19faa95775dcba0c8310a0609ad174f8020cbec082f95f0f61dd258a094228a342d2cb2bcda5a6f7d54d9ba515e982916afa48200d39064f8c5c55a4e6a3b3d9144b8c25de78266db08329a09a4496c714442b3356af857d4fd2d960c17193e61fc1ccbacaf07bb2bac20658c01dbcbc0b182d443c7ce65f724281dbdcd1c8778fcb060e1d9d3553bf9960fc10e626516675361ce88471b9b8b10817f4af84cb2921e0ff991418594276f51e43ddd5d2c0a596a421ce2982eace2348b5b6c62d3f7bbe3c9f8f066eb7885fcca92b2e80be4e6d6e2968529b6d4c77f745402c998f63485ca07cbd97eff14e832da6a716facbdb28c5180dcbc31c62cd2395195e07c8d05c1a33d24b9297a462e67da8e6e2a1a0f79ee8bdc2a6e4dcd31594cea3a83f4173d99800a3d3c5a9353a74d8f0c576d8a9046522a1e763fddaaa9274f2156cbdc7ea74024001bb32388036a7d3780bd617c9f7be47216d341121999fe53f6b03f008710ba6f45c9c521875dd78eee11ec4a37621f5597ae7bece15ffb6c59dfcd00cdad4b62ec0afa624273ba741efd4af653398cbfb53ca75ed77bc6f280a35559ed58254b4a8af9ab27b7f96c8a434424387e05b1232116139cfd0787119a1e49ee3a001f57f2956df36a873d6bfcc76aad176b902cd2f3f0605498af20a9c56fa0fc79110ad9e4e29a231bbd81ef4b1631fb6d1e64e9f3fdac428609733e7d6825d074fe51fb2bc73d5c9c6f004116c837952c1ce228380685c536f2128afa626babeba26b6642db740a28eb8895d4bb99b2f7b4284a059ec481bcc01c12f4815706f5bc26d593f1464343687e8672e7cac1f3ff62dad89231b72bf770e64e7a7f09861456a4da6ab803945c5e8a2929fd9674af2fc17ee417648ee2e76ed3675e8e62d4294c07cdd1d82b1b7b42081513259ad195b450a179f683f6e7e805f7f2e0dda91065ae4e76fcf55d05d8dbae7062a0d65e7678e6dabec47e3034f6592c5951ce8aa36ac6744328ded73924443f7351da4374e317969558589ba6b29aff96a68f26626ec531e6a7643c7879516a75ffc5d128fb5506b6670510b72447cde351ff29d8069b2ef1de7d4acee3622082a9d3cf24fb3fb68f137e96a170920eec045d33bef85fe42755a2546999f232ae44fcbb7284e9b718d00b8342fc7a9d71c751e5d2420a07f11d35f313964baa14cb4e1c23ed00812e25d1de4c2bb841400e56fc5459ed850f5fe33c854293d9a5407208c68d3b7e35dd5e176ea0ca567904dd2b8890797436f08d6e8135eaf0045eb93dc7edda81666dd9ad67ed1862d9d78af42b5d04cce37122cf7c72688c1d68f1b830890bb458ebb02a991766bd595207871c52e9da57629378090f620553aca1febc1cab68f414abfe4353d72280ea2ac8368cc3c2f75084fa1b86d49ac8b6be7331133629bbdd3ab08ce76aad4f7d09c2aba8018fefef3a6581ff1a17707967998eb54d24422565335b10affc11cfeb1ff99902895b2e5bbd8e5be5f0091459e998134eddfb3a4422e767382444c245f763ae117a5d0078e914f523ae5dfeb0eeffa2a84a0561d2df0329982acbaffdb0206238065970261374be60522b8adbe2baaa052dce8f7a2b056c4ecf38cfd50c8ce86d9833f529112d9658bf513269f4fe0aca85a4aef043445ae05fece441d3533a552fc83358b46e2b329973f43a6efd53a8c2f630571581ede745b03ccbac9b843060fc617b92fef0985b3cd92a2cb4a145bbc4572e7463b8e968b45e949bce61e14b78570c4dff87516933baa07f9fc45aec01e7f69dcb43845455d302b11426ef143f2ae0611c4478c5a4b2b5aa91f81945e147befabc54f3f8668a4f6aad5f3144349ab9495ba9764b004eb4c9514470cc620fb13225c9683c633df644007764d9e6a0cdcbabf75a9058f59a6836d866363ea1d46e3950160778f52a2a23be5ed32c73c6c5c0dbfbb0aa5d2f6410704e818f748d2963a24c3164f1d6ab5ce3203c1d9545e3ca13c0017a5cc0297be31f5f78ee5d473d8fa6691746a5bbb215824d5ec28ee3f27cb09c91b19d1908a076ce0239ae68511ef8320fc33d0606273fed6f24b9f6c00637922647967f2b3eac9fc27e4956f134abd68b3f29f8636ef9901d1db8f0dabc3727728dc42c30e25c54693ebe6dbd57b20b1f931119da1efb26e1f244ca357d6419777e74eb31f2469307059aad6913b68e0b1066d3287ad3459c60f2aa2fcfa30dcecbe85be4f9b708604102da9c3b7b85d8d1d4d54fc5d0ec989bb010d4e6ab6c9f3bc1c10f409a8688da6629179660f9b9ec844c712d939c381c13516a2c09b073f115c48a3d4c0a0bc3f998bb3a7a5069eec333758500eb46ac022ec6cc33d78f552c7f4f6bc876244e679cf934b478c8f9f8cc2dafb0c98394edd7e41fe034ce1dbe86ec67f37ea60cbae03a1cfa1f5cc8c6f6380c6a27601d788c81c02677f6e003b52c8c2e4c69d89e09e49d91baa079e55038c0dda274b5bf4c10cff0703c10c95ff4d4cb4f37b40d7612fa9346d19080ecb639fe30f9898437fc78e2478a5d54c0b17c8c40980af5d7341fcb1ca9d535ddedf89acbf0ec551ee5672faddf33a34574a8758c2da49aaf94fb1787faf5602d130e87361dbd309d5b7fc2cbe57be8026678ed071f2e585cb173d673071872341bd922b6c18355ff5f90a8628ce2bfc2183e660fbd4e51c5cd6257f54731df600089f4c695ed87b0c0be08b5fabcf025347ad40b30eb20d05946c322853de7d42e535dd7d4b1e5490184aab3461a437f538481d9cc7f2c297714a293e38f658b5b402f868bf177f30657bc7d4487f7697fc9b71e3d2ac2f6a44851ecbd5bc4a76222d15c8fccd593b35dc18662d220eba7899e1776aaf7be9cfc8c10cc2dad8bf472f0e91b633bf5a3c27fe1a3d24a70f84937aa17e2fe8145c0525af4d722adbcec83404601bf74cf2f26c03f3168356d6237af8b5b2c44268c1aa9c89c0243d19336eaf8a49f790af35c68ef9dd4ab73d25159d64c4890635fc8f41793cfdbb8d476da62f4e51f08c8ca23cafc92b42a8b7075352615072b44d898289b880b9f081b00e1ef95858dd853fd9b641e0a8af73c3077ef300a9b4da2c5d520a60a81757bf2f03927690ee27bacdface8bf3e5dbfa7546b7ea5d5353f836dde5b26f0dfaf057c8c17da49a1d54b37f05b9c80e191ed640848d3a722ce22da07e21407a68e6d0619ba5d27dabd07e3415a54e88291d245c7a32c56c7149fc461ac0f07decf41af66f6a5dc1625a99c2e804022d0445e8e141cfb2d164c4aac91758894e0869ef43a9dd7cd42cf36c899c45ba69aa02e1d929d8bc2d9a7b2bcfd1898bb8640d3faae4b664c79058fb224a4f6fd0af158fb3927537968a38c1f1be5290371ef29fda2e7baf1b97a9f18062452756d8b9f27b5c9c033ca334ca3a5b9f929e7ad40cfaa7c205fe7b297dcbe5200e3b1935ea0c71935efed3d7e7afbf19099d5a8832dc721e1f75cbbfbd3ed88b3cc39166fd75b15b5a7e7ec7ab596a1ce2a656e04fe742bdfe490bf6f15ef1e95034905fe7e2302c7ba760846473f3ee43a802572b510c59ae26268874344511cc219bccd6d9d939dd94f9c12e02f9f3fbe431ad73be9b662156e6ea749f3884e32ee005a50b82c5948ab45b7ccefb9725004e96b2dbb83d3dbafe12d8732f27feb87faa05952bc9abc8246a0ffc5b524131c6758afec1eb7c96318189d92b3d97418cff69b736f7f18b963c5d65f74f860d444bbaa0400a69cad9d8d3aa3e67891645a0031b5de8dae3f199942204028c33112fac93568896b06b14460f47574eba8ce7ee160e30cf655f89c1e45e2b2def4a37f0e79592690483ce8a56bffa7877c8f6c0c2dfa845eb9d5402f4cdefd1bad53daf3337fe6d57907cdd022e5463f968ad41bb5e6fcb34833b01c7d845c1b6f26c7c27f3512c7d78242f8ad8dbc47603f4e1ab616797802bad9c27d608b72c86ab75d060732284c99f36194035ace9dd020d33993d8630073917043444c260814f84a8abe2476db1f9cfd64bee482f5e60fbefeaa232f65a6e74165adc213a26269bc03f9445465e4dd9bdf542ed8c5348958789b5f716d5d975d783c8dc20f0cb1ed2ad4f3286740f6302721f6c7ed7f245775f544b01150c26e76003a21158bd00d3f634f0f16ff857d04c47cf6de6071fe55cda3e6c5d36bc5d69d4db75ecf00468d9a12af19d9c861ad889caf519156a495329b8005dd23e988456129999afa56967c738650bbc8283e479452f5b3cf85d52df35e0eb4302c89abfc1d8e0cfaff6ec0c616c3dc93ff26583f021d79c8ff7e5c77c110f8afdc45fa4678d52d0c4577a8c3bcf77aa640f219965787f6c8fcdb5ec5600a690b25df635e6b297bad5250b1c30e62d036d19d0862285d9a29c09df45f2ba69f41af03c9cc54b2878e1730620da260de442d4ec1266c751863c29a26de1dc47be5598910a6c495d27616b4e99a97c04ed4c854a03a75956ec0e4a4318c1403b42ef2247a94142efbd9a00b2f365991da958409c6e5ae2d904a8a4c9e84ff7d6e182072cce74bce517821e360fc10f3ec62a03919f334d941c592cea68355ec67a0b758530f145cddbddee11ccb0efad081cc6f920a6cf6351b7cab4a67538df28cdac28e32ab1454ee6efd9c60c3a60618e04fc52bdd683d651ac11a5b352ee2f282671116005c88df9ee42ccba8f722cd7b7255cde9663a371932536d6f5f1743096873b42f40c01e0947ca2fb0f366050fdf3fa25717af370360b251421e10fc70bc435877856ef5e4f1bd57ec6c1a604627d8f15be8bc7ff32820e94292a309700d8cf080c8f138c5810363ec91ccdce74eb00468ad07c5a97b84ba17d40d17ef250529e1e0e62d4d8dfd07bbacacd21a05e621e91eed2b921a155885ea82d5271f47742f12c8eba448c2a6899a52d4feaa4dec4b8271f34ab6a01f5c0cac412ebaf5ac99734adfdedb0413f7323eae8c13b98d5d0f6a6ba3ad292e84f60286fb42ca98f72d0e2fe31539f8ecd73158e5ba1443d177e257ac8b3b345d8b9bda20e8683563abe7d8050a6f5eb0660c77878f250ae8d2d598b5df4d97dd95334b854ec9cdc58dc9d8d3ecec26e35b2230ee7b503ca1cf5734f435e9d0ffe4dde398cbfa6546f6bb3d7487d7e9bee09e55cdb4c173aa7df7ffca57ac9c2bb088b73e223ac7832cd3a87df241172490aa34c11c4ff25dee2ddcb0c031e860d467de47e024d5e06ae2150a81da071d0a869a92ab3c64d36c15895a86493c13f9cbdb3c6da8ddfef18e4cbb53fa3046e2f828bef3565b5e8afad6781dcfc0efb58eb6d844beffc86efe894d12da841b2d87354e6b3c8da601a305cc3c71063a72f6ea02754170f80a72706cf00b0377c184437d79c44c0c4ac4f79e7b0b4cbfa74237e75e8188a67ddbca4bfb42efd1ef65000a885aba9f022a71c3964236da83038f660cff0f4fb63c2625b3f2e296324e0a70db8cf94081064d41b83c201982b7ba873b87fd3824db31ad815406bf98f18927b38d5093ce9789dc1f883987693799785e246c9bedbb116d6f34447f94427e1185046fc41cd1562a2c1f7be72e34e4d0ea3419598421c55177b47f20cd2cb29e62d58ca1ea5f1990b54bd0a580f06ca142bda08dbbfb9b9154a8810947c545588f9b6abe35f9ef9fda67efaec3010b89f73ca6e02179a0179b0630844fe6a10255b72e571fbd681df69d4ed91169cd4a2688b5c70a117804936b29e657bde20b84846ae85cb0718d728a5556bd93b63b49d748ed9c4bfb93d5821604e000f75f7e162b4a4d6d80bf98013fade2f47a4929dc0b9514a2cb77865e67bf6cf5df17548fcf9238561f2c737f00c083c855072a6b703ab179bfd1026c549ed8e15a8fa08ce55a486c998c93c3182772553340806a85211526a97d1a6f965c14ac7fdcb12042af2daca94b1fa9b33a670912d928b43980c64c50a6231e8c158e6d58be4cb3a634cc7a58dcca2064d896006ecafc5dc0a65df34acb779e9be4b9630e4ff6ee3702decc64862a6eca29a2dee91ad3102a9327e998504e75cd6b214be90560f2ad321d6f9788a63529334110d46365c694676241d3b8182214778fc48f56158e7dd3ceabbd5d29db89331da43ba508293ed1bda7633e7a9cac19648026b587bd4b7ed47671d471325144f801d042789f8762a203c198792a4f601de352a8eb0929a9ad3b8439a0266fa1726417dd2c424db189c796995c8a7731e06418611b94fc07d62c4c6794ab5438f49d8db58f224b165371df0545f938f5d756ee81a0bd91eb45de9d26f64076f16eaa58b33ae3a917733f2fbc6f835a5be201238000bbc096f5d47e0fdcdf635c5c899b667aa23465e15adf9145547d97d2bd8cfe4b5847374f5c4f479ae9ace4d852b5de4fb1a79ee2da0b3ea30c5ca0e7b0537f8e32e228e905bbc2850ef6f90a04e2eb6b3f9fb75810ba74afc1501431fd22b7a7fa52f3871006332637fcbd3d21ae525a8fec6a1eee3954ec1532c2efd2a208b73d3709e703985b8432e0475c97eb6c10dbd66da6172224f4b5faef9196571d0779eb99873ea595fe52b2715a72ac33912bf4b2163883ae5534499cfc1307c909ff4a70f42c0b5511968706ba5794aa24dc98c424888fa5a9bd350207b10e3c6a5dea01498d78efb94743f05d61d4c5b86380e245a25e1b8cb61194e77f398117ea5cc9826bbc0bf5f1e84198910ecd323101a5a6f45f5c8ceb005fe29ecdf92d5083071d30f92bf5c7a700d6f5863c3b6fd74be653402ba38397ee6950d711d026822ac63934688ca5f724d8e75e9aaab6a83f759aa5847e2452cba1f3707057ca78781a39f2749f4c35042313c87d22b2fd6a111d1d352026a0857d937725fe5f67cdf1334caf27f3b3de000b026c915a189cb9dedacab40cd14d7360e795daa306b31e7f1f799db87a0536b6afa777d49c0fe83b3d8cb345b8026c74ba677d7a70e17896668b645c785bf863661fbd3f6d99a1ab37223e814a05256640b52b100008442cef1b64215a25baaa1fbdef28fb90fc93bd04884c6738fac6e12d24b2a30c51d98c2160e37eeae2761b613d28a5b369e17e0a1963a3fde88387493774dca04d79b3343a9a6ee9296861568ec907cd48f83a2a7e0e53b8c8b851a162b909a52cdc1daa9aac6f0b87f103dcc2cd910502041d57b9860f9a2dbeaffe01376937a4746732c2941de4dff94d4fe3d3b80c56826cb36feef31a1346ff268d2fe163abc8f720470fadc64bd831964fdd0d2bc96ad2b82f42171280a000bd6cdc2ee67702e125a5b21a09a902843796d56f9702f5760e8022e1d12809a97d63b371fb1b504dbbd26d40c9bb7e22843fd0d79f9a6b07240b797dce044f04073edfdd04e019279213f001c52c3d09d07114a08f6ec344302f5f0632133cc85f993d8240dabdec1e7be5daf34984583d05ec1cb5d3cfdb322fe774be9047f4d998b5fcff1cfec828a05fe22b08495d16c90ebe95e78f7e3289e3d3f50b99c74891d2d070004a354414fb21fa7c45fb449ced07df5dff88859498c74e2a9a0ac78ac9b7d664e8c7f6a67a2b5714ffe446ba35e8e50295528a6c81531b462b9f6dad70366014ff039b7e25f628e384fa70d60a2cb6f911ba0babeb8d58e9b9b912e12f5ff40ace432238c97cbd902f8523b8a112e4a5ff66e8f5587641b8e286e9a1042d4c45c219feaeef04237710b99ab2e6cf27cfc7718684d94d3bd06bb3b4ff2ebf430185859057d02aaff0efe9f93ea796dbbc0ec72b5cf9a956e142e623bd8d666824807e2e47cc97b912b8c805c21c0c8b83cb9576cc0202852a205783674ec92b70005a660e6e7be8fe805c36917bdfccfb298b50a40ee21c348300fb61e7dc7a701ba835281c655cf533c01d2ce0cc7fe71b123d36786e8944fcf50674326328c24848502fe7f42d5d5d6aee8748e1f7a3c52035e298e24069a33a78e8a9fbff521fc03e8d82354e74b78c3adcaf7d7f24faa74cacfe6e61594a6955c38d962a4de6f6b1dfd40a418b2e069fbeb270f9687e18c0d37942ffeb0162a45c37a53e5cdeb3d14d52fecda9ed27ddb1b7b695eef54681bd7d26b5af536e78546312d0ac9138ac1034c21808cffc7268195a59f06f9a4f74faf98edf8c0d9e68f4b2e64404951542dd75e3c0311fae2dfec2330e7e33c762b57c653bdd54ae0947ebc4deeb0b05b72905f35628309f4854d02346af67946b8ff9250a644d6e1a5bb7c88a96e6ac15d1b15b16b3a693455f944f0befeff3e738d740c316ae4e20327ce0e0875395324c98fa5b3381f3f5690fa2de323ea113f123d455a406360f23f3c39674201bbbc34adb2ca56819bcbe1cd9381c22f070e3bea95bce102e260e9ebe331626fb23a7dbee3573c97b89327c9eda2ce1ca918af0419436d28747f3b89713721543a5f721f7f64c7767c336145d00d25e078727deaebd0166332c867e8295fd312302b1e3ad68e02b8db858ae001ebee624e0274868c1d63a43655efef840ce8acddfbfd270d704735a18f6b18db18fefb2107ac6953be5cbe63bd9b3af08cdd6190c3b8e5d9ff1eeb43061b97bfa09f2f6c3d261afd6a6015347dae1ac3cbe207a79988f83b4ab61ad60241c8e8ade9b976f91c2053801ea40933d983cc5ff882c5d447385cfb11bbf48a800456511bb3c0429d7aaa272095ab275722268c61c3072868ea81af00686d824527ed8c398d79fd8fb91160b3198cf8280e759065be6e657f3797fb9ce5468b8d99c2309a1c094e35055d18f04ce48ef88ab45a1a562bdf02888e43cd0ae8479cd5afa0b529d827e584f2e9ceade17d177cb4895a1b40fd7ad2291de542ba3bc6e7621ca1f369db111571ca822a4815455330b1d08796f49a73892a00952f479673c72944dd183965e79f58e676c9a73adc5d476ee6327e5090532f5f93e58e2606de74120458c75f4b6c73d94da746367fd0b69f2d481b7ef8c6f4533210ceb093119c8700dd432d96d851bac29c40d0b8dd7d558c65bbf89f8887899aa2842814eb0e1d57d7377214c738714c621c5e9210877092b39630b5f35ab923d3eeda23d1aab5526b904da134e3aefbb00c434b7762e08732b4b2da6706fea7d89efde88c134b3a31474b29b44bf3aad897027730d64bd0116bf2c4877d0d236b899e04106f50654829fb032b91fd4e432eadcf53588ab9fe165af9b753e2b13755b71450a27a7968235678f7623c88abba2ba7849e8674d477a4f10496c612651934f36096de97ed60b81478ca0f53c46a584663e7332a10706dbe3513e0f61a082565cde3ed635f9705d2c9e09be85b90f0149232f1ccc0988753245fb125dfb5b28408fe543e2f48376abf11e7c03059c6e52187e860f14bdbf26f80731058693d96e003fe16446038a9bfa16bf76a59f140b3b456c98b4375536dcee5d53ec8ae2ada5da84f38bdb4d8d2909f51a541a08a371d6deedc702f7939838d78040d14e14083c97c70b484bddabe911c550550726ead155bdd7c450e0848f689d2278c32fcf55b8a37809f6475a9bab17612c7d49b324bcea3a577cfa985f07dc3ea4af813603e5b9966cf28133483d01310ec07d38d4cf29c878b977e22ca79c972ffb12665ecab6a309ac80185ab0e7a30669a9fb3fa07835f0f8b4894139a4666e5376ebdf277af02800342a00b4494e18442f3638e0bf2bbb350439803afe4b00c01ad81abfbb6867a5ae2b4afbb257716d03e216be39bfbf4157f3ec58a4cd4877f58dbaaa42819110f3dca9278d378bc02b871d0fe850e2e0ccdb3cf5fd201315f0dc7459d939eaa9af06cb5d5b8a026980dc4854fc4ea3e17f2bae9b1c627e0592ee8874945af6ba5eabdc9d4d992a2fddb564f76f21d0c9f05e244c2620cc13796d2de7b900855de14795055741a79a1b5ec11622c7139f82b3686f6379f158c63010e3d7926f21b4f20ba36122645d3d33c6c22cf9608b2e8a8efbe0b3e6ad7b4b8080974d5149e1b58dd16c443539849f92f96a7b28f544536f5facda301509404f5108ace069397829e928225a30de6cadeda5aaa02f962ded2b19b7b1283fa49b76e699bf71429449db8d84ae46ab4824c0f0db7b4b4e11a3836b43be9c364d7cfc9e33bde465cec1304b2a61422894a3d2b71638c185a811a3107878e0ea031f05e06b49b05f0a6e11795c7d2f3196fbc55127f7c36f94db6eede7145428e01b5c2a71b1fbb580fbf493a647f6824d7988f9da44fba44bda499354ee0b57b721ee49f5a19e5789a3b79b9bcb7814ec99cdd764f45bcc05ad4eb5b1b94a21b2a9fec83da787dc69dba13cbc80725926d65bc8e325f41d9b7a4bac09850e1896759c0d45bdb3232ae279cbd9a75bbbfe4695236136ab6f63615b21c3e5eb5967f1ba03f70cb0c58b5e56e368e5d1450af858c06c735d4f6943c511268d30c60b9f6196c92b202a69d00f0cf28771187fd25b3ebf67adbe5f38361131c309214bee070ac561025c7ac5c5c1bf9638628b0fc2fe1be34c5e4e5ab7c2717d84616f5461f25bca5d6711f383f35b770c6fde998e0a1430177370faa3dcc7045813feec67b0f6cfeab0f89972f51fcfe4d78347958822b633fe73867fba355b2c0ddc182cba497694ccf5f91a379a66309e19642cb9f16edf86b95de0d4fdb4f46884e3998824f3c7630623a1a288ad576e50531af057929a8463b9cfdd6c93956100d48d948e08c9734a34bf5e8ab526a025a5e22c7e18c255680a87e3b9ab59beb6ae46e330b63cc97259d7602abe3ec7a4fe7603af82ca2c38852b862a58ac550ea8607ba4e131b9f3efc8891653b82c69fb0943328e0c68183817078561678f4f5694f357efb5f8ec03ddd28e8404bcc180fbe4185422850a8e4f6f2d335a3d2686e808edf692d662e04a730155f8f30f9613200a657792ebe50e8f3dce5a962e1914e17e1ccb7ff7916276305ddf149d438c821f4ba3aeeda8008ef13134ae9d4c819edfac820ac12aaba889a831882d0dfa407f26268584a931366667ff7881796afe570ed1fe5a7304fe5c9c90ed6efc3bfd0199881f18d283e15c928f218f395d89def8750f1532f87f252c519b31c4fcd190da181c78e3f1f1bcda836f980f31aa1cd89f77a10fd12fbab93f91a5a0a760764e44c56aec54bf27c31c9cb8288864185c7e0b7b123b587c5294f819dd27d111c2a4c4be9363580bfd263d9b65ec34c7fef219c0eb7c32b79a13681ded4c7c18811538829ecc1f5a2e0751e7f1411a0169580c4785e8272158a06b62da0951094bd8fb17152a9402f380e8f6b8cfb019a73caf902b4fc1095b2d214d233fff729594891e05e18b4be09ce1efdabaaf65434949c632b6ce437ac8df17efeccc9cd16d0afcd0aaa1ba980bc572182d6fd7508b30cee9e03032f12fa2ab6375dc0751ff16075ca394f8a5549b1cea260590a79706913f36f8185ebc2e3500aec341c7761d915878f9e455a885ee2c87932d6e00bbd2062a891dfe8c3b764760e2f42fe4a9591635c9e15197efb2c0b14936d63faeb5d4627768040d026e596ef3fd40cb6a225a2060b6f92c3719f313ea47f6b4e2668bc3834029a628472c83ee006e73fb470356dc722abee216e2e1bd5684970d87f9584204eff37595dfedeaffb3ff8f00a65dec71060668a890ae2970c05609133e159271009e4aaab42e0a00dd8dbaf5a480fe9e6c6056fb54ff2ab7b5ac42790f6168a9d631f656321ef75064862036ddcb8528a3f3c0f1dc8df50aa452e8458f039f11bf96fe40a1c12edd0ff6319a66f4a6af08a567f8e8f853003e6875f8e67834d345f765a5b6f7b916eb460226040a429af259358eece9078706e6f932c1fefa191bcf19cf9f8968936bc050aaaab8a634e4a2ec9e88b9051acb9921c28bb5fea29ccccd3ad1c2eaa8c436e3a089f869229c83df3b64d22728614251c417039a3a740ca738d79e49e5d819bde6f2dd353522b445c2875bdef92018c50b283a6018136cd3ad05d684fccc97d1897bed15c07688b1a1325af52444c44624cac69b16678da201d3ed21fffb193409ced3875445c1ab6bc29c8cd341858a2a2a687dbfe6705a8d1faab02f5b571030d1b321fca9b41e017f47db949e14d64ce344b6271beb2a15e7cbc35da25846679936581627178bdf2f691e2e3935f8c18035d43cee284682ef625cbeb582c8d772b25f322b9d5df039c0537d997e952a9a36906dbdeabd6576daf2a6924522f0901d1ae1b8ac9368583dc839214adc462a62fc130d1932fd3ce416850249e7bd2e6c579d18fded352c7d3eb9fcdc6f0506e69f279ac6b28a3d9844eaea63d6cc36f6542521cb21264bc139c2242e585e88bda86bdb5e42487c655c094418d8d5a9f543ebd2265484bebb6ca4f3705906d557547e246a15b90bd47ce9b16a7b5a25349ad2ee1e4a9bbb68f14db6b9fe61f2257b24142312d397e2830220b77a096d3381c420419e5fa6ea53313731fd91750c0ae2f6330ad056fadbd90a09cac55b6d9926711425a58bcb1d2a93d6c10468d35ece649f8b6dec86c5e327d93f77349463ce827cbb5a0a9e583c9520a646e0d07da0e6bab7a66e28f516a7984c7d1be1fecec3aa6258815f86e1665d4fe4196f4e86a068aa6f934c7ccd9d44b694d4117fec2c56fb46fa23887398cc83cca6e2edd4f3f2d9399bcc315d53a865bf57a26d5359f9d81e0b0ad95e46febf07536c49b78ce8ea62d0f3a93897896721dbbc0dde5ad5bf421f92131eb351d55699857181f1db72ed602f2e9602cbed361258be9f8da812f8e91cdb8ab43236cc62bd286b1594d83504dabd775fbc68a2f46d5aaa8b057a6b7da32df79ee872ada21b070ffa7b20acfe4acf5f173f06e3e60ffcf23b83c82d6f78732f5f28a6d16bea0711f520ac191a6674a3b9e6bd24a0ed5a8fbbd49fa7cf650b012368aac6213f30346c5bcb64d4ada54cf294504604d112ff87be23f6ced2fa56edc20f144ccdf1f574df45083de28e7611041cf9862bf10a18a91c2072e3f55573a7676c23473b99416b80203ee473356cdd6d1897f4f19b8e6d6d14bfb84d5b01c339a51cc8f882a85036015e5e080d2cd413ec73b020d95c7fd8c7985c058117b8640e052db1e7ecea1a25449f158b61fc0e942f5d582a2f07957492b7b2726ca3128d1424908ee48268ef6bbe8dc735ddf4e7cb2b77d0a11a581d614ea2aed68f372a0ad721c43db2643b53aed3c2a95bbcc3f4886d72258d983763b7ef86c135aca8ef3839a86acce9637fd85ac9bebed9f3890b0dcbf328ad4b30370568a2d4286b9400155082395c474fb7eb62272659e657a70b9ad9c41d5a82b8082a4e631725cd82e09621f219b08d7b8d19d1d7a3d699ca61042c726eee724c2a1002ff3a7ef7b03e678a72bf5652fce980786f28dd02567ccda7d91ffcae5cff7d3a03fe727af2750870c3ac468606823095f63f55a753bb78ff02f49dabe690b90c2a06c471812efebeae9e393e754f3e3ef41f43190eceea9069a0d72d376437a214e421f7f096b322bab80c03db732db090dbc902753e8ae938b2b5fbb5849e0b94299e262ab02c6b13a3ecde08055cdd60731c0920ae814a3b25f82a87112ac6eb73a0d252f4be21c78ef7062efc23986078525009f622e8cb5213774bf5e7a62eaf4aeaf5188bdbcb1cd07ca7c81d06f104e80c1244605f284ffa945a09b32f0d3c9838a4055066f8ff1c0ef4c78f758c868f1a51a102634819726b49b2b373eac892e2af9cb9c1f56eb47470ea2290059d1e83dc7774d77fb0781876d4d27ecea4b12101f1d34d9a4c15f7f4e73be4987491d846268c4e7da4ca1b2e06663228a6d77758aab64cb19d2765ee0df59749ed9e5acd75da39c73c6ba27403ef4445b6e0e068b1baeb7e3966d7b8bb1189dd8326adc59f0efb5d081c7d272fe60f59d6b595c0f453777bef39ff3f1b4385692d86704ee587418a986bc6c8a5cff788c0c03aa7b3dbb48f090ed1b05e7fe36bcecaf28ce9344ad5c4c4f209279928c1fb3b9563d7c1af4bcd15ce26aa5285c87fdae93a995bbbecb5435e64e0aa1a1443963cef59471742cee59b3fbd798b464f1b11be3fcfc1ed01983f499ec0dd4e00e6c76138c8610ba8585713b811f55d1427e4d1f8ee1f50a81704f1908d9ed94ee9ade76fa07eb0b62fcfbe2d338e4112b7890d6717814cf88c41b7dc79673d0065258e8e1eb339c3b17b4110aaf6e7476b84f9484073490eec79425a7c2846e6bbd29bf5b621274df0efcb15746278288185bcd295c18c3aff7b48a0308dce1bb58e5fa12a8b3d9ba568b90335c16e9bb7a3feaa885e4f163bfaa10571af4a7894bae110eed3a0a7661cb2d6751a956823a70d1134599a9adce4c1cf0ecc5f252deb04c0fc3323fe9f7e5b4817f443ec5f890f50484b5a4a9cfa1cebfa2dc2ed2c389b3d3aab84ff12574c3a18ea2db920903d1dc4cec40a7b8a407832db246b0194ca2a90c8a642c5e898b52411db4fc07a9b76b8fb1c946e699ac211ba80c93e2618ce1cb9e5c24955b3360293999a6f01e45c7ef1fa84ff17c39c3023addc13984b04ccf00f2af08bda63d130c7b298e07d8b14b3f8c3d83379e25ae262369bfd396c671d7b253436ad50dbfb61ae9d9fb3eb211510699088319c9d26154b693daf01f804cc0af23002c22d38294c7399ad2456f0256be702661c4b2170f3736fbb80a4c67ea122995e41b0671ac7ae882937f1f796420427e1a6fab7a1d903fb9c425b4f19d103026a0f9ad8062c69c5856b9f8e596877efb7f8ec79a5b8e6804cf42510baf4b8d72d3a37a40558d77511efc9f2444e3c34fdf9246da40fcaa9949dd84ef96e16024fc82f01f20b81c490c05fa74816f0a68d6ee7e64030b76f4cd2d09aa9bbf8a4ad1f122d34910b1beb73635bbd43d102d861dde82c347d7fe12ffb9429cd2e9fbf2d4afa08454b43f08683d2354beb528408ed034a88ced88b0a069424179a96f8dd6ca1ca610365931bbcf01971e0d3acf9d31a4adcbeb93fda3062fb3f31a237eea70269a0d4c346adc5f6b3f4acddde2153ad1ab16b9e8eb4991e68649ba1f920bcbc900c3eeb84e31ed795101c97c3d21b0df4ad9c44aa341dc5087c11d4d4272f1167388b331560c64c4fd150a4f8e097dd9ed24ddb51dc2f249272455e603ff782af9a69</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Score of nch</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 考试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树套树</title>
      <link href="//OI/%E6%A0%91%E5%A5%97%E6%A0%91/"/>
      <url>//OI/%E6%A0%91%E5%A5%97%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p>人太菜了，只能写板子</p><span id="more"></span><h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><p><a href="https://www.luogu.com.cn/problem/P3834">P3834 【模板】可持久化线段树 2  </a></p><p>这是不是个主席树水题，<del>如果你说是，那你就已经吊打114514个我了</del></p><p>那如果带上修改怎么办</p><p><a href="https://www.luogu.com.cn/problem/P1908">P1908 逆序对  </a></p><p>这个大家都会做，但如果数组$a$变为两个数组怎么办,要删除又怎么办</p><p><a href="https://www.luogu.com.cn/problem/AT_chokudai_S001_h">LIS  </a></p><p>这个很容易，但如果其中有一个值会改变怎么办</p><p><a href="https://www.luogu.com.cn/problem/P4175">P4735 最大异或和  </a></p><p>这个我不会，神仙你一定会，但带上修改怎么办</p><p>对于上面这些带修,增加维度(带修就是增加了时间维度,并对时间维度进行扫描线)的问题，我们有一种解决问题的好方法–<del>CDQ分治</del>树套树</p><h2 id="树状数组-线段树-套线段树-平衡树"><a href="#树状数组-线段树-套线段树-平衡树" class="headerlink" title="树状数组(线段树)套线段树(平衡树)"></a>树状数组(线段树)套线段树(平衡树)</h2><p>一般内层是权值线段树，也可以换成平衡树，空间会从$O(nlog^{2}n)$变成$O(nlogn)$，但求第K大时由于平衡树不支持多棵树同时二分，需要在外面套二分，时间复杂度会从$O(log^{2}n)$变成$O(log^{3}n)$，而且权值线段树更好写</p><h3 id="P3437-POI2006-TET-Tetris-3D"><a href="#P3437-POI2006-TET-Tetris-3D" class="headerlink" title="P3437 [POI2006]TET-Tetris 3D  "></a><a href="https://www.luogu.com.cn/problem/P3437">P3437 [POI2006]TET-Tetris 3D  </a></h3><p>也许是板子，使用了标记永久化</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,D,S;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> tot,lc[N&lt;&lt;<span class="number">5</span>],rc[N&lt;&lt;<span class="number">5</span>],tag[N&lt;&lt;<span class="number">5</span>],val[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) k=++tot;</span><br><span class="line">tag[k]=<span class="built_in">max</span>(tag[k],v);</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> (<span class="type">void</span>)(val[k]=<span class="built_in">max</span>(val[k],v));</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid) <span class="built_in">change</span>(lc[k],l,mid,L,R,v);</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) <span class="built_in">change</span>(rc[k],mid+<span class="number">1</span>,r,L,R,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> <span class="built_in">max</span>(tag[k],val[k]);</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>,ans=val[k];</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid) ans=<span class="built_in">max</span>(ans,<span class="built_in">ask</span>(lc[k],l,mid,L,R));</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) ans=<span class="built_in">max</span>(ans,<span class="built_in">ask</span>(rc[k],mid+<span class="number">1</span>,r,L,R));</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">&#125;T;</span><br><span class="line"><span class="type">int</span> rt1[N&lt;&lt;<span class="number">2</span>],rt2[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> u,<span class="type">int</span> d,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">T.<span class="built_in">change</span>(rt1[k],<span class="number">1</span>,S,u,d,v);</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> T.<span class="built_in">change</span>(rt2[k],<span class="number">1</span>,S,u,d,v);</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid)<span class="built_in">change</span>(k1,l,mid,L,R,u,d,v);</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) <span class="built_in">change</span>(k2,mid+<span class="number">1</span>,r,L,R,u,d,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> u,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> ans=T.<span class="built_in">ask</span>(rt2[k],<span class="number">1</span>,S,u,d);</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> ans=<span class="built_in">max</span>(ans,T.<span class="built_in">ask</span>(rt1[k],<span class="number">1</span>,S,u,d));</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid) ans=<span class="built_in">max</span>(ans,<span class="built_in">ask</span>(k1,l,mid,L,R,u,d));</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) ans=<span class="built_in">max</span>(ans,<span class="built_in">ask</span>(k2,mid+<span class="number">1</span>,r,L,R,u,d));</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;D&gt;&gt;S&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> d,s,w,x,y;</span><br><span class="line">cin&gt;&gt;d&gt;&gt;s&gt;&gt;w&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="type">int</span> h=<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,D,x+<span class="number">1</span>,x+d,y+<span class="number">1</span>,y+s);</span><br><span class="line"><span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,D,x+<span class="number">1</span>,x+d,y+<span class="number">1</span>,y+s,h+w);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,D,<span class="number">1</span>,D,<span class="number">1</span>,S)&lt;&lt;endl;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h3 id="三道很水的题"><a href="#三道很水的题" class="headerlink" title="三道很水的题"></a>三道很水的题</h3><h4 id="P2617-Dynamic-Rankings"><a href="#P2617-Dynamic-Rankings" class="headerlink" title="P2617 Dynamic Rankings"></a><a href="https://www.luogu.com.cn/problem/P2617">P2617 Dynamic Rankings</a></h4><p>我会莫队，我会整体二分，那我们强制在线</p><p><del>我会分块</del></p><p>可我们(犯贱)就想用值域线段树解决(bushi</p><p>先考虑暴力</p><p><del>一棵一棵地修改值域线段树</del></p><p><del>这样我们就得到一个修改$O(nlogn)$查询$O(logn)$的优秀算法了</del></p><p>我们先考虑静态时怎么做的，将其转化为前缀相减的形式，我们可以使用善于维护前缀和的数据结构–<del>分块</del>树状数组或者线段树</p><p>所以我们用值域线段树维护值域，树状数组或者线段树维护下标，将其嵌套就做完了</p><p>代码太丑不放了</p><h4 id="P3810-【模板】三维偏序（陌上花开）"><a href="#P3810-【模板】三维偏序（陌上花开）" class="headerlink" title="P3810 【模板】三维偏序（陌上花开）"></a><a href="https://www.luogu.com.cn/problem/P3810">P3810 【模板】三维偏序（陌上花开）</a></h4><p>三维偏序，一维排序，剩下一种树维护一个维度</p><p>代码怎么还是这么丑</p><h4 id="P3157-CQOI2011-动态逆序对"><a href="#P3157-CQOI2011-动态逆序对" class="headerlink" title="P3157 [CQOI2011]动态逆序对"></a><a href="https://www.luogu.com.cn/problem/P3157">P3157 [CQOI2011]动态逆序对</a></h4><p>要求单点修改，区间查询，板子,不过要维护两棵树，细节有点多</p><p>还有个双倍经验<a href="https://www.luogu.com.cn/problem/P1975">P1975 [国家集训队]排队  </a></p><h3 id="P3380-【模板】二逼平衡树（树套树）"><a href="#P3380-【模板】二逼平衡树（树套树）" class="headerlink" title="P3380 【模板】二逼平衡树（树套树）"></a><a href="https://www.luogu.com.cn/problem/P3380">P3380 【模板】二逼平衡树（树套树）</a></h3><p>这才是真正的模板，几乎包含了上面的操作</p><p>那讲上面干什么，为了引入<del>占字数</del></p><p>看看代码就够了，感觉写的不怎么样，没有写出应有的对称美</p><p>求前驱后继可以对每棵树求后合并统计，<del>但我太懒了</del>，所以常数巨大，总用时9.29s，内存用了364MB</p><p>树状数组套权值线段树跑了3.61s,空间95MB</p><p><del>但还是被3.2s 90MB的分块吊起来锤</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid (l+r&gt;&gt;1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M=<span class="number">1e8</span>,N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> a[N],n,m,tot,root[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span>&#123;<span class="type">int</span> lc,rc,v;&#125;t[N*<span class="number">500</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) k=++tot;t[k].v+=v;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ins</span>(t[k].lc,l,mid,x,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">ins</span>(t[k].rc,mid+<span class="number">1</span>,r,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rk</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="keyword">return</span> <span class="built_in">rk</span>(t[k].lc,l,mid,x);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">rk</span>(t[k].rc,mid+<span class="number">1</span>,r,x)+t[t[k].lc].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) <span class="built_in">ins</span>(root[k],<span class="number">0</span>,M,a[i],<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid),<span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> val,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">ins</span>(root[k],<span class="number">0</span>,M,val,v);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">change</span>(k1,l,mid,x,val,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(k2,mid+<span class="number">1</span>,r,x,val,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> cnt,rt[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">find</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> rt[++cnt]=root[k],<span class="built_in">void</span>();</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid) <span class="built_in">find</span>(k1,l,mid,L,R);</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) <span class="built_in">find</span>(k2,mid+<span class="number">1</span>,r,L,R);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">rk</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i) res+=<span class="built_in">rk</span>(rt[i],<span class="number">0</span>,M,k<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line"><span class="type">int</span> tmp=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i) tmp+=t[t[rt[i]].lc].v;</span><br><span class="line"><span class="keyword">if</span>(k&lt;=tmp)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i) rt[i]=t[rt[i]].lc;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">kth</span>(l,mid,k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i) rt[i]=t[rt[i]].rc;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">kth</span>(mid+<span class="number">1</span>,r,k-tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">rk</span>(x);</span><br><span class="line"><span class="keyword">return</span> k==<span class="number">1</span>?<span class="number">-2147483647</span>:<span class="built_in">kth</span>(<span class="number">0</span>,M,k<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">suf</span><span class="params">(<span class="type">int</span> len,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">rk</span>(x+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> k==len+<span class="number">1</span>?<span class="number">2147483647</span>:<span class="built_in">kth</span>(<span class="number">0</span>,M,k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="type">int</span> opt,l,r,k;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;l&gt;&gt;r;</span><br><span class="line"><span class="keyword">if</span>(opt!=<span class="number">3</span>)cin&gt;&gt;k,cnt=<span class="number">0</span>,<span class="built_in">find</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,r);</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) cout&lt;&lt;<span class="built_in">rk</span>(k)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">2</span>) cout&lt;&lt;<span class="built_in">kth</span>(<span class="number">0</span>,M,k)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">3</span>) <span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,a[l],<span class="number">-1</span>),<span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,a[l]=r,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">4</span>) cout&lt;&lt;<span class="built_in">pre</span>(k)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;<span class="built_in">suf</span>(r-l+<span class="number">1</span>,k)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="P3332-ZJOI2013-K大数查询"><a href="#P3332-ZJOI2013-K大数查询" class="headerlink" title="P3332 [ZJOI2013]K大数查询"></a><a href="https://www.luogu.com.cn/problem/P3332">P3332 [ZJOI2013]K大数查询</a></h3><p>这题也是板子，但一看，区间加</p><p><del>不要慌，一个一个加</del></p><p>我们可以反过来，外层维护权值，内层维护下标，查询时在外层二分，注意要标记永久化，不然常数爆炸</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> root[N*<span class="number">4</span>],n,idx,tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,v,tag;</span><br><span class="line">&#125;t[N*<span class="number">300</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) k=++idx;</span><br><span class="line">t[k].v+=<span class="built_in">min</span>(R,r)-<span class="built_in">max</span>(l,L)+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r)<span class="keyword">return</span> (<span class="type">void</span>)++t[k].tag;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid) <span class="built_in">change</span>(t[k].lc,l,mid,L,R);</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) <span class="built_in">change</span>(t[k].rc,mid+<span class="number">1</span>,r,L,R);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">change</span>(root[k],<span class="number">1</span>,n,L,R);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(v&lt;=mid) <span class="built_in">add</span>(k1,l,mid,L,R,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">add</span>(k2,mid+<span class="number">1</span>,r,L,R,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>,res=t[k].tag*(<span class="built_in">min</span>(R,r)-<span class="built_in">max</span>(l,L)+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid) res+=<span class="built_in">query</span>(t[k].lc,l,mid,L,R);</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) res+=<span class="built_in">query</span>(t[k].rc,mid+<span class="number">1</span>,r,L,R);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>,tmp=<span class="built_in">query</span>(root[k2],<span class="number">1</span>,n,L,R);</span><br><span class="line"><span class="keyword">if</span>(x&lt;=tmp) <span class="keyword">return</span> <span class="built_in">ask</span>(k2,mid+<span class="number">1</span>,r,L,R,x);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">ask</span>(k1,l,mid,L,R,x-tmp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;T;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> opt,x,y,z;</span><br><span class="line">T.n=n;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;x&gt;&gt;y&gt;&gt;z;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) T.<span class="built_in">add</span>(<span class="number">1</span>,<span class="number">1</span>,n,x,y,z);</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;T.<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,n,x,y,z)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="P4175-CTSC2008-网络管理"><a href="#P4175-CTSC2008-网络管理" class="headerlink" title="P4175 [CTSC2008]网络管理"></a><a href="https://www.luogu.com.cn/problem/P4175">P4175 [CTSC2008]网络管理</a></h3><p>P2617的上树版本，先来看静态的<a href="https://www.luogu.com.cn/problem/P2633">P2633 Count on a tree  </a></p><p>考虑树上差分，<del>然后就可以看题解了</del></p><p>可这题要修改，一个容易得到的结论是一个节点影响的是自己的子孙，在dfn上是一段连续区间，所以问题转化为区间修改，单点询问</p><p>$clj$神仙说把外层换成可持久化线段树可查询历史版本，但我不会</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid (l+r&gt;&gt;1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,M=<span class="number">1e8</span>;</span><br><span class="line"><span class="type">int</span> n,m,top[N],root[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> dfn[N],sz[N],idx,son[N],f[N],val[N],id[N],tot,dep[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;g[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;g[x].<span class="built_in">push_back</span>(y);&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> lc,rc,v;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">8</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[x]=fa,dfn[++idx]=x,sz[x]=<span class="number">1</span>,id[x]=idx,dep[x]=dep[fa]+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;g[x].<span class="built_in">size</span>();++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> y=g[x][i];</span><br><span class="line"><span class="keyword">if</span>(y!=fa)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">dfs1</span>(y,x),sz[x]+=sz[y];</span><br><span class="line">            <span class="keyword">if</span>(sz[y]&gt;sz[son[x]]) son[x]=y;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> tp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    top[x]=tp;</span><br><span class="line">    <span class="keyword">if</span>(son[x]) <span class="built_in">dfs2</span>(son[x],tp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;g[x].<span class="built_in">size</span>();++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> y=g[x][i];</span><br><span class="line">        <span class="keyword">if</span>(y!=f[x]&amp;&amp;y!=son[x]) <span class="built_in">dfs2</span>(y,y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">        x=f[top[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[x]&lt;dep[y]?x:y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!k) k=++tot;</span><br><span class="line">    t[k].v+=v;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ins</span>(t[k].lc,l,mid,x,v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">ins</span>(t[k].rc,mid+<span class="number">1</span>,r,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> <span class="built_in">ins</span>(root[k],<span class="number">1</span>,M,x,v);;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=mid) <span class="built_in">change</span>(k1,l,mid,L,R,x,v);</span><br><span class="line">    <span class="keyword">if</span>(R&gt;mid) <span class="built_in">change</span>(k2,mid+<span class="number">1</span>,r,L,R,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">find</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> &amp;cnt,<span class="type">int</span> *rt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    rt[++cnt]=root[k];</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">find</span>(k1,l,mid,x,cnt,rt);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">find</span>(k2,mid+<span class="number">1</span>,r,x,cnt,rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> cnt[<span class="number">4</span>],rt[<span class="number">4</span>][N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="type">int</span> tmp=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">0</span>];++i) tmp+=t[t[rt[<span class="number">0</span>][i]].rc].v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">1</span>];++i) tmp+=t[t[rt[<span class="number">1</span>][i]].rc].v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">2</span>];++i) tmp-=t[t[rt[<span class="number">2</span>][i]].rc].v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">3</span>];++i) tmp-=t[t[rt[<span class="number">3</span>][i]].rc].v;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=tmp)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">0</span>];++i) rt[<span class="number">0</span>][i]=t[rt[<span class="number">0</span>][i]].rc;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">1</span>];++i) rt[<span class="number">1</span>][i]=t[rt[<span class="number">1</span>][i]].rc;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">2</span>];++i) rt[<span class="number">2</span>][i]=t[rt[<span class="number">2</span>][i]].rc;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">3</span>];++i) rt[<span class="number">3</span>][i]=t[rt[<span class="number">3</span>][i]].rc;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">kth</span>(mid+<span class="number">1</span>,r,k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">0</span>];++i) rt[<span class="number">0</span>][i]=t[rt[<span class="number">0</span>][i]].lc;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">1</span>];++i) rt[<span class="number">1</span>][i]=t[rt[<span class="number">1</span>][i]].lc;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">2</span>];++i) rt[<span class="number">2</span>][i]=t[rt[<span class="number">2</span>][i]].lc;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">3</span>];++i) rt[<span class="number">3</span>][i]=t[rt[<span class="number">3</span>][i]].lc;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">kth</span>(l,mid,k-tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;val[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>),<span class="built_in">dfs2</span>(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,n,id[i],id[i]+sz[i]<span class="number">-1</span>,val[i],<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> x,y,k;</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;k&gt;&gt;x&gt;&gt;y;</span><br><span class="line">        <span class="keyword">if</span>(!k) <span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,n,id[x],id[x]+sz[x]<span class="number">-1</span>,val[x],<span class="number">-1</span>),<span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,n,id[x],id[x]+sz[x]<span class="number">-1</span>,val[x]=y,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> lc=<span class="built_in">lca</span>(x,y),tmp=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;++i) cnt[i]=<span class="number">0</span>;</span><br><span class="line">            <span class="built_in">find</span>(<span class="number">1</span>,<span class="number">1</span>,n,id[x],cnt[<span class="number">0</span>],rt[<span class="number">0</span>]);</span><br><span class="line">            <span class="built_in">find</span>(<span class="number">1</span>,<span class="number">1</span>,n,id[y],cnt[<span class="number">1</span>],rt[<span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">find</span>(<span class="number">1</span>,<span class="number">1</span>,n,id[lc],cnt[<span class="number">2</span>],rt[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">if</span>(f[lc]) <span class="built_in">find</span>(<span class="number">1</span>,<span class="number">1</span>,n,id[f[lc]],cnt[<span class="number">3</span>],rt[<span class="number">3</span>]);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">0</span>];++i) tmp+=t[rt[<span class="number">0</span>][i]].v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">1</span>];++i) tmp+=t[rt[<span class="number">1</span>][i]].v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">2</span>];++i) tmp-=t[rt[<span class="number">2</span>][i]].v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt[<span class="number">3</span>];++i) tmp-=t[rt[<span class="number">3</span>][i]].v;</span><br><span class="line">    <span class="keyword">if</span>(tmp&lt;k) cout&lt;&lt;<span class="string">&quot;invalid request!&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="keyword">else</span> cout&lt;&lt;<span class="built_in">kth</span>(<span class="number">1</span>,M,k)&lt;&lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="题单"><a href="#题单" class="headerlink" title="题单"></a>题单</h3><p>一个都不会，真的只会板子</p><p><a href="https://www.luogu.com.cn/problem/P3242">P3242 [HNOI2015] 接水果  </a></p><p><a href="https://www.luogu.com.cn/problem/P3250">P3250 [HNOI2016] 网络  </a></p><p><a href="https://www.luogu.com.cn/problem/P5445">P5445 [APIO2019] 路灯  </a></p><p><a href="https://www.luogu.com.cn/problem/P3248">P3248 [HNOI2016]树  </a></p><h2 id="线段树套Trie"><a href="#线段树套Trie" class="headerlink" title="线段树套Trie"></a>线段树套Trie</h2><p>解决区间异或的题</p><h3 id="P4585-FJOI2015-火星商店问题"><a href="#P4585-FJOI2015-火星商店问题" class="headerlink" title="P4585 [FJOI2015]火星商店问题  "></a><a href="https://www.luogu.com.cn/problem/P4585">P4585 [FJOI2015]火星商店问题  </a></h3><p>本来想练习线段树分治，<del>但我太菜做着做着就开始写树套树了</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid (l+r&gt;&gt;1)</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,INF=<span class="number">1e9</span>,V=<span class="number">18</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> root[N&lt;&lt;<span class="number">2</span>],a[N],n,m;</span><br><span class="line"><span class="type">int</span> ch[N*<span class="number">400</span>][<span class="number">2</span>],last[N*<span class="number">400</span>],tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=V;~i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c=(x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(!ch[k][c]) ch[k][c]=++tot;</span><br><span class="line">k=ch[k][c],last[k]=<span class="built_in">max</span>(last[k],t);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=V;~i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c=((x&gt;&gt;i)&amp;<span class="number">1</span>)^<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(ch[k][c]&amp;&amp;last[ch[k][c]]&gt;=t) k=ch[k][c],res+=<span class="number">1</span>&lt;&lt;i;</span><br><span class="line"><span class="keyword">else</span> k=ch[k][c^<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">root[k]=++tot;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) <span class="built_in">ins</span>(root[k],a[i],INF);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid);<span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">ins</span>(root[k],v,t);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">change</span>(k1,l,mid,x,v,t);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(k2,mid+<span class="number">1</span>,r,x,v,t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> x,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> <span class="built_in">ask</span>(root[k],x,t);</span><br><span class="line"><span class="keyword">if</span>(R&lt;=mid) <span class="keyword">return</span> <span class="built_in">query</span>(k1,l,mid,L,R,x,t);</span><br><span class="line"><span class="keyword">if</span>(L&gt;mid) <span class="keyword">return</span> <span class="built_in">query</span>(k2,mid+<span class="number">1</span>,r,L,R,x,t);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">query</span>(k1,l,mid,L,R,x,t),<span class="built_in">query</span>(k2,mid+<span class="number">1</span>,r,L,R,x,t));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="type">int</span> opt,l,r,x,d,t=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;l&gt;&gt;r;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">0</span>) <span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,r,++t);</span><br><span class="line"><span class="keyword">else</span> cin&gt;&gt;x&gt;&gt;d,cout&lt;&lt;<span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,r,x,t-d+<span class="number">1</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="平衡树套线段树"><a href="#平衡树套线段树" class="headerlink" title="平衡树套线段树"></a>平衡树套线段树</h2><p>因为改变了区间结构，外层要用支持插入删除的数据结构</p><p>不会，咕咕咕咕</p><p>但可以放个题</p><p><a href="https://www.luogu.com.cn/problem/P4278">P4278 带插入区间K小值  </a></p><p>听说可以用替罪羊树套权值线段树，<del>但会被卡</del></p><p>还有<a href="https://darkbzoj.cc/problem/3217">bzoj3217ALOEXT</a> 替罪羊树套Trie</p><h2 id="序列分块套值域分块"><a href="#序列分块套值域分块" class="headerlink" title="序列分块套值域分块"></a>序列分块套值域分块</h2><p>分块yyds</p><p><a href="https://www.luogu.com.cn/problem/P3380">P3380 【模板】二逼平衡树（树套树）</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,N1=<span class="number">505</span>;</span><br><span class="line"><span class="type">int</span> n,m,block,num;</span><br><span class="line"><span class="type">int</span> a[N],bl[N],L[N1],R[N1];</span><br><span class="line"><span class="type">int</span> v[N1][N1],val[N1][N];</span><br><span class="line"><span class="type">int</span> b[N],tot;</span><br><span class="line"><span class="type">int</span> num1,L1[N1],R1[N1];</span><br><span class="line"><span class="type">int</span> belong[N];</span><br><span class="line"><span class="type">int</span> cnt1[N1],cnt[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> opt,l,r,k;</span><br><span class="line">&#125;s[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">rk</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">1</span>,p=bl[l],q=bl[r];</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i)</span><br><span class="line"><span class="keyword">if</span>(a[i]&lt;k) ++res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) <span class="keyword">if</span>(a[i]&lt;k) ++res;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i) <span class="keyword">if</span>(a[i]&lt;k) ++res;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;belong[k];++i) res+=v[q<span class="number">-1</span>][i]-v[p][i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L1[belong[k]];i&lt;k;++i) res+=val[q<span class="number">-1</span>][i]-val[p][i];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=bl[l],q=bl[r];</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i)</span><br><span class="line"> ++cnt[a[i]],++cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num1;++i)</span><br><span class="line"><span class="keyword">if</span>(k&gt;cnt1[i]) k-=cnt1[i];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L1[i];j&lt;=R1[i];++j)</span><br><span class="line"><span class="keyword">if</span>(k&gt;cnt[j]) k-=cnt[j];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i)</span><br><span class="line">--cnt[a[i]],--cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) </span><br><span class="line">++cnt[a[i]],++cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i)</span><br><span class="line">++cnt[a[i]],++cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num1;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(k&gt;cnt1[i]+v[q<span class="number">-1</span>][i]-v[p][i]) k-=cnt1[i]+v[q<span class="number">-1</span>][i]-v[p][i];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L1[i];j&lt;=R1[i];++j)</span><br><span class="line"><span class="keyword">if</span>(k&gt;cnt[j]+val[q<span class="number">-1</span>][j]-val[p][j]) k-=cnt[j]+val[q<span class="number">-1</span>][j]-val[p][j];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) </span><br><span class="line">--cnt[a[i]],--cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i)</span><br><span class="line">--cnt[a[i]],--cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> va,<span class="type">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=bl[x];i&lt;=num;++i)</span><br><span class="line">val[i][va]+=value,v[i][belong[va]]+=value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=bl[l],q=bl[r],res=<span class="number">-2147483647</span>;</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) <span class="keyword">if</span>(a[i]&lt;k) res=<span class="built_in">max</span>(a[i],res);</span><br><span class="line"><span class="keyword">return</span> res==<span class="number">-2147483647</span>?res:b[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) <span class="keyword">if</span>(a[i]&lt;k) res=<span class="built_in">max</span>(a[i],res);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i) <span class="keyword">if</span>(a[i]&lt;k) res=<span class="built_in">max</span>(a[i],res);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=k<span class="number">-1</span>;i&gt;=L1[belong[k]];--i)</span><br><span class="line"><span class="keyword">if</span>(val[q<span class="number">-1</span>][i]-val[p][i]) <span class="keyword">return</span> b[<span class="built_in">max</span>(res,i)];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=belong[k]<span class="number">-1</span>;i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v[q<span class="number">-1</span>][i]-v[p][i])</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=R1[i];j&gt;=L1[i];--j)</span><br><span class="line"><span class="keyword">if</span>(val[q<span class="number">-1</span>][j]-val[p][j]) <span class="keyword">return</span> b[<span class="built_in">max</span>(res,j)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res==<span class="number">-2147483647</span>?res:b[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">suf</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=bl[l],q=bl[r],res=<span class="number">2147483647</span>;</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) <span class="keyword">if</span>(a[i]&gt;k) res=<span class="built_in">min</span>(a[i],res);</span><br><span class="line"><span class="keyword">return</span> res==<span class="number">2147483647</span>?res:b[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) <span class="keyword">if</span>(a[i]&gt;k) res=<span class="built_in">min</span>(a[i],res);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i) <span class="keyword">if</span>(a[i]&gt;k) res=<span class="built_in">min</span>(a[i],res);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=k+<span class="number">1</span>;i&lt;=R1[belong[k]];++i)</span><br><span class="line"><span class="keyword">if</span>(val[q<span class="number">-1</span>][i]-val[p][i]) <span class="keyword">return</span> b[<span class="built_in">min</span>(res,i)];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=belong[k]+<span class="number">1</span>;i&lt;=num1;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v[q<span class="number">-1</span>][i]-v[p][i])</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L1[i];j&lt;=R1[i];++j)</span><br><span class="line"><span class="keyword">if</span>(val[q<span class="number">-1</span>][j]-val[p][j]) <span class="keyword">return</span> b[<span class="built_in">min</span>(res,j)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res==<span class="number">2147483647</span>?res:b[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">block=<span class="built_in">sqrt</span>(n),num=(n<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i) L[i]=R[i<span class="number">-1</span>]+<span class="number">1</span>,R[i]=i*block;</span><br><span class="line">R[num]=n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],b[++tot]=a[i],bl[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;s[i].opt&gt;&gt;s[i].l&gt;&gt;s[i].r;</span><br><span class="line"><span class="keyword">if</span>(s[i].opt!=<span class="number">3</span>) cin&gt;&gt;s[i].k;</span><br><span class="line"><span class="keyword">else</span> s[i].k=s[i].r,s[i].r=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(s[i].opt!=<span class="number">2</span>) b[++tot]=s[i].k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(&amp;b[<span class="number">1</span>],&amp;b[tot+<span class="number">1</span>]);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+tot+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,a[i])-b;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line"><span class="keyword">if</span>(s[i].opt!=<span class="number">2</span>) s[i].k=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,s[i].k)-b;</span><br><span class="line">block=<span class="built_in">sqrt</span>(M),num1=(M<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num1;++i) L1[i]=R1[i<span class="number">-1</span>]+<span class="number">1</span>,R1[i]=i*block;</span><br><span class="line">R1[num1]=M;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i) belong[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=num1;++j) v[i][j]=v[i<span class="number">-1</span>][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=M;++j) val[i][j]=val[i<span class="number">-1</span>][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L[i];j&lt;=R[i];++j) ++v[i][belong[a[j]]],++val[i][a[j]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[i].opt==<span class="number">1</span>) cout&lt;&lt;<span class="built_in">rk</span>(s[i].l,s[i].r,s[i].k)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(s[i].opt==<span class="number">2</span>) cout&lt;&lt;b[<span class="built_in">kth</span>(s[i].l,s[i].r,s[i].k)]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(s[i].opt==<span class="number">3</span>) <span class="built_in">change</span>(s[i].l,a[s[i].l],<span class="number">-1</span>),a[s[i].l]=s[i].k,<span class="built_in">change</span>(s[i].l,a[s[i].l],<span class="number">1</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(s[i].opt==<span class="number">4</span>) cout&lt;&lt;<span class="built_in">pre</span>(s[i].l,s[i].r,s[i].k)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;<span class="built_in">suf</span>(s[i].l,s[i].r,s[i].k)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其他例题找不到了</p><h2 id="块状链表套"><a href="#块状链表套" class="headerlink" title="块状链表套???"></a>块状链表套???</h2><p>块状链表可以维护外围结构的改变，<del>但我不会块状链表</del></p><p>例题和平衡树套线段树一样</p><h2 id="优化DP"><a href="#优化DP" class="headerlink" title="优化DP"></a>优化DP</h2><p>树套树可以做到很多CDQ能做的事，<del>但不管是常数，空间都被吊打</del></p><h3 id="P4093-HEOI2016-TJOI2016-序列"><a href="#P4093-HEOI2016-TJOI2016-序列" class="headerlink" title="P4093 [HEOI2016/TJOI2016]序列  "></a><a href="https://www.luogu.com.cn/problem/P4093">P4093 [HEOI2016/TJOI2016]序列  </a></h3><p>我们不妨用$a_i,f_i,g_i,dp_i$分别表示其原本的值，变化中最大的值，变化中最小的值和以这一位结尾的最不下降子序列长度。</p><p>$dp[i]=\max\limits_{j=1,f_j\leq a_i\wedge a_j\leq g_i}^{i-1}dp[j]$</p><p>用树套树维护最大值就行了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> root[N],v1,v2,idx;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,v;</span><br><span class="line">&#125;t[N*<span class="number">300</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) k=++idx;</span><br><span class="line">t[k].v=<span class="built_in">max</span>(t[k].v,v);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">change</span>(t[k].lc,l,mid,x,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(t[k].rc,mid+<span class="number">1</span>,r,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=v1;x+=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="built_in">change</span>(root[x],<span class="number">1</span>,v2,y,v);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="keyword">return</span> <span class="built_in">query</span>(t[k].lc,l,mid,x);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">max</span>(t[t[k].lc].v,<span class="built_in">query</span>(t[k].rc,mid+<span class="number">1</span>,r,x));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) res=<span class="built_in">max</span>(res,<span class="built_in">query</span>(root[x],<span class="number">1</span>,v2,y));</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _v1,<span class="type">int</span> _v2)</span></span>&#123;v1=_v1,v2=_v2,idx=<span class="number">0</span>;&#125;</span><br><span class="line">&#125;T;</span><br><span class="line"><span class="type">int</span> v1[N],v2[N],v[N],dp[N];</span><br><span class="line"><span class="type">int</span> n,m,res;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;v[i],v1[i]=v2[i]=v[i];</span><br><span class="line">T.<span class="built_in">init</span>(<span class="number">1e5</span>,<span class="number">1e5</span>);</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">v1[x]=<span class="built_in">max</span>(v1[x],y),v2[x]=<span class="built_in">min</span>(v2[x],y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">dp[i]=T.<span class="built_in">ask</span>(v2[i],v[i])+<span class="number">1</span>;res=<span class="built_in">max</span>(res,dp[i]);</span><br><span class="line">T.<span class="built_in">add</span>(v[i],v1[i],dp[i]);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="P2487-SDOI2011-拦截导弹"><a href="#P2487-SDOI2011-拦截导弹" class="headerlink" title="P2487 [SDOI2011]拦截导弹"></a><a href="https://www.luogu.com.cn/problem/P2487">P2487 [SDOI2011]拦截导弹</a></h3><p>还没写</p>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树上启发式合并</title>
      <link href="//OI/%E6%A0%91%E4%B8%8A%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
      <url>//OI/%E6%A0%91%E4%B8%8A%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/</url>
      
        <content type="html"><![CDATA[<p>树上问题都是神仙</p><span id="more"></span><p>又称$DSU on tree$</p><h3 id="前置芝士"><a href="#前置芝士" class="headerlink" title="前置芝士"></a>前置芝士</h3><p>会重链剖分的思想(就是只会口胡就行)</p><p>适用范围：我也不知道</p><h3 id="理论"><a href="#理论" class="headerlink" title="理论"></a>理论</h3><p>就是对每个结点，暴力统计其子树内的信息</p><p>只不过在每个结点统计时，继承其重儿子的信息</p><p>再来口胡一下复杂度</p><p>由于只有轻链会重新统计信息，每个节点到根节点上最多有$O(logn)$条轻链</p><p>所以总时间复杂度为$O(nlognf(n)+mf’(n))$</p><p>($f(n)$为单次修改的代价，$f’(m)$为单次询问的代价)</p><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h4 id="Tree-and-Queries"><a href="#Tree-and-Queries" class="headerlink" title="Tree and Queries"></a><a href="https://www.luogu.com.cn/problem/CF375D">Tree and Queries</a></h4><p>就是板子，主要是贴个代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> idx,to[N&lt;&lt;<span class="number">1</span>],ne[N&lt;&lt;<span class="number">1</span>],head[N];</span><br><span class="line"><span class="type">int</span> c[N],cnt[N],ccnt[N],ans[N];</span><br><span class="line"><span class="type">int</span> s[N],son[N],f[N],n,m;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++idx]=y,ne[idx]=head[x],head[x]=idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[x]=<span class="number">1</span>,f[x]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs</span>(y,x);</span><br><span class="line">s[x]+=s[y];</span><br><span class="line"><span class="keyword">if</span>(s[y]&gt;s[son[x]]) son[x]=y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> d,res;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=ne[i]) <span class="keyword">if</span>(to[i]!=f[x]) <span class="built_in">add</span>(to[i]);</span><br><span class="line">ccnt[++cnt[c[x]]]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--ccnt[cnt[c[x]]--];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x])<span class="built_in">init</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> id,k;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;node&gt;qu[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(son[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x])</span><br><span class="line"><span class="built_in">solve</span>(y),<span class="built_in">init</span>(y),d=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">solve</span>(son[x]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x]) <span class="built_in">add</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">ccnt[++cnt[c[x]]]++;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;qu[x].<span class="built_in">size</span>();++i) ans[qu[x][i].id]=ccnt[qu[x][i].k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;c[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;x&gt;&gt;y,qu[x].<span class="built_in">push_back</span>((node)&#123;i,y&#125;);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">solve</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Lomsat-gelral"><a href="#Lomsat-gelral" class="headerlink" title="Lomsat gelral"></a><a href="https://www.luogu.com.cn/problem/CF600E">Lomsat gelral</a></h4><p>板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> idx,to[N&lt;&lt;<span class="number">1</span>],ne[N&lt;&lt;<span class="number">1</span>],head[N];</span><br><span class="line"><span class="type">int</span> c[N],cnt[N],ans[N];</span><br><span class="line"><span class="type">int</span> s[N],son[N],f[N],n;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++idx]=y,ne[idx]=head[x],head[x]=idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[x]=<span class="number">1</span>,f[x]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(y,x);</span><br><span class="line">s[x]+=s[y];</span><br><span class="line"><span class="keyword">if</span>(s[y]&gt;s[son[x]]) son[x]=y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> d,res;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=ne[i]) <span class="keyword">if</span>(to[i]!=f[x]) <span class="built_in">add</span>(to[i]);</span><br><span class="line"><span class="keyword">if</span>(++cnt[c[x]]&gt;d)</span><br><span class="line">d=cnt[c[x]],res=c[x];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(cnt[c[x]]==d) res+=c[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--cnt[c[x]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x])<span class="built_in">init</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(son[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x])</span><br><span class="line"><span class="built_in">solve</span>(y),<span class="built_in">init</span>(y),d=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">solve</span>(son[x]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x]) <span class="built_in">add</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(++cnt[c[x]]&gt;d)</span><br><span class="line">d=cnt[c[x]],res=c[x];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(cnt[c[x]]==d) res+=c[x];</span><br><span class="line">ans[x]=res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;c[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">solve</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cout&lt;&lt;ans[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Dominant-Indices"><a href="#Dominant-Indices" class="headerlink" title="Dominant Indices"></a><a href="https://www.luogu.com.cn/problem/CF1009F">Dominant Indices</a></h4><p>还是板子<del>（所以学会这个就可以水一堆题）</del>,好像用长剖可以做到$O(n)$(但我不会)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> idx,to[N&lt;&lt;<span class="number">1</span>],ne[N&lt;&lt;<span class="number">1</span>],head[N];</span><br><span class="line"><span class="type">int</span> c[N],cnt[N],ans[N];</span><br><span class="line"><span class="type">int</span> s[N],son[N],f[N],n;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++idx]=y,ne[idx]=head[x],head[x]=idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[x]=<span class="number">1</span>,f[x]=fa,c[x]=c[fa]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(y,x);</span><br><span class="line">s[x]+=s[y];</span><br><span class="line"><span class="keyword">if</span>(s[y]&gt;s[son[x]]) son[x]=y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> d,res;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=ne[i]) <span class="keyword">if</span>(to[i]!=f[x]) <span class="built_in">add</span>(to[i]);</span><br><span class="line"><span class="keyword">if</span>(++cnt[c[x]]&gt;d)</span><br><span class="line">d=cnt[c[x]],res=c[x];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(cnt[c[x]]==d) res=<span class="built_in">min</span>(res,c[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--cnt[c[x]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x])<span class="built_in">init</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(son[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x])</span><br><span class="line"><span class="built_in">solve</span>(y),<span class="built_in">init</span>(y),d=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">solve</span>(son[x]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x]) <span class="built_in">add</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(++cnt[c[x]]&gt;d)</span><br><span class="line">d=cnt[c[x]],res=c[x];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(cnt[c[x]]==d) res=<span class="built_in">min</span>(res,c[x]);</span><br><span class="line">ans[x]=res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">solve</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cout&lt;&lt;ans[i]-c[i]&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Blood-Cousins-Return"><a href="#Blood-Cousins-Return" class="headerlink" title="Blood Cousins Return"></a><a href="https://www.luogu.com.cn/problem/CF246E">Blood Cousins Return</a></h4><p>还是板子,用$set$维护出现的集合，注意数据是森林</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> idx,to[N&lt;&lt;<span class="number">1</span>],ne[N&lt;&lt;<span class="number">1</span>],head[N];</span><br><span class="line"><span class="type">int</span> c[N],ans[N];</span><br><span class="line"><span class="type">int</span> s[N],son[N],f[N],n,m,dep[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++idx]=y,ne[idx]=head[x],head[x]=idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[x]=<span class="number">1</span>,f[x]=fa,dep[x]=dep[fa]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(y,x);</span><br><span class="line">s[x]+=s[y];</span><br><span class="line"><span class="keyword">if</span>(s[y]&gt;s[son[x]]) son[x]=y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> d,res;</span><br><span class="line">set&lt;<span class="type">int</span>&gt;se[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=ne[i]) <span class="keyword">if</span>(to[i]!=f[x]) <span class="built_in">add</span>(to[i]);</span><br><span class="line">se[dep[x]].<span class="built_in">insert</span>(c[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">se[dep[x]].<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x])<span class="built_in">init</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> id,k;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;node&gt;qu[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(son[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x])</span><br><span class="line"><span class="built_in">solve</span>(y),<span class="built_in">init</span>(y),d=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">solve</span>(son[x]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x]) <span class="built_in">add</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">se[dep[x]].<span class="built_in">insert</span>(c[x]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;qu[x].<span class="built_in">size</span>();++i) ans[qu[x][i].id]=se[qu[x][i].k+dep[x]].<span class="built_in">size</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> t,rt;</span><br><span class="line">map&lt;string,<span class="type">int</span>&gt;mp;</span><br><span class="line">string name;</span><br><span class="line"><span class="type">int</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;name&gt;&gt;x;</span><br><span class="line"><span class="keyword">if</span>(!x) vis[i]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">add</span>(x,i);</span><br><span class="line"><span class="keyword">if</span>(!mp[name]) mp[name]=++t;</span><br><span class="line">c[i]=mp[name];</span><br><span class="line">&#125;</span><br><span class="line">cin&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;x&gt;&gt;y,qu[x].<span class="built_in">push_back</span>((node)&#123;i,y&#125;);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(vis[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">dfs1</span>(i,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">solve</span>(i);</span><br><span class="line"><span class="built_in">init</span>(i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Tree-Requests"><a href="#Tree-Requests" class="headerlink" title="Tree Requests"></a><a href="https://www.luogu.com.cn/problem/CF570D">Tree Requests</a></h4><p>终于比板子难一点了</p><p>由于是回文串，所以出现次数为奇数的种类数只能不超过$2$，然后就可做了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> idx,to[N&lt;&lt;<span class="number">1</span>],ne[N&lt;&lt;<span class="number">1</span>],head[N];</span><br><span class="line"><span class="type">int</span> c[N],ans[N],cnt[N][<span class="number">26</span>],ccnt[N];</span><br><span class="line"><span class="type">int</span> s[N],son[N],f[N],n,m,dep[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++idx]=y,ne[idx]=head[x],head[x]=idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[x]=<span class="number">1</span>,f[x]=fa,dep[x]=dep[fa]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(y,x),s[x]+=s[y];</span><br><span class="line"><span class="keyword">if</span>(s[y]&gt;s[son[x]]) son[x]=y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> d,res;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=ne[i]) <span class="keyword">if</span>(to[i]!=f[x]) <span class="built_in">add</span>(to[i]);</span><br><span class="line"><span class="keyword">if</span>((++cnt[dep[x]][c[x]])&amp;<span class="number">1</span>) ++ccnt[dep[x]];</span><br><span class="line"><span class="keyword">else</span> --ccnt[dep[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>((--cnt[dep[x]][c[x]])&amp;<span class="number">1</span>) ++ccnt[dep[x]];</span><br><span class="line"><span class="keyword">else</span> --ccnt[dep[x]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x])<span class="built_in">init</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> id,k;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;node&gt;qu[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(son[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x])</span><br><span class="line"><span class="built_in">solve</span>(y),<span class="built_in">init</span>(y),d=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">solve</span>(son[x]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i]) </span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=f[x]&amp;&amp;y!=son[x]) <span class="built_in">add</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>((++cnt[dep[x]][c[x]])&amp;<span class="number">1</span>) ++ccnt[dep[x]];</span><br><span class="line"><span class="keyword">else</span> --ccnt[dep[x]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;qu[x].<span class="built_in">size</span>();++i) ans[qu[x][i].id]=ccnt[qu[x][i].k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> str[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) cin&gt;&gt;x,<span class="built_in">add</span>(x,i);</span><br><span class="line">cin&gt;&gt;str+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) c[i]=str[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;x&gt;&gt;y,qu[x].<span class="built_in">push_back</span>((node)&#123;i,y&#125;);</span><br><span class="line"><span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">solve</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) <span class="built_in">puts</span>(ans[i]&gt;<span class="number">1</span>?<span class="string">&quot;No&quot;</span>:<span class="string">&quot;Yes&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 启发式算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>莫队</title>
      <link href="//OI/%E8%8E%AB%E9%98%9F/"/>
      <url>//OI/%E8%8E%AB%E9%98%9F/</url>
      
        <content type="html"><![CDATA[<p>暑假学的东西，现在才来写</p><span id="more"></span><p>先推荐<a href="https://www.cnblogs.com/WAMonster/p/10118934.html">莫队算法——从入门到紫题</a>&amp;&amp;<a href="https://www.luogu.com.cn/training/38213">dX的莫队题单</a></p><h3 id="普通莫队"><a href="#普通莫队" class="headerlink" title="普通莫队"></a>普通莫队</h3><p>口胡一下时间复杂度（默认$m，n$同阶）</p><p>左指针单次操作在块内移动次数为$O(\sqrt{n})$,n次操作加上从左往右总移动次数$O(n)$,左指针移动次数为$O(n\sqrt{n})$</p><p>右指针在左指针每块移动次数为$O(n)$，左指针共经过$O(\sqrt{n})$块，右指针总时间复杂度为$O(n\sqrt{n})$</p><p>所以普通莫队的时间复杂度为$O(n\sqrt{n}f(n)+nf’(n))$</p><p>（默认$n,m$同阶,$f(n)$为移动单次指针的代价，$f’(n)$为单次询问的代价）</p><p>但是这是极限数据，事实上莫队完全跑不到这么多，且莫队常数小，开了O2跑飞快，有图为证：</p><p><img src="/images/P4074.png"></p><p>普通莫队还有方法优化常数，具体见上面那篇文章</p><p>接下来讲下例题</p><h4 id="P5268-SNOI2017-一个简单的询问"><a href="#P5268-SNOI2017-一个简单的询问" class="headerlink" title="P5268 [SNOI2017]一个简单的询问"></a><a href="https://www.luogu.com.cn/problem/P5268">P5268 [SNOI2017]一个简单的询问</a></h4><p>这题直接做肯定是不可做的</p><p>但我们可以考虑容斥</p><p>由于$get(l,r,x)=get(1,r,x)−get(1,l−1,x)$</p><p>我们令$g(l,x)=get(1,l,x)$</p><p>则要求的是$\sum_{0}^{\infty} g(r1,x)g(r2,x)−g(r1,x)g(l2−1,x)−g(l1−1,x)g(r2,x)+g(l1−1,x)g(l2−1,x)$</p><p>然后拆成四个询问就能做了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,k,res;</span><br><span class="line"><span class="type">int</span> a[maxm],belong[maxm],ans[maxm],cnt1[maxm*<span class="number">2</span>],cnt2[maxm&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> l,r;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> qq &amp;x)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?(belong[l]&amp;<span class="number">1</span>?r&lt;x.r:r&gt;x.r):l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[maxm*<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">++cnt1[a[x]];</span><br><span class="line">res+=cnt2[a[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add2</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">++cnt2[a[x]];</span><br><span class="line">res+=cnt1[a[x]];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--cnt1[a[x]];</span><br><span class="line">res-=cnt2[a[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del2</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--cnt2[a[x]];</span><br><span class="line">res-=cnt1[a[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n=<span class="built_in">read</span>();</span><br><span class="line"><span class="type">int</span> Q=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> t=<span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">read</span>(),belong[i]=(i<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line">m=<span class="built_in">read</span>();</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l1=<span class="built_in">read</span>(),r1=<span class="built_in">read</span>(),l2=<span class="built_in">read</span>(),r2=<span class="built_in">read</span>();</span><br><span class="line">q[++Q]=qq&#123;r1,r2,i&#125;;</span><br><span class="line">q[++Q]=qq&#123;l1<span class="number">-1</span>,r2,-i&#125;;</span><br><span class="line">q[++Q]=qq&#123;l2<span class="number">-1</span>,r1,-i&#125;;</span><br><span class="line">q[++Q]=qq&#123;l1<span class="number">-1</span>,l2<span class="number">-1</span>,i&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i)<span class="keyword">if</span>(q[i].l&gt;q[i].r) <span class="built_in">swap</span>(q[i].l,q[i].r);</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+Q+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">add2</span>(++l);</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">del2</span>(l--);</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add1</span>(++r);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">del1</span>(r--);</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">abs</span>(q[i].id);</span><br><span class="line"><span class="keyword">if</span>(q[i].id&lt;<span class="number">0</span>) ans[k]-=res;</span><br><span class="line"><span class="keyword">else</span> ans[k]+=res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P4396-AHOI2013-作业"><a href="#P4396-AHOI2013-作业" class="headerlink" title="P4396 [AHOI2013]作业"></a><a href="https://www.luogu.com.cn/problem/P4396">P4396 [AHOI2013]作业</a></h4><p>这题我们可以联想到莫队（我也不知怎么想到的）</p><p>我们想一下莫队的复杂度$O(n\sqrt{n}f(n)+nf’(n))$</p><p>为了保证不鸡肋$f(n)$必须为$O(1)$(一般$O(logn)$就寄了)，$f’(n)$可以是$O(\sqrt{n})的$</p><p>$O(1)-O(\sqrt{n})$,你想到了什么，分块</p><p>我们对值域分块，再随便搞搞就过了</p><p>代码就不放了，<del>主要我也不知道当时为什么写莫队套树状数组，还能过</del></p><h4 id="P3730-曼哈顿交易"><a href="#P3730-曼哈顿交易" class="headerlink" title="P3730 曼哈顿交易"></a><a href="https://www.luogu.com.cn/problem/P3730">P3730 曼哈顿交易</a></h4><p>同理，真的差不多</p><p>放个代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,N1=<span class="number">505</span>;</span><br><span class="line"><span class="type">int</span> ans[N],a[N],idx,block,num,bl[N];</span><br><span class="line"><span class="type">int</span> v[N1],val[N],cnt[N];</span><br><span class="line"><span class="type">int</span> L[N1],R[N1];</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,k,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> bl[l]!=bl[res.l]?l&lt;res.l:(bl[l]&amp;<span class="number">1</span>?r&lt;res.r:r&gt;res.r);</span><br><span class="line">&#125;</span><br><span class="line">&#125;s[N];</span><br><span class="line">map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--v[bl[cnt[x]]],--val[cnt[x]];</span><br><span class="line">++cnt[x];</span><br><span class="line">++v[bl[cnt[x]]],++val[cnt[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--v[bl[cnt[x]]],--val[cnt[x]];</span><br><span class="line">--cnt[x];</span><br><span class="line">++v[bl[cnt[x]]],++val[cnt[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i)</span><br><span class="line"><span class="keyword">if</span>(k&gt;v[i]) k-=v[i];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L[i];j&lt;=R[i];++j)</span><br><span class="line"><span class="keyword">if</span>(k&gt;val[j]) k-=val[j];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> j;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;a[i];</span><br><span class="line"><span class="keyword">if</span>(!mp[a[i]]) mp[a[i]]=++idx;</span><br><span class="line">a[i]=mp[a[i]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;s[i].l&gt;&gt;s[i].r&gt;&gt;s[i].k,s[i].id=i;</span><br><span class="line">block=<span class="built_in">sqrt</span>(n),num=(n<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) bl[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i) L[i]=R[i<span class="number">-1</span>]+<span class="number">1</span>,R[i]=i*block;</span><br><span class="line">R[num]=n;</span><br><span class="line"><span class="built_in">sort</span>(&amp;s[<span class="number">1</span>],&amp;s[n+<span class="number">1</span>]);</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(r&lt;s[i].r) <span class="built_in">add</span>(a[++r]);</span><br><span class="line"><span class="keyword">while</span>(l&gt;s[i].l) <span class="built_in">add</span>(a[--l]);</span><br><span class="line"><span class="keyword">while</span>(l&lt;s[i].l) <span class="built_in">del</span>(a[l++]);</span><br><span class="line"><span class="keyword">while</span>(r&gt;s[i].r) <span class="built_in">del</span>(a[r--]);</span><br><span class="line">ans[s[i].id]=<span class="built_in">ask</span>(s[i].k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Tree-and-Queries"><a href="#Tree-and-Queries" class="headerlink" title="Tree and Queries"></a><a href="https://www.luogu.com.cn/problem/CF375D">Tree and Queries</a></h4><p>先把树转为dfn序，然后就是莫队板子了</p><p>代码不放了</p><h3 id="带修莫队"><a href="#带修莫队" class="headerlink" title="带修莫队"></a>带修莫队</h3><p>就多了一维，注意块长开$O(n^{\frac{2}{3}})$</p><p>好像没了</p><h4 id="P1903-国家集训队-数颜色-维护队列"><a href="#P1903-国家集训队-数颜色-维护队列" class="headerlink" title="P1903 [国家集训队] 数颜色 / 维护队列"></a><a href="https://www.luogu.com.cn/problem/P1903">P1903 [国家集训队] 数颜色 / 维护队列</a></h4><p>板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,k,res;</span><br><span class="line"><span class="type">int</span> a[maxm],belong[maxm],ans[maxm],cnt[<span class="number">1000005</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,t,id;</span><br><span class="line">&#125;q[maxm];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">xg</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">&#125;g[maxm];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">cmp</span><span class="params">(qq a, qq b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (belong[a.l] ^ belong[b.l]) ? belong[a.l] &lt; belong[b.l] : ((belong[a.r] ^ belong[b.r]) ? belong[a.r] &lt; belong[b.r] : a.t &lt; b.t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(++cnt[x]==<span class="number">1</span>) ++res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(--cnt[x]==<span class="number">0</span>) --res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n=<span class="built_in">read</span>(),m=<span class="built_in">read</span>();</span><br><span class="line"><span class="type">int</span> Q1=<span class="number">0</span>,Q2=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> t=<span class="built_in">pow</span>(n,<span class="number">2.0</span>/<span class="number">3.0</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">read</span>(),belong[i]=(i<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line"><span class="type">char</span> opt;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot; %c&quot;</span>,&amp;opt);</span><br><span class="line">x=<span class="built_in">read</span>(),y=<span class="built_in">read</span>();</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="string">&#x27;Q&#x27;</span>)++Q1,q[Q1]=&#123;x,y,Q2,Q1&#125;;</span><br><span class="line"><span class="keyword">else</span> g[++Q2]=&#123;x,y&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+Q1+<span class="number">1</span>,cmp);</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>;</span><br><span class="line">t=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q1;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add</span>(a[++r]);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">del</span>(a[r--]);</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">del</span>(a[l++]);</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add</span>(a[--l]);</span><br><span class="line"><span class="keyword">while</span>(t&lt;q[i].t)</span><br><span class="line">&#123;</span><br><span class="line">++t;</span><br><span class="line"><span class="keyword">if</span>(g[t].x&gt;=q[i].l&amp;&amp;g[t].x&lt;=q[i].r)<span class="built_in">del</span>(a[g[t].x]),<span class="built_in">add</span>(g[t].y);</span><br><span class="line"><span class="built_in">swap</span>(a[g[t].x],g[t].y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(t&gt;q[i].t)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(g[t].x&gt;=q[i].l&amp;&amp;g[t].x&lt;=q[i].r)<span class="built_in">del</span>(a[g[t].x]),<span class="built_in">add</span>(g[t].y);</span><br><span class="line"><span class="built_in">swap</span>(a[g[t].x],g[t].y);</span><br><span class="line">--t;</span><br><span class="line">&#125;</span><br><span class="line">ans[q[i].id]=res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q1;++i)<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Machine-Learning"><a href="#Machine-Learning" class="headerlink" title="Machine Learning"></a><a href="https://www.luogu.com.cn/problem/CF940F">Machine Learning</a></h4><p>也是板子，暴力取mex是$O(\sqrt{n})$的，不影响复杂度</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,k;</span><br><span class="line"><span class="type">int</span> ccnt[N],a[N],belong[N],ans[N],cnt[N],b[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,t,id;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">xg</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">&#125;g[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">cmp</span><span class="params">(qq a, qq b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (belong[a.l]^belong[b.l])?belong[a.l]&lt;belong[b.l]:((belong[a.r]^belong[b.r])?belong[a.r]&lt;belong[b.r]:a.t&lt;b.t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--ccnt[cnt[x]++];</span><br><span class="line">++ccnt[cnt[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--ccnt[cnt[x]--];</span><br><span class="line">++ccnt[cnt[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">mex</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(ccnt[res]) ++res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> idx;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">idx=n=<span class="built_in">read</span>(),m=<span class="built_in">read</span>();</span><br><span class="line"><span class="type">int</span> Q1=<span class="number">0</span>,Q2=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> t=<span class="built_in">pow</span>(n,<span class="number">2.0</span>/<span class="number">3.0</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) b[i]=a[i]=<span class="built_in">read</span>(),belong[i]=(i<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> opt,x,y;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line">opt=<span class="built_in">read</span>(),x=<span class="built_in">read</span>(),y=<span class="built_in">read</span>();</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>)++Q1,q[Q1]=&#123;x,y,Q2,Q1&#125;;</span><br><span class="line"><span class="keyword">else</span> g[++Q2]=&#123;x,y&#125;,b[++idx]=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(b+<span class="number">1</span>,b+idx+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+idx+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,a[i])-b;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q2;++i) g[i].y=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,g[i].y)-b;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+Q1+<span class="number">1</span>,cmp);</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>;</span><br><span class="line">t=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q1;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add</span>(a[++r]);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">del</span>(a[r--]);</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">del</span>(a[l++]);</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add</span>(a[--l]);</span><br><span class="line"><span class="keyword">while</span>(t&lt;q[i].t)</span><br><span class="line">&#123;</span><br><span class="line">++t;</span><br><span class="line"><span class="keyword">if</span>(g[t].x&gt;=q[i].l&amp;&amp;g[t].x&lt;=q[i].r)<span class="built_in">del</span>(a[g[t].x]),<span class="built_in">add</span>(g[t].y);</span><br><span class="line"><span class="built_in">swap</span>(a[g[t].x],g[t].y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(t&gt;q[i].t)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(g[t].x&gt;=q[i].l&amp;&amp;g[t].x&lt;=q[i].r)<span class="built_in">del</span>(a[g[t].x]),<span class="built_in">add</span>(g[t].y);</span><br><span class="line"><span class="built_in">swap</span>(a[g[t].x],g[t].y);</span><br><span class="line">--t;</span><br><span class="line">&#125;</span><br><span class="line">ans[q[i].id]=<span class="built_in">mex</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q1;++i)<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="回滚莫队"><a href="#回滚莫队" class="headerlink" title="回滚莫队"></a>回滚莫队</h3><p>当莫队的过程中我们无法用合理的代价添加或删除时，可以考虑只删除或不添加莫队，也就是回滚莫队</p><h4 id="歴史の研究"><a href="#歴史の研究" class="headerlink" title="歴史の研究"></a><a href="https://www.luogu.com.cn/problem/AT_joisc2014_c">歴史の研究</a></h4><p>这题我们在插入时可以$O(1)$判断，可删除时便不容易寻找答案，所以我们使用回滚莫队</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">1e5</span>+<span class="number">5</span>,maxn=<span class="number">1e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,Q,t,t1;</span><br><span class="line"><span class="type">int</span> belong[maxm],a[maxm],b[maxm],R[maxn],cnt[maxm],cnt1[maxm],ans[maxm];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> query&amp;x)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?r&lt;x.r:l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[maxm];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;x,<span class="type">int</span> &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">++cnt[x];</span><br><span class="line">res=<span class="built_in">max</span>(res,cnt[x]*b[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--cnt[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;x,<span class="type">int</span> &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">++cnt1[x];</span><br><span class="line">res=<span class="built_in">max</span>(res,cnt1[x]*b[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--cnt1[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;Q;</span><br><span class="line">t=<span class="built_in">sqrt</span>(n*n/Q);</span><br><span class="line">t1=(n<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t1;++i) R[i]=i*t;</span><br><span class="line">R[t1]=n;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],b[i]=a[i],belong[i]=(i<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,a[i])-b;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i) cin&gt;&gt;q[i].l&gt;&gt;q[i].r,q[i].id=i;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+Q+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> res,res1,last=<span class="number">0</span>,l=<span class="number">1</span>,r=<span class="number">0</span>,ll;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(belong[q[i].l]==belong[q[i].r])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=q[i].l;j&lt;=q[i].r;++j) <span class="built_in">add1</span>(a[j],ans[q[i].id]);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=q[i].l;j&lt;=q[i].r;++j) <span class="built_in">del1</span>(a[j]);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(belong[q[i].l]!=last)</span><br><span class="line">&#123;</span><br><span class="line">last=belong[q[i].l];</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=l;j&lt;=r;++j) <span class="built_in">del</span>(a[j]);</span><br><span class="line">l=R[last]+<span class="number">1</span>,r=l<span class="number">-1</span>;</span><br><span class="line">ll=l;</span><br><span class="line">res=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add</span>(a[++r],res);</span><br><span class="line">res1=res;</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add</span>(a[--l],res1);</span><br><span class="line"><span class="keyword">while</span>(l&lt;ll) <span class="built_in">del</span>(a[l++]);</span><br><span class="line">ans[q[i].id]=res1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P5906-【模板】回滚莫队-amp-不删除莫队"><a href="#P5906-【模板】回滚莫队-amp-不删除莫队" class="headerlink" title="P5906 【模板】回滚莫队&amp;不删除莫队  "></a><a href="https://www.luogu.com.cn/problem/P5906">P5906 【模板】回滚莫队&amp;不删除莫队  </a></h4><p>板子，没什么说的</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,Q,t,t1;</span><br><span class="line"><span class="type">int</span> last,l=<span class="number">1</span>,r,res,res1;</span><br><span class="line"><span class="type">int</span> a[maxm],belong[maxm],b[maxm],R[maxm],ans[maxm],pre[maxm],pre1[maxm],suc[maxm],suc2[maxm];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> qq &amp;res)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[res.l]?r&lt;res.r:l&lt;res.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[maxm];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n=<span class="built_in">read</span>();</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) b[i]=a[i]=<span class="built_in">read</span>();</span><br><span class="line">Q=<span class="built_in">read</span>();</span><br><span class="line">t=<span class="built_in">sqrt</span>(n);</span><br><span class="line">t1=(n<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) belong[i]=(i<span class="number">-1</span>)/t+<span class="number">1</span>,a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,a[i])-b;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i) q[i]=qq&#123;<span class="built_in">read</span>(),<span class="built_in">read</span>(),i&#125;;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+Q+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t1;++i) R[i]=i*t;</span><br><span class="line">R[t1]=n;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(belong[q[i].l]==belong[q[i].r])</span><br><span class="line">&#123;</span><br><span class="line">res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=q[i].l;j&lt;=q[i].r;++j) pre1[a[j]]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=q[i].l;j&lt;=q[i].r;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!pre1[a[j]]) pre1[a[j]]=j;</span><br><span class="line">res=<span class="built_in">max</span>(res,j-pre1[a[j]]);</span><br><span class="line">&#125;</span><br><span class="line">ans[q[i].id]=res;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(belong[q[i].l]!=last)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=l;j&lt;=r;++j) suc[a[j]]=pre[a[j]]=<span class="number">0</span>;</span><br><span class="line">l=R[belong[q[i].l]]+<span class="number">1</span>,r=l<span class="number">-1</span>;</span><br><span class="line">res1=res=<span class="number">0</span>;</span><br><span class="line">last=belong[q[i].l];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r)</span><br><span class="line">&#123;</span><br><span class="line">++r;</span><br><span class="line">suc[a[r]]=r;</span><br><span class="line"><span class="keyword">if</span>(!pre[a[r]]) pre[a[r]]=r;</span><br><span class="line">res=<span class="built_in">max</span>(res,r-pre[a[r]]);</span><br><span class="line">&#125;</span><br><span class="line">res1=res;</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!suc[a[--l]]) suc[a[l]]=l;</span><br><span class="line">res1=<span class="built_in">max</span>(res1,suc[a[l]]-l);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(l&lt;R[belong[q[i].l]]+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(suc[a[l]]==l)suc[a[l]]=<span class="number">0</span>;</span><br><span class="line">++l;</span><br><span class="line">&#125;</span><br><span class="line">ans[q[i].id]=res1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P3709-大爷的字符串题"><a href="#P3709-大爷的字符串题" class="headerlink" title="P3709 大爷的字符串题  "></a><a href="https://www.luogu.com.cn/problem/P3709">P3709 大爷的字符串题  </a></h4><p>就是求区间众数的出现次数（普通莫队也能做）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> R[N],block,num,n,m;</span><br><span class="line"><span class="type">int</span> bl[N],idx,a[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node &amp;res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> bl[l]==bl[res.l]?r&lt;res.r:l&lt;res.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="type">int</span> cnt[N],ans[N],last,l=<span class="number">1</span>,r,res,p;</span><br><span class="line"><span class="type">int</span> b[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">block=<span class="built_in">sqrt</span>(n),num=(n<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i) R[i]=i*block;</span><br><span class="line">R[num]=n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">cin&gt;&gt;a[i],b[i]=a[i],bl[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,a[i])-b;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;q[i].l&gt;&gt;q[i].r,q[i].id=i;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+m+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(bl[q[i].l]==bl[q[i].r])</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> res1=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=q[i].l;j&lt;=q[i].r;++j) cnt[a[j]]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=q[i].l;j&lt;=q[i].r;++j) res1=<span class="built_in">max</span>(res1,++cnt[a[j]]);</span><br><span class="line">ans[q[i].id]=res1;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(last!=bl[q[i].l])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(r&gt;R[bl[q[i].l]]) cnt[a[r--]]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(l&lt;=R[bl[q[i].l]]) cnt[a[l++]]=<span class="number">0</span>;</span><br><span class="line">r=l<span class="number">-1</span>,p=l,res=<span class="number">0</span>,last=bl[q[i].l];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) res=<span class="built_in">max</span>(res,++cnt[a[++r]]);</span><br><span class="line"><span class="type">int</span> res1=res;</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) res1=<span class="built_in">max</span>(res1,++cnt[a[--l]]);</span><br><span class="line"><span class="keyword">while</span>(l&lt;p) --cnt[a[l++]];</span><br><span class="line">ans[q[i].id]=res1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;<span class="string">&quot;-&quot;</span>&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="树上莫队"><a href="#树上莫队" class="headerlink" title="树上莫队"></a>树上莫队</h3><p><del>就是在树上跑莫队</del></p><p>不，是在欧拉序上莫队，也就多个lca</p><p>此时我才体会到前开后闭有多妙</p><h4 id="COT2-Count-on-a-tree-II"><a href="#COT2-Count-on-a-tree-II" class="headerlink" title="COT2 - Count on a tree II  "></a><a href="https://www.luogu.com.cn/problem/SP10707">COT2 - Count on a tree II  </a></h4><p>板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[N],head[N],ne[N],tot;</span><br><span class="line"><span class="type">int</span> n,m,res;</span><br><span class="line"><span class="type">int</span> ans[N],s[N],v[N],cnt[N],belong[N],block,num,vis[N],b[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=head[x],head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[N][<span class="number">21</span>];</span><br><span class="line"><span class="type">int</span> st[N],ed[N],idx;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[++idx]=x,st[x]=idx,f[x][<span class="number">0</span>]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;f[x][i<span class="number">-1</span>];++i) f[x][i]=f[f[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=fa)<span class="built_in">dfs</span>(y,x);</span><br><span class="line">s[++idx]=x,ed[x]=idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,lca,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> qq &amp;x)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?(belong[l]&amp;<span class="number">1</span>?r&lt;x.r:r&gt;x.r):l&lt;x.l;</span><br><span class="line">&#125; </span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> st[x]&lt;=st[y]&amp;&amp;ed[x]&gt;=ed[y];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(y,x)) <span class="keyword">return</span> y;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(x,y)) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line"><span class="keyword">if</span>(f[x][i]&amp;&amp;!<span class="built_in">pd</span>(f[x][i],y))x=f[x][i];</span><br><span class="line"><span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vis[x]^=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(vis[x])&#123;<span class="keyword">if</span>(++cnt[v[x]]==<span class="number">1</span>) ++res;&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(--cnt[v[x]]==<span class="number">0</span>) --res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">block=<span class="built_in">sqrt</span>(<span class="number">2</span>*n);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>*n;++i) belong[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;v[i],b[i]=v[i];</span><br><span class="line"><span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) v[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,v[i])-b;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">lca</span>(x,y);</span><br><span class="line"><span class="keyword">if</span>(x==k||y==k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(st[y]&lt;st[x]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">q[i]=&#123;st[x],st[y],<span class="number">0</span>,i&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ed[y]&lt;st[x]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">q[i]=&#123;ed[x],st[y],k,i&#125;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+m+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add</span>(s[--l]);</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add</span>(s[++r]);</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">add</span>(s[l++]);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">add</span>(s[r--]);</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add</span>(q[i].lca);</span><br><span class="line">ans[q[i].id]=res;</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add</span>(q[i].lca);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P4074-WC2013-糖果公园"><a href="#P4074-WC2013-糖果公园" class="headerlink" title="P4074 [WC2013] 糖果公园  "></a><a href="https://www.luogu.com.cn/problem/P4074">P4074 [WC2013] 糖果公园  </a></h4><p>树上带修莫队，<del>超级套娃</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[N],f[N],ne[N],tot,l=<span class="number">1</span>,r,ti;</span><br><span class="line"><span class="type">int</span> n,m,res,Q;</span><br><span class="line"><span class="type">int</span> w[N],c[N];</span><br><span class="line"><span class="type">int</span> ans[N],s[N],v[N],cnt[N],belong[N],block,num,vis[N],b[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=f[x],f[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> fa[N][<span class="number">21</span>];</span><br><span class="line"><span class="type">int</span> st[N],ed[N],t;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> dad)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[++t]=x,st[x]=t;</span><br><span class="line">fa[x][<span class="number">0</span>]=dad;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">20</span>;++i)</span><br><span class="line">fa[x][i]=fa[fa[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=dad)<span class="built_in">dfs</span>(y,x);</span><br><span class="line">s[++t]=x,ed[x]=t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,lca,t,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> qq &amp;x)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?(belong[r]==belong[x.r]?t&lt;x.t:r&lt;x.r):l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">xg</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">&#125;g[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> st[x]&lt;=st[y]&amp;&amp;ed[x]&gt;=ed[y];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(y,x)) <span class="keyword">return</span> y;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(x,y)) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>;~i;--i)</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">pd</span>(fa[x][i],y)&amp;&amp;fa[x][i])x=fa[x][i];</span><br><span class="line"><span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">x=s[x],vis[x]^=<span class="number">1</span>;</span><br><span class="line">res-=w[cnt[c[x]]]*v[c[x]];</span><br><span class="line"><span class="keyword">if</span>(vis[x]) ++cnt[c[x]];</span><br><span class="line"><span class="keyword">else</span> --cnt[c[x]];</span><br><span class="line">res+=w[cnt[c[x]]]*v[c[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> x1=st[g[x].x],x2=ed[g[x].x];</span><br><span class="line"><span class="keyword">if</span>(x1&gt;=l&amp;&amp;x1&lt;=r) <span class="built_in">add1</span>(x1);</span><br><span class="line"><span class="keyword">if</span>(x2&gt;=l&amp;&amp;x2&lt;=r) <span class="built_in">add1</span>(x2);</span><br><span class="line"><span class="built_in">swap</span>(c[s[x1]],g[x].y);</span><br><span class="line"><span class="keyword">if</span>(x1&gt;=l&amp;&amp;x1&lt;=r) <span class="built_in">add1</span>(x1);</span><br><span class="line"><span class="keyword">if</span>(x2&gt;=l&amp;&amp;x2&lt;=r) <span class="built_in">add1</span>(x2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m&gt;&gt;Q;</span><br><span class="line"><span class="type">int</span> QQ=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">block=<span class="built_in">pow</span>(<span class="number">2</span>*n,<span class="number">2.0</span>/<span class="number">3.0</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>*n;++i) belong[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;v[i];</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;w[i],w[i]+=w[i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i)</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;c[i];</span><br><span class="line"><span class="type">int</span> T=<span class="number">0</span>,ty;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;ty&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">if</span>(ty)</span><br><span class="line">&#123;</span><br><span class="line">++QQ;</span><br><span class="line">    <span class="type">int</span> k=<span class="built_in">lca</span>(x,y);</span><br><span class="line"><span class="keyword">if</span>(x==k||y==k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(st[y]&lt;st[x]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">q[QQ]=&#123;st[x],st[y],<span class="number">0</span>,T,QQ&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ed[y]&lt;st[x]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">q[QQ]=&#123;ed[x],st[y],k,T,QQ&#125;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> g[++T]=&#123;x,y&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+QQ+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=QQ;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add1</span>(--l);</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">add1</span>(l++);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">add1</span>(r--);</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add1</span>(++r);</span><br><span class="line"><span class="keyword">while</span>(ti&lt;q[i].t) <span class="built_in">up</span>(++ti);</span><br><span class="line"><span class="keyword">while</span>(ti&gt;q[i].t) <span class="built_in">up</span>(ti--);</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add1</span>(st[q[i].lca]);</span><br><span class="line">ans[q[i].id]=res;</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add1</span>(st[q[i].lca]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=QQ;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ADAFTBLL-Ada-and-Football"><a href="#ADAFTBLL-Ada-and-Football" class="headerlink" title="ADAFTBLL - Ada and Football  "></a><a href="https://www.luogu.com.cn/problem/SP32952">ADAFTBLL - Ada and Football  </a></h4><p>也是板子</p><p>贴个代码以纪念我块长取$\sqrt{n}$而爆炸的操作</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> head[N],to[N],ne[N],toto;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++toto]=y,ne[toto]=head[x],head[x]=toto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[N][<span class="number">21</span>];</span><br><span class="line"><span class="type">int</span> s[N],idx,st[N],ed[N]; </span><br><span class="line"><span class="type">int</span> n,m,v[N],bl[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[++idx]=x,st[x]=idx,f[x][<span class="number">0</span>]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;f[x][i];++i) f[x][i+<span class="number">1</span>]=f[f[x][i]][i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>(to[i]!=fa) <span class="built_in">dfs</span>(to[i],x);</span><br><span class="line">s[++idx]=x,ed[x]=idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">xg</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">&#125;g[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,lca,t,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> query x)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> bl[l]==bl[x.l]?(bl[r]==bl[x.r]?t&lt;x.t:r&lt;x.r):l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> st[x]&lt;=st[y]&amp;&amp;ed[x]&gt;=ed[y];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(x,y)) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(y,x)) <span class="keyword">return</span> y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>;~i;--i)</span><br><span class="line"><span class="keyword">if</span>(f[x][i]&amp;&amp;!<span class="built_in">pd</span>(f[x][i],y)) x=f[x][i];</span><br><span class="line"><span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> Q,T,ans[N],vis[N],res,cnt[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vis[x]^=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(vis[x]) res+=(cnt[v[x]]++);</span><br><span class="line"><span class="keyword">else</span> res-=(--cnt[v[x]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;v[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,++x,++y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> opt,x,y,i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;x&gt;&gt;y,++x;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) g[++T]=&#123;x,y&#125;;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">++y,++Q;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">lca</span>(x,y);</span><br><span class="line"><span class="keyword">if</span>(k==x||k==y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(st[y]&lt;st[x]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">q[Q]=&#123;st[x],st[y],<span class="number">0</span>,T,Q&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ed[y]&lt;st[x]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">q[Q]=&#123;ed[x],st[y],k,T,Q&#125;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> block=<span class="built_in">pow</span>(<span class="number">2</span>*n,<span class="number">0.666666</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>*n;++i) bl[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+Q+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">add</span>(s[l++]);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">add</span>(s[r--]);</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add</span>(s[--l]);</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add</span>(s[++r]);</span><br><span class="line"><span class="keyword">while</span>(t&lt;q[i].t)</span><br><span class="line">&#123;</span><br><span class="line">++t;</span><br><span class="line"><span class="type">int</span> k1=st[g[t].x],k2=ed[g[t].x];</span><br><span class="line"><span class="keyword">if</span>(k1&gt;=l&amp;&amp;k1&lt;=r) <span class="built_in">add</span>(s[k1]);</span><br><span class="line"><span class="keyword">if</span>(k2&gt;=l&amp;&amp;k2&lt;=r) <span class="built_in">add</span>(s[k2]);</span><br><span class="line"><span class="built_in">swap</span>(v[g[t].x],g[t].y);</span><br><span class="line"><span class="keyword">if</span>(k1&gt;=l&amp;&amp;k1&lt;=r) <span class="built_in">add</span>(s[k1]);</span><br><span class="line"><span class="keyword">if</span>(k2&gt;=l&amp;&amp;k2&lt;=r) <span class="built_in">add</span>(s[k2]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(t&gt;q[i].t)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> k1=st[g[t].x],k2=ed[g[t].x];</span><br><span class="line"><span class="keyword">if</span>(k1&gt;=l&amp;&amp;k1&lt;=r) <span class="built_in">add</span>(s[k1]);</span><br><span class="line"><span class="keyword">if</span>(k2&gt;=l&amp;&amp;k2&lt;=r) <span class="built_in">add</span>(s[k2]);</span><br><span class="line"><span class="built_in">swap</span>(v[g[t].x],g[t].y);</span><br><span class="line"><span class="keyword">if</span>(k1&gt;=l&amp;&amp;k1&lt;=r) <span class="built_in">add</span>(s[k1]);</span><br><span class="line"><span class="keyword">if</span>(k2&gt;=l&amp;&amp;k2&lt;=r) <span class="built_in">add</span>(s[k2]);</span><br><span class="line">--t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add</span>(q[i].lca);</span><br><span class="line">ans[q[i].id]=res;</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add</span>(q[i].lca);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P4175-CTSC2008-网络管理"><a href="#P4175-CTSC2008-网络管理" class="headerlink" title="P4175 [CTSC2008]网络管理  "></a><a href="https://www.luogu.com.cn/problem/P4175">P4175 [CTSC2008]网络管理  </a></h4><p>树上带修第$K$大</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[N],f[N],ne[N],tot,l=<span class="number">1</span>,r,ti;</span><br><span class="line"><span class="type">int</span> n,m,res,Q,su,block1,num1,L[N],R[N];</span><br><span class="line"><span class="type">int</span> w[N],c[N];</span><br><span class="line"><span class="type">int</span> ans[N],s[N],v[N],cnt[N],belong[N],block,num,vis[N],b[N],belong1[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">int</span> ss[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=f[x],f[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> fa[N][<span class="number">21</span>];</span><br><span class="line"><span class="type">int</span> st[N],ed[N],t;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> dad)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[++t]=x,st[x]=t;</span><br><span class="line">fa[x][<span class="number">0</span>]=dad;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">20</span>;++i)</span><br><span class="line">fa[x][i]=fa[fa[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=dad)<span class="built_in">dfs</span>(y,x);</span><br><span class="line">s[++t]=x,ed[x]=t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,lca,t,k,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> qq &amp;x)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?(belong[r]==belong[x.r]?t&lt;x.t:r&lt;x.r):l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">xg</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">&#125;g[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> st[x]&lt;=st[y]&amp;&amp;ed[x]&gt;=ed[y];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(y,x)) <span class="keyword">return</span> y;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(x,y)) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">pd</span>(fa[x][i],y)&amp;&amp;fa[x][i]!=<span class="number">0</span>)x=fa[x][i];</span><br><span class="line"><span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">x=s[x],vis[x]^=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> y=v[x];</span><br><span class="line"><span class="keyword">if</span>(vis[x]) ++cnt[y],++ss[belong1[y]];</span><br><span class="line"><span class="keyword">else</span> --cnt[y],--ss[belong1[y]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">re <span class="type">int</span> res=num1;</span><br><span class="line"><span class="keyword">for</span>(;res;--res)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(k&gt;ss[res]) k-=ss[res];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!res) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=R[res];i&gt;=L[res];--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(k&lt;=cnt[i]) <span class="keyword">return</span> sum[i];</span><br><span class="line"><span class="keyword">else</span> k-=cnt[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> x1=st[g[x].x],x2=ed[g[x].x];</span><br><span class="line"><span class="keyword">if</span>(x1&gt;=l&amp;&amp;x1&lt;=r) <span class="built_in">add1</span>(x1);</span><br><span class="line"><span class="keyword">if</span>(x2&gt;=l&amp;&amp;x2&lt;=r) <span class="built_in">add1</span>(x2);</span><br><span class="line"><span class="built_in">swap</span>(v[s[x1]],g[x].y);</span><br><span class="line"><span class="keyword">if</span>(x1&gt;=l&amp;&amp;x1&lt;=r) <span class="built_in">add1</span>(x1);</span><br><span class="line"><span class="keyword">if</span>(x2&gt;=l&amp;&amp;x2&lt;=r) <span class="built_in">add1</span>(x2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;Q;</span><br><span class="line"><span class="type">int</span> QQ=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">block=<span class="built_in">pow</span>(<span class="number">2</span>*n,<span class="number">2.0</span>/<span class="number">3.0</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>*n;++i) belong[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;v[i],sum[++su]=v[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> T=<span class="number">0</span>,ty;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;ty&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">if</span>(ty)</span><br><span class="line">&#123;</span><br><span class="line">++QQ;</span><br><span class="line"><span class="keyword">if</span>(st[x]&gt;st[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    <span class="type">int</span> k=<span class="built_in">lca</span>(x,y);</span><br><span class="line"><span class="keyword">if</span>(x==k) q[QQ]=&#123;st[x],st[y],<span class="number">0</span>,T,ty,QQ&#125;;</span><br><span class="line"><span class="keyword">else</span>q[QQ]=&#123;ed[x],st[y],k,T,ty,QQ&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> g[++T]=&#123;x,y&#125;,sum[++su]=y;</span><br><span class="line">&#125;</span><br><span class="line">block1=<span class="built_in">pow</span>(su,<span class="number">2.0</span>/<span class="number">3.0</span>);</span><br><span class="line">num1=(su<span class="number">-1</span>)/block1+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=num1;++i) L[i]=(i<span class="number">-1</span>)*block1<span class="number">-1</span>,R[i]=i*block1;</span><br><span class="line">R[num1]=su;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=su;++i) belong1[i]=(i<span class="number">-1</span>)/block1+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+QQ+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">sort</span>(sum+<span class="number">1</span>,sum+su+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(sum+<span class="number">1</span>,sum+su+<span class="number">1</span>)-sum<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) v[i]=<span class="built_in">lower_bound</span>(sum+<span class="number">1</span>,sum+M+<span class="number">1</span>,v[i])-sum;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=T;++i) g[i].y=<span class="built_in">lower_bound</span>(sum+<span class="number">1</span>,sum+M+<span class="number">1</span>,g[i].y)-sum;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=QQ;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add1</span>(--l);</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">add1</span>(l++);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">add1</span>(r--);</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add1</span>(++r);</span><br><span class="line"><span class="keyword">while</span>(ti&lt;q[i].t) <span class="built_in">up</span>(++ti);</span><br><span class="line"><span class="keyword">while</span>(ti&gt;q[i].t) <span class="built_in">up</span>(ti--);</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add1</span>(st[q[i].lca]);</span><br><span class="line">ans[q[i].id]=<span class="built_in">ask</span>(q[i].k);</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add1</span>(st[q[i].lca]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=QQ;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ans[i]==<span class="number">-1</span>) cout&lt;&lt;<span class="string">&quot;invalid request!&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="莫队二次离线"><a href="#莫队二次离线" class="headerlink" title="莫队二次离线"></a>莫队二次离线</h3><p>$\text{lxl}$神仙发明的黑科技</p><p>先膜为敬</p><h4 id="P4887-【模板】莫队二次离线（第十四分块-前体-）"><a href="#P4887-【模板】莫队二次离线（第十四分块-前体-）" class="headerlink" title="P4887 【模板】莫队二次离线（第十四分块(前体)）  "></a><a href="https://www.luogu.com.cn/problem/P4887">P4887 【模板】莫队二次离线（第十四分块(前体)）  </a></h4><p>板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,k,block;</span><br><span class="line"><span class="type">int</span> cnt[N],a[N],g[N];</span><br><span class="line"><span class="type">int</span> bl[N];</span><br><span class="line">ll ans[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;s;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line">ll v;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> query &amp;res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> bl[l]!=bl[res.l]?l&lt;res.l:r&lt;res.r;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ask</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,v,id;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;ask&gt;rg[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getcount</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) ++res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m&gt;&gt;k,block=<span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],bl[i]=i/block;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;<span class="number">14</span>;++i) <span class="keyword">if</span>(<span class="built_in">getcount</span>(i)==k) s.<span class="built_in">push_back</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;q[i].l&gt;&gt;q[i].r,q[i].id=i;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+m+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">g[i]=cnt[a[i]];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> x:s) ++cnt[a[i]^x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="keyword">sizeof</span> cnt);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,L=<span class="number">1</span>,R=<span class="number">0</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l=q[i].l,r=q[i].r;</span><br><span class="line"><span class="keyword">if</span>(R&gt;r) rg[L<span class="number">-1</span>].<span class="built_in">push_back</span>((ask)&#123;r+<span class="number">1</span>,R,<span class="number">1</span>,i&#125;);</span><br><span class="line"><span class="keyword">while</span>(R&gt;r) q[i].v-=g[R--];</span><br><span class="line"><span class="keyword">if</span>(R&lt;r) rg[L<span class="number">-1</span>].<span class="built_in">push_back</span>((ask)&#123;R+<span class="number">1</span>,r,<span class="number">-1</span>,i&#125;);</span><br><span class="line"><span class="keyword">while</span>(R&lt;r) q[i].v+=g[++R];</span><br><span class="line"><span class="keyword">if</span>(L&lt;l) rg[R].<span class="built_in">push_back</span>((ask)&#123;L,l<span class="number">-1</span>,<span class="number">-1</span>,i&#125;);</span><br><span class="line"><span class="keyword">while</span>(L&lt;l) q[i].v+=g[L++]+!k;</span><br><span class="line"><span class="keyword">if</span>(L&gt;l) rg[R].<span class="built_in">push_back</span>((ask)&#123;l,L<span class="number">-1</span>,<span class="number">1</span>,i&#125;);</span><br><span class="line"><span class="keyword">while</span>(L&gt;l) q[i].v-=g[--L]+!k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> x:s) ++cnt[a[i]^x];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> u:rg[i])</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> p=u.l;p&lt;=u.r;++p) q[u.id].v+=cnt[a[p]]*u.v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) q[i].v+=q[i<span class="number">-1</span>].v,ans[q[i].id]=q[i].v;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P5047-Ynoi2019-模拟赛-Yuno-loves-sqrt-technology-II"><a href="#P5047-Ynoi2019-模拟赛-Yuno-loves-sqrt-technology-II" class="headerlink" title="P5047 [Ynoi2019 模拟赛] Yuno loves sqrt technology II  "></a><a href="https://www.luogu.com.cn/problem/P5047">P5047 [Ynoi2019 模拟赛] Yuno loves sqrt technology II  </a></h4><p>也是板子，贴个代码以纪念把全局变量打成局部变量而爆炸的我</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>,N1=<span class="number">505</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BIT</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> n,c[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _n)</span></span>&#123;n=_n;<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)c[i]=<span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span>&#123;<span class="keyword">for</span>(;x&lt;=n;x+=<span class="built_in">lowbit</span>(x)) c[x]+=v;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="type">int</span> res=<span class="number">0</span>;<span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) res+=c[x];<span class="keyword">return</span> res;&#125;</span><br><span class="line">&#125;t;</span><br><span class="line"><span class="type">int</span> block,n,m,a[N];</span><br><span class="line"><span class="type">int</span> bl[N],Lp[N1],Rp[N1],bk;</span><br><span class="line">ll cnt[N],tag[N1];</span><br><span class="line"><span class="type">int</span> num[N];</span><br><span class="line">ll ans[N],lv[N],rv[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> query &amp;res)<span class="type">const</span>&#123;<span class="keyword">return</span> bl[l]==bl[res.l]?r&lt;res.r:l&lt;res.l;&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">rag</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id,v;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;rag&gt;rg[<span class="number">2</span>][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addL</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x;i&gt;=Lp[bl[x]];--i) ++cnt[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=bl[x]<span class="number">-1</span>;i&gt;<span class="number">0</span>;--i) ++tag[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addR</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x;i&lt;=Rp[bl[x]];++i) ++cnt[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=bl[x]+<span class="number">1</span>;i&lt;=bl[n];++i) ++tag[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> cnt[x]+tag[bl[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">block=<span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],num[i]=a[i];</span><br><span class="line"><span class="built_in">sort</span>(num+<span class="number">1</span>,num+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(num+<span class="number">1</span>,num+n+<span class="number">1</span>)-num<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(num+<span class="number">1</span>,num+M+<span class="number">1</span>,a[i])-num;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) bl[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=bl[n];++i) Lp[i]=Rp[i<span class="number">-1</span>]+<span class="number">1</span>,Rp[i]=i*block;</span><br><span class="line">Rp[bl[n]]=n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;q[i].l&gt;&gt;q[i].r,q[i].id=i;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+m+<span class="number">1</span>);</span><br><span class="line">t.<span class="built_in">init</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">lv[i]=lv[i<span class="number">-1</span>]+t.<span class="built_in">ask</span>(n)-t.<span class="built_in">ask</span>(a[i]),t.<span class="built_in">add</span>(a[i],<span class="number">1</span>);</span><br><span class="line">t.<span class="built_in">init</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i;--i)</span><br><span class="line">rv[i]=rv[i+<span class="number">1</span>]+t.<span class="built_in">ask</span>(a[i]<span class="number">-1</span>),t.<span class="built_in">add</span>(a[i],<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> L=<span class="number">1</span>,R=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l=q[i].l,r=q[i].r,id=q[i].id;</span><br><span class="line"><span class="keyword">if</span>(R&lt;r)</span><br><span class="line">rg[<span class="number">0</span>][L<span class="number">-1</span>].<span class="built_in">push_back</span>((rag)&#123;R+<span class="number">1</span>,r,id,<span class="number">-1</span>&#125;);</span><br><span class="line"><span class="keyword">if</span>(R&gt;r)</span><br><span class="line">rg[<span class="number">0</span>][L<span class="number">-1</span>].<span class="built_in">push_back</span>((rag)&#123;r+<span class="number">1</span>,R,id,<span class="number">1</span>&#125;);</span><br><span class="line"><span class="keyword">if</span>(L&gt;l)</span><br><span class="line">rg[<span class="number">1</span>][r+<span class="number">1</span>].<span class="built_in">push_back</span>((rag)&#123;l,L<span class="number">-1</span>,id,<span class="number">-1</span>&#125;);</span><br><span class="line"><span class="keyword">if</span>(l&gt;L)</span><br><span class="line">rg[<span class="number">1</span>][r+<span class="number">1</span>].<span class="built_in">push_back</span>((rag)&#123;L,l<span class="number">-1</span>,id,<span class="number">1</span>&#125;);</span><br><span class="line">ans[id]+=rv[l]-rv[L]+lv[r]-lv[R];</span><br><span class="line">L=l,R=r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">addL</span>(a[i]<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> x:rg[<span class="number">0</span>][i])</span><br><span class="line">&#123;</span><br><span class="line">ll res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=x.l;j&lt;=x.r;++j) res+=<span class="built_in">ask</span>(a[j]);</span><br><span class="line">ans[x.id]+=x.v*res;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="keyword">sizeof</span> cnt);</span><br><span class="line"><span class="built_in">memset</span>(tag,<span class="number">0</span>,<span class="keyword">sizeof</span> tag);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">addR</span>(a[i]+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> x:rg[<span class="number">1</span>][i])</span><br><span class="line">&#123;</span><br><span class="line">ll res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=x.l;j&lt;=x.r;++j) res+=<span class="built_in">ask</span>(a[j]);</span><br><span class="line">ans[x.id]+=x.v*res;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) ans[q[i].id]+=ans[q[i<span class="number">-1</span>].id];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P5501-LnOI2019-来者不拒，去者不追"><a href="#P5501-LnOI2019-来者不拒，去者不追" class="headerlink" title="P5501 [LnOI2019]来者不拒，去者不追"></a><a href="https://www.luogu.com.cn/problem/P5501">P5501 [LnOI2019]来者不拒，去者不追</a></h4><p>先咕着</p><h3 id="莫队-bitset"><a href="#莫队-bitset" class="headerlink" title="莫队+bitset"></a>莫队+bitset</h3><p>有些题我们能在$O(n\sqrt{n}+\frac{n^{2}}{w})$的时间复杂度内解决问题</p><p>则可用莫队+$bitset$</p><h4 id="P3674-小清新人渣的本愿"><a href="#P3674-小清新人渣的本愿" class="headerlink" title="P3674 小清新人渣的本愿  "></a><a href="https://www.luogu.com.cn/problem/P3674">P3674 小清新人渣的本愿  </a></h4><p>板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">1e5</span>+<span class="number">5</span>,N=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> a[maxm],belong[maxm],ans[maxm],cnt[maxm];</span><br><span class="line">bitset&lt;maxm&gt;s,s1,k;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> opt,l,r,x,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> qq &amp;x)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?(belong[l]&amp;<span class="number">1</span>?r&lt;x.r:r&gt;x.r):l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[maxm];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(++cnt[a[x]]==<span class="number">1</span>) s[a[x]]=s1[N-a[x]]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(--cnt[a[x]]==<span class="number">0</span>) s[a[x]]=s1[N-a[x]]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n=<span class="built_in">read</span>(),m=<span class="built_in">read</span>();</span><br><span class="line"><span class="type">int</span> t=<span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">read</span>(),belong[i]=(i<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) q[i]=qq&#123;<span class="built_in">read</span>(),<span class="built_in">read</span>(),<span class="built_in">read</span>(),<span class="built_in">read</span>(),i&#125;;</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+m+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">del</span>(l++);</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add</span>(--l);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">del</span>(r--);</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add</span>(++r);</span><br><span class="line"><span class="keyword">if</span>(q[i].opt==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">k=s&amp;(s&lt;&lt;q[i].x);</span><br><span class="line">ans[q[i].id]=k.<span class="built_in">any</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(q[i].opt==<span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">k=s&amp;(s1&gt;&gt;N-q[i].x);</span><br><span class="line">ans[q[i].id]=k.<span class="built_in">any</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j*j&lt;=q[i].x;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(q[i].x%j==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[j]&amp;&amp;s[q[i].x/j])</span><br><span class="line">&#123;</span><br><span class="line">ans[q[i].id]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ans[i]) <span class="built_in">printf</span>(<span class="string">&quot;hana\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;bi\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P5355-Ynoi2017-由乃的玉米田"><a href="#P5355-Ynoi2017-由乃的玉米田" class="headerlink" title="P5355 [Ynoi2017] 由乃的玉米田  "></a><a href="https://www.luogu.com.cn/problem/P5355">P5355 [Ynoi2017] 由乃的玉米田  </a></h4><p>就是在上题基础上多个根号分治</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">1e5</span>+<span class="number">5</span>,N=<span class="number">1e5</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n,m,mx;</span><br><span class="line"><span class="type">int</span> a[maxm],belong[maxm],ans[maxm],cnt[maxm];</span><br><span class="line"><span class="type">int</span> la[maxm],res[maxm];</span><br><span class="line">bitset&lt;maxm&gt;s,s1,k;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;ss[N]; </span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> opt,l,r,x,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> qq &amp;x)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?(belong[l]&amp;<span class="number">1</span>?r&lt;x.r:r&gt;x.r):l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[maxm];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">q1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,x,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> q1&amp;b)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> x&lt;b.x;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q1[maxm];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span> (ch==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(++cnt[a[x]]==<span class="number">1</span>) s[a[x]]=s1[N-a[x]]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(--cnt[a[x]]==<span class="number">0</span>) s[a[x]]=s1[N-a[x]]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n=<span class="built_in">read</span>(),m=<span class="built_in">read</span>();</span><br><span class="line"><span class="type">int</span> cyq=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> t=<span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">read</span>(),belong[i]=(i<span class="number">-1</span>)/t+<span class="number">1</span>,mx=<span class="built_in">max</span>(mx,a[i]);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) q[i]=qq&#123;<span class="built_in">read</span>(),<span class="built_in">read</span>(),<span class="built_in">read</span>(),<span class="built_in">read</span>(),i&#125;;</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+m+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">del</span>(l++);</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add</span>(--l);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">del</span>(r--);</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add</span>(++r);</span><br><span class="line"><span class="keyword">if</span>(q[i].opt==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">k=s&amp;(s&lt;&lt;q[i].x);</span><br><span class="line">ans[q[i].id]=k.<span class="built_in">any</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(q[i].opt==<span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">k=s&amp;(s1&gt;&gt;N-q[i].x);</span><br><span class="line">ans[q[i].id]=k.<span class="built_in">any</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(q[i].opt==<span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j*j&lt;=q[i].x;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(q[i].x%j==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[j]&amp;&amp;s[q[i].x/j])</span><br><span class="line">&#123;</span><br><span class="line">ans[q[i].id]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(q[i].x==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span>(q[i].x&lt;=t)</span><br><span class="line">&#123;</span><br><span class="line">q1[++cyq]=&#123;q[i].l,q[i].r,q[i].x,q[i].id&#125;;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j*q[i].x&lt;=mx;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[j]&amp;&amp;s[j*q[i].x])</span><br><span class="line">&#123;</span><br><span class="line">ans[q[i].id]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(q1+<span class="number">1</span>,q1+<span class="number">1</span>+cyq);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=cyq;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(q1[i].x==q1[i<span class="number">-1</span>].x)</span><br><span class="line">&#123;</span><br><span class="line">ans[q1[i].id]=q1[i].l&lt;=res[q1[i].r];</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">memset</span>(res,<span class="number">0</span>,<span class="keyword">sizeof</span> res);</span><br><span class="line"><span class="built_in">memset</span>(la,<span class="number">0</span>,<span class="keyword">sizeof</span> la);</span><br><span class="line">l=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">&#123;</span><br><span class="line">la[a[j]]=j;</span><br><span class="line"><span class="keyword">if</span>(a[j]%q1[i].x==<span class="number">0</span>) l=<span class="built_in">max</span>(l,la[a[j]/q1[i].x]);</span><br><span class="line"><span class="keyword">if</span>(a[j]*q1[i].x&lt;=mx) l=<span class="built_in">max</span>(l,la[a[j]*q1[i].x]);</span><br><span class="line">res[j]=l;</span><br><span class="line">&#125;</span><br><span class="line">ans[q1[i].id]=q1[i].l&lt;=res[q1[i].r];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ans[i]) <span class="built_in">printf</span>(<span class="string">&quot;yuno\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;yumi\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P4688-Ynoi2016-掉进兔子洞"><a href="#P4688-Ynoi2016-掉进兔子洞" class="headerlink" title="P4688 [Ynoi2016] 掉进兔子洞 "></a><a href="https://www.luogu.com.cn/problem/P4688">P4688 [Ynoi2016] 掉进兔子洞 </a></h4><p>先咕着</p>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kruskal重构树</title>
      <link href="//OI/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/"/>
      <url>//OI/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p>感觉再颓下去可以死家里</p><span id="more"></span><h3 id="算法概述"><a href="#算法概述" class="headerlink" title="算法概述"></a>算法概述</h3><p>以下内容最好搭配<a href="https://www.luogu.com.cn/blog/me-immortal/kruskal-chong-gou-shu">洛谷日报</a>和<a href="https://oi-wiki.org//graph/mst/#kruskal-%E9%87%8D%E6%9E%84%E6%A0%91">oi-wiki</a>食用</p><p>理论就不讲了吧。。。<del>逃</del></p><p>讲一下性质：</p><p>原图中两个点间所有路径上的边最大权值的最小值=最小生成树上两点简单路径的边最大权值= $\text{Kruskal}$重构树上两点 $\text{LCA}$的点权。</p><p>emm，好像就没了</p><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h4 id="P1967-NOIP2013-提高组-货车运输"><a href="#P1967-NOIP2013-提高组-货车运输" class="headerlink" title="P1967 [NOIP2013 提高组] 货车运输"></a><a href="https://www.luogu.com.cn/problem/P1967">P1967 [NOIP2013 提高组] 货车运输</a></h4><p>纯板子，主要是贴个代码（但这码风是真的丑）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> tot,ne[N&lt;&lt;<span class="number">1</span>],to[N&lt;&lt;<span class="number">1</span>],head[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> f[N][<span class="number">20</span>],v[N],fa[N],vis[N];</span><br><span class="line"><span class="type">int</span> idx,tin[N],tout[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=head[x],head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">tin[x]=++idx,vis[x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;f[x][i];++i) f[x][i+<span class="number">1</span>]=f[f[x][i]][i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==f[x][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">f[y][<span class="number">0</span>]=x,<span class="built_in">dfs</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">tout[x]=++idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> tin[x]&lt;=tin[y]&amp;&amp;tout[x]&gt;=tout[y];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(x,y)) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(y,x)) <span class="keyword">return</span> y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line"><span class="keyword">if</span>(f[x][i]&amp;&amp;!<span class="built_in">pd</span>(f[x][i],y)) x=f[x][i];</span><br><span class="line"><span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> fa[x]==x?x:fa[x]=<span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> edge &amp;res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> z&gt;res.z;</span><br><span class="line">&#125;</span><br><span class="line">&#125;ed[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Ex_kruskal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> cnt=n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>*n;++i) fa[i]=i;</span><br><span class="line"><span class="built_in">sort</span>(ed+<span class="number">1</span>,ed+m+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=<span class="built_in">find</span>(ed[i].x),y=<span class="built_in">find</span>(ed[i].y);</span><br><span class="line"><span class="keyword">if</span>(x!=y)</span><br><span class="line">&#123;</span><br><span class="line">fa[x]=fa[y]=++cnt,v[cnt]=ed[i].z;</span><br><span class="line"><span class="built_in">add</span>(cnt,x),<span class="built_in">add</span>(x,cnt);</span><br><span class="line"><span class="built_in">add</span>(cnt,y),<span class="built_in">add</span>(y,cnt);</span><br><span class="line"><span class="keyword">if</span>(cnt==<span class="number">2</span>*n<span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=cnt;i;--i) <span class="keyword">if</span>(!vis[i]) <span class="built_in">dfs</span>(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;ed[i].x&gt;&gt;ed[i].y&gt;&gt;ed[i].z;</span><br><span class="line"><span class="built_in">Ex_kruskal</span>();</span><br><span class="line">cin&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">cout&lt;&lt;(<span class="built_in">find</span>(x)==<span class="built_in">find</span>(y)?v[<span class="built_in">lca</span>(x,y)]:<span class="number">-1</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P4768-NOI2018-归程"><a href="#P4768-NOI2018-归程" class="headerlink" title="P4768 [NOI2018] 归程"></a><a href="https://www.luogu.com.cn/problem/P4768">P4768 [NOI2018] 归程</a></h4><p>看到最短路，先考虑 <del>SPFA</del> $dijkstra$</p><p>然后预处理出源点到每个点的最短路，在上面倍增就行了</p><p>这代码死活35pts过不去，改天再写一遍</p><p>（果然是码风太丑所以别人不帮忙调吗）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp(a,b) make_pair(a,b)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,val[N];</span><br><span class="line"><span class="type">int</span> tin[N],tout[N],idx;</span><br><span class="line"><span class="type">int</span> ne[N],head[N],to[N],tot;</span><br><span class="line"><span class="type">int</span> p[N],e[N];</span><br><span class="line"><span class="type">int</span> f[N][<span class="number">20</span>],vis[N],cnt,h[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x,y,z,v;</span><br><span class="line">    <span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> edge &amp;res)<span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> z&gt;res.z;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;ed[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tot=idx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n*<span class="number">2</span>;++i) head[i]=vis[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ne[++tot]=head[x],head[x]=tot,e[tot]=z,to[tot]=y;</span><br><span class="line">&#125;</span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n*<span class="number">2</span>;++i) val[i]=<span class="number">1e18</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>,<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=q.<span class="built_in">top</span>().second;q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(vis[x]++) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">            <span class="keyword">if</span>(val[x]+e[i]&lt;val[y=to[i]]) val[y]=val[x]+e[i],q.<span class="built_in">push</span>(<span class="built_in">mp</span>(-val[y],y));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p[x]==x?x:p[x]=<span class="built_in">find</span>(p[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[x][<span class="number">0</span>]=fa,vis[x]=<span class="number">1</span>,tin[x]=++idx;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;f[x][i];++i) f[x][i+<span class="number">1</span>]=f[f[x][i]][i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">        <span class="keyword">if</span>((y=to[i])!=fa) <span class="built_in">dfs</span>(y,x),val[x]=<span class="built_in">min</span>(val[x],val[y]);</span><br><span class="line">    tout[x]=++idx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Ex_kruskal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt=n,tot=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n*<span class="number">2</span>;++i) p[i]=i,vis[i]=head[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sort</span>(ed+<span class="number">1</span>,ed+m+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=<span class="built_in">find</span>(ed[i].x),y=<span class="built_in">find</span>(ed[i].y);</span><br><span class="line">        <span class="keyword">if</span>(x==y) <span class="keyword">continue</span>;</span><br><span class="line">        p[x]=p[y]=++cnt,h[cnt]=ed[i].z;</span><br><span class="line">        <span class="built_in">add</span>(cnt,x),<span class="built_in">add</span>(cnt,y);</span><br><span class="line">        <span class="built_in">add</span>(y,cnt),<span class="built_in">add</span>(x,cnt);</span><br><span class="line">        <span class="keyword">if</span>(cnt==<span class="number">2</span>*n<span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i) <span class="keyword">if</span>(!vis[i]) <span class="built_in">dfs</span>(<span class="built_in">find</span>(i),<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">        <span class="keyword">if</span>(f[x][i]&amp;&amp;h[f[x][i]]&gt;v) x=f[x][i];</span><br><span class="line">    <span class="keyword">return</span> val[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//  freopen(&quot;return5.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line"><span class="comment">//  freopen(&quot;out.txt&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin&gt;&gt;T;</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) </span><br><span class="line">            cin&gt;&gt;ed[i].x&gt;&gt;ed[i].y&gt;&gt;ed[i].v&gt;&gt;ed[i].z,</span><br><span class="line">            <span class="built_in">add</span>(ed[i].x,ed[i].y,ed[i].v),</span><br><span class="line">            <span class="built_in">add</span>(ed[i].y,ed[i].x,ed[i].v);</span><br><span class="line">        <span class="built_in">dijkstra</span>();</span><br><span class="line">        <span class="built_in">Ex_kruskal</span>();</span><br><span class="line">        <span class="type">int</span> Q,K,S,ans=<span class="number">0</span>;</span><br><span class="line">        cin&gt;&gt;Q&gt;&gt;K&gt;&gt;S;</span><br><span class="line">        <span class="type">int</span> x,y;</span><br><span class="line">        <span class="keyword">while</span>(Q--)</span><br><span class="line">        &#123;</span><br><span class="line">            cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">            x=(x+K*ans<span class="number">-1</span>)%n+<span class="number">1</span>,y=(y+K*ans)%(S+<span class="number">1</span>);</span><br><span class="line">            cout&lt;&lt;(ans=<span class="built_in">ask</span>(x,y))&lt;&lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="P4197-Peaks"><a href="#P4197-Peaks" class="headerlink" title="P4197 Peaks"></a><a href="https://www.luogu.com.cn/problem/P4197">P4197 Peaks</a></h4><p>这道题我们先倍增找到能跳到的最远祖先，然后主席树查第K大即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>,INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> edge &amp;res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> z&lt;res.z;</span><br><span class="line">&#125;</span><br><span class="line">&#125;ed[N];</span><br><span class="line"><span class="type">int</span> p[N],val[N],vis[N];</span><br><span class="line"><span class="type">int</span> f[N][<span class="number">20</span>],to[N],head[N],ne[N],tot;</span><br><span class="line"><span class="type">int</span> tin[N],tout[N],idx;</span><br><span class="line"><span class="type">int</span> n,m,q,cnt;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> p[x]==x?x:p[x]=<span class="built_in">find</span>(p[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ne[++tot]=head[x],head[x]=tot,to[tot]=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">f[x][<span class="number">0</span>]=fa,vis[x]=<span class="number">1</span>,tin[x]=++idx;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;f[x][i];++i) f[x][i+<span class="number">1</span>]=f[f[x][i]][i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y=to[i];i;y=to[i=ne[i]])</span><br><span class="line"><span class="keyword">if</span>(y!=fa) <span class="built_in">dfs</span>(y,x);</span><br><span class="line">tout[x]=++idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Ex_kruskal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cnt=n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n*<span class="number">2</span>;++i) p[i]=i;</span><br><span class="line"><span class="built_in">sort</span>(ed+<span class="number">1</span>,ed+m+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=<span class="built_in">find</span>(ed[i].x),y=<span class="built_in">find</span>(ed[i].y);</span><br><span class="line"><span class="keyword">if</span>(x==y) <span class="keyword">continue</span>;</span><br><span class="line">p[x]=p[y]=++cnt,val[cnt]=ed[i].z;</span><br><span class="line"><span class="built_in">add</span>(cnt,x),<span class="built_in">add</span>(cnt,y);</span><br><span class="line"><span class="built_in">add</span>(y,cnt),<span class="built_in">add</span>(x,cnt);</span><br><span class="line"><span class="keyword">if</span>(cnt==<span class="number">2</span>*n<span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i) <span class="keyword">if</span>(!vis[i]) <span class="built_in">dfs</span>(<span class="built_in">find</span>(i),<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> id[N],nid[N],sz[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vis[x]=<span class="number">1</span>;</span><br><span class="line">id[++idx]=x,nid[x]=idx,sz[x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y=to[i];i;y=to[i=ne[i]])</span><br><span class="line"><span class="keyword">if</span>(y!=fa) <span class="built_in">dfs1</span>(y,x),sz[x]+=sz[y];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> root[N],xb;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,v;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k=++xb]=t[p];</span><br><span class="line">t[k].v+=v;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ins</span>(t[k].lc,t[p].lc,l,mid,x,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">ins</span>(t[k].rc,t[p].rc,mid+<span class="number">1</span>,r,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">idx=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i) vis[i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i) <span class="keyword">if</span>(!vis[i]) <span class="built_in">dfs1</span>(<span class="built_in">find</span>(i),<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(id[i]&lt;=n) <span class="built_in">ins</span>(root[i],root[i<span class="number">-1</span>],<span class="number">1</span>,INF,val[id[i]],<span class="number">1</span>);</span><br><span class="line"><span class="keyword">else</span> root[i]=root[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line"><span class="keyword">if</span>(f[x][i]&amp;&amp;val[f[x][i]]&lt;=v) x=f[x][i];</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> q,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line"><span class="type">int</span> k1=t[t[p].rc].v-t[t[q].rc].v,mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(k1&gt;=k) <span class="keyword">return</span> <span class="built_in">ask</span>(t[p].rc,t[q].rc,mid+<span class="number">1</span>,r,k);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">ask</span>(t[p].lc,t[q].lc,l,mid,k-k1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=<span class="built_in">find1</span>(x,v);</span><br><span class="line"><span class="keyword">return</span> t[root[nid[p]+sz[p]<span class="number">-1</span>]].v-t[root[nid[p]<span class="number">-1</span>]].v&lt;k?<span class="number">-1</span>:<span class="built_in">ask</span>(root[nid[p]+sz[p]<span class="number">-1</span>],root[nid[p]<span class="number">-1</span>],<span class="number">1</span>,INF,k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m&gt;&gt;q;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;val[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;ed[i].x&gt;&gt;ed[i].y&gt;&gt;ed[i].z;</span><br><span class="line"><span class="built_in">Ex_kruskal</span>();</span><br><span class="line"><span class="built_in">pre</span>();</span><br><span class="line"><span class="keyword">while</span>(q--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;</span><br><span class="line">cout&lt;&lt;<span class="built_in">query</span>(x,y,z)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>第一篇学习笔记，狗屁不通，请轻喷</p>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kruskal </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOIP2022游记</title>
      <link href="//%E6%B8%B8%E8%AE%B0/NOIP2022%E6%B8%B8%E8%AE%B0/"/>
      <url>//%E6%B8%B8%E8%AE%B0/NOIP2022%E6%B8%B8%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>游了，寄了</p><span id="more"></span><p>每个人都不得不面对这些问题。 在面对这种问题时， 既然如此， 一般来讲，我们都必须务必慎重的考虑考虑。  在这种困难的抉择下，本人思来想去，寝食难安。 那么， 吉格·金克拉曾经提到过，如果你能做梦，你就能实现它。这句话语虽然很短，但令我浮想联翩。  培根说过一句富有哲理的话，要知道对好事的称颂过于夸大，也会招来人们的反感轻蔑和嫉妒。我希望诸位也能好好地体会这句话。 生活中，若NOIP2022 游记出现了，我们就不得不考虑它出现了的事实。 我们不得不面对一个非常尴尬的事实，那就是。 </p><p>　　经过上述讨论，  一般来讲，我们都必须务必慎重的考虑考虑。 要想清楚，NOIP2022 游记，到底是一种怎么样的存在。  我们都知道，只要有意义，那么就必须慎重考虑。 在这种困难的抉择下，本人思来想去，寝食难安。 总结的来说，  俾斯麦曾经提到过，失败是坚忍的最后考验。这似乎解答了我的疑惑。 一般来说， 问题的关键究竟为何？ NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。  塞涅卡曾经说过，生命如同寓言，其价值不在与长短，而在与内容。这句话语虽然很短，但令我浮想联翩。 NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 总结的来说，  这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 爱尔兰曾经提到过，越是无能的人，越喜欢挑剔别人的错儿。这似乎解答了我的疑惑。  我们不得不面对一个非常尴尬的事实，那就是， 带着这些问题，我们来审视一下NOIP2022 游记。 了解清楚NOIP2022  游记到底是一种怎么样的存在，是解决一切问题的关键。 我们不得不面对一个非常尴尬的事实，那就是， 就我个人来说，NOIP2022  游记对我的意义，不能不说非常重大。 总结的来说，  苏轼在不经意间这样说过，古之立大事者，不惟有超世之才，亦必有坚忍不拔之志。这句话语虽然很短，但令我浮想联翩。 </p><p>　　现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以， 每个人都不得不面对这些问题。 在面对这种问题时， NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 NOIP2022 游记，到底应该如何实现。  这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。  塞涅卡说过一句富有哲理的话，真正的人生，只有在经过艰难卓绝的斗争之后才能实现。我希望诸位也能好好地体会这句话。  达尔文曾经提到过，敢于浪费哪怕一个钟头时间的人，说明他还不懂得珍惜生命的全部价值。这似乎解答了我的疑惑。 了解清楚NOIP2022  游记到底是一种怎么样的存在，是解决一切问题的关键。  海贝尔说过一句富有哲理的话，人生就是学校。在那里，与其说好的教师是幸福，不如说好的教师是不幸。这似乎解答了我的疑惑。  这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 而这些并不是完全重要，更加重要的问题是， 那么， 生活中，若NOIP2022  游记出现了，我们就不得不考虑它出现了的事实。 NOIP2022 游记因何而发生？ 经过上述讨论， 而这些并不是完全重要，更加重要的问题是，  我们不得不面对一个非常尴尬的事实，那就是， 经过上述讨论， 带着这些问题，我们来审视一下NOIP2022 游记。 NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 问题的关键究竟为何？  拿破仑·希尔曾经提到过，不要等待，时机永远不会恰到好处。我希望诸位也能好好地体会这句话。 带着这些问题，我们来审视一下NOIP2022 游记。  我认为， 普列姆昌德曾经说过，希望的灯一旦熄灭，生活刹那间变成了一片黑暗。带着这句话，我们还要更加慎重的审视这个问题： 从这个角度来看，  要想清楚，NOIP2022 游记，到底是一种怎么样的存在。 那么， 问题的关键究竟为何？ 现在，解决NOIP2022  游记的问题，是非常非常重要的。 所以， NOIP2022 游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 </p><p>　　每个人都不得不面对这些问题。 在面对这种问题时， 要想清楚，NOIP2022 游记，到底是一种怎么样的存在。 经过上述讨论， 现在，解决NOIP2022  游记的问题，是非常非常重要的。 所以， 我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。 一般来说，  塞内加在不经意间这样说过，勇气通往天堂，怯懦通往地狱。这句话语虽然很短，但令我浮想联翩。 了解清楚NOIP2022  游记到底是一种怎么样的存在，是解决一切问题的关键。 既然如何， 从这个角度来看， 我认为， 带着这些问题，我们来审视一下NOIP2022 游记。 笛卡儿曾经说过，读一切好书，就是和许多高尚的人谈话。这不禁令我深思。  贝多芬曾经说过，卓越的人一大优点是：在不利与艰难的遭遇里百折不饶。这不禁令我深思。  迈克尔·F·斯特利说过一句富有哲理的话，最具挑战性的挑战莫过于提升自我。这启发了我， 从这个角度来看， 这样看来，  富勒曾经说过，苦难磨炼一些人，也毁灭另一些人。这似乎解答了我的疑惑。  卡耐基说过一句富有哲理的话，一个不注意小事情的人，永远不会成就大事业。这句话语虽然很短，但令我浮想联翩。 既然如此， 了解清楚NOIP2022  游记到底是一种怎么样的存在，是解决一切问题的关键。 既然如何，  培根曾经说过，深窥自己的心，而后发觉一切的奇迹在你自己。带着这句话，我们还要更加慎重的审视这个问题：  伏尔泰在不经意间这样说过，不经巨大的困难，不会有伟大的事业。我希望诸位也能好好地体会这句话。 带着这些问题，我们来审视一下NOIP2022  游记。 达尔文曾经提到过，敢于浪费哪怕一个钟头时间的人，说明他还不懂得珍惜生命的全部价值。这似乎解答了我的疑惑。 每个人都不得不面对这些问题。  在面对这种问题时， 我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。 那么， 要想清楚，NOIP2022 游记，到底是一种怎么样的存在。  了解清楚NOIP2022 游记到底是一种怎么样的存在，是解决一切问题的关键。 我们不得不面对一个非常尴尬的事实，那就是，  我们不得不面对一个非常尴尬的事实，那就是， 那么， 总结的来说， NOIP2022 游记的发生，到底需要如何做到，不NOIP2022  游记的发生，又会如何产生。 一般来说， 既然如何， 要想清楚，NOIP2022 游记，到底是一种怎么样的存在。 既然如此，  对我个人而言，NOIP2022 游记不仅仅是一个重大的事件，还可能会改变我的人生。 NOIP2022 游记因何而发生？  就我个人来说，NOIP2022 游记对我的意义，不能不说非常重大。 我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。  一般来讲，我们都必须务必慎重的考虑考虑。 NOIP2022 游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。  生活中，若NOIP2022 游记出现了，我们就不得不考虑它出现了的事实。 所谓NOIP2022 游记，关键是NOIP2022 游记需要如何写。  NOIP2022 游记，发生了会如何，不发生又会如何。 每个人都不得不面对这些问题。 在面对这种问题时， 对我个人而言，NOIP2022  游记不仅仅是一个重大的事件，还可能会改变我的人生。 对我个人而言，NOIP2022 游记不仅仅是一个重大的事件，还可能会改变我的人生。  就我个人来说，NOIP2022 游记对我的意义，不能不说非常重大。 总结的来说， 总结的来说， 生活中，若NOIP2022  游记出现了，我们就不得不考虑它出现了的事实。 我认为。 </p><p>　　那么，  莎士比亚曾经说过，人的一生是短的，但如果卑劣地过这一生，就太长了。这似乎解答了我的疑惑。  这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 一般来说，  屠格涅夫说过一句富有哲理的话，你想成为幸福的人吗？但愿你首先学会吃得起苦。这启发了我，  海贝尔说过一句富有哲理的话，人生就是学校。在那里，与其说好的教师是幸福，不如说好的教师是不幸。我希望诸位也能好好地体会这句话。 NOIP2022 游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 我们不得不面对一个非常尴尬的事实，那就是，  歌德曾经提到过，没有人事先了解自己到底有多大的力量，直到他试过以后才知道。我希望诸位也能好好地体会这句话。  带着这些问题，我们来审视一下NOIP2022 游记。 问题的关键究竟为何？  阿卜·日·法拉兹说过一句富有哲理的话，学问是异常珍贵的东西，从任何源泉吸收都不可耻。这启发了我，  我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。 生活中，若NOIP2022 游记出现了，我们就不得不考虑它出现了的事实。  NOIP2022 游记因何而发生？ 而这些并不是完全重要，更加重要的问题是， 本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。  NOIP2022 游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 从这个角度来看， 既然如此， NOIP2022 游记因何而发生？  我认为， 一般来说， 现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以， 一般来说， 每个人都不得不面对这些问题。  在面对这种问题时， 莫扎特在不经意间这样说过，谁和我一样用功，谁就会和我一样成功。带着这句话，我们还要更加慎重的审视这个问题： NOIP2022 游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 一般来讲，我们都必须务必慎重的考虑考虑。  对我个人而言，NOIP2022 游记不仅仅是一个重大的事件，还可能会改变我的人生。 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 爱迪生在不经意间这样说过，失败也是我需要的，它和成功对我一样有价值。我希望诸位也能好好地体会这句话。 既然如此， 所谓NOIP2022  游记，关键是NOIP2022 游记需要如何写。 一般来说， 总结的来说， NOIP2022 游记的发生，到底需要如何做到，不NOIP2022  游记的发生，又会如何产生。 </p><p>　　我们不得不面对一个非常尴尬的事实，那就是， 这样看来，  阿卜·日·法拉兹在不经意间这样说过，学问是异常珍贵的东西，从任何源泉吸收都不可耻。这不禁令我深思。  我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。 既然如何， 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。  本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。  塞涅卡说过一句富有哲理的话，真正的人生，只有在经过艰难卓绝的斗争之后才能实现。这不禁令我深思。 NOIP2022 游记，到底应该如何实现。  我认为， 生活中，若NOIP2022 游记出现了，我们就不得不考虑它出现了的事实。  左拉说过一句富有哲理的话，生活的道路一旦选定，就要勇敢地走到底，决不回头。这不禁令我深思。  伏尔泰说过一句富有哲理的话，坚持意志伟大的事业需要始终不渝的精神。这似乎解答了我的疑惑。 既然如此，  在这种困难的抉择下，本人思来想去，寝食难安。  笛卡儿在不经意间这样说过，我的努力求学没有得到别的好处，只不过是愈来愈发觉自己的无知。我希望诸位也能好好地体会这句话。  达·芬奇曾经说过，大胆和坚定的决心能够抵得上武器的精良。带着这句话，我们还要更加慎重的审视这个问题：  卡耐基曾经说过，一个不注意小事情的人，永远不会成就大事业。这句话语虽然很短，但令我浮想联翩。 这样看来， 生活中，若NOIP2022  游记出现了，我们就不得不考虑它出现了的事实。 马云在不经意间这样说过，最大的挑战和突破在于用人，而用人最大的突破在于信任人。这启发了我，  莎士比亚曾经提到过，意志命运往往背道而驰，决心到最后会全部推倒。这不禁令我深思。  莎士比亚在不经意间这样说过，意志命运往往背道而驰，决心到最后会全部推倒。这句话语虽然很短，但令我浮想联翩。  我们都知道，只要有意义，那么就必须慎重考虑。 NOIP2022 游记因何而发生？ 我们都知道，只要有意义，那么就必须慎重考虑。  对我个人而言，NOIP2022 游记不仅仅是一个重大的事件，还可能会改变我的人生。 可是，即使是这样，NOIP2022  游记的出现仍然代表了一定的意义。 对我个人而言，NOIP2022 游记不仅仅是一个重大的事件，还可能会改变我的人生。 NOIP2022  游记，到底应该如何实现。 苏轼曾经提到过，古之立大事者，不惟有超世之才，亦必有坚忍不拔之志。这句话语虽然很短，但令我浮想联翩。  要想清楚，NOIP2022 游记，到底是一种怎么样的存在。  易卜生曾经说过，伟大的事业，需要决心，能力，组织和责任感。我希望诸位也能好好地体会这句话。 所谓NOIP2022 游记，关键是NOIP2022  游记需要如何写。 所谓NOIP2022 游记，关键是NOIP2022 游记需要如何写。 问题的关键究竟为何？ 现在，解决NOIP2022  游记的问题，是非常非常重要的。 所以， 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。  别林斯基在不经意间这样说过，好的书籍是最贵重的珍宝。这似乎解答了我的疑惑。 既然如此， 在这种困难的抉择下，本人思来想去，寝食难安。  总结的来说， 对我个人而言，NOIP2022 游记不仅仅是一个重大的事件，还可能会改变我的人生。  迈克尔·F·斯特利在不经意间这样说过，最具挑战性的挑战莫过于提升自我。我希望诸位也能好好地体会这句话。  这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 总结的来说， 在这种困难的抉择下，本人思来想去，寝食难安。 从这个角度来看，  我们都知道，只要有意义，那么就必须慎重考虑。 黑格尔曾经说过，只有永远躺在泥坑里的人，才不会再掉进坑里。这似乎解答了我的疑惑。 既然如何，  问题的关键究竟为何？ 在这种困难的抉择下，本人思来想去，寝食难安。 而这些并不是完全重要，更加重要的问题是， 我认为，  本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。 本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。  而这些并不是完全重要，更加重要的问题是， 生活中，若NOIP2022 游记出现了，我们就不得不考虑它出现了的事实。  本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。 NOIP2022 游记的发生，到底需要如何做到，不NOIP2022  游记的发生，又会如何产生。 </p><p>　　我认为， 一般来讲，我们都必须务必慎重的考虑考虑。  鲁巴金在不经意间这样说过，读书是在别人思想的帮助下，建立起自己的思想。带着这句话，我们还要更加慎重的审视这个问题： NOIP2022  游记因何而发生？ 总结的来说， 在这种困难的抉择下，本人思来想去，寝食难安。 既然如何， 经过上述讨论， 要想清楚，NOIP2022  游记，到底是一种怎么样的存在。 现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以， 那么， NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 NOIP2022 游记，发生了会如何，不发生又会如何。  本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。 那么， 要想清楚，NOIP2022 游记，到底是一种怎么样的存在。  要想清楚，NOIP2022 游记，到底是一种怎么样的存在。 苏轼曾经提到过，古之立大事者，不惟有超世之才，亦必有坚忍不拔之志。这不禁令我深思。  苏轼曾经说过，古之立大事者，不惟有超世之才，亦必有坚忍不拔之志。这句话语虽然很短，但令我浮想联翩。 NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以， 了解清楚NOIP2022 游记到底是一种怎么样的存在，是解决一切问题的关键。 从这个角度来看， NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 这样看来， 要想清楚，NOIP2022  游记，到底是一种怎么样的存在。 卡耐基曾经说过，一个不注意小事情的人，永远不会成就大事业。这不禁令我深思。  维龙曾经说过，要成功不需要什么特别的才能，只要把你能做的小事做得好就行了。这启发了我， 一般来说， 问题的关键究竟为何？ 一般来说，  NOIP2022 游记，到底应该如何实现。 既然如何， 生活中，若NOIP2022 游记出现了，我们就不得不考虑它出现了的事实。  了解清楚NOIP2022 游记到底是一种怎么样的存在，是解决一切问题的关键。 生活中，若NOIP2022  游记出现了，我们就不得不考虑它出现了的事实。 NOIP2022 游记因何而发生？ 而这些并不是完全重要，更加重要的问题是，  了解清楚NOIP2022 游记到底是一种怎么样的存在，是解决一切问题的关键。 可是，即使是这样，NOIP2022  游记的出现仍然代表了一定的意义。 既然如此， 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 了解清楚NOIP2022  游记到底是一种怎么样的存在，是解决一切问题的关键。 要想清楚，NOIP2022 游记，到底是一种怎么样的存在。 既然如何， 一般来说，  问题的关键究竟为何？ 在这种困难的抉择下，本人思来想去，寝食难安。 我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。 NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。  塞涅卡在不经意间这样说过，真正的人生，只有在经过艰难卓绝的斗争之后才能实现。这似乎解答了我的疑惑。  孔子说过一句富有哲理的话，知之者不如好之者，好之者不如乐之者。这不禁令我深思。  赫尔普斯在不经意间这样说过，有时候读书是一种巧妙地避开思考的方法。我希望诸位也能好好地体会这句话。 </p><p>　　那么， 这样看来， 一般来说， 我们都知道，只要有意义，那么就必须慎重考虑。  斯宾诺莎说过一句富有哲理的话，最大的骄傲于最大的自卑都表示心灵的最软弱无力。这句话语虽然很短，但令我浮想联翩。 现在，解决NOIP2022  游记的问题，是非常非常重要的。 所以， 每个人都不得不面对这些问题。 在面对这种问题时， 既然如此， NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。 NOIP2022 游记，发生了会如何，不发生又会如何。  现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以， 我们不得不面对一个非常尴尬的事实，那就是， NOIP2022  游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。  卢梭说过一句富有哲理的话，浪费时间是一桩大罪过。这句话语虽然很短，但令我浮想联翩。 我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。  要想清楚，NOIP2022 游记，到底是一种怎么样的存在。 本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。  非洲在不经意间这样说过，最灵繁的人也看不见自己的背脊。带着这句话，我们还要更加慎重的审视这个问题： 要想清楚，NOIP2022  游记，到底是一种怎么样的存在。 塞涅卡曾经说过，真正的人生，只有在经过艰难卓绝的斗争之后才能实现。带着这句话，我们还要更加慎重的审视这个问题：  从这个角度来看， NOIP2022 游记，到底应该如何实现。 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。  笛卡儿在不经意间这样说过，阅读一切好书如同和过去最杰出的人谈话。我希望诸位也能好好地体会这句话。 那么，  我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。 NOIP2022 游记，发生了会如何，不发生又会如何。  而这些并不是完全重要，更加重要的问题是， 从这个角度来看， 白哲特在不经意间这样说过，坚强的信念能赢得强者的心，并使他们变得更坚强。  这启发了我， 罗素·贝克曾经说过，一个人即使已登上顶峰，也仍要自强不息。这启发了我。 </p><p>　　那么，  带着这些问题，我们来审视一下NOIP2022 游记。 我们不得不面对一个非常尴尬的事实，那就是，  马云曾经提到过，最大的挑战和突破在于用人，而用人最大的突破在于信任人。带着这句话，我们还要更加慎重的审视这个问题：  这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 每个人都不得不面对这些问题。 在面对这种问题时，  这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 既然如此， 对我个人而言，NOIP2022  游记不仅仅是一个重大的事件，还可能会改变我的人生。 莎士比亚在不经意间这样说过，意志命运往往背道而驰，决心到最后会全部推倒。这不禁令我深思。  带着这些问题，我们来审视一下NOIP2022 游记。 在这种困难的抉择下，本人思来想去，寝食难安。 就我个人来说，NOIP2022  游记对我的意义，不能不说非常重大。 我们不得不面对一个非常尴尬的事实，那就是， 了解清楚NOIP2022  游记到底是一种怎么样的存在，是解决一切问题的关键。 NOIP2022 游记的发生，到底需要如何做到，不NOIP2022  游记的发生，又会如何产生。 既然如何， 既然如何， 这样看来， 而这些并不是完全重要，更加重要的问题是， 我认为，  文森特·皮尔曾经提到过，改变你的想法，你就改变了自己的世界。这句话语虽然很短，但令我浮想联翩。 从这个角度来看，  非洲曾经说过，最灵繁的人也看不见自己的背脊。这不禁令我深思。 所谓NOIP2022 游记，关键是NOIP2022 游记需要如何写。  我们都知道，只要有意义，那么就必须慎重考虑。 在这种困难的抉择下，本人思来想去，寝食难安。 对我个人而言，NOIP2022  游记不仅仅是一个重大的事件，还可能会改变我的人生。 </p><p>　　在这种困难的抉择下，本人思来想去，寝食难安。 所谓NOIP2022 游记，关键是NOIP2022 游记需要如何写。 俾斯麦曾经说过，对于不屈不挠的人来说，没有失败这回事。这句话语虽然很短，但令我浮想联翩。  现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以， 一般来讲，我们都必须务必慎重的考虑考虑。  日本谚语在不经意间这样说过，不幸可能成为通向幸福的桥梁。这不禁令我深思。 本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。 既然如何，  本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。 一般来说， 那么， 现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以，  NOIP2022 游记，到底应该如何实现。 一般来讲，我们都必须务必慎重的考虑考虑。 既然如何， 既然如何， 总结的来说。 </p><p>　　所谓NOIP2022 游记，关键是NOIP2022 游记需要如何写。 生活中，若NOIP2022 游记出现了，我们就不得不考虑它出现了的事实。  卡耐基说过一句富有哲理的话，一个不注意小事情的人，永远不会成就大事业。带着这句话，我们还要更加慎重的审视这个问题： 每个人都不得不面对这些问题。 在面对这种问题时， 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 从这个角度来看， NOIP2022 游记因何而发生？  一般来说， 可是，即使是这样，NOIP2022 游记的出现仍然代表了一定的意义。 从这个角度来看，  马云在不经意间这样说过，最大的挑战和突破在于用人，而用人最大的突破在于信任人。这句话语虽然很短，但令我浮想联翩。 从这个角度来看，  我们一般认为，抓住了问题的关键，其他一切则会迎刃而解。 所谓NOIP2022 游记，关键是NOIP2022 游记需要如何写。 NOIP2022  游记，到底应该如何实现。 总结的来说， 那么， 既然如何， NOIP2022 游记因何而发生？ 既然如何， 那么， 既然如何，  而这些并不是完全重要，更加重要的问题是， 现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以。 </p><p>　　了解清楚NOIP2022 游记到底是一种怎么样的存在，是解决一切问题的关键。 那么， 一般来讲，我们都必须务必慎重的考虑考虑。  韩非曾经提到过，内外相应，言行相称。带着这句话，我们还要更加慎重的审视这个问题： 我认为，  拿破仑·希尔曾经提到过，不要等待，时机永远不会恰到好处。这不禁令我深思。 所谓NOIP2022 游记，关键是NOIP2022 游记需要如何写。  经过上述讨论， NOIP2022 游记的发生，到底需要如何做到，不NOIP2022 游记的发生，又会如何产生。  可是，即使是这样，NOIP2022 游记的出现仍然代表了一定的意义。 本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。  现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以， 在这种困难的抉择下，本人思来想去，寝食难安。 那么，  屠格涅夫在不经意间这样说过，你想成为幸福的人吗？但愿你首先学会吃得起苦。这似乎解答了我的疑惑。 要想清楚，NOIP2022  游记，到底是一种怎么样的存在。 叔本华在不经意间这样说过，意志是一个强壮的盲人，倚靠在明眼的跛子肩上。这不禁令我深思。  生活中，若NOIP2022 游记出现了，我们就不得不考虑它出现了的事实。 </p><p>　　我认为， 这样看来， 我认为，  在这种困难的抉择下，本人思来想去，寝食难安。 一般来说， NOIP2022 游记因何而发生？ NOIP2022 游记，到底应该如何实现。  非洲曾经提到过，最灵繁的人也看不见自己的背脊。这不禁令我深思。  海贝尔曾经说过，人生就是学校。在那里，与其说好的教师是幸福，不如说好的教师是不幸。这启发了我， 就我个人来说，NOIP2022  游记对我的意义，不能不说非常重大。 NOIP2022 游记因何而发生？ 问题的关键究竟为何？ NOIP2022 游记，到底应该如何实现。  每个人都不得不面对这些问题。 在面对这种问题时。 </p><p>　　本人也是经过了深思熟虑，在每个日日夜夜思考这个问题。 经过上述讨论， 史美尔斯在不经意间这样说过，书籍把我们引入最美好的社会，使我们认识各个时代的伟大智者。这似乎解答了我的疑惑。 所谓NOIP2022  游记，关键是NOIP2022 游记需要如何写。 我认为， 而这些并不是完全重要，更加重要的问题是， 而这些并不是完全重要，更加重要的问题是，  可是，即使是这样，NOIP2022 游记的出现仍然代表了一定的意义。  卢梭在不经意间这样说过，浪费时间是一桩大罪过。我希望诸位也能好好地体会这句话。 可是，即使是这样，NOIP2022  游记的出现仍然代表了一定的意义。 我们不得不面对一个非常尴尬的事实，那就是， 现在，解决NOIP2022 游记的问题，是非常非常重要的。 所以， 了解清楚NOIP2022 游记到底是一种怎么样的存在，是解决一切问题的关键。 可是，即使是这样，NOIP2022  游记的出现仍然代表了一定的意义。 我认为， NOIP2022 游记因何而发生？  维龙说过一句富有哲理的话，要成功不需要什么特别的才能，只要把你能做的小事做得好就行了。这似乎解答了我的疑惑。 既然如何，  要想清楚，NOIP2022 游记，到底是一种怎么样的存在。  莎士比亚在不经意间这样说过，人的一生是短的，但如果卑劣地过这一生，就太长了。这启发了我， 总结的来说， NOIP2022  游记，到底应该如何实现。 而这些并不是完全重要，更加重要的问题是， 对我个人而言，NOIP2022  游记不仅仅是一个重大的事件，还可能会改变我的人生。 </p><p>　　既然如何， NOIP2022 游记，发生了会如何，不发生又会如何。 一般来讲，我们都必须务必慎重的考虑考虑。 就我个人来说，NOIP2022 游记对我的意义，不能不说非常重大。  吉姆·罗恩说过一句富有哲理的话，要么你主宰生活，要么你被生活主宰。这句话语虽然很短，但令我浮想联翩。 可是，即使是这样，NOIP2022  游记的出现仍然代表了一定的意义。 易卜生曾经提到过，伟大的事业，需要决心，能力，组织和责任感。这不禁令我深思。 </p><p>　　这样看来， 卢梭说过一句富有哲理的话，浪费时间是一桩大罪过。我希望诸位也能好好地体会这句话。 问题的关键究竟为何？ 现在，解决NOIP2022  游记的问题，是非常非常重要的。 所以， 这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 问题的关键究竟为何？  我们不得不面对一个非常尴尬的事实，那就是，  富兰克林曾经提到过，你热爱生命吗？那么别浪费时间，因为时间是组成生命的材料。这句话语虽然很短，但令我浮想联翩。 所谓NOIP2022  游记，关键是NOIP2022 游记需要如何写。 既然如此， 在这种困难的抉择下，本人思来想去，寝食难安。  在这种困难的抉择下，本人思来想去，寝食难安。 所谓NOIP2022 游记，关键是NOIP2022 游记需要如何写。 生活中，若NOIP2022  游记出现了，我们就不得不考虑它出现了的事实。 </p><p>​    <a href="https://www.cnblogs.com/nich666/p/16944726.html">游你妈记</a></p>]]></content>
      
      
      <categories>
          
          <category> 游记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 游记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>模板整合</title>
      <link href="//OI/%E6%A8%A1%E6%9D%BF%E6%95%B4%E5%90%88/"/>
      <url>//OI/%E6%A8%A1%E6%9D%BF%E6%95%B4%E5%90%88/</url>
      
        <content type="html"><![CDATA[<p>基本和个人码风一致</p><span id="more"></span><h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><h3 id="单调队列"><a href="#单调队列" class="headerlink" title="单调队列"></a>单调队列</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">q[++r]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(q[l]&lt;i-m&amp;&amp;l&lt;=r) ++l;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">while</span>(v[i]&lt;=v[q[r]]&amp;&amp;l&lt;=r) --r;</span><br><span class="line">    q[++r]=i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="单调栈"><a href="#单调栈" class="headerlink" title="单调栈"></a>单调栈</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,w[N],cnt,x,ans,h[N],a[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    cnt=ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)    cin&gt;&gt;a[i];</span><br><span class="line">    a[n+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(h[cnt]&gt;a[i]) res+=w[cnt],ans=<span class="built_in">max</span>(ans,res*h[cnt]),--cnt;</span><br><span class="line">        w[++cnt]=res,h[cnt]=a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h3> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x==f[x]?x:f[x]=<span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="堆"><a href="#堆" class="headerlink" title="堆"></a>堆</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line"></span><br><span class="line">priority_queue&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;,less&lt;<span class="type">int</span>&gt; &gt;q;</span><br></pre></td></tr></table></figure><h4 id="左偏树"><a href="#左偏树" class="headerlink" title="左偏树"></a>左偏树</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!x||!y) <span class="keyword">return</span> x+y;</span><br><span class="line"><span class="keyword">if</span>(v[y]&lt;v[x]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">rc[x]=<span class="built_in">merge</span>(rc[x],y);</span><br><span class="line"><span class="keyword">if</span>(d[rc[x]]&gt;d[lc[x]]) <span class="built_in">swap</span>(rc[x],lc[x]);</span><br><span class="line">d[x]=d[rc[x]]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(;x&lt;=n;x+=<span class="built_in">lowbit</span>(x)) c[x]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) res+=c[x];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//二维</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=n;x+=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=y;i&lt;=m;i+=<span class="built_in">lowbit</span>(i)) c[x][i]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=y;i;i-=<span class="built_in">lowbit</span>(i)) res+=c[x][i];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//单点修改，区间查询</span></span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;opt&gt;&gt;a&gt;&gt;b&gt;&gt;c)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(opt==<span class="number">1</span>) <span class="built_in">add</span>(a,b,c);</span><br><span class="line">    <span class="keyword">else</span> cin&gt;&gt;d,cout&lt;&lt;<span class="built_in">ask</span>(c,d)-<span class="built_in">ask</span>(c,b<span class="number">-1</span>)-<span class="built_in">ask</span>(a<span class="number">-1</span>,d)+<span class="built_in">ask</span>(a<span class="number">-1</span>,b<span class="number">-1</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//区间修改，单点查询</span></span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;opt&gt;&gt;a&gt;&gt;b)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(opt==<span class="number">1</span>) cin&gt;&gt;c&gt;&gt;d&gt;&gt;k,<span class="built_in">add</span>(c+<span class="number">1</span>,d+<span class="number">1</span>,k),<span class="built_in">add</span>(a,b,k),<span class="built_in">add</span>(a,d+<span class="number">1</span>,-k),<span class="built_in">add</span>(c+<span class="number">1</span>,b,-k);</span><br><span class="line">    <span class="keyword">else</span> cout&lt;&lt;<span class="built_in">ask</span>(a,b)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//区间修改，区间查询</span></span><br><span class="line"><span class="type">int</span> n,m,c[<span class="number">4</span>][N][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=n;x+=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=y;i&lt;=m;i+=<span class="built_in">lowbit</span>(i)) c[k][x][i]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=y;i;i-=<span class="built_in">lowbit</span>(i)) res+=c[k][x][i];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0</span>,x,y,v),<span class="built_in">add</span>(<span class="number">1</span>,x,y,x*v),<span class="built_in">add</span>(<span class="number">2</span>,x,y,y*v),<span class="built_in">add</span>(<span class="number">3</span>,x,y,v*x*y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ask</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">ask</span>(<span class="number">0</span>,x,y)*(x*y+x+y+<span class="number">1</span>)-<span class="built_in">ask</span>(<span class="number">1</span>,x,y)*(y+<span class="number">1</span>)-<span class="built_in">ask</span>(<span class="number">2</span>,x,y)*(x+<span class="number">1</span>)+<span class="built_in">ask</span>(<span class="number">3</span>,x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;opt&gt;&gt;a&gt;&gt;b&gt;&gt;cc&gt;&gt;d)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) cin&gt;&gt;k,<span class="built_in">Add</span>(a,b,k),<span class="built_in">Add</span>(cc+<span class="number">1</span>,b,-k),<span class="built_in">Add</span>(a,d+<span class="number">1</span>,-k),<span class="built_in">Add</span>(cc+<span class="number">1</span>,d+<span class="number">1</span>,k);</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;<span class="built_in">Ask</span>(cc,d)+<span class="built_in">Ask</span>(a<span class="number">-1</span>,b<span class="number">-1</span>)-<span class="built_in">Ask</span>(a<span class="number">-1</span>,d)-<span class="built_in">Ask</span>(cc,b<span class="number">-1</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ST表"><a href="#ST表" class="headerlink" title="ST表"></a>ST表</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    lg[<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) lg[i]=lg[i&gt;&gt;<span class="number">1</span>]+<span class="number">1</span>,maxn[i][<span class="number">0</span>]=v[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=lg[n];++i)</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j+(<span class="number">1</span>&lt;&lt;i)<span class="number">-1</span>&lt;=n;++j) maxn[j][i]=<span class="built_in">max</span>(maxn[j][i<span class="number">-1</span>],maxn[j+(<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>)][i<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> len=lg[r-l+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(maxn[l][len],maxn[r-(<span class="number">1</span>&lt;&lt;len)+<span class="number">1</span>][len]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h3><h4 id="非动态开点"><a href="#非动态开点" class="headerlink" title="非动态开点"></a>非动态开点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="keyword">struct</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> l,r,v,add;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    t[k].v=t[k1].v+t[k2].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t[k].add)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v=t[k].add;t[k].add=<span class="number">0</span>;</span><br><span class="line">        t[k1].add+=v,t[k1].v+=(t[k1].r-t[k1].l+<span class="number">1</span>)*v;</span><br><span class="line">        t[k2].add+=v,t[k2].v+=(t[k2].r-t[k2].l+<span class="number">1</span>)*v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    t[k].l=l,t[k].r=r;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;t[k].v;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(k1,l,mid);</span><br><span class="line">    <span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=t[k].l&amp;&amp;r&gt;=t[k].r)</span><br><span class="line">    &#123;</span><br><span class="line">        t[k].add+=v,t[k].v+=v*(t[k].r-t[k].l+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">push</span>(k);</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=t[k1].r) <span class="built_in">change</span>(k1,l,r,v);</span><br><span class="line">    <span class="keyword">if</span>(r&gt;=t[k2].l) <span class="built_in">change</span>(k2,l,r,v);</span><br><span class="line">    <span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=t[k].l&amp;&amp;r&gt;=t[k].r) <span class="keyword">return</span> t[k].v;</span><br><span class="line">    <span class="built_in">push</span>(k);</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=t[k1].r) res+=<span class="built_in">ask</span>(k1,l,r);</span><br><span class="line">    <span class="keyword">if</span>(r&gt;=t[k2].l) res+=<span class="built_in">ask</span>(k2,l,r);</span><br><span class="line">    <span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="动态开点"><a href="#动态开点" class="headerlink" title="动态开点"></a>动态开点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> k1 t[k].lc</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 t[k].rc</span></span><br><span class="line"><span class="keyword">struct</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> lc,rc,v,add;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    t[k].v=t[k1].v+t[k2].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t[k].add)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v=t[k].add;t[k].add=<span class="number">0</span>;</span><br><span class="line">        t[k1].add+=v,t[k1].v+=(t[k1].r-t[k1].l+<span class="number">1</span>)*v;</span><br><span class="line">        t[k2].add+=v,t[k2].v+=(t[k2].r-t[k2].l+<span class="number">1</span>)*v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!k) k=++tot;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=L&amp;&amp;r&gt;=R)</span><br><span class="line">    &#123;</span><br><span class="line">        t[k].add+=v,t[k].v+=v*(t[k].r-t[k].l+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">push</span>(k);</span><br><span class="line">    <span class="type">int</span> mid=L+R&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid) <span class="built_in">change</span>(k1,l,r,L,mid,v);</span><br><span class="line">    <span class="keyword">if</span>(r&gt;mid) <span class="built_in">change</span>(k2,l,r,mid+<span class="number">1</span>,R,v);</span><br><span class="line">    <span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=L&amp;&amp;r&gt;=R) <span class="keyword">return</span> t[k].v;</span><br><span class="line">    <span class="built_in">push</span>(k);</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid=L+R&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid) res+=<span class="built_in">ask</span>(k1,l,r,L,mid);</span><br><span class="line">    <span class="keyword">if</span>(r&gt;mid) res+=<span class="built_in">ask</span>(k2,l,r,mid+<span class="number">1</span>,R);</span><br><span class="line">    <span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="线段树合并（不回收内存）"><a href="#线段树合并（不回收内存）" class="headerlink" title="线段树合并（不回收内存）"></a>线段树合并（不回收内存）</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> q,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p||!q) <span class="keyword">return</span> p+q;</span><br><span class="line">    t[p].v+=t[q].v;</span><br><span class="line">    <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    t[p].lc=<span class="built_in">merge</span>(t[p].lc,t[q].lc,l,mid);</span><br><span class="line">    t[p].rc=<span class="built_in">merge</span>(t[p].rc,t[p].rc,mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="线段树分裂"><a href="#线段树分裂" class="headerlink" title="线段树分裂"></a>线段树分裂</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> &amp;q,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">    q=++tot;</span><br><span class="line">    <span class="type">int</span> v=t[t[p].lc].v;</span><br><span class="line">    <span class="keyword">if</span>(v&lt;x) <span class="built_in">split</span>(t[p].rc,t[q].rc,x-v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">swap</span>(t[p].rc,t[q].rc);</span><br><span class="line">    <span class="keyword">if</span>(x&lt;v) <span class="built_in">split</span>(t[p].lc,t[q].lc,x);</span><br><span class="line">    t[q].v=t[p].v-x,t[p].v=x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="线段树分治"><a href="#线段树分治" class="headerlink" title="线段树分治"></a>线段树分治</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid (l+r&gt;&gt;1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;<span class="type">int</span> x,y;&#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;s[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">node st[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line"><span class="type">int</span> top,f[N],n,m;</span><br><span class="line"><span class="type">int</span> ans[N],sz[N],last[N];</span><br><span class="line"><span class="type">char</span> opt[N];</span><br><span class="line">node e[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(x^f[x]) x=f[x];</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mer</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x==y) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(sz[x]&gt;sz[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">st[++top]=&#123;x,sz[x]&#125;,sz[y]+=sz[x],f[x]=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].l=l,t[k].r=r;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid),<span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k].l&amp;&amp;r&gt;=t[k].r) <span class="keyword">return</span> s[k].<span class="built_in">push_back</span>(v),<span class="built_in">void</span>();</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k1].r) <span class="built_in">add</span>(k1,l,r,v);</span><br><span class="line"><span class="keyword">if</span>(r&gt;=t[k2].l) <span class="built_in">add</span>(k2,l,r,v);</span><br><span class="line">&#125;</span><br><span class="line">map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">id</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x*n+y;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> tmp=top;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">0</span>;x&lt;s[k].<span class="built_in">size</span>();++x) <span class="built_in">mer</span>(<span class="built_in">find</span>(e[s[k][x]].x),<span class="built_in">find</span>(e[s[k][x]].y));</span><br><span class="line"><span class="keyword">if</span>(l==r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(opt[l]==<span class="string">&#x27;Q&#x27;</span>) cout&lt;&lt;sz[<span class="built_in">find</span>(e[l].x)]*sz[<span class="built_in">find</span>(e[l].y)]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">solve</span>(k1,l,mid),<span class="built_in">solve</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="keyword">while</span>(top&gt;tmp) sz[f[st[top].x]]-=st[top].y,f[st[top].x]=st[top].x,--top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,m);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i]=i,sz[i]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt[i]&gt;&gt;e[i].x&gt;&gt;e[i].y;</span><br><span class="line"><span class="keyword">if</span>(e[i].x&gt;e[i].y) <span class="built_in">swap</span>(e[i].x,e[i].y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> tmp=<span class="built_in">id</span>(e[i].x,e[i].y);</span><br><span class="line"><span class="keyword">if</span>(opt[i]==<span class="string">&#x27;A&#x27;</span>) mp[tmp]=i,last[i]=i;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">add</span>(<span class="number">1</span>,last[mp[tmp]],i<span class="number">-1</span>,mp[tmp]),last[mp[tmp]]=i+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;::iterator it=mp.<span class="built_in">begin</span>();it!=mp.<span class="built_in">end</span>();++it)</span><br><span class="line"><span class="keyword">if</span>(last[it-&gt;second]&lt;=m) <span class="built_in">add</span>(<span class="number">1</span>,last[it-&gt;second],m,it-&gt;second);</span><br><span class="line"><span class="built_in">solve</span>(<span class="number">1</span>,<span class="number">1</span>,m);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="李超线段树"><a href="#李超线段树" class="headerlink" title="李超线段树"></a>李超线段树</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">double</span> k,b,l,r;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">double</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x&gt;r||x&lt;l) <span class="keyword">return</span> -INF;</span><br><span class="line"><span class="keyword">return</span> k*x+b;</span><br><span class="line">&#125;</span><br><span class="line">&#125;line[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">cmp</span><span class="params">(<span class="type">double</span> x,<span class="type">double</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">fabs</span>(x-y)&lt;eps?<span class="number">0</span>:x&gt;y?<span class="number">1</span>:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">check</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">double</span> af=line[a].<span class="built_in">calc</span>(x),bf=line[b].<span class="built_in">calc</span>(x);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">cmp</span>(af,bf)?af&lt;bf:a&gt;b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Line <span class="title">get</span><span class="params">(<span class="type">double</span> a,<span class="type">double</span> b,<span class="type">double</span> c,<span class="type">double</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">cmp</span>(a,c)) <span class="keyword">return</span> (Line)&#123;<span class="number">0</span>,<span class="built_in">max</span>(b,d),a,a&#125;;</span><br><span class="line"><span class="type">double</span> k=(d-b)/(c-a);</span><br><span class="line"><span class="type">double</span> e=b-a*k;</span><br><span class="line"><span class="keyword">return</span> (Line)&#123;k,e,a,c&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LC_Segment_Tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k]=(tree)&#123;l,r,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid);<span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> mid=t[k].l+t[k].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k].l&amp;&amp;r&gt;=t[k].r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">check</span>(t[k].id,p,mid)) <span class="built_in">swap</span>(t[k].id,p);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">check</span>(t[k].id,p,t[k].l)) <span class="built_in">change</span>(k1,t[k].l,t[k].r,p);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">check</span>(t[k].id,p,t[k].r)) <span class="built_in">change</span>(k2,t[k].l,t[k].r,p);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=mid) <span class="built_in">change</span>(k1,l,r,p);</span><br><span class="line"><span class="keyword">if</span>(r&gt;mid) <span class="built_in">change</span>(k2,l,r,p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(t[k].l==t[k].r) <span class="keyword">return</span> t[k].id;</span><br><span class="line"><span class="type">int</span> mid=t[k].l+t[k].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> res=<span class="built_in">ask</span>(x&lt;=mid?k1:k2,x);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">check</span>(res,t[k].id,x)) res=t[k].id;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">&#125;T;</span><br></pre></td></tr></table></figure><h3 id="平衡树"><a href="#平衡树" class="headerlink" title="平衡树"></a>平衡树</h3><h4 id="Treap"><a href="#Treap" class="headerlink" title="Treap"></a>Treap</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n,tot,root;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>],s[N],c[N],v[N],p[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[k]=s[ch[k][<span class="number">0</span>]]+s[ch[k][<span class="number">1</span>]]+c[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">New</span><span class="params">(<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">v[++tot]=val,p[tot]=<span class="built_in">rand</span>(),s[tot]=c[tot]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rote</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">const</span> <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> x=ch[k][d^<span class="number">1</span>];</span><br><span class="line">ch[k][d^<span class="number">1</span>]=ch[x][d],ch[x][d]=k;</span><br><span class="line">k=x;</span><br><span class="line"><span class="built_in">up</span>(ch[k][d]),<span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k)</span><br><span class="line">&#123;</span><br><span class="line">k=<span class="built_in">New</span>(val);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(v[k]==val)++c[k];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> d=v[k]&lt;val?<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line"><span class="built_in">ins</span>(ch[k][d],val);</span><br><span class="line"><span class="keyword">if</span>(p[ch[k][d]]&gt;p[k]) <span class="built_in">rote</span>(k,d^<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(v[k]==val)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(c[k]&gt;<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">--c[k],<span class="built_in">up</span>(k);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(ch[k][<span class="number">0</span>]||ch[k][<span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!ch[k][<span class="number">1</span>]||p[ch[k][<span class="number">0</span>]]&gt;p[ch[k][<span class="number">1</span>]])<span class="built_in">rote</span>(k,<span class="number">1</span>),<span class="built_in">del</span>(ch[k][<span class="number">1</span>],val);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">rote</span>(k,<span class="number">0</span>),<span class="built_in">del</span>(ch[k][<span class="number">0</span>],val);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> k=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">del</span>(ch[k][val&gt;v[k]],val);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rk</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(v[k]==val) <span class="keyword">return</span> s[ch[k][<span class="number">0</span>]]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(v[k]&gt;val) <span class="keyword">return</span> <span class="built_in">rank1</span>(ch[k][<span class="number">0</span>],val);</span><br><span class="line"><span class="keyword">return</span> s[ch[k][<span class="number">0</span>]]+c[k]+<span class="built_in">rank1</span>(ch[k][<span class="number">1</span>],val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">if</span>(s[ch[k][<span class="number">0</span>]]&gt;=x) <span class="keyword">return</span> <span class="built_in">find</span>(ch[k][<span class="number">0</span>],x);</span><br><span class="line"><span class="keyword">if</span>(s[ch[k][<span class="number">0</span>]]+c[k]&gt;=x) <span class="keyword">return</span> v[k];</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">find</span>(ch[k][<span class="number">1</span>],x-s[ch[k][<span class="number">0</span>]]-c[k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> k=root,ans;</span><br><span class="line"><span class="keyword">while</span>(k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v[k]&lt;val) ans=v[k],k=ch[k][<span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> k=ch[k][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">suc</span><span class="params">(<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> k=root,ans;</span><br><span class="line"><span class="keyword">while</span>(k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v[k]&gt;val) ans=v[k],k=ch[k][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">else</span> k=ch[k][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">if</span>(x==<span class="number">1</span>) <span class="built_in">ins</span>(root,y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">2</span>) <span class="built_in">del</span>(root,y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">3</span>)cout&lt;&lt;<span class="built_in">rk</span>(root,y)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">4</span>)cout&lt;&lt;<span class="built_in">find</span>(root,y)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">5</span>)cout&lt;&lt;<span class="built_in">pre</span>(y)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">6</span>)cout&lt;&lt;<span class="built_in">suc</span>(y)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Splay"><a href="#Splay" class="headerlink" title="Splay"></a>Splay</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,root,tot;</span><br><span class="line"><span class="type">int</span> s[N],ch[N][<span class="number">2</span>],v[N],cnt[N],f[N],flag[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[x]=s[ch[x][<span class="number">0</span>]]+s[ch[x][<span class="number">1</span>]]+cnt[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x==ch[f[x]][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">reve</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">swap</span>(ch[x][<span class="number">0</span>],ch[x][<span class="number">1</span>]);</span><br><span class="line">flag[x]^=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(flag[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">reve</span>(ch[x][<span class="number">0</span>]),<span class="built_in">reve</span>(ch[x][<span class="number">1</span>]);</span><br><span class="line">flag[x]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> y=f[x],z=f[y],d=<span class="built_in">get</span>(x);</span><br><span class="line">ch[y][d]=ch[x][d^<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span>(ch[y][d]) f[ch[y][d]]=y;</span><br><span class="line">ch[z][<span class="built_in">get</span>(y)]=x,f[x]=z;</span><br><span class="line">ch[x][d^<span class="number">1</span>]=y,f[y]=x;</span><br><span class="line"><span class="built_in">up</span>(y),<span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(f[x]!=k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> y=f[x],z=f[y];</span><br><span class="line"><span class="keyword">if</span>(z!=k) <span class="built_in">rotate</span>(<span class="built_in">get</span>(x)==<span class="built_in">get</span>(y)?y:x);</span><br><span class="line"><span class="built_in">rotate</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!k) root=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> cur=root,fa=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(cur&amp;&amp;v[cur]!=x) fa=cur,cur=ch[cur][x&gt;v[cur]];</span><br><span class="line"><span class="keyword">if</span>(cur) ++cnt[cur],++s[cur];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">cur=++tot;</span><br><span class="line"><span class="keyword">if</span>(fa) ch[fa][x&gt;v[fa]]=cur;</span><br><span class="line">f[cur]=fa,v[cur]=x,cnt[cur]=s[cur]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">splay</span>(cur);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> cur=root;</span><br><span class="line"><span class="keyword">while</span>(ch[cur][x&gt;v[cur]]&amp;&amp;x!=v[cur]) cur=ch[cur][x&gt;v[cur]];</span><br><span class="line"><span class="built_in">splay</span>(cur);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> cur=root;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(k&lt;=s[ch[cur][<span class="number">0</span>]]) cur=ch[cur][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(k&gt;s[ch[cur][<span class="number">0</span>]]+cnt[cur]) k-=s[ch[cur][<span class="number">0</span>]]+cnt[cur],cur=ch[cur][<span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">splay</span>(cur),cur;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">rk</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">find</span>(k);</span><br><span class="line"><span class="keyword">return</span> s[ch[root][<span class="number">0</span>]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">find</span>(x);</span><br><span class="line"><span class="keyword">if</span>(v[root]&lt;x) <span class="keyword">return</span> root;</span><br><span class="line"><span class="type">int</span> cur=ch[root][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">while</span>(ch[cur][<span class="number">1</span>]) cur=ch[cur][<span class="number">1</span>];</span><br><span class="line"><span class="built_in">splay</span>(cur);</span><br><span class="line"><span class="keyword">return</span> cur;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">suc</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">find</span>(x);</span><br><span class="line"><span class="keyword">if</span>(v[root]&gt;x) <span class="keyword">return</span> root;</span><br><span class="line"><span class="type">int</span> cur=ch[root][<span class="number">1</span>];</span><br><span class="line"><span class="keyword">while</span>(ch[cur][<span class="number">0</span>]) cur=ch[cur][<span class="number">0</span>];</span><br><span class="line"><span class="built_in">splay</span>(cur);</span><br><span class="line"><span class="keyword">return</span> cur;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> k1=<span class="built_in">pre</span>(x),k2=<span class="built_in">suc</span>(x);</span><br><span class="line"><span class="built_in">splay</span>(k1);</span><br><span class="line"><span class="built_in">splay</span>(k2,k1);</span><br><span class="line"><span class="type">int</span> del=ch[k2][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span>(--cnt[del]) <span class="built_in">splay</span>(del);</span><br><span class="line"><span class="keyword">else</span> ch[k2][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">up</span>(k2),<span class="built_in">up</span>(root);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rev</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> k1=<span class="built_in">kth</span>(l),k2=<span class="built_in">kth</span>(r+<span class="number">2</span>);</span><br><span class="line"><span class="built_in">splay</span>(k1),<span class="built_in">splay</span>(k2,k1);</span><br><span class="line"><span class="built_in">reve</span>(ch[k2][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> opt,x,y;</span><br><span class="line"><span class="built_in">ins</span>(<span class="number">-1e9</span>),<span class="built_in">ins</span>(<span class="number">1e9</span>);</span><br><span class="line"><span class="type">int</span> ans=<span class="number">0</span>,res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;x;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) <span class="built_in">ins</span>(x);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">2</span>) <span class="built_in">del</span>(x);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">3</span>) res=<span class="built_in">rk</span>(x),cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">4</span>) res=v[<span class="built_in">kth</span>(x+<span class="number">1</span>)],cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">5</span>) res=v[<span class="built_in">pre</span>(x)],cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">6</span>) res=v[<span class="built_in">suc</span>(x)],cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="FHQ-Treap"><a href="#FHQ-Treap" class="headerlink" title="FHQ-Treap"></a>FHQ-Treap</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">FHQ_Treap</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> root=<span class="number">0</span>,tot=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,s,v,p;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[++tot]=(tree)&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,v,<span class="built_in">rand</span>()&#125;;</span><br><span class="line"><span class="keyword">return</span> tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].s=t[t[k].lc].s+t[t[k].rc].s+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> v,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k)</span><br><span class="line">&#123;</span><br><span class="line">x=y=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(t[k].v&lt;=v) x=k,<span class="built_in">split</span>(t[k].rc,v,t[k].rc,y);</span><br><span class="line"><span class="keyword">else</span> y=k,<span class="built_in">split</span>(t[k].lc,v,x,t[k].lc);</span><br><span class="line"><span class="built_in">up</span>(k); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!x||!y) <span class="keyword">return</span> x+y;</span><br><span class="line"><span class="keyword">if</span>(t[x].p&lt;t[y].p)</span><br><span class="line">&#123;</span><br><span class="line">t[x].rc=<span class="built_in">merge</span>(t[x].rc,y);</span><br><span class="line"><span class="built_in">up</span>(x);</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">t[y].lc=<span class="built_in">merge</span>(x,t[y].lc);</span><br><span class="line"><span class="built_in">up</span>(y);</span><br><span class="line"><span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">split</span>(root,v,x,y);</span><br><span class="line">root=<span class="built_in">merge</span>(<span class="built_in">merge</span>(x,<span class="built_in">newnode</span>(v)),y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">split</span>(root,v<span class="number">-1</span>,x,y),<span class="built_in">split</span>(y,v,y,z);</span><br><span class="line">y=<span class="built_in">merge</span>(t[y].lc,t[y].rc);</span><br><span class="line">root=<span class="built_in">merge</span>(<span class="built_in">merge</span>(x,y),z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rk</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">split</span>(root,v<span class="number">-1</span>,x,y);</span><br><span class="line">cout&lt;&lt;t[x].s+<span class="number">1</span>&lt;&lt;endl;</span><br><span class="line">root=<span class="built_in">merge</span>(x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(k&lt;=t[t[p].lc].s) p=t[p].lc;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(t[t[p].lc].s+<span class="number">1</span>==k) <span class="keyword">return</span> t[p].v;</span><br><span class="line"><span class="keyword">else</span> k-=t[t[p].lc].s+<span class="number">1</span>,p=t[p].rc;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">split</span>(root,v<span class="number">-1</span>,x,y);</span><br><span class="line">cout&lt;&lt;<span class="built_in">kth</span>(x,t[x].s)&lt;&lt;endl;</span><br><span class="line">root=<span class="built_in">merge</span>(x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">suc</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">split</span>(root,v,x,y);</span><br><span class="line">cout&lt;&lt;<span class="built_in">kth</span>(y,<span class="number">1</span>)&lt;&lt;endl;</span><br><span class="line">root=<span class="built_in">merge</span>(x,y); </span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rev</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">x=y=z=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">split</span>(root,r,x,y),<span class="built_in">split</span>(x,l<span class="number">-1</span>,x,z);</span><br><span class="line">t[z].rev^=<span class="number">1</span>;</span><br><span class="line">root=<span class="built_in">merge</span>(<span class="built_in">merge</span>(x,z),y); </span><br><span class="line">&#125;</span><br><span class="line">&#125;T;</span><br></pre></td></tr></table></figure><h3 id="分块"><a href="#分块" class="headerlink" title="分块"></a>分块</h3><p><del>这个就不放了</del></p><p>放个板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,N1=<span class="number">505</span>;</span><br><span class="line"><span class="type">int</span> n,m,block,num;</span><br><span class="line"><span class="type">int</span> a[N],bl[N],L[N1],R[N1];</span><br><span class="line"><span class="type">int</span> v[N1][N1],val[N1][N];</span><br><span class="line"><span class="type">int</span> b[N],tot;</span><br><span class="line"><span class="type">int</span> num1,L1[N1],R1[N1];</span><br><span class="line"><span class="type">int</span> belong[N];</span><br><span class="line"><span class="type">int</span> cnt1[N1],cnt[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> opt,l,r,k;</span><br><span class="line">&#125;s[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">rk</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">1</span>,p=bl[l],q=bl[r];</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i)</span><br><span class="line"><span class="keyword">if</span>(a[i]&lt;k) ++res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) <span class="keyword">if</span>(a[i]&lt;k) ++res;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i) <span class="keyword">if</span>(a[i]&lt;k) ++res;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;belong[k];++i) res+=v[q<span class="number">-1</span>][i]-v[p][i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L1[belong[k]];i&lt;k;++i) res+=val[q<span class="number">-1</span>][i]-val[p][i];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=bl[l],q=bl[r];</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i)</span><br><span class="line"> ++cnt[a[i]],++cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num1;++i)</span><br><span class="line"><span class="keyword">if</span>(k&gt;cnt1[i]) k-=cnt1[i];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L1[i];j&lt;=R1[i];++j)</span><br><span class="line"><span class="keyword">if</span>(k&gt;cnt[j]) k-=cnt[j];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i)</span><br><span class="line">--cnt[a[i]],--cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) </span><br><span class="line">++cnt[a[i]],++cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i)</span><br><span class="line">++cnt[a[i]],++cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num1;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(k&gt;cnt1[i]+v[q<span class="number">-1</span>][i]-v[p][i]) k-=cnt1[i]+v[q<span class="number">-1</span>][i]-v[p][i];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L1[i];j&lt;=R1[i];++j)</span><br><span class="line"><span class="keyword">if</span>(k&gt;cnt[j]+val[q<span class="number">-1</span>][j]-val[p][j]) k-=cnt[j]+val[q<span class="number">-1</span>][j]-val[p][j];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) </span><br><span class="line">--cnt[a[i]],--cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i)</span><br><span class="line">--cnt[a[i]],--cnt1[belong[a[i]]];</span><br><span class="line"><span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> va,<span class="type">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=bl[x];i&lt;=num;++i)</span><br><span class="line">val[i][va]+=value,v[i][belong[va]]+=value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=bl[l],q=bl[r],res=<span class="number">-2147483647</span>;</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) <span class="keyword">if</span>(a[i]&lt;k) res=<span class="built_in">max</span>(a[i],res);</span><br><span class="line"><span class="keyword">return</span> res==<span class="number">-2147483647</span>?res:b[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) <span class="keyword">if</span>(a[i]&lt;k) res=<span class="built_in">max</span>(a[i],res);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i) <span class="keyword">if</span>(a[i]&lt;k) res=<span class="built_in">max</span>(a[i],res);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=k<span class="number">-1</span>;i&gt;=L1[belong[k]];--i)</span><br><span class="line"><span class="keyword">if</span>(val[q<span class="number">-1</span>][i]-val[p][i]) <span class="keyword">return</span> b[<span class="built_in">max</span>(res,i)];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=belong[k]<span class="number">-1</span>;i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v[q<span class="number">-1</span>][i]-v[p][i])</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=R1[i];j&gt;=L1[i];--j)</span><br><span class="line"><span class="keyword">if</span>(val[q<span class="number">-1</span>][j]-val[p][j]) <span class="keyword">return</span> b[<span class="built_in">max</span>(res,j)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res==<span class="number">-2147483647</span>?res:b[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">suf</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=bl[l],q=bl[r],res=<span class="number">2147483647</span>;</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) <span class="keyword">if</span>(a[i]&gt;k) res=<span class="built_in">min</span>(a[i],res);</span><br><span class="line"><span class="keyword">return</span> res==<span class="number">2147483647</span>?res:b[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i) <span class="keyword">if</span>(a[i]&gt;k) res=<span class="built_in">min</span>(a[i],res);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i) <span class="keyword">if</span>(a[i]&gt;k) res=<span class="built_in">min</span>(a[i],res);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=k+<span class="number">1</span>;i&lt;=R1[belong[k]];++i)</span><br><span class="line"><span class="keyword">if</span>(val[q<span class="number">-1</span>][i]-val[p][i]) <span class="keyword">return</span> b[<span class="built_in">min</span>(res,i)];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=belong[k]+<span class="number">1</span>;i&lt;=num1;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v[q<span class="number">-1</span>][i]-v[p][i])</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L1[i];j&lt;=R1[i];++j)</span><br><span class="line"><span class="keyword">if</span>(val[q<span class="number">-1</span>][j]-val[p][j]) <span class="keyword">return</span> b[<span class="built_in">min</span>(res,j)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res==<span class="number">2147483647</span>?res:b[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">block=<span class="built_in">sqrt</span>(n),num=(n<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i) L[i]=R[i<span class="number">-1</span>]+<span class="number">1</span>,R[i]=i*block;</span><br><span class="line">R[num]=n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],b[++tot]=a[i],bl[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;s[i].opt&gt;&gt;s[i].l&gt;&gt;s[i].r;</span><br><span class="line"><span class="keyword">if</span>(s[i].opt!=<span class="number">3</span>) cin&gt;&gt;s[i].k;</span><br><span class="line"><span class="keyword">else</span> s[i].k=s[i].r,s[i].r=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(s[i].opt!=<span class="number">2</span>) b[++tot]=s[i].k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(&amp;b[<span class="number">1</span>],&amp;b[tot+<span class="number">1</span>]);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+tot+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,a[i])-b;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line"><span class="keyword">if</span>(s[i].opt!=<span class="number">2</span>) s[i].k=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,s[i].k)-b;</span><br><span class="line">block=<span class="built_in">sqrt</span>(M),num1=(M<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num1;++i) L1[i]=R1[i<span class="number">-1</span>]+<span class="number">1</span>,R1[i]=i*block;</span><br><span class="line">R1[num1]=M;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i) belong[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=num1;++j) v[i][j]=v[i<span class="number">-1</span>][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=M;++j) val[i][j]=val[i<span class="number">-1</span>][j];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L[i];j&lt;=R[i];++j) ++v[i][belong[a[j]]],++val[i][a[j]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[i].opt==<span class="number">1</span>) cout&lt;&lt;<span class="built_in">rk</span>(s[i].l,s[i].r,s[i].k)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(s[i].opt==<span class="number">2</span>) cout&lt;&lt;b[<span class="built_in">kth</span>(s[i].l,s[i].r,s[i].k)]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(s[i].opt==<span class="number">3</span>) <span class="built_in">change</span>(s[i].l,a[s[i].l],<span class="number">-1</span>),a[s[i].l]=s[i].k,<span class="built_in">change</span>(s[i].l,a[s[i].l],<span class="number">1</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(s[i].opt==<span class="number">4</span>) cout&lt;&lt;<span class="built_in">pre</span>(s[i].l,s[i].r,s[i].k)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;<span class="built_in">suf</span>(s[i].l,s[i].r,s[i].k)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="莫队"><a href="#莫队" class="headerlink" title="莫队"></a>莫队</h3><p>emmm</p><p>也放个板子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[N],f[N],ne[N],tot,l=<span class="number">1</span>,r,ti;</span><br><span class="line"><span class="type">int</span> n,m,res,Q,su,block1,num1,L[N],R[N];</span><br><span class="line"><span class="type">int</span> w[N],c[N];</span><br><span class="line"><span class="type">int</span> ans[N],s[N],v[N],cnt[N],belong[N],block,num,vis[N],b[N],belong1[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">int</span> ss[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=f[x],f[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> fa[N][<span class="number">21</span>];</span><br><span class="line"><span class="type">int</span> st[N],ed[N],t;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> dad)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[++t]=x,st[x]=t;</span><br><span class="line">fa[x][<span class="number">0</span>]=dad;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">20</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line">fa[x][i]=fa[fa[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=dad)<span class="built_in">dfs</span>(y,x);</span><br><span class="line">&#125;</span><br><span class="line">s[++t]=x,ed[x]=t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qq</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,lca,t,k,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> qq &amp;x)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?(belong[r]==belong[x.r]?t&lt;x.t:r&lt;x.r):l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">xg</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">&#125;g[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> st[x]&lt;=st[y]&amp;&amp;ed[x]&gt;=ed[y];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(y,x)) <span class="keyword">return</span> y;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(x,y)) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">pd</span>(fa[x][i],y)&amp;&amp;fa[x][i]!=<span class="number">0</span>)x=fa[x][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">x=s[x],vis[x]^=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> y=v[x];</span><br><span class="line"><span class="keyword">if</span>(vis[x]) ++cnt[y],++ss[belong1[y]];</span><br><span class="line"><span class="keyword">else</span> --cnt[y],--ss[belong1[y]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=num1;</span><br><span class="line"><span class="keyword">for</span>(;res;--res)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(k&gt;ss[res]) k-=ss[res];</span><br><span class="line"><span class="keyword">else</span><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!res) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=R[res];i&gt;=L[res];--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(k&lt;=cnt[i]) <span class="keyword">return</span> sum[i];</span><br><span class="line"><span class="keyword">else</span> k-=cnt[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> x1=st[g[x].x],x2=ed[g[x].x];</span><br><span class="line"><span class="keyword">if</span>(x1&gt;=l&amp;&amp;x1&lt;=r) <span class="built_in">add1</span>(x1);</span><br><span class="line"><span class="keyword">if</span>(x2&gt;=l&amp;&amp;x2&lt;=r) <span class="built_in">add1</span>(x2);</span><br><span class="line"><span class="built_in">swap</span>(v[s[x1]],g[x].y);</span><br><span class="line"><span class="keyword">if</span>(x1&gt;=l&amp;&amp;x1&lt;=r) <span class="built_in">add1</span>(x1);</span><br><span class="line"><span class="keyword">if</span>(x2&gt;=l&amp;&amp;x2&lt;=r) <span class="built_in">add1</span>(x2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;Q;</span><br><span class="line"><span class="type">int</span> QQ=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">block=<span class="built_in">pow</span>(<span class="number">2</span>*n,<span class="number">2.0</span>/<span class="number">3.0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>*n;++i) belong[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;v[i],sum[++su]=v[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> T=<span class="number">0</span>,ty;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;ty&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">if</span>(ty)</span><br><span class="line">&#123;</span><br><span class="line">++QQ;</span><br><span class="line"><span class="keyword">if</span>(st[x]&gt;st[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    <span class="type">int</span> k=<span class="built_in">lca</span>(x,y);</span><br><span class="line"><span class="keyword">if</span>(x==k) q[QQ]=&#123;st[x],st[y],<span class="number">0</span>,T,ty,QQ&#125;;</span><br><span class="line"><span class="keyword">else</span>q[QQ]=&#123;ed[x],st[y],k,T,ty,QQ&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>g[++T]=&#123;x,y&#125;,sum[++su]=y;</span><br><span class="line">&#125;</span><br><span class="line">block1=<span class="built_in">pow</span>(su,<span class="number">2.0</span>/<span class="number">3.0</span>);</span><br><span class="line">num1=(su<span class="number">-1</span>)/block1+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num1;++i) L[i]=(i<span class="number">-1</span>)*block1<span class="number">-1</span>,R[i]=i*block1;</span><br><span class="line">R[num1]=su;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=su;++i) belong1[i]=(i<span class="number">-1</span>)/block1+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+QQ+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">sort</span>(sum+<span class="number">1</span>,sum+su+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(sum+<span class="number">1</span>,sum+su+<span class="number">1</span>)-sum<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) v[i]=<span class="built_in">lower_bound</span>(sum+<span class="number">1</span>,sum+M+<span class="number">1</span>,v[i])-sum;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=T;++i) g[i].y=<span class="built_in">lower_bound</span>(sum+<span class="number">1</span>,sum+M+<span class="number">1</span>,g[i].y)-sum;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=QQ;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add1</span>(--l);</span><br><span class="line"><span class="keyword">while</span>(l&lt;q[i].l) <span class="built_in">add1</span>(l++);</span><br><span class="line"><span class="keyword">while</span>(r&gt;q[i].r) <span class="built_in">add1</span>(r--);</span><br><span class="line"><span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add1</span>(++r);</span><br><span class="line"><span class="keyword">while</span>(ti&lt;q[i].t) <span class="built_in">up</span>(++ti);</span><br><span class="line"><span class="keyword">while</span>(ti&gt;q[i].t) <span class="built_in">up</span>(ti--);</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add1</span>(st[q[i].lca]);</span><br><span class="line">ans[q[i].id]=<span class="built_in">ask</span>(q[i].k);</span><br><span class="line"><span class="keyword">if</span>(q[i].lca) <span class="built_in">add1</span>(st[q[i].lca]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=QQ;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ans[i]==<span class="number">-1</span>) cout&lt;&lt;<span class="string">&quot;invalid request!&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="莫队二次离线"><a href="#莫队二次离线" class="headerlink" title="莫队二次离线"></a>莫队二次离线</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>,N1=<span class="number">505</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BIT</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> n,c[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _n)</span></span>&#123;n=_n;<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)c[i]=<span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span>&#123;<span class="keyword">for</span>(;x&lt;=n;x+=<span class="built_in">lowbit</span>(x)) c[x]+=v;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="type">int</span> res=<span class="number">0</span>;<span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) res+=c[x];<span class="keyword">return</span> res;&#125;</span><br><span class="line">&#125;t;</span><br><span class="line"><span class="type">int</span> block,n,m,a[N];</span><br><span class="line"><span class="type">int</span> bl[N],Lp[N1],Rp[N1],bk;</span><br><span class="line">ll cnt[N],tag[N1];</span><br><span class="line"><span class="type">int</span> num[N];</span><br><span class="line">ll ans[N],lv[N],rv[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> query &amp;res)<span class="type">const</span>&#123;<span class="keyword">return</span> bl[l]==bl[res.l]?r&lt;res.r:l&lt;res.l;&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">rag</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id,v;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;rag&gt;rg[<span class="number">2</span>][N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">block</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">n=_n;</span><br><span class="line"><span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="keyword">sizeof</span> cnt);</span><br><span class="line"><span class="built_in">memset</span>(tag,<span class="number">0</span>,<span class="keyword">sizeof</span> tag);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addL</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v=<span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x;i&gt;=Lp[bl[x]];--i) cnt[i]+=v;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=bl[x]<span class="number">-1</span>;i&gt;<span class="number">0</span>;--i) tag[i]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addR</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v=<span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x;i&lt;=Rp[bl[x]];++i) cnt[i]+=v;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=bl[x]+<span class="number">1</span>;i&lt;=bl[n];++i) tag[i]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> cnt[x]+tag[bl[x]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;s;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">block=<span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],num[i]=a[i];</span><br><span class="line"><span class="built_in">sort</span>(num+<span class="number">1</span>,num+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(num+<span class="number">1</span>,num+n+<span class="number">1</span>)-num<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(num+<span class="number">1</span>,num+M+<span class="number">1</span>,a[i])-num;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) bl[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=bl[n];++i) Lp[i]=Rp[i<span class="number">-1</span>]+<span class="number">1</span>,Rp[i]=i*block;</span><br><span class="line">Rp[bl[n]]=n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;q[i].l&gt;&gt;q[i].r,q[i].id=i;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+m+<span class="number">1</span>);</span><br><span class="line">t.<span class="built_in">init</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">lv[i]=lv[i<span class="number">-1</span>]+t.<span class="built_in">ask</span>(n)-t.<span class="built_in">ask</span>(a[i]),t.<span class="built_in">add</span>(a[i],<span class="number">1</span>);</span><br><span class="line">t.<span class="built_in">init</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i;--i)</span><br><span class="line">rv[i]=rv[i+<span class="number">1</span>]+t.<span class="built_in">ask</span>(a[i]<span class="number">-1</span>),t.<span class="built_in">add</span>(a[i],<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> L=<span class="number">1</span>,R=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l=q[i].l,r=q[i].r,id=q[i].id;</span><br><span class="line"><span class="keyword">if</span>(R&lt;r)</span><br><span class="line">rg[<span class="number">0</span>][L<span class="number">-1</span>].<span class="built_in">push_back</span>((rag)&#123;R+<span class="number">1</span>,r,id,<span class="number">-1</span>&#125;);</span><br><span class="line"><span class="keyword">if</span>(R&gt;r)</span><br><span class="line">rg[<span class="number">0</span>][L<span class="number">-1</span>].<span class="built_in">push_back</span>((rag)&#123;r+<span class="number">1</span>,R,id,<span class="number">1</span>&#125;);</span><br><span class="line"><span class="keyword">if</span>(L&gt;l)</span><br><span class="line">rg[<span class="number">1</span>][r+<span class="number">1</span>].<span class="built_in">push_back</span>((rag)&#123;l,L<span class="number">-1</span>,id,<span class="number">-1</span>&#125;);</span><br><span class="line"><span class="keyword">if</span>(l&gt;L)</span><br><span class="line">rg[<span class="number">1</span>][r+<span class="number">1</span>].<span class="built_in">push_back</span>((rag)&#123;L,l<span class="number">-1</span>,id,<span class="number">1</span>&#125;);</span><br><span class="line">ans[id]+=rv[l]-rv[L]+lv[r]-lv[R];</span><br><span class="line">L=l,R=r;</span><br><span class="line">&#125;</span><br><span class="line">s.<span class="built_in">init</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">s.<span class="built_in">addL</span>(a[i]<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> x:rg[<span class="number">0</span>][i])</span><br><span class="line">&#123;</span><br><span class="line">ll res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=x.l;j&lt;=x.r;++j) res+=s.<span class="built_in">ask</span>(a[j]);</span><br><span class="line">ans[x.id]+=x.v*res;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">s.<span class="built_in">init</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i;--i)</span><br><span class="line">&#123;</span><br><span class="line">s.<span class="built_in">addR</span>(a[i]+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> x:rg[<span class="number">1</span>][i])</span><br><span class="line">&#123;</span><br><span class="line">ll res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=x.l;j&lt;=x.r;++j) res+=s.<span class="built_in">ask</span>(a[j]);</span><br><span class="line">ans[x.id]+=x.v*res;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) ans[q[i].id]+=ans[q[i<span class="number">-1</span>].id];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="重链剖分"><a href="#重链剖分" class="headerlink" title="重链剖分"></a>重链剖分</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 k&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 k&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,v,add;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> n,m,r,p;</span><br><span class="line"><span class="type">int</span> dfn[N],id[N],son[N],s[N],a[N],dep[N],f[N],top[N],tot;</span><br><span class="line"><span class="type">int</span> idx,head[N],ne[N&lt;&lt;<span class="number">1</span>],to[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++idx]=y,ne[idx]=head[x],head[x]=idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dep[x]=dep[fa]+<span class="number">1</span>;</span><br><span class="line">s[x]=<span class="number">1</span>;</span><br><span class="line">f[x]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=fa)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">dfs1</span>(y,x);</span><br><span class="line">s[x]+=s[y];</span><br><span class="line"><span class="keyword">if</span>(s[y]&gt;s[son[x]]) son[x]=y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">top[x]=t;</span><br><span class="line">id[x]=++tot;</span><br><span class="line">dfn[tot]=x;</span><br><span class="line"><span class="keyword">if</span>(!son[x]) <span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">dfs2</span>(son[x],t);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line">y=to[i];</span><br><span class="line"><span class="keyword">if</span>(y==f[x]||y==son[x]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs2</span>(y,y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].v=(t[k1].v+t[k2].v)%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> add=t[k].add;</span><br><span class="line"><span class="keyword">if</span>(!add) <span class="keyword">return</span>;</span><br><span class="line">(t[k1].add+=add)%=p;</span><br><span class="line">(t[k2].add+=add)%=p;</span><br><span class="line">(t[k1].v+=(t[k1].r-t[k1].l+<span class="number">1</span>)*add)%=p;</span><br><span class="line">(t[k2].v+=(t[k2].r-t[k2].l+<span class="number">1</span>)*add)%=p;</span><br><span class="line">t[k].add=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].l=l,t[k].r=r;</span><br><span class="line"><span class="keyword">if</span>(l==r)</span><br><span class="line">&#123;</span><br><span class="line">t[k].v=a[dfn[l]]%p;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid);</span><br><span class="line"><span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k].l&amp;&amp;r&gt;=t[k].r)</span><br><span class="line">&#123;</span><br><span class="line">t[k].v=(t[k].v+(t[k].r-t[k].l+<span class="number">1</span>)*v)%p;</span><br><span class="line">t[k].add=(t[k].add+v)%p;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">pushdown</span>(k);</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k1].r) <span class="built_in">change</span>(k1,l,r,v);</span><br><span class="line"><span class="keyword">if</span>(r&gt;=t[k2].l) <span class="built_in">change</span>(k2,l,r,v);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k].l&amp;&amp;r&gt;=t[k].r) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="built_in">pushdown</span>(k);</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k1].r) res+=<span class="built_in">ask</span>(k1,l,r);</span><br><span class="line"><span class="keyword">if</span>(r&gt;=t[k2].l) res+=<span class="built_in">ask</span>(k2,l,r);</span><br><span class="line"><span class="keyword">return</span> res%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">changes</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="built_in">change</span>(<span class="number">1</span>,id[top[x]],id[x],v);</span><br><span class="line">x=f[top[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="built_in">change</span>(<span class="number">1</span>,id[x],id[y],v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y); </span><br><span class="line">res+=<span class="built_in">ask</span>(<span class="number">1</span>,id[top[x]],id[x]);</span><br><span class="line">res%=p;</span><br><span class="line">x=f[top[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">res+=<span class="built_in">ask</span>(<span class="number">1</span>,id[x],id[y]);</span><br><span class="line"><span class="keyword">return</span> res%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m&gt;&gt;r&gt;&gt;p;</span><br><span class="line"><span class="type">int</span> x,y,z,e;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs1</span>(r,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">dfs2</span>(r,r);</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x;</span><br><span class="line"><span class="keyword">if</span>(x==<span class="number">1</span>) cin&gt;&gt;x&gt;&gt;y&gt;&gt;z,<span class="built_in">changes</span>(x,y,z);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">2</span>) cin&gt;&gt;x&gt;&gt;y,cout&lt;&lt;<span class="built_in">query</span>(x,y)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">3</span>) cin&gt;&gt;x&gt;&gt;z,<span class="built_in">change</span>(<span class="number">1</span>,id[x],id[x]+s[x]<span class="number">-1</span>,z);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">4</span>) cin&gt;&gt;x,cout&lt;&lt;<span class="built_in">ask</span>(<span class="number">1</span>,id[x],id[x]+s[x]<span class="number">-1</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Chtholly树（ODT）"><a href="#Chtholly树（ODT）" class="headerlink" title="Chtholly树（ODT）"></a>Chtholly树（ODT）</h3><p>珂朵莉太可爱了,我永远喜欢珂朵莉</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> iter set<span class="string">&lt;node&gt;</span>::iterator</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,seed,vmax;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r;</span><br><span class="line"><span class="keyword">mutable</span> <span class="type">int</span> v;</span><br><span class="line"><span class="built_in">node</span>(<span class="type">int</span> a=<span class="number">-1</span>,<span class="type">int</span> b=<span class="number">-1</span>,<span class="type">int</span> c=<span class="number">-1</span>):<span class="built_in">l</span>(a),<span class="built_in">r</span>(b),<span class="built_in">v</span>(c)&#123;&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node &amp;res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> l&lt;res.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;node&gt;s;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> iter <span class="title">split</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">iter it=s.<span class="built_in">lower_bound</span>(<span class="built_in">node</span>(x));</span><br><span class="line"><span class="keyword">if</span>(it!=s.<span class="built_in">end</span>()&amp;&amp;it-&gt;l==x) <span class="keyword">return</span> it;</span><br><span class="line">--it;</span><br><span class="line">node t=*it;</span><br><span class="line">s.<span class="built_in">erase</span>(it);</span><br><span class="line">s.<span class="built_in">insert</span>(<span class="built_in">node</span>(t.l,x<span class="number">-1</span>,t.v));</span><br><span class="line"><span class="keyword">return</span> s.<span class="built_in">insert</span>(<span class="built_in">node</span>(x,t.r,t.v)).first;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">assign</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">iter it2=<span class="built_in">split</span>(r+<span class="number">1</span>),it1=<span class="built_in">split</span>(l);</span><br><span class="line">s.<span class="built_in">erase</span>(it1,it2);</span><br><span class="line">s.<span class="built_in">insert</span>(<span class="built_in">node</span>(l,r,v));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">iter it2=<span class="built_in">split</span>(r+<span class="number">1</span>),it1=<span class="built_in">split</span>(l);</span><br><span class="line"><span class="keyword">for</span>(;it1!=it2;++it1) it1-&gt;v+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">rank1</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;<span class="built_in">ve</span>(<span class="number">0</span>);</span><br><span class="line">iter it2=<span class="built_in">split</span>(r+<span class="number">1</span>),it1=<span class="built_in">split</span>(l);</span><br><span class="line"><span class="keyword">for</span>(;it1!=it2;it1++) ve.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(it1-&gt;v,it1-&gt;r-it1-&gt;l+<span class="number">1</span>));</span><br><span class="line"><span class="built_in">sort</span>(ve.<span class="built_in">begin</span>(),ve.<span class="built_in">end</span>());</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;ve.<span class="built_in">size</span>();++i)<span class="keyword">if</span>((x-=ve[i].second)&lt;=<span class="number">0</span>) <span class="keyword">return</span> ve[i].first;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">a%=p;</span><br><span class="line"><span class="keyword">while</span>(b)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(b&amp;<span class="number">1</span>) res=res*a%p;</span><br><span class="line">a=a*a%p;</span><br><span class="line">b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">power</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">iter it2=<span class="built_in">split</span>(r+<span class="number">1</span>),it1=<span class="built_in">split</span>(l);</span><br><span class="line"><span class="keyword">for</span>(;it1!=it2;it1++) res=(res+(it1-&gt;r-it1-&gt;l+<span class="number">1</span>)*<span class="built_in">qpow</span>(it1-&gt;v,x,y))%y;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">rnd</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=seed;</span><br><span class="line">seed=(seed*<span class="number">7</span>+<span class="number">13</span>)%<span class="number">1000000007</span>;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m&gt;&gt;seed&gt;&gt;vmax;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">a[i]=(<span class="built_in">rnd</span>()%vmax)+<span class="number">1</span>;</span><br><span class="line">s.<span class="built_in">insert</span>(<span class="built_in">node</span>(i,i,a[i]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> op,l,r,x,y;</span><br><span class="line">op=(<span class="built_in">rnd</span>()%<span class="number">4</span>)+<span class="number">1</span>;</span><br><span class="line">l=(<span class="built_in">rnd</span>()%n)+<span class="number">1</span>;</span><br><span class="line">r=(<span class="built_in">rnd</span>()%n)+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l&gt;r) <span class="built_in">swap</span>(l,r);</span><br><span class="line"><span class="keyword">if</span>(op==<span class="number">3</span>) x=(<span class="built_in">rnd</span>()%(r-l+<span class="number">1</span>))+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> x=(<span class="built_in">rnd</span>()%vmax)+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(op==<span class="number">4</span>) y=(<span class="built_in">rnd</span>()%vmax)+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(op==<span class="number">1</span>) <span class="built_in">add</span>(l,r,x);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>) <span class="built_in">assign</span>(l,r,x);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>) cout&lt;&lt;<span class="built_in">rank1</span>(l,r,x)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;<span class="built_in">power</span>(l,r,x,y)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LCT"><a href="#LCT" class="headerlink" title="LCT"></a>LCT</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,root,tot;</span><br><span class="line"><span class="type">int</span> s[N],ch[N][<span class="number">2</span>],v[N],f[N],flag[N];</span><br><span class="line"><span class="type">int</span> stk[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;s[x]=s[ch[x][<span class="number">0</span>]]^s[ch[x][<span class="number">1</span>]]^v[x];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">isroot</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> ch[f[x]][<span class="number">0</span>]!=x&amp;&amp;ch[f[x]][<span class="number">1</span>]!=x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> x==ch[f[x]][<span class="number">1</span>];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rev</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">swap</span>(ch[x][<span class="number">0</span>],ch[x][<span class="number">1</span>]);</span><br><span class="line">flag[x]^=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(flag[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">rev</span>(ch[x][<span class="number">0</span>]),<span class="built_in">rev</span>(ch[x][<span class="number">1</span>]);</span><br><span class="line">flag[x]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> y=f[x],z=f[y],d=<span class="built_in">get</span>(x);</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">isroot</span>(y)) ch[z][<span class="built_in">get</span>(y)]=x;</span><br><span class="line">ch[y][d]=ch[x][d^<span class="number">1</span>],f[ch[x][d^<span class="number">1</span>]]=y;</span><br><span class="line">f[x]=z,ch[x][d^<span class="number">1</span>]=y,f[y]=x;</span><br><span class="line"><span class="built_in">up</span>(y),<span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> top=<span class="number">0</span>,r=x;</span><br><span class="line">stk[++top]=r;</span><br><span class="line"><span class="keyword">while</span>(!<span class="built_in">isroot</span>(r)) stk[++top]=r=f[r];</span><br><span class="line"><span class="keyword">while</span>(top) <span class="built_in">push</span>(stk[top--]);</span><br><span class="line"><span class="keyword">while</span>(!<span class="built_in">isroot</span>(x))</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> y=f[x],z=f[y];</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">isroot</span>(y)) <span class="built_in">rotate</span>(<span class="built_in">get</span>(x)==<span class="built_in">get</span>(y)?y:x);</span><br><span class="line"><span class="built_in">rotate</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> z=x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y=<span class="number">0</span>;x;y=x,x=f[x]) <span class="built_in">splay</span>(x),ch[x][<span class="number">1</span>]=y,<span class="built_in">up</span>(x);</span><br><span class="line"><span class="built_in">splay</span>(z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">access</span>(x),<span class="built_in">rev</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">access</span>(x);</span><br><span class="line"><span class="keyword">while</span>(ch[x][<span class="number">0</span>]) <span class="built_in">push</span>(x),x=ch[x][<span class="number">0</span>];</span><br><span class="line"><span class="built_in">splay</span>(x);</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">makeroot</span>(x),<span class="built_in">access</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">makeroot</span>(x);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">findroot</span>(y)!=x) f[x]=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">makeroot</span>(x);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">findroot</span>(y)==x&amp;&amp;f[y]==x&amp;&amp;!ch[y][<span class="number">0</span>]) ch[x][<span class="number">1</span>]=f[y]=<span class="number">0</span>,<span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;v[i];</span><br><span class="line"><span class="type">int</span> opt,x,y;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">0</span>) <span class="built_in">split</span>(x,y),cout&lt;&lt;s[y]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">1</span>) <span class="built_in">link</span>(x,y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(opt==<span class="number">2</span>) <span class="built_in">cut</span>(x,y);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">splay</span>(x),v[x]=y,<span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="树套树"><a href="#树套树" class="headerlink" title="树套树"></a>树套树</h3><h4 id="树状数组套权值线段树"><a href="#树状数组套权值线段树" class="headerlink" title="树状数组套权值线段树"></a>树状数组套权值线段树</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> root[N],v1,v2,idx;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,v;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) k=++idx;</span><br><span class="line">t[k].v+=v;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">change</span>(t[k].lc,l,mid,x,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(t[k].rc,mid+<span class="number">1</span>,r,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=v1;x+=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="built_in">change</span>(root[x],<span class="number">1</span>,v2,y,v);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="keyword">return</span> <span class="built_in">query</span>(t[k].lc,l,mid,x);</span><br><span class="line"><span class="keyword">return</span> t[t[k].lc].v+<span class="built_in">query</span>(t[k].rc,mid+<span class="number">1</span>,r,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) res+=<span class="built_in">query</span>(root[x],<span class="number">1</span>,v2,y);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _v1,<span class="type">int</span> _v2)</span></span>&#123;v1=_v1,v2=_v2,idx=<span class="number">0</span>;&#125;</span><br><span class="line">&#125;T;</span><br></pre></td></tr></table></figure><h4 id="权值线段树套线段树"><a href="#权值线段树套线段树" class="headerlink" title="权值线段树套线段树"></a>权值线段树套线段树</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> root[N*<span class="number">4</span>],n,idx,tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,v,tag;</span><br><span class="line">&#125;t[N*<span class="number">300</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) k=++idx;</span><br><span class="line">t[k].v+=<span class="built_in">min</span>(R,r)-<span class="built_in">max</span>(l,L)+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r)<span class="keyword">return</span> (<span class="type">void</span>)++t[k].tag;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid) <span class="built_in">change</span>(t[k].lc,l,mid,L,R);</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) <span class="built_in">change</span>(t[k].rc,mid+<span class="number">1</span>,r,L,R);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">change</span>(root[k],<span class="number">1</span>,n,L,R);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(v&lt;=mid) <span class="built_in">add</span>(k1,l,mid,L,R,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">add</span>(k2,mid+<span class="number">1</span>,r,L,R,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>,res=t[k].tag*(<span class="built_in">min</span>(R,r)-<span class="built_in">max</span>(l,L)+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(L&lt;=mid) res+=<span class="built_in">query</span>(t[k].lc,l,mid,L,R);</span><br><span class="line"><span class="keyword">if</span>(R&gt;mid) res+=<span class="built_in">query</span>(t[k].rc,mid+<span class="number">1</span>,r,L,R);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>,tmp=<span class="built_in">query</span>(root[k2],<span class="number">1</span>,n,L,R);</span><br><span class="line"><span class="keyword">if</span>(x&lt;=tmp) <span class="keyword">return</span> <span class="built_in">ask</span>(k2,mid+<span class="number">1</span>,r,L,R,x);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">ask</span>(k1,l,mid,L,R,x-tmp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;T;</span><br></pre></td></tr></table></figure><h4 id="线段树套Trie"><a href="#线段树套Trie" class="headerlink" title="线段树套Trie"></a>线段树套Trie</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid (l+r&gt;&gt;1)</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,INF=<span class="number">1e9</span>,V=<span class="number">18</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> root[N&lt;&lt;<span class="number">2</span>],a[N],n,m;</span><br><span class="line"><span class="type">int</span> ch[N*<span class="number">400</span>][<span class="number">2</span>],last[N*<span class="number">400</span>],tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=V;~i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c=(x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(!ch[k][c]) ch[k][c]=++tot;</span><br><span class="line">k=ch[k][c],last[k]=<span class="built_in">max</span>(last[k],t);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=V;~i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c=((x&gt;&gt;i)&amp;<span class="number">1</span>)^<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(ch[k][c]&amp;&amp;last[ch[k][c]]&gt;=t) k=ch[k][c],res+=<span class="number">1</span>&lt;&lt;i;</span><br><span class="line"><span class="keyword">else</span> k=ch[k][c^<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">root[k]=++tot;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) <span class="built_in">ins</span>(root[k],a[i],INF);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid);<span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">ins</span>(root[k],v,t);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">change</span>(k1,l,mid,x,v,t);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(k2,mid+<span class="number">1</span>,r,x,v,t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> x,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r) <span class="keyword">return</span> <span class="built_in">ask</span>(root[k],x,t);</span><br><span class="line"><span class="keyword">if</span>(R&lt;=mid) <span class="keyword">return</span> <span class="built_in">query</span>(k1,l,mid,L,R,x,t);</span><br><span class="line"><span class="keyword">if</span>(L&gt;mid) <span class="keyword">return</span> <span class="built_in">query</span>(k2,mid+<span class="number">1</span>,r,L,R,x,t);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">query</span>(k1,l,mid,L,R,x,t),<span class="built_in">query</span>(k2,mid+<span class="number">1</span>,r,L,R,x,t));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="type">int</span> opt,l,r,x,d,t=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;l&gt;&gt;r;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">0</span>) <span class="built_in">change</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,r,++t);</span><br><span class="line"><span class="keyword">else</span> cin&gt;&gt;x&gt;&gt;d,cout&lt;&lt;<span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,r,x,t-d+<span class="number">1</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="整体二分"><a href="#整体二分" class="headerlink" title="整体二分"></a>整体二分</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">4e5</span>+<span class="number">5</span>,NN=<span class="number">505</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> id,x1,y1,x2,y2,k;</span><br><span class="line">&#125;s[N],s1[N],s2[N];</span><br><span class="line"><span class="type">int</span> ans[N];</span><br><span class="line"><span class="type">int</span> c[NN][NN];</span><br><span class="line"><span class="type">int</span> n,q,tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">++x,++y;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=n+<span class="number">1</span>;x+=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=y;i&lt;=n+<span class="number">1</span>;i+=<span class="built_in">lowbit</span>(i)) c[x][i]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">++x,++y;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=y;i;i-=<span class="built_in">lowbit</span>(i)) res+=c[x][i];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> lv,<span class="type">int</span> rv,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(lv==rv)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) ans[s[i].id]=lv;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> mid=lv+rv&gt;&gt;<span class="number">1</span>,ll=<span class="number">0</span>,rr=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!s[i].id)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[i].k&lt;=mid) <span class="built_in">add</span>(s[i].x1,s[i].y1,<span class="number">1</span>),s1[++ll]=s[i];</span><br><span class="line"><span class="keyword">else</span> s2[++rr]=s[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">ask</span>(s[i].x2,s[i].y2)+<span class="built_in">ask</span>(s[i].x1<span class="number">-1</span>,s[i].y1<span class="number">-1</span>)-<span class="built_in">ask</span>(s[i].x1<span class="number">-1</span>,s[i].y2)-<span class="built_in">ask</span>(s[i].x2,s[i].y1<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">if</span>(k&gt;=s[i].k) s1[++ll]=s[i];</span><br><span class="line"><span class="keyword">else</span> s[i].k-=k,s2[++rr]=s[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=ll;++i) <span class="keyword">if</span>(!s1[i].id) <span class="built_in">add</span>(s1[i].x1,s1[i].y1,<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=ll;++i) s[l+i<span class="number">-1</span>]=s1[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=rr;++i) s[ll+l+i<span class="number">-1</span>]=s2[i];</span><br><span class="line"><span class="built_in">solve</span>(lv,mid,l,l+ll<span class="number">-1</span>);</span><br><span class="line"><span class="built_in">solve</span>(mid+<span class="number">1</span>,rv,l+ll,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line"><span class="type">int</span> x1,y1,x2,y3,k,x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">cin&gt;&gt;x,s[++tot]=(node)&#123;<span class="number">0</span>,i,j,<span class="number">0</span>,<span class="number">0</span>,x&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;++i) cin&gt;&gt;x1&gt;&gt;y1&gt;&gt;x2&gt;&gt;y3&gt;&gt;k,s[++tot]=(node)&#123;i,x1,y1,x2,y3,k&#125;;</span><br><span class="line"><span class="built_in">solve</span>(<span class="number">0</span>,<span class="number">1e9</span>,<span class="number">1</span>,tot);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CDQ分治"><a href="#CDQ分治" class="headerlink" title="CDQ分治"></a>CDQ分治</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ss</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y,z,v,ans;</span><br><span class="line">&#125;s[N],a[N];</span><br><span class="line"><span class="type">int</span> n,k,c[N],ans[N],d[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=k;x+=<span class="built_in">lowbit</span>(x)) c[x]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) res+=c[x];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(ss a,ss b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.x&lt;b.x||(a.x==b.x&amp;&amp;a.y&lt;b.y)||(a.x==b.x&amp;&amp;a.y==b.y&amp;&amp;a.z&lt;b.z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cdq</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">cdq</span>(l,mid),<span class="built_in">cdq</span>(mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="type">int</span> p=l,q=mid+<span class="number">1</span>,tot=l;</span><br><span class="line"><span class="keyword">while</span>(p&lt;=mid&amp;&amp;q&lt;=r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[p].y&lt;=s[q].y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">add</span>(s[p].z,s[p].v);</span><br><span class="line">a[tot++]=s[p++];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">s[q].ans+=<span class="built_in">ask</span>(s[q].z);</span><br><span class="line">a[tot++]=s[q++];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(q&lt;=r)</span><br><span class="line">&#123;</span><br><span class="line">s[q].ans+=<span class="built_in">ask</span>(s[q].z);</span><br><span class="line">a[tot++]=s[q++];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;p;++i) <span class="built_in">add</span>(s[i].z,-s[i].v);</span><br><span class="line"><span class="keyword">while</span>(p&lt;=mid) a[tot++]=s[p++];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) s[i]=a[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;k;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;s[i].x&gt;&gt;s[i].y&gt;&gt;s[i].z;</span><br><span class="line"><span class="built_in">sort</span>(s+<span class="number">1</span>,s+n+<span class="number">1</span>,cmp);</span><br><span class="line"><span class="type">int</span> tot=<span class="number">0</span>,res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">++res;</span><br><span class="line"><span class="keyword">if</span>(s[i].x!=s[i+<span class="number">1</span>].x||s[i].y!=s[i+<span class="number">1</span>].y||s[i].z!=s[i+<span class="number">1</span>].z) a[++tot]=s[i],a[tot].v=res,res=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i) s[i]=a[i];</span><br><span class="line"><span class="built_in">cdq</span>(<span class="number">1</span>,tot);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i) d[s[i].ans+s[i].v<span class="number">-1</span>]+=s[i].v;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;++i) cout&lt;&lt;d[i]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="KD树"><a href="#KD树" class="headerlink" title="KD树"></a>KD树</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r;</span><br><span class="line"><span class="type">int</span> xl,xr,yl,yr,z;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="title">tree</span><span class="params">(<span class="type">int</span> _l=<span class="number">0</span>,<span class="type">int</span> _r=<span class="number">0</span>,<span class="type">int</span> x1=<span class="number">0</span>,<span class="type">int</span> x2=<span class="number">0</span>,<span class="type">int</span> x3=<span class="number">0</span>,<span class="type">int</span> x4=<span class="number">0</span>,<span class="type">int</span> x5=<span class="number">0</span>)</span></span>&#123;l=_l,r=_r,xl=x1,xr=x2,yl=x3,yr=x4,z=x5;&#125;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y,id;</span><br><span class="line">&#125;s[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp1</span><span class="params">(point x,point y)</span></span>&#123;<span class="keyword">return</span> x.x&lt;y.x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp2</span><span class="params">(point x,point y)</span></span>&#123;<span class="keyword">return</span> x.y&lt;y.y;&#125;</span><br><span class="line"><span class="type">int</span> n,m,ans[N],tp[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> (<span class="type">void</span>)(t[k]=<span class="built_in">tree</span>(l,r,s[l].x,s[l].x,s[l].y,s[l].y,s[l].id),tp[s[l].id]=l);</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">nth_element</span>(s+l,s+mid,s+r+<span class="number">1</span>,d?cmp1:cmp2);</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid,!d);</span><br><span class="line"><span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r,!d);</span><br><span class="line">t[k]=<span class="built_in">tree</span>(l,r,<span class="built_in">min</span>(t[k1].xl,t[k2].xl),<span class="built_in">max</span>(t[k1].xr,t[k2].xr),<span class="built_in">min</span>(t[k1].yl,t[k2].yl),<span class="built_in">max</span>(t[k1].yr,t[k2].yr),<span class="built_in">min</span>(t[k1].z,t[k2].z));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(t[k].l==t[k].r) <span class="keyword">return</span> (<span class="type">void</span>)(t[k].z=n+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">change</span>(x&lt;=t[k1].r?k1:k2,x);</span><br><span class="line">t[k].z=<span class="built_in">min</span>(t[k1].z,t[k2].z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> xl,<span class="type">int</span> xr,<span class="type">int</span> yl,<span class="type">int</span> yr,<span class="type">int</span> &amp;id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(t[k].z&gt;=id||xr&lt;t[k].xl||xl&gt;t[k].xr||t[k].yl&gt;yr||t[k].yr&lt;yl) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(xl&lt;=t[k].xl&amp;&amp;xr&gt;=t[k].xr&amp;&amp;yl&lt;=t[k].yl&amp;&amp;yr&gt;=t[k].yr) <span class="keyword">return</span> (<span class="type">void</span>)(id=<span class="built_in">min</span>(id,t[k].z));</span><br><span class="line"><span class="keyword">if</span>(t[k1].z&lt;t[k2].z) <span class="built_in">ask</span>(k1,xl,xr,yl,yr,id),<span class="built_in">ask</span>(k2,xl,xr,yl,yr,id);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">ask</span>(k2,xl,xr,yl,yr,id),<span class="built_in">ask</span>(k1,xl,xr,yl,yr,id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">squ</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> xl,yl,xr,yr,id,h;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(squ res)<span class="type">const</span>&#123;<span class="keyword">return</span> h&lt;res.h;&#125;</span><br><span class="line">&#125;a[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">cin&gt;&gt;a[i].xl&gt;&gt;a[i].xr&gt;&gt;a[i].yl&gt;&gt;a[i].yr&gt;&gt;a[i].h,a[i].id=i;</span><br><span class="line"><span class="built_in">sort</span>(a+<span class="number">1</span>,a+m+<span class="number">1</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;s[i].x&gt;&gt;s[i].y,s[i].id=i;</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> u,i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">ask</span>(<span class="number">1</span>,a[i].xl,a[i].xr,a[i].yl,a[i].yr,u=n+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(u!=n+<span class="number">1</span>) ans[u]=a[i].id,<span class="built_in">change</span>(<span class="number">1</span>,tp[u]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (t[k].lc)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (t[k].rc)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps=<span class="number">0.6</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y,v;</span><br><span class="line">&#125;s[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp1</span><span class="params">(point x,point y)</span></span>&#123;<span class="keyword">return</span> x.x&lt;y.x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp2</span><span class="params">(point x,point y)</span></span>&#123;<span class="keyword">return</span> x.y&lt;y.y;&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,xl,xr,yl,yr,v,c;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">leaf</span><span class="params">(point k)</span></span>&#123;xl=xr=k.x,yl=yr=k.y,v=k.v,c=<span class="number">1</span>;&#125;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> tot,top,st[N&lt;&lt;<span class="number">1</span>],id;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> u=top?st[top--]:++tot;</span><br><span class="line">t[u]=(tree)&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">return</span> u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pia</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!t[k].lc) <span class="keyword">return</span> (<span class="type">void</span>)(s[++id]=(point)&#123;t[k].xl,t[k].yl,t[k].v&#125;,st[++top]=k);</span><br><span class="line"><span class="built_in">pia</span>(k1),<span class="built_in">pia</span>(k2),st[++top]=k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;<span class="keyword">return</span> t[k].c&gt;<span class="number">3</span>&amp;&amp;<span class="built_in">max</span>(t[k1].c,t[k2].c)&gt;t[k].c*eps;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].v=t[k1].v+t[k2].v,t[k].c=t[k1].c+t[k2].c;</span><br><span class="line">t[k].xl=<span class="built_in">min</span>(t[k1].xl,t[k2].xl),t[k].xr=<span class="built_in">max</span>(t[k1].xr,t[k2].xr);</span><br><span class="line">t[k].yl=<span class="built_in">min</span>(t[k1].yl,t[k2].yl),t[k].yr=<span class="built_in">max</span>(t[k1].yr,t[k2].yr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">k=<span class="built_in">newnode</span>();</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> (<span class="type">void</span>)(t[k].<span class="built_in">leaf</span>(s[l]));</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">nth_element</span>(s+l,s+mid,s+r+<span class="number">1</span>,d?cmp1:cmp2);</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid,!d),<span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r,!d);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line">point o;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> k,point p,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!t[k].lc)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> v1=<span class="built_in">newnode</span>(),v2=<span class="built_in">newnode</span>();</span><br><span class="line">t[v1]=t[k],t[v2].<span class="built_in">leaf</span>(p);</span><br><span class="line">t[k].lc=v1,t[k].rc=v2;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(t[k1].xl&lt;=p.x&amp;&amp;p.x&lt;=t[k1].xr&amp;&amp;t[k1].yl&lt;=p.y&amp;&amp;p.y&lt;=t[k1].yr) <span class="built_in">ins</span>(k1,p,!d);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">ins</span>(k2,p,!d);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">check</span>(k))&#123;o.x=k,o.y=d;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(point p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!tot) <span class="keyword">return</span> t[++tot].<span class="built_in">leaf</span>(p);</span><br><span class="line">o.x=<span class="number">0</span>,<span class="built_in">ins</span>(<span class="number">1</span>,p,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(o.x)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> u;</span><br><span class="line">id=<span class="number">0</span>,<span class="built_in">pia</span>(o.x),<span class="built_in">build</span>(u,<span class="number">1</span>,id,o.y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> xl,<span class="type">int</span> xr,<span class="type">int</span> yl,<span class="type">int</span> yr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(xr&lt;t[k].xl||xl&gt;t[k].xr||yl&gt;t[k].yr||yr&lt;t[k].yl) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(xl&lt;=t[k].xl&amp;&amp;xr&gt;=t[k].xr&amp;&amp;yl&lt;=t[k].yl&amp;&amp;yr&gt;=t[k].yr) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">ask</span>(k1,xl,xr,yl,yr)+<span class="built_in">ask</span>(k2,xl,xr,yl,yr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,opt,xl,xr,yl,yr,ans;</span><br><span class="line">point k;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">3</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) cin&gt;&gt;xl&gt;&gt;yl&gt;&gt;n,<span class="built_in">insert</span>(k=(point)&#123;xl^ans,yl^ans,n^ans&#125;);</span><br><span class="line"><span class="keyword">else</span> cin&gt;&gt;xl&gt;&gt;yl&gt;&gt;xr&gt;&gt;yr,cout&lt;&lt;(ans=<span class="built_in">ask</span>(<span class="number">1</span>,xl^ans,xr^ans,yl^ans,yr^ans))&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="可持久化"><a href="#可持久化" class="headerlink" title="可持久化"></a>可持久化</h3><h4 id="主席树"><a href="#主席树" class="headerlink" title="主席树"></a>主席树</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> root[N],a[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,v;</span><br><span class="line">&#125;t[N*<span class="number">25</span>];</span><br><span class="line"><span class="type">int</span> n,m,tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].v=t[t[k].lc].v+t[t[k].rc].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">k=++tot;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">(t[k].lc,l,mid);</span><br><span class="line"><span class="built_in">build</span>(t[k].rc,mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p,<span class="type">int</span> q,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[p=++tot]=t[q];t[p].v++;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ins</span>(t[p].lc,t[q].lc,l,mid,x,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">ins</span>(t[p].rc,t[q].rc,mid+<span class="number">1</span>,r,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k1,<span class="type">int</span> k2,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=t[t[k1].lc].v-t[t[k2].lc].v) <span class="keyword">return</span> <span class="built_in">ask</span>(t[k1].lc,t[k2].lc,l,mid,x);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">ask</span>(t[k1].rc,t[k2].rc,mid+<span class="number">1</span>,r,x-t[t[k1].lc].v+t[t[k2].lc].v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> b[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> l,r,x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)cin&gt;&gt;a[i],b[i]=a[i];</span><br><span class="line"><span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,a[i])-b;</span><br><span class="line"><span class="built_in">build</span>(root[<span class="number">0</span>],<span class="number">1</span>,M);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">ins</span>(root[i],root[i<span class="number">-1</span>],<span class="number">1</span>,M,a[i],<span class="number">1</span>);</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;l&gt;&gt;r&gt;&gt;x;</span><br><span class="line">cout&lt;&lt;b[<span class="built_in">ask</span>(root[r],root[l<span class="number">-1</span>],<span class="number">1</span>,M,x)]&lt;&lt;endl;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Tries"><a href="#Tries" class="headerlink" title="Tries"></a>Tries</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">6e5</span>*<span class="number">25</span>+<span class="number">5</span>,NN=<span class="number">6e5</span>+<span class="number">5</span>;;</span><br><span class="line"><span class="type">int</span> s[N][<span class="number">2</span>],tot,root[N],t[N],n,m;</span><br><span class="line"><span class="type">int</span> b[NN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v,<span class="type">int</span> tt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">25</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c=v&gt;&gt;i&amp;<span class="number">1</span>;</span><br><span class="line">        s[x][c^<span class="number">1</span>]=s[y][c^<span class="number">1</span>];</span><br><span class="line">        s[x][c]=++tot,t[s[x][c]]=tt;</span><br><span class="line">        x=s[x][c],y=s[y][c];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> l,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">25</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c=(v&gt;&gt;i&amp;<span class="number">1</span>)^<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(t[s[x][c]]&gt;=l) res+=<span class="number">1</span>&lt;&lt;i,x=s[x][c];</span><br><span class="line">        <span class="keyword">else</span> x=s[x][c^<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="type">char</span> opt;</span><br><span class="line">    <span class="type">int</span> l,r,x;++n;</span><br><span class="line">    <span class="built_in">ins</span>(root[<span class="number">1</span>]=++tot,root[<span class="number">0</span>],<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) cin&gt;&gt;x,b[i]=x^b[i<span class="number">-1</span>],<span class="built_in">ins</span>(root[i]=++tot,root[i<span class="number">-1</span>],b[i],i);</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;opt;</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="string">&#x27;A&#x27;</span>) cin&gt;&gt;x,++n,b[n]=b[n<span class="number">-1</span>]^x,<span class="built_in">ins</span>(root[n]=++tot,root[n<span class="number">-1</span>],b[n],n);</span><br><span class="line">        <span class="keyword">else</span> cin&gt;&gt;l&gt;&gt;r&gt;&gt;x,cout&lt;&lt;<span class="built_in">ask</span>(root[r],l,b[n]^x)&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="笛卡尔树"><a href="#笛卡尔树" class="headerlink" title="笛卡尔树"></a>笛卡尔树</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e7</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,p[N];</span><br><span class="line"><span class="type">int</span> st[N],top;</span><br><span class="line"><span class="type">int</span> lc[N],rc[N],f[N];</span><br><span class="line"><span class="type">int</span> ans1,ans2;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;p[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> k=top;</span><br><span class="line"><span class="keyword">while</span>(k&amp;&amp;p[i]&lt;p[st[k]]) --k;</span><br><span class="line"><span class="keyword">if</span>(k) rc[st[k]]=i,f[i]=st[k];</span><br><span class="line"><span class="keyword">if</span>(k&lt;top) lc[i]=st[k+<span class="number">1</span>],f[st[k+<span class="number">1</span>]]=i;</span><br><span class="line">st[top=++k]=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans1^=i*(lc[i]+<span class="number">1</span>),ans2^=i*(rc[i]+<span class="number">1</span>);</span><br><span class="line">cout&lt;&lt;ans1&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;ans2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><h3 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>,j=<span class="number">0</span>;i&lt;=bb;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(j&amp;&amp;b[i+<span class="number">1</span>]!=b[j+<span class="number">1</span>]) j=p[j];</span><br><span class="line"><span class="keyword">if</span>(b[j+<span class="number">1</span>]==b[i+<span class="number">1</span>]) ++j;</span><br><span class="line">p[i+<span class="number">1</span>]=j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Tries-1"><a href="#Tries-1" class="headerlink" title="Tries"></a>Tries</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">char</span> *st)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;st[i];++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c=st[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!s[p][c]) s[p][c]=++tot;</span><br><span class="line">p=s[p][c],++e[p];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">char</span> *st)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;st[i];++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c=st[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!s[p][c]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">p=s[p][c];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> e[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">26</span>;++j) s[i][j]=<span class="number">0</span>;</span><br><span class="line">    tot=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="AC自动机"><a href="#AC自动机" class="headerlink" title="AC自动机"></a>AC自动机</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> u=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;s[i];++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!ch[u][c]) ch[u][c]=++tot;</span><br><span class="line">u=ch[u][c];</span><br><span class="line">&#125;</span><br><span class="line">p[u]++;</span><br><span class="line">&#125;</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)<span class="keyword">if</span>(ch[<span class="number">0</span>][i]) q.<span class="built_in">push</span>(ch[<span class="number">0</span>][i]);</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> u=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!ch[u][i]) ch[u][i]=ch[nxt[u]][i];</span><br><span class="line"><span class="keyword">else</span> q.<span class="built_in">push</span>(ch[u][i]),nxt[ch[u][i]]=ch[nxt[u]][i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> u=<span class="number">0</span>,k;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;s[i];++i)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="type">int</span> c=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">k=u=ch[u][c];</span><br><span class="line"><span class="keyword">while</span>(k&amp;&amp;!t[k])ans+=p[k],t[k]=<span class="number">1</span>,k=nxt[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="后缀数组"><a href="#后缀数组" class="headerlink" title="后缀数组"></a>后缀数组</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sort</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ++cnt[rk[i]=a[i]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cnt[i]+=cnt[i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) sa[cnt[rk[i]]--]=i;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;k&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> num=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n-k+<span class="number">1</span>;i&lt;=n;++i) rk1[++num]=i;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(sa[i]&gt;k) rk1[++num]=sa[i]-k;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cnt[i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ++cnt[rk[i]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cnt[i]+=cnt[i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i;--i) sa[cnt[rk[rk1[i]]]--]=rk1[i],rk1[i]=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">swap</span>(rk,rk1);</span><br><span class="line">rk[sa[<span class="number">1</span>]]=<span class="number">1</span>,num=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">rk[sa[i]]=(rk1[sa[i]]==rk1[sa[i<span class="number">-1</span>]]&amp;&amp;rk1[sa[i]+k]==rk1[sa[i<span class="number">-1</span>]+k])?num:++num;</span><br><span class="line"><span class="keyword">if</span>(num==n) <span class="keyword">return</span>;</span><br><span class="line">m=num;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h2><h3 id="邻接表"><a href="#邻接表" class="headerlink" title="邻接表"></a>邻接表</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++tot]=y,ne[tot]=f[x],f[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++tot]=y,e[tot]=z,ne[tot]=f[x],f[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//变量冲突时</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++tot]=y,e[tot]=z,ne[tot]=head[x],head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//网络流 费用流</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=f[x],f[x]=tot,e[tot]=z;</span><br><span class="line">to[++tot]=x,ne[tot]=f[y],f[y]=tot,e[tot]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z,<span class="type">int</span> o)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=f[x],f[x]=tot,w[tot]=o,e[tot]=z;</span><br><span class="line">to[++tot]=x,ne[tot]=f[y],f[y]=tot,w[tot]=-o,e[tot]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最短路"><a href="#最短路" class="headerlink" title="最短路"></a>最短路</h3><h4 id="dijkstra"><a href="#dijkstra" class="headerlink" title="dijkstra"></a>dijkstra</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> mp(a,b) make_pair(a,b)</span></span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dijkstra</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">2147483647</span>;</span><br><span class="line">d[s]=<span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>,s));</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">            <span class="type">int</span> x=q.<span class="built_in">top</span>().second;q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(v[x]) <span class="keyword">continue</span>;</span><br><span class="line">            v[x]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(d[x]+e[i]&lt;d[y=to[i]])</span><br><span class="line">                &#123;</span><br><span class="line">                    d[y]=d[x]+e[i];</span><br><span class="line">                    q.<span class="built_in">push</span>(<span class="built_in">mp</span>(-d[y],y));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="spfa"><a href="#spfa" class="headerlink" title="spfa"></a>spfa</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">2147483647</span>;</span><br><span class="line">d[s]=<span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(s);</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line">v[x]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(d[y=to[i]]&gt;d[x]+e[i])</span><br><span class="line">&#123;</span><br><span class="line">d[y]=d[x]+e[i];</span><br><span class="line"><span class="keyword">if</span>(!v[y]) q.<span class="built_in">push</span>(y),v[y]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="floyd"><a href="#floyd" class="headerlink" title="floyd"></a>floyd</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">floyd</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j) d[i][j]=<span class="built_in">min</span>(d[i][k]+d[k][j],d[i][j]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Johnson"><a href="#Johnson" class="headerlink" title="Johnson"></a>Johnson</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp(a,b) make_pair(a,b) </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[N],f[N],e[N],ne[N],cnt[N];</span><br><span class="line"><span class="type">int</span> n,m,tot;</span><br><span class="line"><span class="type">bool</span> v[N];</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> d[N],h[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=f[x],e[tot]=z,f[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;q1;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">2147483647</span>;</span><br><span class="line">d[s]=<span class="number">0</span>;cnt[s]=<span class="number">1</span>;</span><br><span class="line">q1.<span class="built_in">push</span>(s);</span><br><span class="line"><span class="keyword">while</span>(!q1.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=q1.<span class="built_in">front</span>();</span><br><span class="line">q1.<span class="built_in">pop</span>();</span><br><span class="line">v[x]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(d[y=to[i]]&gt;d[x]+e[i])</span><br><span class="line">&#123;</span><br><span class="line">d[y]=d[x]+e[i];</span><br><span class="line">cnt[y]=cnt[x]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt[y]==n+<span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(!v[y]) q1.<span class="built_in">push</span>(y),v[y]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dijkstra</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">1e9</span>;</span><br><span class="line">d[s]=<span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>,s));</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=q.<span class="built_in">top</span>().second;</span><br><span class="line">q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(d[x]+e[i]&lt;d[y=to[i]])</span><br><span class="line">&#123;</span><br><span class="line">d[y]=d[x]+e[i];</span><br><span class="line">q.<span class="built_in">push</span>(<span class="built_in">mp</span>(-d[y],y));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;x&gt;&gt;y&gt;&gt;z,<span class="built_in">add</span>(x,y,z);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">add</span>(<span class="number">0</span>,i,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">spfa</span>(<span class="number">0</span>))</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=f[i];j;j=ne[j]) e[j]+=h[i]-h[to[j]];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">dijkstra</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(d[j]==<span class="number">1e9</span>) ans+=j*<span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">else</span> ans+=j*(d[j]+h[j]-h[i]);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最小生成树"><a href="#最小生成树" class="headerlink" title="最小生成树"></a>最小生成树</h3><h4 id="Kruskal"><a href="#Kruskal" class="headerlink" title="Kruskal"></a>Kruskal</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> x,y,z;</span><br><span class="line">    <span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> edge &amp;res)<span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> z&lt;res.z;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;e[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x==f[x]?x:f[x]=<span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">kruskal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i]=i;</span><br><span class="line">    <span class="built_in">sort</span>(e+<span class="number">1</span>,e+m+<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> tot=<span class="number">1</span>,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=<span class="built_in">find</span>(e[i].x),y=<span class="built_in">find</span>(e[i].y);</span><br><span class="line">        <span class="keyword">if</span>(x==y) <span class="keyword">continue</span>;</span><br><span class="line">        f[x]=y,ans+=e[i].z;</span><br><span class="line">        <span class="keyword">if</span>(++tot==n) <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Prim"><a href="#Prim" class="headerlink" title="Prim"></a>Prim</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> mp(a,b) make_pair(a,b)</span></span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;q;</span><br><span class="line"><span class="type">int</span> tot,ans;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Prim</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">2147483647</span>;</span><br><span class="line">d[s]=<span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>,s));</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">            <span class="type">int</span> x=q.<span class="built_in">top</span>().second;q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(v[x]) <span class="keyword">continue</span>;</span><br><span class="line">            v[x]=<span class="number">1</span>;</span><br><span class="line">            ans+=d[x];</span><br><span class="line">            <span class="keyword">if</span>(++tot==n) <span class="keyword">return</span> ans;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(e[i]&lt;d[y=to[i]])</span><br><span class="line">                &#123;</span><br><span class="line">                    d[y]=e[i];</span><br><span class="line">                    q.<span class="built_in">push</span>(<span class="built_in">mp</span>(-d[y],y));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Boruvka-Sollin"><a href="#Boruvka-Sollin" class="headerlink" title="Borůvka(Sollin)"></a>Borůvka(Sollin)</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line">&#125;e[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x==f[x]?x:f[x]=<span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> tot=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sollin</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i]=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">bool</span> fl=<span class="number">1</span>;fl;)</span><br><span class="line">    &#123;</span><br><span class="line">        fl=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) p[i]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> x=<span class="built_in">find</span>(e[i].x),y=<span class="built_in">find</span>(e[i].y);</span><br><span class="line">            <span class="keyword">if</span>(x==y||v[i]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(!p[x]||e[i].z&lt;e[p[x]].z) p[x]=i;</span><br><span class="line">            <span class="keyword">if</span>(!p[y]||e[i].z&lt;e[p[y]].z) p[y]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(p[i]&amp;&amp;!v[p[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                v[p[i]]=<span class="number">1</span>;</span><br><span class="line">                fl=<span class="number">1</span>;</span><br><span class="line">                ans+=e[p[i]].z;</span><br><span class="line">                <span class="keyword">if</span>(++tot==n) <span class="keyword">return</span> ans;</span><br><span class="line">                f[<span class="built_in">find</span>(e[p[i]].x)]=<span class="built_in">find</span>(e[p[i]].y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="附：严格次小生成树"><a href="#附：严格次小生成树" class="headerlink" title="附：严格次小生成树"></a>附：严格次小生成树</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>,NN=<span class="number">20</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> head[N],to[N],ne[N],tot,e[N],v[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,e[tot]=z,ne[tot]=head[x],head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> p[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x==p[x]?x:p[x]=<span class="built_in">find</span>(p[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> edge &amp;res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> z&lt;res.z;</span><br><span class="line">&#125;</span><br><span class="line">&#125;ed[N];</span><br><span class="line"><span class="type">int</span> f[N][NN],g1[N][NN],g2[N][NN];</span><br><span class="line"><span class="type">int</span> d[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">d[x]=d[fa]+<span class="number">1</span>,f[x][<span class="number">0</span>]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;i++) f[x][i]=f[f[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a[<span class="number">4</span>]=&#123;g1[x][i<span class="number">-1</span>],g2[x][i<span class="number">-1</span>],g1[f[x][i<span class="number">-1</span>]][i<span class="number">-1</span>],g2[f[x][i<span class="number">-1</span>]][i<span class="number">-1</span>]&#125;;</span><br><span class="line"><span class="built_in">sort</span>(a,a+<span class="number">4</span>);</span><br><span class="line">g1[x][i]=a[<span class="number">3</span>];</span><br><span class="line"><span class="type">int</span> id=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">while</span>(a[id]==a[<span class="number">3</span>]&amp;&amp;id&gt;<span class="number">-1</span>) --id;</span><br><span class="line"><span class="keyword">if</span>(id&gt;<span class="number">-1</span>) g2[x][i]=a[id];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line">g1[y][<span class="number">0</span>]=e[i],g2[y][<span class="number">0</span>]=-INF;</span><br><span class="line"><span class="built_in">dfs</span>(y,x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">1</span>,ans,res=INF;</span><br><span class="line"><span class="type">int</span> recond;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(d[x]&lt;d[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)<span class="keyword">if</span>(d[f[x][i]]&gt;=d[y]) x=f[x][i];</span><br><span class="line"><span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)<span class="keyword">if</span>(f[x][i]!=f[y][i]) x=f[x][i],y=f[y][i];</span><br><span class="line"><span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> mx=-INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(d[f[x][i]]&gt;=d[y]) mx=<span class="built_in">max</span>(mx,g1[x][i]==recond?g2[x][i]:g1[x][i]),x=f[x][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;ed[i].x&gt;&gt;ed[i].y&gt;&gt;ed[i].z;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) p[i]=i;</span><br><span class="line"><span class="built_in">sort</span>(ed+<span class="number">1</span>,ed+m+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=<span class="built_in">find</span>(ed[i].x),y=<span class="built_in">find</span>(ed[i].y);</span><br><span class="line"><span class="keyword">if</span>(x==y)<span class="keyword">continue</span>;</span><br><span class="line">p[x]=y,ans+=ed[i].z,v[i]=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">add</span>(ed[i].x,ed[i].y,ed[i].z),<span class="built_in">add</span>(ed[i].y,ed[i].x,ed[i].z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v[i]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">lca</span>(ed[i].x,ed[i].y);</span><br><span class="line">recond=ed[i].z;</span><br><span class="line"><span class="type">int</span> k1=<span class="built_in">find</span>(ed[i].x,k),k2=<span class="built_in">find</span>(ed[i].y,k);</span><br><span class="line">res=<span class="built_in">min</span>(res,<span class="built_in">min</span>(recond-k1,recond-k2));</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;ans+res;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="判负环"><a href="#判负环" class="headerlink" title="判负环"></a>判负环</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">2e9</span>;</span><br><span class="line">d[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=q.<span class="built_in">front</span>();</span><br><span class="line">q.<span class="built_in">pop</span>();</span><br><span class="line">v[x]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(d[y=to[i]]&gt;d[x]+e[i])</span><br><span class="line">&#123;</span><br><span class="line">d[y]=d[x]+e[i];</span><br><span class="line"><span class="keyword">if</span>(!v[y]) q.<span class="built_in">push</span>(y),v[y]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>((cnt[y]=cnt[x]+<span class="number">1</span>)==n) <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="差分约束"><a href="#差分约束" class="headerlink" title="差分约束"></a>差分约束</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> to[N],ne[N],f[N],e[N],tot=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> v[N],cnt[N],d[N],q[N],l=<span class="number">1</span>,r;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++tot]=y,ne[tot]=f[x],f[x]=tot,e[tot]=z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">2147483647</span>;</span><br><span class="line">cnt[x]=<span class="number">1</span>;</span><br><span class="line">q[++r]=x;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;=r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=q[l++];</span><br><span class="line">        <span class="keyword">if</span>(l==N) l=<span class="number">0</span>;</span><br><span class="line">        v[x]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(d[x]+e[i]&lt;d[y=to[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                d[y]=d[x]+e[i];</span><br><span class="line">                cnt[y]=cnt[x]+<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(cnt[y]==n+<span class="number">2</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;NO&quot;</span>;</span><br><span class="line">                    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(!v[y])</span><br><span class="line">                &#123;</span><br><span class="line">                    v[y]=<span class="number">1</span>,q[++r]=y;</span><br><span class="line">                    <span class="keyword">if</span>(r==N) r=<span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="type">int</span> x,a,b;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b&gt;&gt;x;</span><br><span class="line">        <span class="built_in">add</span>(b,a,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">add</span>(<span class="number">0</span>,i,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">spfa</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cout&lt;&lt;d[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// d[a]-d[b]&lt;=x</span></span><br></pre></td></tr></table></figure><h3 id="lca"><a href="#lca" class="headerlink" title="lca"></a>lca</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//倍增法</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">d[x]=d[fa]+<span class="number">1</span>,f[x][<span class="number">0</span>]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;i++) f[x][i]=f[f[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=fa) <span class="built_in">dfs</span>(y,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(d[x]&lt;d[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)<span class="keyword">if</span>(d[f[x][i]]&gt;=d[y]) x=f[x][i];</span><br><span class="line"><span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)<span class="keyword">if</span>(f[x][i]!=f[y][i]) x=f[x][i],y=f[y][i];</span><br><span class="line"><span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//时间戳</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tin[x]=++t;</span><br><span class="line">d[x]=d[fa]+<span class="number">1</span>,f[x][<span class="number">0</span>]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;i++) f[x][i]=f[f[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=fa) <span class="built_in">dfs</span>(y,x);</span><br><span class="line">    tout[x]=++t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> tin[x]&lt;=tin[y]&amp;&amp;tout[x]&gt;=tout[y];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(y,x)) <span class="keyword">return</span> y;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(x,y)) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">18</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">pd</span>(fa[x][i],y))x=fa[x][i];</span><br><span class="line"><span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//树剖</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dep[x]=dep[fa]+<span class="number">1</span>;</span><br><span class="line">s[x]=<span class="number">1</span>;</span><br><span class="line">f[x]=fa;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=fa)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">dfs1</span>(y,x);</span><br><span class="line">s[x]+=s[y];</span><br><span class="line"><span class="keyword">if</span>(s[y]&gt;s[son[x]]) son[x]=y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">top[x]=t;</span><br><span class="line"><span class="keyword">if</span>(!son[x]) <span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">dfs2</span>(son[x],t);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line">y=to[i];</span><br><span class="line"><span class="keyword">if</span>(y==f[x]||y==son[x]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs2</span>(y,y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">x=f[top[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ST表</span></span><br><span class="line"><span class="comment">略</span></span><br><span class="line"><span class="comment">tarjan</span></span><br><span class="line"><span class="comment">略</span></span><br><span class="line"><span class="comment">四毛子(一半)</span></span><br><span class="line"><span class="comment">略</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="树的直径"><a href="#树的直径" class="headerlink" title="树的直径"></a>树的直径</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//树形DP</span></span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x，<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> d=<span class="number">0</span>,d1=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line"><span class="type">int</span> d2=<span class="built_in">dp</span>(y)+e[i];</span><br><span class="line"><span class="keyword">if</span>(d2&gt;d) d1=d,d=d2;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(d2&gt;d1) d1=d2;</span><br><span class="line">&#125;</span><br><span class="line">res=<span class="built_in">max</span>(d1+d,res);</span><br><span class="line"><span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="有向图tarjan"><a href="#有向图tarjan" class="headerlink" title="有向图tarjan"></a>有向图tarjan</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dfn[x]=low[x]=++t,st[++top]=x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!dfn[y=to[i]]) <span class="built_in">tarjan</span>(y),low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!c[y]) low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(low[x]==dfn[x])</span><br><span class="line">&#123;</span><br><span class="line">++cnt;</span><br><span class="line"><span class="keyword">while</span>(st[top+<span class="number">1</span>]!=x) s[cnt].<span class="built_in">push_back</span>(st[top]),c[st[top--]]=cnt,++size[cnt];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="无向图tarjan"><a href="#无向图tarjan" class="headerlink" title="无向图tarjan"></a>无向图tarjan</h3><h4 id="桥"><a href="#桥" class="headerlink" title="桥"></a>桥</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> ine)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">low[x]=dfn[x]=++t;</span><br><span class="line">st[++top]=x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!dfn[y=to[i]])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">tarjan</span>(y,i),low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line"><span class="keyword">if</span>(low[y]&gt;dfn[x]) v[i]=v[i^<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(i!=(ine^<span class="number">1</span>)) low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="边双连通分量"><a href="#边双连通分量" class="headerlink" title="边双连通分量"></a>边双连通分量</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> ine)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">low[x]=dfn[x]=++t;</span><br><span class="line">st[++top]=x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!dfn[y=to[i]])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">tarjan</span>(y,i),low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line"><span class="keyword">if</span>(low[y]&gt;dfn[x])v[i]=v[i^<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(i!=(ine^<span class="number">1</span>)) low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(low[x]==dfn[x])</span><br><span class="line">&#123;</span><br><span class="line">++cnt;</span><br><span class="line"><span class="keyword">while</span>(st[top+<span class="number">1</span>]!=x) s[cnt].<span class="built_in">push_back</span>(st[top]),c[st[top--]]=cnt;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="割点"><a href="#割点" class="headerlink" title="割点"></a>割点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dfn[x]=low[x]=++idx;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!dfn[y=to[i]])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">tarjan</span>(y),low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line"><span class="keyword">if</span>(low[y]&gt;=dfn[x]) <span class="keyword">if</span>(res++||root!=x) s[++cnt]=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="点双连通分量"><a href="#点双连通分量" class="headerlink" title="点双连通分量"></a>点双连通分量</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    low[x]=dfn[x]=++t;</span><br><span class="line">    st[++top]=x;</span><br><span class="line">    <span class="keyword">if</span>(!f[x]&amp;&amp;!fa)</span><br><span class="line">    &#123;</span><br><span class="line">        s[++cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[y=to[i]])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(y,i),low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line">            <span class="keyword">if</span>(low[y]&gt;=dfn[x])</span><br><span class="line">            &#123;</span><br><span class="line">                ++cnt;</span><br><span class="line">                <span class="keyword">while</span>(st[top+<span class="number">1</span>]!=y) s[cnt].<span class="built_in">push_back</span>(st[top--]);</span><br><span class="line">                s[cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(y!=fa) low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="欧拉回路"><a href="#欧拉回路" class="headerlink" title="欧拉回路"></a>欧拉回路</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">euler</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">st[++top]=s;</span><br><span class="line"><span class="keyword">while</span>(top)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=st[top],i=f[x];</span><br><span class="line"><span class="keyword">while</span> (i&amp;&amp;vis[i]) i=ne[i];</span><br><span class="line"><span class="keyword">if</span>(i) st[++top]=to[i],vis[i]=vis[i^<span class="number">1</span>]=<span class="number">1</span>,f[x]=ne[i]; </span><br><span class="line"><span class="keyword">else</span> --top,ans[++cnt]=x;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="二分图"><a href="#二分图" class="headerlink" title="二分图"></a>二分图</h3><h4 id="判定"><a href="#判定" class="headerlink" title="判定"></a>判定</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">color</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> d)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    v[x]=d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!v[y=to[i]]) <span class="built_in">dfs</span>(y,<span class="number">3</span>-x);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(v[y]==v[x]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="最大匹配"><a href="#最大匹配" class="headerlink" title="最大匹配"></a>最大匹配</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(v[y=to[i]]) <span class="keyword">continue</span>;</span><br><span class="line">        v[y]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(!mat[y]||<span class="built_in">find</span>(mat[y]))</span><br><span class="line">        &#123;</span><br><span class="line">            mat[y]=x;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">match</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span> v);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">find</span>(i)) ++ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="最小点覆盖-最大匹配"><a href="#最小点覆盖-最大匹配" class="headerlink" title="最小点覆盖=最大匹配"></a>最小点覆盖=最大匹配</h4><h4 id="最大独立集-总数-最小点覆盖"><a href="#最大独立集-总数-最小点覆盖" class="headerlink" title="最大独立集=总数-最小点覆盖"></a>最大独立集=总数-最小点覆盖</h4><h3 id="网络流"><a href="#网络流" class="headerlink" title="网络流"></a>网络流</h3><h4 id="最大流"><a href="#最大流" class="headerlink" title="最大流"></a>最大流</h4><h5 id="Dinic"><a href="#Dinic" class="headerlink" title="Dinic"></a>Dinic</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dinic</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> flow)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x==t) <span class="keyword">return</span> flow;</span><br><span class="line"><span class="type">int</span> rest=flow;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=cur[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line">cur[x]=i;</span><br><span class="line"><span class="keyword">if</span>(e[i]&amp;&amp;d[y=to[i]]==d[x]+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">dinic</span>(y,<span class="built_in">min</span>(rest,e[i]));</span><br><span class="line"><span class="keyword">if</span>(!k) d[y]=<span class="number">0</span>;</span><br><span class="line">e[i]-=k,e[i^<span class="number">1</span>]+=k,rest-=k;</span><br><span class="line"><span class="keyword">if</span>(!rest) <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow-rest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cur[i]=f[i],d[i]=<span class="number">0</span>;</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">q.<span class="built_in">push</span>(s);</span><br><span class="line">d[s]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=f[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(e[i]&amp;&amp;!d[y=to[i]])</span><br><span class="line">&#123;</span><br><span class="line">q.<span class="built_in">push</span>(y);d[y]=d[x]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(y==t) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Dinic</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>,k;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">bfs</span>())</span><br><span class="line"><span class="keyword">while</span>(k=<span class="built_in">dinic</span>(s,<span class="number">1</span>&lt;&lt;<span class="number">30</span>)) res+=k;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="费用流"><a href="#费用流" class="headerlink" title="费用流"></a>费用流</h4><h5 id="SSP"><a href="#SSP" class="headerlink" title="SSP"></a>SSP</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">0x3f3f3f3f</span>,c[i]=f[i],v[i]=<span class="number">0</span>;</span><br><span class="line">d[s]=<span class="number">0</span>;</span><br><span class="line">queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">q.<span class="built_in">push</span>(s);</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line">v[x]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(d[y=to[i]]&gt;d[x]+w[i]&amp;&amp;e[i])</span><br><span class="line">&#123;</span><br><span class="line">d[y]=d[x]+w[i];</span><br><span class="line"><span class="keyword">if</span>(!v[y]) q.<span class="built_in">push</span>(y),v[y]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> d[t]!=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dinic</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> flow)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x==t)</span><br><span class="line">&#123;</span><br><span class="line">ans+=flow,res+=flow*d[t];</span><br><span class="line">v[t]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> used=<span class="number">0</span>;</span><br><span class="line">v[x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=c[x],y;i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line">y=to[i];</span><br><span class="line"><span class="keyword">if</span>((!v[y]||y==t)&amp;&amp;e[i]&amp;&amp;d[x]+w[i]==d[y])</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">dinic</span>(y,<span class="built_in">min</span>(flow-used,e[i]));</span><br><span class="line"><span class="keyword">if</span>(!k) <span class="keyword">continue</span>;</span><br><span class="line">e[i]-=k,e[i^<span class="number">1</span>]+=k,used+=k;</span><br><span class="line"><span class="keyword">if</span>(used==flow) <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> used;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">SSP</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        v[t]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(v[t])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span> v);</span><br><span class="line">            <span class="built_in">dinic</span>(s,<span class="number">1</span>&lt;&lt;<span class="number">30</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h2><h3 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) (res*=a)%=mod;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>,(a*=a)%=mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//矩阵快速幂</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> f[N][N],m,n;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j) f[i][j]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _m,<span class="type">int</span> _n)</span></span>&#123;m=_m,n=_n;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> node <span class="title">mul</span><span class="params">(node x,node y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">node z;</span><br><span class="line">z.<span class="built_in">init</span>(x.m,y.n);</span><br><span class="line">z.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=x.m;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=x.n;++k)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=y.n;++j)</span><br><span class="line">                (z.f[i][j]+=x.f[i][k]*y.f[k][j])%=mod;</span><br><span class="line"><span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> node <span class="title">qpow</span><span class="params">(node x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">node res=x;--y;</span><br><span class="line"><span class="keyword">while</span>(y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=<span class="built_in">mul</span>(res,x);</span><br><span class="line">y&gt;&gt;=<span class="number">1</span>,x=<span class="built_in">mul</span>(x,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h3><h4 id="筛质数"><a href="#筛质数" class="headerlink" title="筛质数"></a>筛质数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">primes</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i]) v[i]=i,prime[++cnt]=i;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(prime[j]&gt;v[i]||prime[j]&gt;n/i) <span class="keyword">break</span>;</span><br><span class="line">v[i*prime[j]]=prime[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="筛欧拉函数"><a href="#筛欧拉函数" class="headerlink" title="筛欧拉函数"></a>筛欧拉函数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i]) v[i]=i,prime[++cnt]=i,phi[i]=i<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(prime[j]&gt;v[i]||prime[j]*i&gt;n) <span class="keyword">break</span>;</span><br><span class="line">v[i*prime[j]]=prime[j];</span><br><span class="line">phi[i*prime[j]]=phi[i]*(i%prime[j]?prime[j]<span class="number">-1</span>:prime[j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="筛莫比乌斯函数"><a href="#筛莫比乌斯函数" class="headerlink" title="筛莫比乌斯函数"></a>筛莫比乌斯函数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mobius</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!v[i]) prime[++cnt]=i,mu[i]=<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=cnt;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            v[prime[j]*i]=prime[j];</span><br><span class="line">            mu[i*prime[j]]=i%prime[j]?-mu[i]:<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Exgcd"><a href="#Exgcd" class="headerlink" title="Exgcd"></a>Exgcd</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;d,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">        d=a,x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exgcd</span>(b,a%b,d,y,x);</span><br><span class="line">    y-=a/b*x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">BSGS</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b%p==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> k=<span class="built_in">sqrt</span>(p)+<span class="number">1</span>;</span><br><span class="line">    map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,j=b%p;i&lt;k;++i) mp[j]=i,(j*=a)%=p;</span><br><span class="line">    <span class="type">int</span> s=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;k;++i) (s*=a)%=p;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>,j=s;i&lt;=k;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(mp.<span class="built_in">find</span>(j)!=mp.<span class="built_in">end</span>()) <span class="keyword">return</span> i*k-mp[j];</span><br><span class="line">        (j*=s)%=p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CRT"><a href="#CRT" class="headerlink" title="CRT"></a>CRT</h3><h4 id="CRT-1"><a href="#CRT-1" class="headerlink" title="CRT"></a>CRT</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">CRT</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> M=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i]&gt;&gt;b[i],M*=a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        m[i]=M/a[i];</span><br><span class="line">        <span class="built_in">exgcd</span>(m[i],a[i],d,x,y);</span><br><span class="line">        ans=((ans+m[i]*x*b[i])%M+M)%M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="EXCRT"><a href="#EXCRT" class="headerlink" title="EXCRT"></a>EXCRT</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">EXCRT</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin&gt;&gt;lcm&gt;&gt;ans;</span><br><span class="line">    ans=(ans%lcm+lcm)%lcm;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">        b=(b-ans%a+a)%a;</span><br><span class="line">        <span class="built_in">exgcd</span>(lcm,a,d,x,y);</span><br><span class="line">        <span class="type">int</span> k=x*(b/d)%a;</span><br><span class="line">        ans+=k*lcm;</span><br><span class="line">        lcm=lcm/d*a;</span><br><span class="line">        ans=(ans%lcm+lcm)%lcm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="逆元递推"><a href="#逆元递推" class="headerlink" title="逆元递推"></a>逆元递推</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    inv[<span class="number">1</span>]=jcinv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) inv[i]=(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) jcinv[i]=jcinv[i<span class="number">-1</span>]*inv[i]%mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Lucas定理"><a href="#Lucas定理" class="headerlink" title="Lucas定理"></a>Lucas定理</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> jc[x]*jcinv[y]*jcinv[x-y]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Lucas</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;mod) <span class="keyword">return</span> <span class="built_in">C</span>(x,y);</span><br><span class="line">    <span class="keyword">return</span>  <span class="built_in">Lucas</span>(x/mod,y/mod)*<span class="built_in">Lucas</span>(x%mod,y%mod)%mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数论分块"><a href="#数论分块" class="headerlink" title="数论分块"></a>数论分块</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">1</span>,r;l&lt;=n;l=r+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r=n/(n/l);</span><br><span class="line">        ans+=(k/l)*(r-l+<span class="number">1</span>)*(l+r)/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="高斯消元"><a href="#高斯消元" class="headerlink" title="高斯消元"></a>高斯消元</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> c=<span class="number">1</span>,r=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(;c&lt;=n;++c)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> t=r;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=r+<span class="number">1</span>;i&lt;=n;++i)<span class="keyword">if</span>(<span class="built_in">fabs</span>(a[i][c])&gt;<span class="built_in">fabs</span>(a[t][c])) t=i;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">fabs</span>(a[t][c])&lt;eps) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=c;i&lt;=n+<span class="number">1</span>;++i) <span class="built_in">swap</span>(a[t][i],a[r][i]);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=n+<span class="number">1</span>;i&gt;=c;--i) a[r][i]/=a[r][c];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=r+<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j=n+<span class="number">1</span>;j&gt;=c;--j) a[i][j]-=a[r][j]*a[i][c];</span><br><span class="line">            r++;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">if</span>(r&lt;=n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=r;i&lt;=n;++i)<span class="keyword">if</span>(<span class="built_in">fabs</span>(a[i][n+<span class="number">1</span>])&gt;eps) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i;--i)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;=n;++j)a[i][n+<span class="number">1</span>]-=a[i][j]*a[j][n+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="快读快写"><a href="#快读快写" class="headerlink" title="快读快写"></a>快读快写</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;c=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+c<span class="number">-48</span>,c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> sta[<span class="number">35</span>],top=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;<span class="number">0</span>)x=-x,<span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        sta[top++]=x%<span class="number">10</span>,x/=<span class="number">10</span>;</span><br><span class="line">    &#125;<span class="keyword">while</span>(x);</span><br><span class="line">    <span class="keyword">while</span>(top) <span class="built_in">putchar</span>(sta[--top]+<span class="number">48</span>); </span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数据生成和对拍"><a href="#数据生成和对拍" class="headerlink" title="数据生成和对拍"></a>数据生成和对拍</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成n个1e9以内的数 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> mod1=<span class="number">1e6</span><span class="number">-1</span>,mod2=<span class="number">1e9</span><span class="number">-1</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line">    <span class="type">int</span> n=<span class="built_in">rand</span>()%mod1;</span><br><span class="line">    cout&lt;&lt;n&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cout&lt;&lt;<span class="built_in">pow</span>(<span class="number">-1</span>, <span class="built_in">rand</span>())*(<span class="built_in">rand</span>()*<span class="built_in">rand</span>()%mod2)&lt;&lt; <span class="string">&quot; &quot;</span>;<span class="comment">//负数 </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cout&lt;&lt;<span class="built_in">rand</span>()*<span class="built_in">rand</span>()%mod2&lt;&lt; <span class="string">&quot; &quot;</span>;<span class="comment">//正数 </span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(++t) &#123;</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;data.exe &gt; data.txt&quot;</span>);</span><br><span class="line">        <span class="type">int</span> t1=<span class="built_in">clock</span>();</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;1.exe &lt; data.txt &gt; 1.txt&quot;</span>);</span><br><span class="line">        <span class="type">int</span> t2=<span class="built_in">clock</span>();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;测试点%d 用时%dms\n&quot;</span>,t,t2-t1);</span><br><span class="line">        <span class="keyword">if</span>(t2-t1&gt;<span class="number">1000</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;超时！&quot;</span>);</span><br><span class="line">            <span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;2.exe &lt; data.txt &gt; 2.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">system</span>(<span class="string">&quot;fc 1.txt 2.txt&quot;</span>))    <span class="type">char</span> c=<span class="built_in">getchar</span>();   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="悬线法"><a href="#悬线法" class="headerlink" title="悬线法"></a>悬线法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> a[N][N];</span><br><span class="line"><span class="type">int</span> n,m,ans;</span><br><span class="line"><span class="type">char</span> c;</span><br><span class="line"><span class="type">int</span> l[N][N],r[N][N],up[N][N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</span><br><span class="line">cin&gt;&gt;c,a[i][j]=c==<span class="string">&#x27;F&#x27;</span>,l[i][j]=r[i][j]=j,up[i][j]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">2</span>;j&lt;=m;++j)</span><br><span class="line"><span class="keyword">if</span>(a[i][j]&amp;&amp;a[i][j<span class="number">-1</span>]) l[i][j]=l[i][j<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=m<span class="number">-1</span>;j;--j)</span><br><span class="line"><span class="keyword">if</span>(a[i][j]&amp;&amp;a[i][j+<span class="number">1</span>]) r[i][j]=r[i][j+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i&gt;<span class="number">1</span>&amp;&amp;a[i][j]&amp;&amp;a[i<span class="number">-1</span>][j])</span><br><span class="line">&#123;</span><br><span class="line">l[i][j]=<span class="built_in">max</span>(l[i][j],l[i<span class="number">-1</span>][j]);</span><br><span class="line">r[i][j]=<span class="built_in">min</span>(r[i][j],r[i<span class="number">-1</span>][j]);</span><br><span class="line">up[i][j]=up[i<span class="number">-1</span>][j]+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(a[i][j]) ans=<span class="built_in">max</span>(ans,(r[i][j]-l[i][j]+<span class="number">1</span>)*up[i][j]);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="模拟退火"><a href="#模拟退火" class="headerlink" title="模拟退火"></a>模拟退火</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">double</span> ans=<span class="number">1e18</span>,ansx,ansy,x,y,t;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> bl=<span class="number">0.999</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y,w;</span><br><span class="line">&#125;a[<span class="number">1005</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">double</span> <span class="title">energy</span><span class="params">(<span class="type">double</span> x,<span class="type">double</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">double</span> rt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">double</span> xx=x-a[i].x,yy=y-a[i].y;</span><br><span class="line">rt+=<span class="built_in">sqrt</span>(xx*xx+yy*yy)*a[i].w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> rt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">SA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">double</span> x=ansx,y=ansy;</span><br><span class="line">t=<span class="number">20000</span>;</span><br><span class="line"><span class="keyword">while</span>(t&gt;<span class="number">1e-15</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">double</span> xx=x+((<span class="built_in">rand</span>()&lt;&lt;<span class="number">1</span>)-RAND_MAX)*t;</span><br><span class="line"><span class="type">double</span> yy=y+((<span class="built_in">rand</span>()&lt;&lt;<span class="number">1</span>)-RAND_MAX)*t;</span><br><span class="line"><span class="type">double</span> now=<span class="built_in">energy</span>(xx,yy);</span><br><span class="line"><span class="type">double</span> k=now-ans;</span><br><span class="line"><span class="keyword">if</span>(k&lt;<span class="number">0</span>)ansx=x=xx,ansy=y=yy,ans=now;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">exp</span>(-k/t)*RAND_MAX&gt;<span class="built_in">rand</span>()) x=xx,y=yy;</span><br><span class="line">t*=bl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="type">int</span> sumx=<span class="number">0</span>,sumy=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>,&amp;a[i].x,&amp;a[i].y,&amp;a[i].w);</span><br><span class="line">sumx+=a[i].x,sumy+=a[i].y;</span><br><span class="line">&#125;</span><br><span class="line">ansx=(<span class="type">double</span>)sumx/n,ansy=(<span class="type">double</span>)sumy/n;</span><br><span class="line"><span class="built_in">SA</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.3f %.3f\n&quot;</span>,ansx,ansy);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 模板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>追番记录</title>
      <link href="//%E7%94%9F%E6%B4%BB/%E8%BF%BD%E7%95%AA%E8%AE%B0%E5%BD%95/"/>
      <url>//%E7%94%9F%E6%B4%BB/%E8%BF%BD%E7%95%AA%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="再想想" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="afde17ba581512464f742653ce8fe3acc297b2894f5e0289e2c53ea98f2141d7">f9aa147cd51ad362eb8b7eeceb905f0cf4e36519cbdc7d3c42d62d97989cb143c156fd9d321612bb59e9aa8c0d15fe68e795ace9a423f0492a267f5498240627871c40e95255ad86a32c08b22332d48c5923553cee4bcc6a3074e2d190149031dab322afef2ae8332f47993c05620c13a16a02e8fdc901e9df6138aa3c69f5597e19b9bb1ad1e2fd1fc7110e31a0d98a502bf3056ea27165c18f274c822669f199fab8a6fdd0f8111e28280979b72f9507c86eed3fb9455afb26271710929e42a9b202da49d47bcf265c3f69e4df32fadcfebbbd52eab49e896807e65ece081f774b2b3a952f46791620973e7f546af6f59f0d44e71fed68b1a20e54ecbafe83a359e550b26b5e6b3d1fee27f4557e96bc810f2293bf1a616849d5a6e6c577ce8fe56d4fb3bca379253e45342f6d790d15ba57831de2f3195f38fafa11dde736579176fe18bf4f400074a9e1951c33f40d467c34b80898efa9fd7a0852a8d6d497f77070fab90176949b1f1a16b17b2e014cef0bc01d9f3181fd3f595eaa92600d366f64b58cf55ed3543e43e536d02d9b19958976a68167510eca29c8cc74691f34d7f3751a8f3c2ebbf89b0a48a10ce721061611243eeabb16f274762375d7e0899bcb33c4e765ef75673f5927de5be2519907458bc4f628765c3bee48d2b62dcea59b86a7562a74f11f54df80eebc891ad0c1186df29491016fba51744e54491934d66e72aab7f3742637ac97f0a04c96259806d45aafc2b0f506b2d060159ecdd4c4196f20a1952deef8ca6798587783b0f38c2a41c11de19f8262ee04a9a2c5b6fc806b539ec343a57e7764aa9d2c437be9b4fb6350a0ec9d5dc0f3f50e8661a2cb36cb3db4e7bc3b104f6ee6e1b61481b6fe9add586d0aea169dce88dfcf384482f26d4f4df713b038bdbf6d0d6c3b092918d5efbbfb7364324a04565358562937b6c9883d1532383a92ee88b2a0ec8632eceda876147523ddb9d4577048c7934ac9ec8e3319b54850485362d7cf46dd40c9b6b48f057c5040fcce770ac0ea5b12c0a87e68b00a00c1f27c34b998fcd4d508f5bf13f5598996085a336dabea796e7ace83d4678c21494e7df04c5819f4c0b42587058dbce427d3be0d57f26096feb28b65d3fd3a63d902cfa955209c5d5e4df32891f08881c0804b4a4741eae456093c70f0c7cefa40cc2a4c473f2ad69da59b2c50414a7fdc1c2506f0914477846d16c226995e22cf45c3c68609822faf41af24e04d104966ec453d989f2d0a20af1190deaafdf958535b64616507a221a6aa2fc36a76f1e5664457098ad79f3582e632b434c53d0ceb4d7b5c3af298db7ad3469e07f721d501fcbe6be94cb7668d6fe95d98d9e99b0530b60396a06282c28fdb176fec20cb9c69be3bb5ce0b74bfada39b1411ab5b41b38172e57e65009cce3608a9cd71e86699c09934a4d661d2dfd63b254626ee6746af90fd88152d6b8190ca98ad73aa98cffdba20e2ee271ec9af247c20cc38987bb865455f27ccb03334690e7d1777b00995e97d2eff9a4b82bc05ab1fe794929e98a378e8d8c140a24eed90baecd3fdd18344046eb22a92c1f53e1267eeee043faedd698ac1136ba77f95f912300ab30a1438b859e0084d95901202e2603bea1e7ba4b8404e5f2679db5cfab68213cfbe9180f1441fb112cdf6d14422dc0064e35bd3ec82553f1e9de873467dfc21deaba9f51d8b46f6183e867276033f5147e111aea41b21ebe9f5ec11deaf21e6b57d0d26453057580df245fda076a99c90f10dd83ec5bff9c56dc92998f73751eff390b50fa3ef287ab4a5a69630e9c9c6b7076e30caf649ed4219051e2814e1b6c0201a42a21ab07eea1c38c169c8edf3b9b02f92a12494e6a4da87a927b4e519ea73ef7fc2cec6624ea3e8782d5403867d2c7a33795349b23f93db1671fb7604b0168bfb87e33cf166d1236b69c0bdfe81620cf76b5a436c2853acd088b726852d847cf296a538578b1c28b3d9dcf243a071a8d36358869ae8b970649dd5403c98622b83640011f3d914c73de5dfb0de0ec1a022e31310a03376622d1765ee7a4e1f7725dc4ef26da9eae2f5092a960b9152d809f65a377bb205e4cf1e402f0fb867357687bb79ec33b6c26deac9c1bc7881bafb506f9848732900496eab82e8b8b549dbd991bfa65660b2220ded19a8a953ea7dddd2caa010507383eed0caf37b37b8d763726c67751e125b9076ea80de0db4016237269bdf5d93a84f5c3fa4301e865d77021322e2f3c9f6b69c08c14031441231a3f9333d7ebb8643d9fe9f0bec8d4b7619ad96c81b9a64ed416980391aea8bb6e64837dd0c7ba90aa2984da5667e944c9112889352357958f6fada56c0beef4bbc1cc661aee8c4275ef650c5e2a65d19a7ae2c88b667d1426e3c88e3a7b333e11913e5b3b71e493eab1795d3d23980b07abded70487cbfae63844270226bd2e0194ed7ba42ddfb320ab1195d5c61ab764258c481afa76b7c4a4f34059c7124e689156a7d10208615e28607441e4cd926d2bea0e4388467b4e3127fb9e6a27fe315389569bb45653027ca4bcaf16cb3705883e8a9aa4d56d04eda3a1a70f5b7f5e2e01473dd10aa4281c8011764157b24d2dc232b5cd8743756226033a30da52794e7975e3d27f1fb93eb0c9fcbf742f4d803a949dab184f3fa8ff73b11874f7a5dd678b36008c97c5d22c879df362b5da9070d2e9fa2fe82ddf8190443c0c895d100a09ca06fa8cee3fbe057394ac7bb2f7bfff613d59b388e4966fdd34de6e7ebf523f361c2bb2ffeb49452844185cd2aa9bd3dd2bdfc9b6e2597b7917e807ac6db5a99d25ed37d55bffddeab74fc51a0403789ab5a4df1f955a41c00f70dd8b134fb503f8cff5222f7edbe290dc848b25441de326888c72286886562e6c7507d0b676ddca9945a267544e824a9d981d011e7d3c4268fcad903201901f0312bcc78139e2e1a3f5617ed9a4a2bc7c3d699eed4e820a621f102f5d09d6c0c7667c38fe012e64a45f82c24184d22a4c78a008e601bd56c98efc6e2a8b701fb146b2ea39d3fe445e66228fb2b5289f3ee5df917ea9e56086a6e8ad2b816bcb1e8585bac0c1b1a912a795ce8e0338108a8d36e121539f8b12b1a18c43dcbabfa3232cb475191bee735646cb4a6802bb98a8b53e7e66fe59adeb5220c312bda31f8c88bc36671fdcda2de80ecaed1cb85714191ef30dddc6331a6a224dc6a145c8b2f8a50b8cd5f43288d063de9298adb35400ce9a7210a8ae91dc124ad3815dd08ef28c33036476a136a7e4b6221ce6283440d204e4d4c2e46d6cfae96b8d9527d94f67f290f47626834d024064a31245f0c671f107e8ed51b618546c510d587271a92cea351497c97f02e9f94a3bd7ee6509bd1c603884c73ecfcc268b5c32fabc0f9112d29daf9a2e3d83534c2ffdfa9ee163c5b128fe071165c4f0a8f707c2e2277b986c340fcf8b447e85db67a76b87fe998af42385351e099c976f665f4f19d4c408167086867c9930f382a72b90c0937916199ad94520f4ecd90dbc212b2c837142546787aaea446034a6d90692f3f2dc19d388a59623741f27918c6c8f864696195083e6ad37527cc8393676de665c8fbab1a978de7328f07cf87ce868cf64eb06c5ab28347921514827f5ce47209cb1b4b3715d09bbdd7162fecb32e77babef334b74c28b79ff61b4bd7351a067ea4eec87a2d4777b76b260f51cd33d87c4d646938f81ee8f7e02efcb97c0931da1d3fd7774e747c425e1519d08f471ebbc2dd9445acf81e5019a9c14019d3f9b6eecaad12eeeda99cc3b0dab4c3bb2b6cd17609314f63fdc4fa6c48b0a7a01610a62a37409a1c9790c4f92e5e27a257f7b828669a6eb413688c7b03e8404c426d466536a7b53c0bf63425f44f8ec5574f49573fa755831d89b673aa86958cd5351deb5fe32b049781eb25fce605daac1aab23a8ac064fe0377b16813135501b555c04d0ca146aa9fb5efdac66f25fc3a558d4819dc54d607df6dc115f4ea53eb78d8ff251cf9bd11bc86ef92fe39511b8bbad214a5b8d8d2e31e24a91f419971e3e753b1f5474084999b9e10ced3a64e7c8ce679925a649c366d3909850ccb6d24f140e4b671cf19a9da2012199e391c3da9c8dd319acf93c5412ae67b61a52671363a7a35c63c0ff2370f43f2e1eca9f3fde99dbd10b84b33b7df37e5b534396ff547679b23a37dc685f6b04f3c5105fe7edd0201f05df6abc20f5a087a360f2ddc68aa14e8040b856aa3f77e147bada90594a2a876683c9da96f292b07362bfcc8565204ecbf6144d5ed35176494523e6936a9a00962b24b4c334d2846e97170d2ea96c3510162270f80c2112cab276fbc86320fec8e3e3a1b2555250a6184f0a66bcbafcf83f5663a5a81d7f6d1a376fa32cf9addee3867bd41fbe22900273c16d8b30d52bd8b720ca4ee843aebb51060beae242c66da9530ae6848417feb9863dbba94b4129579c08ec1ccc204047cf3291b533fe48f677ce724b5e73fd2d534d7657551a41a847b62c765638ea2120659bfeb1943594d14c14fbb6a1a720af63de9a7583ab49c33acff4a5ac23396931f33275ea557a03afc8ede04daacd93537f4d716c586d69733ae49482ef6727a19a72fe3d57f1763cb5dd112d745d64e7333519f0a30bfe6f300b57b7adb7896106a195117120b140b201258d0b152173fe5d9f9ab3eee1721a005451600c8fcb7966aa9e2ab26dbe334c38338986b6380a33c5c09b10c2da74ac5356bd78aeac5eec39575a026642fdd0645e6723f3c4cbd21510dd013deb27829bdc294ab493a9bf9fe01eb08cbeffa688a6d57703b99a368d187243b1b719c9de9fd95fb380e4da80a3847423b10b86939c93ff645d266c1f3759cc6f483ded3961f9fa8f0b70f2fa406bc6e16fe4371f59fedd8ce2cdf787d4403b7edc55bcd5a409821a1f461a1f01245bc0ad8ae68b3be6c130e4d93f3d33459010c1a8a84e9db9c039803efb0137d8a188b1b71ae7a12edb0baa1aa2de2e0f06f5a93bee61238be10be789c31e07162f68272a4552dd9e4055b7ee23f1b28f25e231d94d6d247d74c6167f36d71a6adbcdee2d5377e7dab96486e362b893876626616878e2b3c783facd3e5f4f265288203738a9b8320140fd71c393a73abf4e86510fa0cb554dc42a92b11c7aea50921106d5b1d6426e4688ef814415f4e024de8a94bd1e7278a626899af9ee0d81624cb84544a29532e274ca2136afefe32851467ccb4cf3cbd0ae87c29c484dbb9b5bd238f5a52253aec6ade2a6541d097bb9eac31e82bfece79d400baeba25e46388182e508924aa981fe5da47527f63afa4b9407dd2575debf6eb4aab6661ecdd9f71abc37baec3a54357866bef4bea4a715aae4a806c0613d931a2b0799d101349cad7710db7228a410a7db913d49a7a84bdd6b06adf1e7c00fe59ec16878245a8d693921ab5755634505cbbbccb222a5a675af8bf8a7f334329fb497ea9b975292723ac2db2989c551da59184b2b25c4259f05ac317e34f3ba08e119c29cb6860714c58738ab69eef8aed84bcd6bfbaca46f1e2c0492e84ed37c6a3b55534c5783a38bab50d00f4bc3a8515b800539f20dcc3e60a0d611af5fd2fc71fd60ec1166b227a5ec175c115b4dfa1bb788dbd69637b87f40f994ca5741f9a889395e22761a8bc6bdadb494a72f7f57a4b1007251fc99ba62f2ba9d9064406b620f9d104215fac96e567a7a652c661bca9fad908d75c27ef8c6722bd28a87ecb61791a6e421006d677a4bed94ff2cf7c6808ff96b75f2a69b401a48787455e87d9e6920f190326f989cb26ad2c6977526c28dceb71f7d5f820514dea62563cf4877581012659fa7fd5e533d3f15e9504cb6ee632f463e81af5741bde4afead714f6b33f235e1b8af81bb8fb6b175cadaec593dbf798d33596f22bf34ec3b422760fcab4a89322a9943a9097b4caad1dd625f64dbbd72a8f8cbc5acf6b1f8b00d56a56ea87b5a6abb53614f96f6acf231909a5ef5492954b3d25d810ec58f5a800ada0cb356a8e1e82c9e3884a032428a542e240c4d0603838dbb9def9ef69147eb52d78fc610e6dfb60d10687a8bd8200781d8859c3a412413748fd289ccbccc7b751c0e86f7ee1a71929a2d99b8862f065efac937065f46224728500dbeffaedf5303be8a7f150206882930e9e8c6952a865de8ea39a49aa77bef8ed9f7a8b7665fe08627378bfd2393f57366c836ef4104c245fd5565b2b6128ad261feb4f8f6574a4f9d4c3bb080b4cb27d4336ed2de2ce51a7a08f4886d276525aa174a7023bf49e75be80f2188faf69f8778669054f2602f81d6e4ab04947644c0baeb84fe7191014765ea154457717f381024dc831107a599340f8af41ebc4a271dab8599324ac630ddc7120e13bf63e224e4e8b9e6bd10d8c57797f28c4118704cfec32cebb25f51d296e613c0fb9fbbe965b6f1907dfb02e3cff88ca6cf21ae75df420997737c7f125ab7755ca2e0d7ac6e9eeaacfc9cc890871c1188bb41001ef2d2c2335b8cbd68c8b58b08339ac59f0e3d8440f28aa0581e928d12453013fd093cbfdc12caef2e1a5f0c53f556a9dd82f147fd37bf9ec98575fc1291b4af333178e751406d70ad09af7c125a4e8362e5807867e41e490c5f6488dfafd9ba93349a9d140fbc0d38cf683c999a4c0c8f6693d0104b0c3278652e384e683163b98c97cd78f30fbb2220d603525adc52bff6bf0bee52ddad73c0a23188c599791fa81351f6dc5f470a6c7a9ea838dab01560d6b6fe9c09a5efaf4e7acaff39c2486047e645960073f4a8af54ef43828cfc879e5ed4f7bbc4687c5ad8b2ef5ebad422d8e027e47dd4a502f276f03b9c5bd243a05160d85178c00ee1ccf5bc7c8676a53c5b01c35d0e601d5b651239fb8166647348d2561ccd3bf6373568a01e2e529a10fe51b7a4bea04dd016d75b0e79b7dd8b344f63e622617465e6c72cc3d5524ff82c5165a2a744b4e1deb462d0a32e106491774ec505f165a64e2b2a0ea87908fd899eeabef8e3b4e5111734c42b4dc63a01cf096c7e32ef324a6c2f488b14e240f7f7dd58ac2b98f8b9c75318c4eb9dc599e9596b1a1653c4e937fbfc7b20480b9545c365743644d8156977378d0783b063a9cffe14a45a6814c73dbf58fbefe0b1374fd5137206c2c1f44094cd1f81579bc2a536aa9175111642439f5522081bc9d5c83d6bb09c2a3023fd525974929147d470b1b5c4e53061d3bcb2c9ff3797d442adbcfbcf5c1dfc890e69d015250bf2dc5f3d65eb879b73a01c336fc9ee8a881bdb2e075e039745b1a4788e86d464657850f0ca410ef100d17ab46623dd10720691c9a128ec556e10d16445c8b22cddbaed992bb21a4ed874ebc6fa21a873b7a5ec93d2dc3f07f71112c8218337149ff2b456d24f5e1c6d39b6c3e6ac4a4857d5f9ed07ac6d04dc3c74b69949d987764ae89a62b683be950503e29143c5943123705826158e2147b16352b1c68d3f8469b342ee0da6e7eefa5cc80b7a398b98d5f8954cd4d329be224dae7df389983edb51cc707171684cfe8cd8d895c284d41ac9ec6876d94bb1a84a3720c746790f5021428a945b9968560b97b65de27208acef9e8977d8d36f808785963064cc7a48618924a1efdc0ad4865d1bb7c837c1e45f5e15223dbdf83cd981a4fd58e845eb93be750b378758a7b82e92aeeb21e485087ca1c168ee1bcaa80fb5cdd5e89d7a596578b5395cfa0ad7735fc77c6af904222a50d016e73d66bb67c9c828c1abd5dd7c100c7cf4648e6ea0e6f070616caf0ea69781bb57c3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">nchの大好きな番</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CSP2022游记</title>
      <link href="//%E6%B8%B8%E8%AE%B0/CSP2022%E6%B8%B8%E8%AE%B0/"/>
      <url>//%E6%B8%B8%E8%AE%B0/CSP2022%E6%B8%B8%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p><img src="https://s3.bmp.ovh/imgs/2022/10/20/0e093f893d44300b.png"></p><span id="more"></span><h4 id="Day0"><a href="#Day0" class="headerlink" title="Day0"></a>Day0</h4><p>在机房里颓，背了背对拍（虽然S组没用上）</p><p>颓废好累啊</p><h4 id="Day0-5"><a href="#Day0-5" class="headerlink" title="Day0.5"></a>Day0.5</h4><p>考J组</p><p><del>为什么不能带零食进考场啊</del></p><p>T1 一眼看出要特判，水题</p><p>写了对拍拍上，心情愉悦</p><p>T2 本想枚举因数，被$n&lt;=10^{18}$的数据范围吓退</p><p>一分钟后发现是韦达定理，切了</p><p>T3 一眼过去字符串 再看*?~&amp;%$#&amp;^</p><p>发现不可做，先开T4</p><p>T4 一眼DP，十五分钟写了个$O(n^{2}k)$的，调调过了大样例</p><p>此时9点40</p><p>回来开T3</p><p>接着就是<del>一顿乱搞</del>，有条理的递归，<del>话说怎么调了一个半小时</del></p><p>感觉T3会挂，不想改了，开始乱搞</p><p>为了锻炼码力写了一遍树剖，<del>虽然后来发现有锅</del></p><p>果断开始睡觉，差点被<code>one hui</code>抓住</p><p>期望得分：100+100+50+100=350pts</p><h4 id="Day-1"><a href="#Day-1" class="headerlink" title="Day 1"></a>Day 1</h4><p>14:00 进考场开始罚坐</p><p>14:26 密码$belief2022$</p><p>然后看T1，神秘图论，看了5分钟没思路</p><p>顺手写了个快读快写</p><p>又看T2，游戏？博弈论？矩阵？果断放弃</p><p>T3，图论，题目描述有点长，不想看</p><p>T4似乎是一个树上问题，看起来似乎比较可做（后来发现可做个gui）<del>话说怎么又是图论，今年没DP吗</del></p><p>回来继续看T1，想了个$O(n^{4})$的算法，看起来$n=300$的数据都跑不过，不想打</p><p>此时旁边myzx的巨佬在草稿纸上奋笔疾书，害怕ing</p><p>打了个dijkstra<del>为什么不打bfs</del></p><p>此时已经过去40分钟，决定先开T2</p><p>看了题面和$n&lt;=10^{5}$的数据范围之后，觉得是数据结构</p><p>手玩了几个样例，几分钟后想到用时间$O(nlogn)$的数据结构维护一下区间最大，最小，非负最小，非正最大就行了（话说这题为什么暴力分有60pts啊）</p><p>想到8个ST的码量和空间，决定打线段树，二十分钟打完，过了第一个样例</p><p>改改过了第二个样例，第三个样例一拍，错了一车</p><p>接着改改改，半小时发现把v2，v3记反了，一发过了大样例，跑了200+ms</p><p>此时开考一个半小时，去上了个厕所，回来写T3，觉得跟基环树森林有关，但不知道怎么写，写了个$O(qn)$的暴力</p><p>T4不想写lca，把T1的dijkstra复制过来，写了个$O(n^{2}logn)$的暴力</p><p>继续写T1，脑抽加上全排列写了个$O(4!×n^{4})$的暴力 <del>话说这次只会暴力</del></p><p>此时5点钟，估摸着不挂分有200+pts了，准备写部分分</p><p>先看T1，发现$k=0$的情况似乎一样不可做，先弃了</p><p>再看T3，不知道没有2，4操作对暴力有什么用，弃了</p><p>最后看T4，这个k=1时感觉可做，写了个lca，又拆点，<del>但午饭没吃饱好饿啊</del></p><p>运行程序突然发现死循环，手玩一下发现建成图了，艹，果断放弃</p><p>练习罚坐和检查文件（饿的要死）</p><p>期望得分：40pts+100pts+40pts+44pts=224pts</p><p>出来之后看luogu群发现一车人做出T1T2，250+pts</p><p>自闭了</p><h4 id="Day-2"><a href="#Day-2" class="headerlink" title="Day 2"></a>Day 2</h4><p>小图灵上查分，J组AK了</p><p>从luogu群里找到SC代码</p><p>在luogu上测J组AK了，不知道主函数不打<code>return 0</code>会不会RE,S组T3无数据，T4挂了12pts</p><p>T3应该在$n&gt;=1000$时全输出“NO”的，应该能骗分，可惜了</p><p>在infoj上测没挂分，感觉数据很人性</p><p>希望€€￡数据水一点</p><h4 id="Day-3"><a href="#Day-3" class="headerlink" title="Day 3"></a>Day 3</h4><p>回学校机房，因为whk被教练约谈了</p><p>luogu S组T3数据造出来了 没挂分</p><p>期望得分:224-12=212pts</p><p>求老天给个七级勾</p><h4 id="Day-4"><a href="#Day-4" class="headerlink" title="Day 4"></a>Day 4</h4><p>infoj把SC全省代码拿来跑了一下，224pts，rk77</p><p>1= 在180~190pts左右</p><p>本来还觉得考得好，<del>好个锤子</del></p><p>七级勾估计没了</p><p>等€€￡出成绩吧</p><h4 id="Day-7"><a href="#Day-7" class="headerlink" title="Day 7"></a>Day 7</h4><p>小图灵上估分208pts，T4挂成28pts</p><h4 id="Day-11"><a href="#Day-11" class="headerlink" title="Day 11"></a>Day 11</h4><p>出分了 J组AK了，S组208pts</p><p>T4挂成28pts，七级勾没了</p><p>€€￡T3用脚造数据吗，全输出”NO”有45pts</p><p><del>暴力只有40pts</del></p><p><del>话说T1,T3怎么都可以随机化乱搞啊</del></p><p>NOIP再战吧</p><h4 id="Day-inf"><a href="#Day-inf" class="headerlink" title="Day inf"></a>Day inf</h4><p>成绩公示后发现省rk110+</p><p>我TM考了个寂寞</p><p>PS：本来前面还有一千多字的，后来<del>发现过于SB</del>删了</p>]]></content>
      
      
      <categories>
          
          <category> 游记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 游记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>master定理</title>
      <link href="//OI/master%E5%AE%9A%E7%90%86/"/>
      <url>//OI/master%E5%AE%9A%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>初赛模拟错了个题，就来学一下,<del>以下内容大部分是复制的</del></p><span id="more"></span><h2 id="一-符号"><a href="#一-符号" class="headerlink" title="一.符号"></a>一.符号</h2><p>在介绍master定理前，我们需要介绍几个符号：</p><p>$T(n)$表示时间复杂度，我们可以这么表示时间复杂度：</p><p>$T(n)=$下面的任意一个符号(一个单项式)。</p><p>$Θ$，读音：<code>theta</code>，等于的意思。</p><p>$O$，读音：<code>big-oh</code>，小于等于的意思。</p><p>$o$，读音：<code>small-oh</code>，小于的意思。</p><p>$Ω$，读音：<code>big omega</code>，大于等于的意思。</p><p>$ω$，读音：<code>small omega</code>，大于的意思。</p><h2 id="二-master定理"><a href="#二-master定理" class="headerlink" title="二.master定理"></a>二.master定理</h2><p>现在我们介绍一个定理，它的名字叫$master$定理，又名主定理，它的内容是这样的：我们将一个规模为$n$的问题，通过分治得到$a$个规模为$\frac{n}{b}$的子问题，每次递归带来的额外计算为$f(n)$，那么我们得到以下关系式：</p><p>$T(n)=aT(\frac{n}{b})+f(n)$</p><p>此外，我们定义一个$c_{crit}$，它是这么计算的：</p><p>$c_{crit}=log_ba$</p><p>那么存在以下关系：</p><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><h4 id="当-f-n-O-n-c-，且-c-lt-c-crit-时-T-n-Theta-n-c-crit"><a href="#当-f-n-O-n-c-，且-c-lt-c-crit-时-T-n-Theta-n-c-crit" class="headerlink" title="当$f(n)=O(n^c)$，且$c&lt;c_{crit}$时$   \ \      $$T(n)$=$\Theta(n^{c_{crit}})$"></a>当$f(n)=O(n^c)$，且$c&lt;c_{crit}$时$   \ \      $$T(n)$=$\Theta(n^{c_{crit}})$</h4><h4 id="eg"><a href="#eg" class="headerlink" title="eg."></a>eg.</h4><p>$T(n)=8T(\frac{n}{2})+1000n^{2}$</p><p>此时,</p><p>$a=8,b=2,f(n)=1000n^{2}$</p><p>所以 $c=2，c_{crit}=log_ba=3&gt;c$</p><p>所以 $T(n)=\Theta(n^{log_ba})=\Theta({n^{3}})$</p><h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><h4 id="若存在一个非负数-k-，使得-f-n-Theta-n-c-crit-log-k-n-时-T-n-Theta-n-e-crit-log-k-1-n"><a href="#若存在一个非负数-k-，使得-f-n-Theta-n-c-crit-log-k-n-时-T-n-Theta-n-e-crit-log-k-1-n" class="headerlink" title="若存在一个非负数$k$，使得$f(n)=\Theta(n^{c_{crit}}\log^{k}n)$时 $T(n)=\Theta(n^{e_{crit}}log^{k+1}n)$"></a>若存在一个非负数$k$，使得$f(n)=\Theta(n^{c_{crit}}\log^{k}n)$时 $T(n)=\Theta(n^{e_{crit}}log^{k+1}n)$</h4><h4 id="eg-1"><a href="#eg-1" class="headerlink" title="eg."></a>eg.</h4><p>$T(n)=2T(\frac{n}{2})+10n$</p><p>此时</p><p>$a=2,b=2,f(n)=10n$</p><p>$c_{crit}=log_ba=1$</p><p>当$k=0$时</p><p>$f(n)=O(n^{c_{crit}}log^{k}n)$</p><p>所以       $T(n)=\Theta(n^{c_{crit}}\log^{k+1}n)=\Theta(n\log n)$</p><h3 id="2-EX"><a href="#2-EX" class="headerlink" title="2.EX"></a>2.EX</h3><p>当存在一个k，使$f(n)=\Theta(n^{c_{crit}}log^{k}n)$时</p><p>$T(n)=\begin{cases}\Theta(n^{c_{crit}}log^{k+1}n)(k&gt;-1)\\ \Theta(n^{c_{crit}}loglogn) (k=-1)\\ \Theta(n^{c_{crit}}) (k&lt;-1)\end{cases}$</p><h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><h4 id="当-f-n-Omega-n-c-，且-c-gt-c-crit-时-T-n-Theta-f-n"><a href="#当-f-n-Omega-n-c-，且-c-gt-c-crit-时-T-n-Theta-f-n" class="headerlink" title="当$f(n)=\Omega(n^{c})$，且$c&gt;c_{crit}$时 $T(n)=\Theta(f(n))$"></a>当$f(n)=\Omega(n^{c})$，且$c&gt;c_{crit}$时 $T(n)=\Theta(f(n))$</h4><h4 id="eg-2"><a href="#eg-2" class="headerlink" title="eg."></a>eg.</h4><p>$T(n)=2T(\frac{n}{2})+n^{2}$</p><p>此时</p><p>$a=2，b=2，f(n)=n^{2}$</p><p>当$c$=2时，$f(n)=\Omega(n^{c})$</p><p>又因为    $c_{crit}=log_ba=1&lt;c$</p><p>所以     $T(n)=\Theta(f(n))=\Theta(n^{2})$</p><p>参考证明请转<a href="http://www.doc88.com/p-9761826142176.html">这里</a></p><h2 id="三-eg"><a href="#三-eg" class="headerlink" title="三.eg"></a>三.eg</h2><p>好，是时候拿出我的错题了</p><p>$T(n)=9T(\frac{n}{3})+n$</p><p>$T(1)=1$</p><p>$a=9,b=3,f(n)=n,c_{crit}=log_ba=2$</p><p>因为$c=1&lt;c_{crit}$</p><p>所以$T(n)=\Theta(n^{log_ba})=\Theta(n^{2})$</p><h3 id="本文终"><a href="#本文终" class="headerlink" title="本文终"></a>本文终</h3><p>PS:这个$Latex$打死我了，QwQ</p>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 时间复杂度分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日记</title>
      <link href="//%E7%94%9F%E6%B4%BB/%E6%97%A5%E8%AE%B0/"/>
      <url>//%E7%94%9F%E6%B4%BB/%E6%97%A5%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="私の好きなタイプですね" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="66559ebd875caf7fc578b8ca86517e7f22d14d4c30c52b2bdc02cb49f0e485fc">e0b64c9f75e922280ddadaada83b1a616d995a56bcf6807ce271a33f406c08ce47105ae015aca16c4f0273450fff790ab2d061b0512115037143e5c089c1920d68cc6d347e781bd100c76d5aee0719154bcbe52b0157827cc3226ff0b43f15dfbcc4778d920ce937883ab55f4fbeae61ae17299bb084c8603df1f723bde6b391d66806202c565c3dc11bb3b85d0942291a50bdc16a225b2833fbba58f244ca2b8b91123de6cd75b50c34073a0042b7d2b5f80f439f4b2bf68adfb6e75ebea8e5593b478d4ee61ccf5c5a0b79e567cff8bb4b7f47704a9ac0031795234e323b54e81200117b482c1c5db6f73508bda329ac2f04171277e89485fbb3969a17e986c6bb6dd3da72f4bfd290d7dcefb173e15405a5743bae37b42de8f263d520ae3ccd04bf1eef0c29f1db01b4a74743fca37d670f39e6d50421828877dcbe0fbee38f773719d9733007fc35dabdcb58c5af0454c82762ca3fa5220e4da48c97a5c1a74193e255145f047989a6f54656d58c7f4ce1d3e13a7c0c40cd0704d2e17b1bc94ac76c174b685080cb59457753815c25e0ff884b09c84dc1a0e01778b83c0426d7b245aa3f0c66e4511d83417c940a7ce49a4aacaa5d7dac59a12c71474d1ce63c01589287d4e05b195e65a54fa543a3f5dc78b7d57fc0701ea14a138fd64d02512e1d17fc535025ac81118f11c8da1d1fccb56d2401a625a7de376372216026c0aa7fac8d0eac192a95688d42210067b2e2a05d060dfc69c229290922469fb288bd2d9efac44ee7212163fefcdbab6e7908353f1796b6178e14e808cab5b97ebc3b8d95c77838abad59adca361023b2c876ada2949875ea0adcdc7bcbe08623b451155791930bfd6ead07e4083dac132547df7c03821e34857b2ead6ec4e17b712dd2b825f16668362533b2ba530e4ada22b293c4141349c0905a3ce94d37c30e435c9e1bb9856912496305dd18b137c791ffeceda1a82119e3770164a429435866378cdfd6d43b9be62cac9710b8feaa60d007289861d5ada1fcbc2525a6a7a42e679f2b3e69905c29c4ac4053d71fc1a330416938f4f48bdd00694d2cc8da53ff396684186cea26d5a5ee5cbcc3dfce057d593a19d7165554964839fee34b194c45b26e7efc34b765fdeb4d13cf2fd54289289c5b8f5bf928f63738bd851da240556b95211b792c83416955e6302132fcc5a4be3e88542f124b24cb0d960b200c1099aa85eb55257e7a9a37f0b319a8baa06c8fbf8fe9e46984dc67e9c6aadb1870e3061ca1e081855f47731aaade7315d39766c2b73754ed12aedcda350cbcdf36ced2064bd69b7162eb472b6f819eee85aa93a0d031b41f05baa91f821a3e57f85b7af66817316f755a093f28910dde30c86b9253f668c6757dc7f6c1ce0b502eaf366624a71f7b8a1c9a0236dfc36eed10b454b3c61067234319e8688c82d507dcde226b2a359cfad2218cbf6b078c28ead2870194b48f9e6781317e5234f41252243eb80dd9c1b5eda152d17e27f8d1807474ab89b7a556a050bc58d8dcd8e67d60ff3a4354a2ec5b86573155ee1986067fb755f33fdb54e36f94f2a6b9cc8ff1cfd3c646b3d02f778ecb0e0da3083ef90cfbba44a99e3612fc4c00cc94dffe5fba2112f8ff2b190d24c3b2ab21eb5045266952db376d41992cfba267cb7faf77cee566d9262b30ab5e1623c8f59b7cae9bbdc46928e447f27e8d2c484a396b2f2c06da92572d5517d91651f04f309e03019c28b4f154a91d3ba341c7e6b89e08c0a66114e814813bae18f5a94cb1faeff19ff29192b8a55f5b198c09f2c31faedc921d9dcb7c9c69307eed50e3a7b0e4be8043606d20c11ce149532237e2641d115cb222c483bc75aad63e0af170e4386bd2844961a27f64135ef27805d1baede3b99fdcdf8358cff577394e4bdf0eb68ef97bf9ab140ad4192896c997528d2092f0d9f008cfe752aaac625b6bda5ba930a1241d9b11697e149a80469bde5a417d505446b278bd5b7fd1662a1192f811f0e3a6b3f9868d83ff38c514625e1b250108a200eb0ac79ea82389d57f37312d0469b51a8660e73ee6412b3058acadc6bf6e26d073ccbdeae9b678aebb4655df31165a653360783544772937d9a9c87c7c82c8506acc316dbba8aa58cadba428baf24b503c6ba58f09d04a4d708559cf9e04e99893b03eb1f42873c64715a88f4208b5148db116e8750f3bde8f2220642eecf92bdc00cdd509cd55739884209fcb31c27b4a451be5dfb2dc73409d778580d638537bbcb5dcfa8554c1a96093835473b8d6eb9f2c5823409ad5f1ec3ad20cf2e10246c35ffb0e1bfee71e22fb1c6deb79c0c55700110c0525ed5d177f405e2ff7781b6218789a05126a25b2d32f2b020d2d9831775d58b961769df62dee3e5b1271b2a034ebdc00f5565b793b6819f2540356a5739a0aedf92d3612068b52ff5bbb4e08922bff7412721ed84976b212c76fe6a5021f7f606292c7b169fae6a4fc41892d4a2e246bcae15ffe527849fb2820d5bc8f9fdf38d1256478cade6cb783519fa4f8c071048abfc56f21af728c0a371cf12ea02d6b2cc9388389e7a721dc5550dc3aaffae7e1e06735c5909ede2680baab0507717511760155adc9752e1ccdf463fa6f084710fba3dd77009f213e118c311bb29bfeb8229005e65a04623bf5b14d99af93e8079dff0ba04efb263116db6514c478f04b1a7b5be672583680d95bf38d621ecedb6fb4fc88349d3a6302a9bcbaca16bb985538fba04877f273614be685cbe31850977633c15f21fd59468fb362055ceb430481a84e1b441a9925536786138b514ef349587dbe309bd7dccf006895b88923c643136189bfc827182eaae92e6c7bb2f42d658b39e49bdab531368a82acc3c0ed708af2dbc9ea0cd3acb550f3475cbdc4e81677134ea726cb68002a3231a530176229c8b69790c2f0c9d8239d60fe6742704247a2e80d33c9006a09388b63a3ec07c3365fc474796f0487bc454100bf5eb393126699ee60a8608107f22c20c8c5349542d17f300ce74ef0076de48896ad4133a31df4769238b97110ac3e7c77ab0da07d83a84d179b4171f5f6678aaaa98409dbcb36e1b0718bd2954eccbc669ec7f00a3e03ba29ba1b68af5ca9484becd924899f6043e2dbe62761dc7897740b612018ede1a9179bacb271c6a089d565f3215ebc80286a79373bd420d7cc8a43c546ebd12dedb86f1e1290687d97c18fe6b9eb126163e75e519e0f1f75a811320e87b0f3f8b7678f3fbfca9486f717df04ad49e1ba58c597704c5fb6fa65656899fd31dab1ddb21fee424c72e1b34520b958bab297b666bb86527377515b931408fac241d57a6eaf376a3c0e4ab95c1e341f6a2c0740210a18db968a04f43afe4afca196a00dd453126ea0b5f3a1c78397a91e582bceabcc7c282e8b2323564f507e2dcff55bed5718a9753d715503e0c462569e7fb79d9306eebf69b9329d2d657e16a7d4b064ff474bfbd4690fb836ca8cd38d412738b267aa501f8bca775136dafd92cfcc56e864034a9b289773dca9af4be84b32511096ae3672c01019c248b994b882e18da13b013ed47b9d9db44164e30c8a1b2f1da703a6563e5e2a8e34aeb1a64b9db30b6568633cfa72cda66b90fa3504d48cc8d0eea003a11e0898aa6c5c13df9e9ee86ad494c86034a41d28c50e6520a1077396a7518b2e02d980ad6b37afd3ccd893be9161cb6432dc02395b3a2280a17428d23a7865dce7871482167011c671686772e3af04bf340066ff4bf25ca552a35b0e78732b4fa86de0d3b5e2c52c53d9456ac50efb48ea863df1be1ce27ed47a91ec07acebdc2b1763dc6625e5738ef684be385613f5f22abc5c6fa191738b5a6b7e3dfbdbaab7bd739d1b8b0046ae4e0d19703107ca697af2315d994873809a41b340da974d380c9bd3e36708cb6badc9193b02530d0771285a474681153ff18d23376c71047ec7c4dcccca91a99441c57aa593ec147ff2d277789ea4db7edbd8c82be8728a9c83</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">可愛くて、強くて理性的なバカ</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>随机100题</title>
      <link href="//OI/%E9%9A%8F%E6%9C%BA100%E9%A2%98/"/>
      <url>//OI/%E9%9A%8F%E6%9C%BA100%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>估计要咕咕咕了</p><span id="more"></span><h2 id="绿题"><a href="#绿题" class="headerlink" title="绿题"></a>绿题</h2><h3 id="P2736-USACO3-4-“破锣摇滚”乐队-Raucous-Rockers"><a href="#P2736-USACO3-4-“破锣摇滚”乐队-Raucous-Rockers" class="headerlink" title="P2736 [USACO3.4]“破锣摇滚”乐队 Raucous Rockers"></a><a href="https://www.luogu.com.cn/problem/P2736">P2736 [USACO3.4]“破锣摇滚”乐队 Raucous Rockers</a></h3><p>一道刷过的水题,但因为<del>懒</del>赶时间，我就<del>厚颜无耻</del>地<del>假装·</del>AC了<br>看数据范围<del>和标签</del>，我们可以知道<del>（猜出）</del>这是一道状压DP<del>（搜索）</del>题，然后就几乎是<del>(贺）</del>板子</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 k&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 k&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n,t,m,a[<span class="number">25</span>],ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> res,<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x==n+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">ans=<span class="built_in">max</span>(ans,k);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dfs</span>(x+<span class="number">1</span>,y,res,k);</span><br><span class="line"><span class="keyword">if</span>(res&gt;=a[x])<span class="built_in">dfs</span>(x+<span class="number">1</span>,y,res-a[x],k+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(y&lt;m&amp;&amp;t&gt;=a[x]) <span class="built_in">dfs</span>(x+<span class="number">1</span>,y+<span class="number">1</span>,t-a[x],k+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin&gt;&gt;n&gt;&gt;t&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">cout&lt;&lt;ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P4878-USACO05DEC-Layout-G"><a href="#P4878-USACO05DEC-Layout-G" class="headerlink" title="P4878 [USACO05DEC]Layout G"></a><a href="https://www.luogu.com.cn/problem/P4878">P4878 [USACO05DEC]Layout G</a></h3><p>看题<del>和题解</del>，我们可以清楚地知道这是一道差分约束的板子题，然后敲板子<del>（从<a href="https://www.luogu.com.cn/problem/P1993">P1993</a>中拷过来)</del>就结束了<br>注意要加个超级源判断是否联通</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">8e4</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> to[maxm],ne[maxm],f[maxm],e[maxm],tot=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> v[maxm],c[maxm],d[maxm];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++tot]=y,ne[tot]=f[x],f[x]=tot,e[tot]=z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="keyword">sizeof</span> c);</span><br><span class="line">    <span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span> v);</span><br><span class="line">    <span class="built_in">memset</span>(d,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">    q.<span class="built_in">push</span>(x);</span><br><span class="line">    d[x]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        v[x]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(++c[x]==n+<span class="number">1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=f[x],y;i;i=ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(d[x]+e[i]&lt;d[y=to[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                d[y]=d[x]+e[i];</span><br><span class="line">                <span class="keyword">if</span>(!v[y]) q.<span class="built_in">push</span>(y),v[y]=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(d[n]&gt;<span class="number">1e8</span>) <span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">    <span class="keyword">return</span> d[n];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> ml,md;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;ml&gt;&gt;md;</span><br><span class="line">    <span class="type">int</span> x,y,z;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=ml;++i) cin&gt;&gt;x&gt;&gt;y&gt;&gt;z,<span class="built_in">add</span>(x,y,z);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=md;++i) cin&gt;&gt;x&gt;&gt;y&gt;&gt;z,<span class="built_in">add</span>(y,x,-z);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) <span class="built_in">add</span>(i+<span class="number">1</span>,i,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">add</span>(<span class="number">0</span>,i,<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> sp=<span class="built_in">spfa</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(sp&lt;=<span class="number">-1</span>) cout&lt;&lt;sp;</span><br><span class="line">    <span class="keyword">else</span> cout&lt;&lt;<span class="built_in">spfa</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="AT2434-JOI-公园-JOI-Park"><a href="#AT2434-JOI-公园-JOI-Park" class="headerlink" title="AT2434 JOI 公园 (JOI Park)"></a><a href="https://www.luogu.com.cn/problem/AT2434">AT2434 JOI 公园 (JOI Park)</a></h3><p>这道题是带有一点模拟性质的最短路，跑dijkstra后将每条边的优先级赋值为更大的点的距离，排序后枚举模拟，注意要换行，不然AtCoder会WA</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp(a,b) make_pair(a,b)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;c=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+c<span class="number">-48</span>,c=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">8e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,c;</span><br><span class="line"><span class="type">int</span> head[N],to[N],ne[N],e[N],tot,d[N],v[N],sum;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> u,v,e,mx;</span><br><span class="line">    <span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> edge &amp;res)<span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> mx&lt;res.mx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;ed[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++tot]=y,ne[tot]=head[x],e[tot]=z,head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) d[i]=<span class="number">999999999999999</span>;</span><br><span class="line">    d[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>,<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x=q.<span class="built_in">top</span>().second;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(v[x]) <span class="keyword">continue</span>;</span><br><span class="line">        v[x]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(d[y=to[i]]&gt;d[x]+e[i])</span><br><span class="line">            &#123;</span><br><span class="line">                d[y]=d[x]+e[i];</span><br><span class="line">                q.<span class="built_in">push</span>(<span class="built_in">mp</span>(-d[y],y));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=<span class="built_in">read</span>(),m=<span class="built_in">read</span>(),c=<span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) ed[i]=&#123;<span class="built_in">read</span>(),<span class="built_in">read</span>(),<span class="built_in">read</span>()&#125;,<span class="built_in">add</span>(ed[i].u,ed[i].v,ed[i].e),<span class="built_in">add</span>(ed[i].v,ed[i].u,ed[i].e),sum+=ed[i].e;</span><br><span class="line">    <span class="built_in">dijkstra</span>();</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) ed[i].mx=<span class="built_in">max</span>(d[ed[i].u],d[ed[i].v]);</span><br><span class="line">    <span class="built_in">sort</span>(ed+<span class="number">1</span>,ed+m+<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> ans=sum;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        sum-=ed[i].e;</span><br><span class="line">        ans=<span class="built_in">min</span>(ans,ed[i].mx*c+sum);</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P3478-POI2008-STA-Station"><a href="#P3478-POI2008-STA-Station" class="headerlink" title="P3478 [POI2008] STA-Station"></a><a href="https://www.luogu.com.cn/problem/P3478">P3478 [POI2008] STA-Station</a></h3><p>换根DP板子题，具体可以看这个<a href="https://violeteternal.github.io/Eternity/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/OI/dp-tree/">树型dp </a>和这个<a href="https://www.luogu.com.cn/blog/sflsrick/note-how-to-change-root#">[学习笔记]换根dp</a></p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;c=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+c<span class="number">-48</span>,c=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> sta[<span class="number">35</span>],top=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;<span class="number">0</span>)x=-x,<span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        sta[top++]=x%<span class="number">10</span>,x/=<span class="number">10</span>;</span><br><span class="line">    &#125;<span class="keyword">while</span>(x);</span><br><span class="line">    <span class="keyword">while</span>(top) <span class="built_in">putchar</span>(sta[--top]+<span class="number">48</span>); </span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,c;</span><br><span class="line"><span class="type">int</span> head[N],to[N],ne[N],tot,d[N],f[N],dep[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++tot]=y,ne[tot]=head[x],head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    d[x]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dep[y]=dep[x]+<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(y,x);</span><br><span class="line">        d[x]+=d[y];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    d[x]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((y=to[i])==fa) <span class="keyword">continue</span>;</span><br><span class="line">        f[y]=f[x]<span class="number">-2</span>*d[y]+n;</span><br><span class="line">        <span class="built_in">dfs2</span>(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n=<span class="built_in">read</span>();</span><br><span class="line">    <span class="type">int</span> x,y,z;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) x=<span class="built_in">read</span>(),y=<span class="built_in">read</span>(),<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[<span class="number">1</span>]+=d[i];</span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(f[ans]&lt;f[i]) ans=i;</span><br><span class="line">    cout&lt;&lt;ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="CF149D-Coloring-Brackets"><a href="#CF149D-Coloring-Brackets" class="headerlink" title="CF149D Coloring Brackets"></a><a href="https://www.luogu.com.cn/problem/CF149D">CF149D Coloring Brackets</a></h3><p>不会做，先咕着吧</p><h3 id="P8452-「SWTR-8」15B03"><a href="#P8452-「SWTR-8」15B03" class="headerlink" title="P8452 「SWTR-8」15B03"></a><a href="https://www.luogu.com.cn/problem/P8452">P8452 「SWTR-8」15B03</a></h3><p>神仙构造题，<del>是时候贺题解了</del></p><p>80pts 运用贪心，如样例，隔一个空放一张桌子</p><p>剩下二十分，我已找到一种绝妙的方法，但<del>(我太懒)</del>这里空白太小写不下，所以可以去<a href="https://www.luogu.com.cn/blog/461366/p8452-swtr-815b03-post#">这里</a></p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f=<span class="number">-1</span>;c=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c))&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+c<span class="number">-48</span>,c=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> sta[<span class="number">35</span>],top=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;<span class="number">0</span>)x=-x,<span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        sta[top++]=x%<span class="number">10</span>,x/=<span class="number">10</span>;</span><br><span class="line">    &#125;<span class="keyword">while</span>(x);</span><br><span class="line">    <span class="keyword">while</span>(top) <span class="built_in">putchar</span>(sta[--top]+<span class="number">48</span>); </span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T,n,m,s;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    s=<span class="built_in">read</span>();</span><br><span class="line">    T=<span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        n=<span class="built_in">read</span>(),m=<span class="built_in">read</span>();</span><br><span class="line">        cout&lt;&lt;n*m-((n+<span class="number">1</span>)/<span class="number">2</span>)*((m+<span class="number">1</span>)/<span class="number">2</span>)&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;<span class="number">3</span>&amp;&amp;m&lt;<span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;0.0\n&quot;</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">double</span> ans=<span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i+=<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j+=<span class="number">2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> x=i,y=j;</span><br><span class="line">                <span class="keyword">if</span>(n%<span class="number">2</span>==<span class="number">0</span>&amp;&amp;i&gt;n/<span class="number">2</span>) x++;</span><br><span class="line">                <span class="keyword">if</span>(m%<span class="number">2</span>==<span class="number">0</span>&amp;&amp;j&gt;m/<span class="number">2</span>) y++;<span class="comment">//调整坐标</span></span><br><span class="line">                <span class="comment">// hypot(a - b, c - d) = sqrt((a - b) * (a - b) + (c - d) * (c - d)) </span></span><br><span class="line">                <span class="type">double</span> d=<span class="built_in">hypot</span>(x<span class="number">-1</span>,y<span class="number">-1</span>);</span><br><span class="line">                d=<span class="built_in">max</span>(d,<span class="built_in">hypot</span>(x<span class="number">-1</span>,y-m));</span><br><span class="line">                d=<span class="built_in">max</span>(d,<span class="built_in">hypot</span>(x-n,y<span class="number">-1</span>));</span><br><span class="line">                d=<span class="built_in">max</span>(d,<span class="built_in">hypot</span>(x-n,y-m));</span><br><span class="line">                ans+=d;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.9lf\n&quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="AT4530-Coins"><a href="#AT4530-Coins" class="headerlink" title="AT4530 Coins"></a><a href="https://www.luogu.com.cn/problem/AT4530">AT4530 Coins</a></h3><p>没错，<del>在看了题解之后</del>我发现这是一道DP</p><p>这题设$dp[i][j]$表示前$i$个元素有$j$个向上的概率。只需要枚举当 前硬币是向上还是向下即可，与背包类似。</p><p>转移方程为：$ dp[i][j]=dp[i−1][j−1]×p_i+dp[i−1][j]×(1−p_i)$</p><p>计算完毕后，枚举有多少枚硬币向上就做完了。</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">3e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">double</span> a[N];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">double</span> f[N][N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">0</span>;j&lt;=i;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            f[i][j]=f[i<span class="number">-1</span>][j]*(<span class="number">1</span>-a[i])+(j&gt;<span class="number">0</span>?f[i<span class="number">-1</span>][j<span class="number">-1</span>]*a[i]:<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(i&gt;n-i) ans+=f[n][i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.9lf&quot;</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><h3 id="CF1387B1-Village-Minimum"><a href="#CF1387B1-Village-Minimum" class="headerlink" title="CF1387B1 Village (Minimum)"></a><a href="https://www.luogu.com.cn/problem/CF1387B1">CF1387B1 Village (Minimum)</a></h3><p>不会，先咕着</p><h3 id="AT2642-ARC076A-Reconciled"><a href="#AT2642-ARC076A-Reconciled" class="headerlink" title="AT2642 [ARC076A] Reconciled?"></a><a href="https://www.luogu.com.cn/problem/AT2642">AT2642 [ARC076A] Reconciled?</a></h3><p>鉴于猴子和狗必须间隔，所以$abs(m-n)&lt;=1$,然后就是排列</p><details>     <summary>AC code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> jc[N]=&#123;<span class="number">1</span>&#125;;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(n-m)&gt;<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">1e5</span>;++i) jc[i]=i*jc[i<span class="number">-1</span>]%mod;</span><br><span class="line">    cout&lt;&lt;jc[m]*jc[n]*(n==m?<span class="number">2</span>:<span class="number">1</span>)%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><h3 id="SP1684-FREQUENT-Frequent-values"><a href="#SP1684-FREQUENT-Frequent-values" class="headerlink" title="SP1684 FREQUENT - Frequent values"></a><a href="https://www.luogu.com.cn/problem/SP1684">SP1684 FREQUENT - Frequent values</a></h3><p>我们看到这个题就会想到莫队<del>？？？</del>，<del>于是把<a href="https://www.luogu.com.cn/problem/AT1219">[AT1219] 歴史の研究</a>拿过来改一下就A了</del>，但绿题怎么能用回滚莫队呢，<del>用普通莫队就可以了,我们用一个数组记录每个数出现次数的次数</del>，经过审题后，我们发现$a$序列是非降的，所以相同的数必定连续，于是可以预处理每个数字的出现次数，用RMQ合并</p><details>     <summary>AC code（回滚莫队）</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">2e5</span>+<span class="number">5</span>,maxn=<span class="number">2e5</span>+<span class="number">5</span>,N=<span class="number">1e5</span>;</span><br><span class="line"><span class="type">int</span> n,Q,t,t1;</span><br><span class="line"><span class="type">int</span> belong[maxm],a[maxm],b[maxm],R[maxn],cnt[maxm],cnt1[maxm],ans[maxm];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,id;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> query&amp;x)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> belong[l]==belong[x.l]?r&lt;x.r:l&lt;x.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[maxm];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;x,<span class="type">int</span> &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">++cnt[x+N];</span><br><span class="line">res=<span class="built_in">max</span>(res,cnt[x+N]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--cnt[x+N];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;x,<span class="type">int</span> &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">++cnt1[x+N];</span><br><span class="line">res=<span class="built_in">max</span>(res,cnt1[x+N]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">del1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">--cnt1[x+N];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span>(cin&gt;&gt;n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        cin&gt;&gt;Q;</span><br><span class="line">        t=<span class="built_in">sqrt</span>(n*n/Q);</span><br><span class="line">        t1=(n<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t1;++i) R[i]=i*t;</span><br><span class="line">        R[t1]=n;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],b[i]=a[i],belong[i]=(i<span class="number">-1</span>)/t+<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> M=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+M+<span class="number">1</span>,a[i])-b;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i) cin&gt;&gt;q[i].l&gt;&gt;q[i].r,q[i].id=i;</span><br><span class="line">        <span class="built_in">sort</span>(q+<span class="number">1</span>,q+Q+<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> res,res1,last=<span class="number">0</span>,l=<span class="number">1</span>,r=<span class="number">0</span>,ll;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(belong[q[i].l]==belong[q[i].r])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(re <span class="type">int</span> j=q[i].l;j&lt;=q[i].r;++j) <span class="built_in">add1</span>(a[j],ans[q[i].id]);</span><br><span class="line">                <span class="keyword">for</span>(re <span class="type">int</span> j=q[i].l;j&lt;=q[i].r;++j) <span class="built_in">del1</span>(a[j]);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(belong[q[i].l]!=last)</span><br><span class="line">            &#123;</span><br><span class="line">                last=belong[q[i].l];</span><br><span class="line">                <span class="keyword">for</span>(re <span class="type">int</span> j=l;j&lt;=r;++j) <span class="built_in">del</span>(a[j]);</span><br><span class="line">                l=R[last]+<span class="number">1</span>,r=l<span class="number">-1</span>;</span><br><span class="line">                ll=l;</span><br><span class="line">                res=<span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(r&lt;q[i].r) <span class="built_in">add</span>(a[++r],res);</span><br><span class="line">            res1=res;</span><br><span class="line">            <span class="keyword">while</span>(l&gt;q[i].l) <span class="built_in">add</span>(a[--l],res1);</span><br><span class="line">            <span class="keyword">while</span>(l&lt;ll) <span class="built_in">del</span>(a[l++]);</span><br><span class="line">            ans[q[i].id]=res1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=Q;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>     <summary>AC code（RMQ）</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> st[N][<span class="number">20</span>],dp[N],num[N];</span><br><span class="line"><span class="type">int</span> n,q;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rmq</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">st[i][<span class="number">0</span>]=dp[i];</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">log</span>((<span class="type">double</span>)(n+<span class="number">1</span>))/<span class="built_in">log</span>(<span class="number">2.0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=k;j++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;i++)</span><br><span class="line">st[i][j]=<span class="built_in">max</span>(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Query</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;    </span><br><span class="line"><span class="type">int</span> k=<span class="built_in">log</span>((<span class="type">double</span>)(r-l+<span class="number">1</span>))/<span class="built_in">log</span>(<span class="number">2.0</span>);    </span><br><span class="line"><span class="keyword">return</span> <span class="built_in">max</span>(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;    </span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n)!=EOF&amp;&amp;n)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;q);</span><br><span class="line">dp[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num[i]);</span><br><span class="line"><span class="keyword">if</span>(i&gt;<span class="number">1</span>)</span><br><span class="line">dp[i]=(num[i]==num[i<span class="number">-1</span>]?dp[i<span class="number">-1</span>]+<span class="number">1</span>:<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">rmq</span>();</span><br><span class="line"><span class="keyword">while</span>(q--)&#123;</span><br><span class="line"><span class="type">int</span> a,b;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line"><span class="type">int</span> c=a;</span><br><span class="line"><span class="keyword">while</span>(c&lt;=b&amp;&amp;num[c]==num[c<span class="number">-1</span>]) c++;</span><br><span class="line">cout&lt;&lt;<span class="built_in">max</span>(<span class="built_in">Query</span>(c,b),c-a)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><h3 id="AT4319-ABC120D-Decayed-Bridges"><a href="#AT4319-ABC120D-Decayed-Bridges" class="headerlink" title="AT4319 [ABC120D] Decayed Bridges"></a><a href="https://www.luogu.com.cn/problem/AT4319">AT4319 [ABC120D] Decayed Bridges</a></h3><p>一道很水的题，类似于<a href="https://www.luogu.com.cn/problem/P1197">P1197 [JSOI2008] 星球大战</a>，鉴于删边不好操作，我们倒序操作，将其改为加边，对两个联通块而言，减少的贡献是两者大小之积，用并查集维护即可</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x,y;</span><br><span class="line">&#125;e[N];</span><br><span class="line"><span class="type">int</span> f[N],s[N];</span><br><span class="line"><span class="type">int</span> ans[N],res;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x==f[x]?x:f[x]=<span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i]=i,s[i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;e[i].x&gt;&gt;e[i].y;</span><br><span class="line">    res=(n<span class="number">-1</span>)*n/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=m;i;--i)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[i]=res;</span><br><span class="line">        <span class="type">int</span> x=<span class="built_in">find</span>(e[i].x),y=<span class="built_in">find</span>(e[i].y);</span><br><span class="line">        <span class="keyword">if</span>(x!=y)</span><br><span class="line">        &#123;</span><br><span class="line">            res-=s[x]*s[y];</span><br><span class="line">            f[x]=y,s[y]+=s[x];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cout&lt;&lt;ans[i]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="SP18185-GIVEAWAY-Give-Away"><a href="#SP18185-GIVEAWAY-Give-Away" class="headerlink" title="SP18185 GIVEAWAY - Give Away"></a><a href="https://www.luogu.com.cn/problem/SP18185">SP18185 GIVEAWAY - Give Away</a></h3><p>分块裸题，题解中有用树套树的巨佬，我就<del>无耻地</del>copy过来</p><details>    <summary>AC Code（分块）</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">1e6</span>+<span class="number">5</span>,maxn=<span class="number">1e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,a[maxm],b[maxm],L[maxn],R[maxn],belong[maxm];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">so</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">sort</span>(a+L[k],a+R[k]+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=belong[x];</span><br><span class="line">    b[x]=v;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=L[p];i&lt;=R[p];++i) a[i]=b[i];</span><br><span class="line">    <span class="built_in">so</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> p=belong[x],q=belong[y];</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=x;i&lt;=y;++i) <span class="keyword">if</span>(b[i]&gt;=v) ++res;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=x;i&lt;=R[p];++i) <span class="keyword">if</span>(b[i]&gt;=v) ++res;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=L[q];i&lt;=y;++i) <span class="keyword">if</span>(b[i]&gt;=v) ++res;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=p+<span class="number">1</span>;i&lt;q;++i)</span><br><span class="line">&#123;</span><br><span class="line">res+=R[i]+<span class="number">1</span>-(<span class="built_in">lower_bound</span>(a+L[i],a+R[i]+<span class="number">1</span>,v)-a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="type">int</span> t1=<span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="type">int</span> t=(n<span class="number">-1</span>)/t1+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;++i)L[i]=(i<span class="number">-1</span>)*t1+<span class="number">1</span>,R[i]=i*t1;</span><br><span class="line">R[t]=n;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],b[i]=a[i],belong[i]=(i<span class="number">-1</span>)/t1+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;++i) <span class="built_in">so</span>(i);</span><br><span class="line"><span class="type">int</span> opt,x,y,z;</span><br><span class="line">    cin&gt;&gt;m;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">0</span>) cin&gt;&gt;z,cout&lt;&lt;<span class="built_in">ask</span>(x,y,z)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><details>    <summary>AC Code（树套树）</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAX_N = <span class="number">500010</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> alpha = <span class="number">0.75</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">scapeGoat</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        node *parent; <span class="comment">// 父节点指针</span></span><br><span class="line">        node *child[<span class="number">2</span>]; <span class="comment">// child[0]为左子结点的指针，child[1]为右子结点的指针。</span></span><br><span class="line">        <span class="type">int</span> value, count, size, cover; <span class="comment">// 数据，结点个数，size为有效结点的数量（记录count），cover为总结点的数量（全视为1）</span></span><br><span class="line"></span><br><span class="line">```c++</span><br><span class="line">    <span class="built_in">node</span>(<span class="type">int</span> _value) &#123;</span><br><span class="line">        value = _value;</span><br><span class="line">        parent = child[<span class="number">0</span>] = child[<span class="number">1</span>] = <span class="literal">NULL</span>;</span><br><span class="line">        size = cover = count = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">node *root;</span><br><span class="line"><span class="type">int</span> deletedCount;</span><br><span class="line"><span class="built_in">scapeGoat</span>() &#123;</span><br><span class="line">    root = <span class="literal">NULL</span>;</span><br><span class="line">    deletedCount = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">~<span class="built_in">scapeGoat</span>() &#123;</span><br><span class="line">    <span class="built_in">destroy</span>(root);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">destroy</span><span class="params">(node *current)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (current) &#123;</span><br><span class="line">        <span class="built_in">destroy</span>(current-&gt;child[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">destroy</span>(current-&gt;child[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">delete</span> current;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">maintain</span><span class="params">(node *current)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span>) &#123; <span class="comment">// 可能传入的是一个空指针</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    current-&gt;size = current-&gt;count;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;child[i]) &#123;</span><br><span class="line">            current-&gt;size += current-&gt;child[i]-&gt;size; <span class="comment">// 加上左右子树的size</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    current-&gt;cover = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;child[i]) &#123;</span><br><span class="line">            current-&gt;cover += current-&gt;child[i]-&gt;cover; <span class="comment">// 加上左右子树的cover</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">getType</span><span class="params">(node *current)</span> </span>&#123; <span class="comment">// 获得结点是左结点还是右结点，0左1右</span></span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span> || current-&gt;parent == <span class="literal">NULL</span>) &#123; <span class="comment">// 传入空指针；根结点没有父亲，特判一下</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 下标放-1会报错，放个0就好了</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> current-&gt;parent-&gt;child[<span class="number">1</span>] == current; <span class="comment">// 父亲的右子结点 是不是 自己</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">connect</span><span class="params">(node *parent, node *current, <span class="type">int</span> type)</span> </span>&#123; <span class="comment">// 父结点指针，当前结点指针，类型（0左1右）</span></span><br><span class="line">    <span class="keyword">if</span> (parent) &#123; <span class="comment">// parent 可能为NULL</span></span><br><span class="line">        parent-&gt;child[type] = current;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (current) &#123; <span class="comment">// current 也可能为NULL</span></span><br><span class="line">        current-&gt;parent = parent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">bool</span> <span class="title">isBad</span><span class="params">(node *current)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;child[i]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (current-&gt;child[i]-&gt;cover &gt; current-&gt;cover * alpha) &#123; <span class="comment">// 对后面的current-&gt;cover * alpha加5可以避免小规模的重构，在O0中能快几ms</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">travel</span><span class="params">(node *current, vector&lt;node *&gt; &amp;v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">travel</span>(current-&gt;child[<span class="number">0</span>], v);</span><br><span class="line">    <span class="keyword">if</span> (current-&gt;count) &#123; <span class="comment">// 结点存在，没被删</span></span><br><span class="line">        v.<span class="built_in">push_back</span>(current);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">travel</span>(current-&gt;child[<span class="number">1</span>], v);</span><br><span class="line">    <span class="keyword">if</span> (!current-&gt;count) &#123; <span class="comment">// 被删了，物理上删除</span></span><br><span class="line">        deletedCount --; <span class="comment">// 标记删除的结点少了一个</span></span><br><span class="line">        <span class="keyword">delete</span> current;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node * <span class="title">divide</span><span class="params">(vector&lt;node *&gt; &amp;v, <span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left &gt;= right) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> middle = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    node *current = v[middle];</span><br><span class="line">    <span class="built_in">connect</span>(current, <span class="built_in">divide</span>(v, left, middle), <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">connect</span>(current, <span class="built_in">divide</span>(v, middle + <span class="number">1</span>, right), <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">maintain</span>(current);</span><br><span class="line">    <span class="keyword">return</span> current;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reBuild</span><span class="params">(node *current)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> type = <span class="built_in">getType</span>(current);</span><br><span class="line">    node *parent = current-&gt;parent;</span><br><span class="line">    <span class="type">static</span> vector&lt;node *&gt; v; <span class="comment">// 避免反复申请、释放内存，快了30ms</span></span><br><span class="line">    v.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="built_in">travel</span>(current, v);</span><br><span class="line">    node *newTree = <span class="built_in">divide</span>(v, <span class="number">0</span>, v.<span class="built_in">size</span>());</span><br><span class="line">    <span class="built_in">connect</span>(parent, newTree, type);</span><br><span class="line">    <span class="keyword">if</span> (root == current) &#123; <span class="comment">// 根节点更新</span></span><br><span class="line">        root = newTree;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">balance</span><span class="params">(node *current)</span> </span>&#123; <span class="comment">// 一路更新，暴力重构最顶端的坏结点</span></span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (deletedCount &gt; root-&gt;cover / <span class="number">2</span>) &#123; <span class="comment">// 懒更新结点太多了，整棵树重构</span></span><br><span class="line">        <span class="built_in">reBuild</span>(root);</span><br><span class="line">        deletedCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    node *badNode = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">maintain</span>(current);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isBad</span>(current)) &#123;</span><br><span class="line">            badNode = current;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;parent) &#123;</span><br><span class="line">            current = current-&gt;parent;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (badNode) &#123;</span><br><span class="line">        <span class="built_in">reBuild</span>(badNode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node* <span class="title">insert</span><span class="params">(<span class="type">int</span> value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        root = <span class="keyword">new</span> <span class="built_in">node</span>(value);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    node *current = root;</span><br><span class="line">    node *parent = current-&gt;parent;</span><br><span class="line">    <span class="type">int</span> type; <span class="comment">// 类型</span></span><br><span class="line">    <span class="keyword">while</span> (current) &#123; <span class="comment">// 和查找一模一样</span></span><br><span class="line">        <span class="keyword">if</span> (current-&gt;value &lt; value) &#123;</span><br><span class="line">            parent = current;</span><br><span class="line">            current = current-&gt;child[<span class="number">1</span>];</span><br><span class="line">            type = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;value &gt; value) &#123;</span><br><span class="line">            parent = current;</span><br><span class="line">            current = current-&gt;child[<span class="number">0</span>];</span><br><span class="line">            type = <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// 已经有相同结点了，将其count++即可。</span></span><br><span class="line">            <span class="keyword">if</span> (!current-&gt;count) &#123; <span class="comment">// 被删除的结点在没有重构之前回来了</span></span><br><span class="line">                deletedCount --;</span><br><span class="line">            &#125;</span><br><span class="line">            current-&gt;count ++;</span><br><span class="line">            <span class="built_in">balance</span>(current);</span><br><span class="line">            <span class="keyword">return</span> current;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    current = <span class="keyword">new</span> <span class="built_in">node</span>(value);</span><br><span class="line">    <span class="built_in">connect</span>(parent, current, type);</span><br><span class="line">    <span class="built_in">balance</span>(current);</span><br><span class="line">    <span class="keyword">return</span> current;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">remove</span><span class="params">(node *current)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span> || !current-&gt;count) &#123; <span class="comment">// 已经被删除了就不要再删了</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    current-&gt;count --;</span><br><span class="line">    <span class="keyword">if</span> (!current-&gt;count) &#123;</span><br><span class="line">        deletedCount ++; <span class="comment">// 删没了一个结点，懒更新</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">balance</span>(current); <span class="comment">// 更新size等信息 + 平衡</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node* <span class="title">find</span><span class="params">(<span class="type">int</span> value)</span> </span>&#123;</span><br><span class="line">    node *current = root; <span class="comment">// 从根结点开始搜索</span></span><br><span class="line">    <span class="keyword">while</span> (current) &#123;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;value &lt; value) &#123;</span><br><span class="line">            current = current-&gt;child[<span class="number">1</span>]; <span class="comment">// 小了，往大了走</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;value &gt; value) &#123;</span><br><span class="line">            current = current-&gt;child[<span class="number">0</span>]; <span class="comment">// 大了，往小了走</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// 不大也不小不就是找到了吗？</span></span><br><span class="line">            <span class="keyword">return</span> current;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>; <span class="comment">// 找不到结点，退出。（找到得到结点的话会在while循环就退出）</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rankOfNode</span><span class="params">(<span class="type">int</span> value)</span> </span>&#123; <span class="comment">// 即使查询的值不在树中，也能查。</span></span><br><span class="line">    <span class="comment">// 这里传入的value为被查询排名的结点的value</span></span><br><span class="line">    node *current = root; <span class="comment">// 从根结点开始搜索</span></span><br><span class="line">    <span class="type">int</span> leftSize = <span class="number">1</span>; <span class="comment">// 左面的结点个数。提前将自己的大小1加上，你就想最左侧结点左面啥也没有但是排名为1</span></span><br><span class="line">    <span class="keyword">while</span> (current) &#123;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;value &gt;= value) &#123; <span class="comment">// 玄学。即使找到了结点， 也还是会往左走到NULL结点后退出，走左子树不加，不影响结果。</span></span><br><span class="line">            current = current-&gt;child[<span class="number">0</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (current-&gt;child[<span class="number">0</span>]) &#123;</span><br><span class="line">                leftSize += current-&gt;child[<span class="number">0</span>]-&gt;size;</span><br><span class="line">            &#125;</span><br><span class="line">            leftSize += current-&gt;count;</span><br><span class="line">            current = current-&gt;child[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> leftSize;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> a[MAX_N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BIT</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    scapeGoat node[MAX_N];</span><br><span class="line">    <span class="built_in">BIT</span>(<span class="type">int</span> _n) &#123;</span><br><span class="line">        n = _n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> index, <span class="type">int</span> c)</span> </span>&#123; <span class="comment">// 大于等于c的有多少</span></span><br><span class="line">        <span class="type">int</span> oriIndex = index; <span class="comment">// 原先的index</span></span><br><span class="line">        <span class="type">int</span> lessThanC = <span class="number">0</span>; <span class="comment">// 比c小的有多少</span></span><br><span class="line">        <span class="keyword">while</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            lessThanC += node[index].<span class="built_in">rankOfNode</span>(c) - <span class="number">1</span>;</span><br><span class="line">            index -= <span class="built_in">lowbit</span>(index);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> oriIndex - lessThanC;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> index, <span class="type">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (index &lt;= n) &#123;</span><br><span class="line">            node[index].<span class="built_in">insert</span>(value);</span><br><span class="line">            index += <span class="built_in">lowbit</span>(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> index, <span class="type">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> p = index; <span class="comment">// 记录原来的位置</span></span><br><span class="line">        <span class="keyword">while</span> (index &lt;= n) &#123;</span><br><span class="line">            node[index].<span class="built_in">remove</span>(node[index].<span class="built_in">find</span>(a[p])); <span class="comment">// 删掉老的</span></span><br><span class="line">            node[index].<span class="built_in">insert</span>(value); <span class="comment">// 插入新的</span></span><br><span class="line">            index += <span class="built_in">lowbit</span>(index);</span><br><span class="line">        &#125;</span><br><span class="line">        a[p] = value; <span class="comment">// 在存放所有数据的a中同样进行更改</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, q, temp, op, l, r, c, p, b;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">BIT <span class="title">tree</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; temp;</span><br><span class="line">        a[i] = temp;</span><br><span class="line">        tree.<span class="built_in">insert</span>(i, temp);</span><br><span class="line">    &#125;</span><br><span class="line">    cin &gt;&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="keyword">switch</span> (op) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                cin &gt;&gt; l &gt;&gt; r &gt;&gt; c;</span><br><span class="line">                cout &lt;&lt; tree.<span class="built_in">sum</span>(r, c) - tree.<span class="built_in">sum</span>(l - <span class="number">1</span>, c) &lt;&lt; endl;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                cin &gt;&gt; p &gt;&gt; b;</span><br><span class="line">                tree.<span class="built_in">change</span>(p, b);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><h3 id="P2002-消息扩散"><a href="#P2002-消息扩散" class="headerlink" title="P2002 消息扩散"></a><a href="https://www.luogu.com.cn/problem/P2002">P2002 消息扩散</a></h3><p>跟tarjan有关，先咕着</p><p>update 2022.11.14 补个代码</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m,tot,res;</span><br><span class="line"><span class="type">int</span> head[N],to[N],ne[N];</span><br><span class="line"><span class="type">int</span> dfn[N],low[N],t;</span><br><span class="line"><span class="type">int</span> st[N],top;</span><br><span class="line"><span class="type">int</span> c[N],co;</span><br><span class="line"><span class="type">int</span> deg[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ne[++tot]=head[x],head[x]=tot,to[tot]=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dfn[x]=low[x]=++t;</span><br><span class="line">st[++top]=x;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!dfn[y=to[i]]) <span class="built_in">tarjan</span>(y),low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!c[y]) low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(low[x]==dfn[x])</span><br><span class="line">&#123;</span><br><span class="line">++co;</span><br><span class="line"><span class="keyword">while</span>(st[top+<span class="number">1</span>]!=x) c[st[top--]]=co;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">while</span>(m--) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(!dfn[i]) <span class="built_in">tarjan</span>(i);</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> y,j=head[i];j;j=ne[j])<span class="keyword">if</span>(c[i]!=c[y=to[j]]) ++deg[c[y]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=co;++i)<span class="keyword">if</span>(!deg[i]) ++res;</span><br><span class="line">cout&lt;&lt;res;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="SP28305-ADAINDEX-Ada-and-Indexing"><a href="#SP28305-ADAINDEX-Ada-and-Indexing" class="headerlink" title="SP28305 ADAINDEX - Ada and Indexing"></a><a href="https://www.luogu.com.cn/problem/SP28305">SP28305 ADAINDEX - Ada and Indexing</a></h3><p>Trie 板子题</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> son[N][<span class="number">26</span>],v[N],n,q,tot=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;s[i];++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!son[p][c]) son[p][c]=++tot;</span><br><span class="line">        p=son[p][c];</span><br><span class="line">        ++v[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">0</span>;s[i];++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> c=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!son[p][c]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        p=son[p][c];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;s,<span class="built_in">ins</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;++i) cin&gt;&gt;s,cout&lt;&lt;<span class="built_in">ask</span>(s)&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="SP1026-FAVDICE-Favorite-Dice"><a href="#SP1026-FAVDICE-Favorite-Dice" class="headerlink" title="SP1026 FAVDICE - Favorite Dice"></a><a href="https://www.luogu.com.cn/problem/SP1026">SP1026 FAVDICE - Favorite Dice</a></h3><p>简单的期望题</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin&gt;&gt;T;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">double</span> ans=<span class="number">0</span>;</span><br><span class="line">        cin&gt;&gt;n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans+=(<span class="type">double</span>)<span class="number">1</span>/i;</span><br><span class="line">        ans*=n;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P7715-「EZEC-10」Shape"><a href="#P7715-「EZEC-10」Shape" class="headerlink" title="P7715 「EZEC-10」Shape"></a><a href="https://www.luogu.com.cn/problem/P7715">P7715 「EZEC-10」Shape</a></h3><p>一道见过多遍的题，不会，先咕着</p><h3 id="SP1805-HISTOGRA-Largest-Rectangle-in-a-Histogram"><a href="#SP1805-HISTOGRA-Largest-Rectangle-in-a-Histogram" class="headerlink" title="SP1805 HISTOGRA - Largest Rectangle in a Histogram"></a><a href="https://www.luogu.com.cn/problem/SP1805">SP1805 HISTOGRA - Largest Rectangle in a Histogram</a></h3><p>单调栈板子题</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,w[N],cnt,x,ans,h[N],a[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(cin&gt;&gt;n)</span><br><span class="line">    &#123;</span><br><span class="line">        cnt=ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(!n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)    cin&gt;&gt;a[i];</span><br><span class="line">        a[n+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(h[cnt]&gt;a[i]) res+=w[cnt],ans=<span class="built_in">max</span>(ans,res*h[cnt]),--cnt;</span><br><span class="line">            w[++cnt]=<span class="number">1</span>+res,h[cnt]=a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="CF61D-Eternal-Victory"><a href="#CF61D-Eternal-Victory" class="headerlink" title="CF61D Eternal Victory"></a><a href="https://www.luogu.com.cn/problem/CF61D">CF61D Eternal Victory</a></h3><p>一道比较有意思的题，读题可知这n座城市构成一棵树，而每个城市都要走到和任意确定终点说明每条链要经过两遍，只有一条含1号点的只经过一遍，所以dfs就行了</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,head[N],to[N&lt;&lt;<span class="number">1</span>],ne[N&lt;&lt;<span class="number">1</span>],e[N&lt;&lt;<span class="number">1</span>],tot,sum,ans;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++tot]=y,ne[tot]=head[x],e[tot]=z,head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ans=<span class="built_in">max</span>(ans,z);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=head[x];i;i=ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u=to[i];</span><br><span class="line">        <span class="keyword">if</span>(u==y) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(u,x,z+e[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="type">int</span> x,y,z;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y&gt;&gt;z,<span class="built_in">add</span>(x,y,z),<span class="built_in">add</span>(y,x,z),sum+=z;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    cout&lt;&lt;sum*<span class="number">2</span>-ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P1613-跑路"><a href="#P1613-跑路" class="headerlink" title="P1613 跑路"></a><a href="https://www.luogu.com.cn/problem/P1613">P1613 跑路</a></h3><p>一道好题，我们用倍增的思想，用$f[i][j][k]表示i到j$之间是否有一条长度为$2^{k}$的边</p><p>再跑最短路就行了</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> f[<span class="number">55</span>][<span class="number">55</span>][<span class="number">65</span>],n,m;</span><br><span class="line"><span class="type">int</span> d[<span class="number">55</span>][<span class="number">55</span>];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="type">int</span> x,y;</span><br><span class="line">    <span class="built_in">memset</span>(d,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;x&gt;&gt;y,f[x][y][<span class="number">0</span>]=d[x][y]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">64</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(re <span class="type">int</span> p=<span class="number">1</span>;p&lt;=n;++p)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(f[j][k][i<span class="number">-1</span>]&amp;&amp;f[k][p][i<span class="number">-1</span>]) f[j][p][i]=d[j][p]=<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j) d[i][j]=<span class="built_in">min</span>(d[i][k]+d[k][j],d[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;d[<span class="number">1</span>][n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="AT2665-AGC017B-Moderate-Differences"><a href="#AT2665-AGC017B-Moderate-Differences" class="headerlink" title="AT2665 [AGC017B] Moderate Differences"></a><a href="https://www.luogu.com.cn/problem/AT2665">AT2665 [AGC017B] Moderate Differences</a></h3><p>不会，先咕着,QwQ</p><h3 id="P1284-三角形牧场"><a href="#P1284-三角形牧场" class="headerlink" title="P1284 三角形牧场"></a><a href="https://www.luogu.com.cn/problem/P1284">P1284 三角形牧场</a></h3><p>做不起的DP，用$f[i][j][k]$表示前$i$块木板拼成的三角形两边长分别为$j，k$,</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">45</span>,L=<span class="number">805</span>;</span><br><span class="line"><span class="type">int</span> n,m,a[N];</span><br><span class="line"><span class="type">int</span> dp[L][L],s;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x+y&gt;z&amp;&amp;x+z&gt;y&amp;&amp;y+z&gt;x)?<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">double</span> <span class="title">mj</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">double</span> xx=x,yy=y,zz=z;</span><br><span class="line">    <span class="type">double</span> p=(xx+yy+zz)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(p*(p-xx)*(p-yy)*(p-zz));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],s+=a[i];</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=s&gt;&gt;<span class="number">1</span>;j&gt;=<span class="number">0</span>;--j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> k=s&gt;&gt;<span class="number">1</span>;k&gt;=<span class="number">0</span>;--k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(j-a[i]&gt;=<span class="number">0</span>) dp[j][k]|=dp[j-a[i]][k];</span><br><span class="line">                <span class="keyword">if</span>(k-a[i]&gt;=<span class="number">0</span>) dp[j][k]|=dp[j][k-a[i]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> ans=<span class="number">-0.01</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=s/<span class="number">2</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=s/<span class="number">2</span>;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!dp[i][j])<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">check</span>(i,j,s-i-j)) <span class="keyword">continue</span>;</span><br><span class="line">            ans=<span class="built_in">max</span>(ans,<span class="built_in">mj</span>(i,j,s-i-j));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;(<span class="type">int</span>)(ans*<span class="number">100</span>)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><h3 id="CF1475F-Unusual-Matrix"><a href="#CF1475F-Unusual-Matrix" class="headerlink" title="CF1475F Unusual Matrix"></a><a href="https://www.luogu.com.cn/problem/CF1475F">CF1475F Unusual Matrix</a></h3><p>一道贪心题，我们将题目中的两个矩阵中的元素分别异或，题目就转化为能否使这个矩阵全为0，对每一行单独判断是否和第一行相同或相反</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> n,a[N][N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin&gt;&gt;T;</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;n;</span><br><span class="line">        <span class="type">int</span> flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            cin&gt;&gt;s+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j) a[i][j]=s[j]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            cin&gt;&gt;s+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j) a[i][j]^=s[j]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> k=a[i][<span class="number">1</span>]^a[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">2</span>;j&lt;=n;++j)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(a[i][j]^a[<span class="number">1</span>][j]^k)</span><br><span class="line">                &#123;</span><br><span class="line">                    flag=<span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(flag) cout&lt;&lt;<span class="string">&quot;YES\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P1687-机器人小Q"><a href="#P1687-机器人小Q" class="headerlink" title="P1687 机器人小Q"></a><a href="https://www.luogu.com.cn/problem/P1687">P1687 机器人小Q</a></h3><p>与<a href="https://www.luogu.com.cn/problem/P3052">P3052</a>相似，相较之下比较好想的DP</p><p>ps:我可能用了假内存，MLE，改成滚动数组了</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">3e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> f[<span class="number">2</span>][N],g[<span class="number">2</span>][N];</span><br><span class="line"><span class="type">int</span> n,k,a[N],nn;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;nn&gt;&gt;k;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=nn;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;x;</span><br><span class="line">        <span class="keyword">if</span>(x&lt;=<span class="number">119</span>) a[++n]=x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;k)</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;You can&#x27;t do it.&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=k;++i) f[<span class="number">0</span>][i]=f[<span class="number">1</span>][i]=<span class="number">1e9</span>;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=k;++j) f[i&amp;<span class="number">1</span>][j]=<span class="number">1e9</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=k;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            f[i&amp;<span class="number">1</span>][j]=f[i+<span class="number">1</span>&amp;<span class="number">1</span>][j],g[i&amp;<span class="number">1</span>][j]=g[i+<span class="number">1</span>&amp;<span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">if</span>(g[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>]&gt;=a[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(f[i&amp;<span class="number">1</span>][j]&gt;f[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>]) f[i&amp;<span class="number">1</span>][j]=f[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>],g[i&amp;<span class="number">1</span>][j]=g[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>]-a[i];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(f[i&amp;<span class="number">1</span>][j]==f[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>]) g[i&amp;<span class="number">1</span>][j]=<span class="built_in">max</span>(g[i&amp;<span class="number">1</span>][j],g[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>]-a[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(f[i&amp;<span class="number">1</span>][j]&gt;f[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>]+<span class="number">1</span>) f[i&amp;<span class="number">1</span>][j]=f[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>]+<span class="number">1</span>,g[i&amp;<span class="number">1</span>][j]=<span class="number">119</span>-a[i];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(f[i&amp;<span class="number">1</span>][j]==f[i+<span class="number">1</span>&amp;<span class="number">1</span>][j<span class="number">-1</span>]+<span class="number">1</span>) g[i&amp;<span class="number">1</span>][j]=<span class="built_in">max</span>(g[i&amp;<span class="number">1</span>][j],<span class="number">119</span>-a[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;f[n&amp;<span class="number">1</span>][k];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="UVA12467-Secret-Word"><a href="#UVA12467-Secret-Word" class="headerlink" title="UVA12467 Secret Word"></a><a href="https://www.luogu.com.cn/problem/UVA12467">UVA12467 Secret Word</a></h3><p>将S倒过来kmp匹配就行了，记录匹配最大长度</p><details>    <summary>AC COde</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">char</span> s[N],s1[N];</span><br><span class="line"><span class="type">int</span> ne[N],n,res;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin&gt;&gt;T;</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;s+<span class="number">1</span>;</span><br><span class="line">        n=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s1[i]=s[n-i+<span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span>(s[j+<span class="number">1</span>]!=s[i]&amp;&amp;j) j=ne[j];</span><br><span class="line">            <span class="keyword">if</span>(s[j+<span class="number">1</span>]==s[i]) ++j;</span><br><span class="line">            ne[i]=j;</span><br><span class="line">        &#125;</span><br><span class="line">        res=j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span>(s[j+<span class="number">1</span>]!=s1[i]&amp;&amp;j) j=ne[j];</span><br><span class="line">            <span class="keyword">if</span>(s[j+<span class="number">1</span>]==s1[i]) ++j;</span><br><span class="line">            res=<span class="built_in">max</span>(res,j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(re <span class="type">int</span> i=res;i;--i) cout&lt;&lt;s[i];</span><br><span class="line">        cout&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="AT4756-ABC126E-1-or-2"><a href="#AT4756-ABC126E-1-or-2" class="headerlink" title="AT4756 [ABC126E] 1 or 2"></a><a href="https://www.luogu.com.cn/problem/AT4756">AT4756 [ABC126E] 1 or 2</a></h3><p>并查集维护关系</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> f[N],res;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x==f[x]?x:f[x]=<span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i]=i;</span><br><span class="line">    <span class="type">int</span> x,y,z;</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;</span><br><span class="line">        x=<span class="built_in">find</span>(x),y=<span class="built_in">find</span>(y);</span><br><span class="line">        <span class="keyword">if</span>(x==y) <span class="keyword">continue</span>;</span><br><span class="line">        f[x]=y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(f[i]==i) ++res;</span><br><span class="line">    cout&lt;&lt;res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="SP39-PIGBANK-Piggy-Bank"><a href="#SP39-PIGBANK-Piggy-Bank" class="headerlink" title="SP39 PIGBANK - Piggy-Bank"></a><a href="https://www.luogu.com.cn/problem/SP39">SP39 PIGBANK - Piggy-Bank</a></h3><p>完全背包裸题</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">505</span>;</span><br><span class="line"><span class="type">int</span> T,n,m;</span><br><span class="line"><span class="type">int</span> f[<span class="number">10005</span>],w[N],v[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;T;</span><br><span class="line"><span class="keyword">while</span>(T--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y&gt;&gt;n;</span><br><span class="line">m=y-x,f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;++j) f[j]=<span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)cin&gt;&gt;v[i]&gt;&gt;w[i];</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(re <span class="type">int</span> j=w[i];j&lt;=m;++j)</span><br><span class="line">&#123;</span><br><span class="line">f[j]=<span class="built_in">min</span>(f[j],f[j-w[i]]+v[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(f[m]==<span class="number">1e9</span>) cout&lt;&lt;<span class="string">&quot;This is impossible.&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;The minimum amount of money in the piggy-bank is &quot;</span>&lt;&lt;f[m]&lt;&lt;<span class="string">&quot;.&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="AT3947-AGC022B-GCD-Sequence"><a href="#AT3947-AGC022B-GCD-Sequence" class="headerlink" title="AT3947 [AGC022B] GCD Sequence"></a><a href="https://www.luogu.com.cn/problem/AT3947">AT3947 [AGC022B] GCD Sequence</a></h3><p>又是神(du)仙(liu)构造题，先咕着吧</p><h3 id="P5026-Lycanthropy"><a href="#P5026-Lycanthropy" class="headerlink" title="P5026 Lycanthropy"></a><a href="https://www.luogu.com.cn/problem/P5026">P5026 Lycanthropy</a></h3><p>差分好题</p><p>由于只查询一次，先差分，最后做前缀和就好了</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> aa[<span class="number">2100000</span>],bb[<span class="number">2100000</span>];</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> isdigit(x) ((x)&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;(x)&lt;=<span class="string">&#x27;9&#x27;</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a=<span class="number">0</span>,flag=<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)flag=<span class="number">-1</span>;</span><br><span class="line">        c=<span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c))&#123;</span><br><span class="line">        a=(a&lt;&lt;<span class="number">1</span>)+(a&lt;&lt;<span class="number">3</span>)+c<span class="number">-48</span>;</span><br><span class="line">        c=<span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a*flag;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n=<span class="built_in">read</span>(),m=<span class="built_in">read</span>();</span><br><span class="line">    <span class="type">int</span> *a=aa+<span class="number">1000000</span>,*b=bb+<span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="type">int</span> v=<span class="built_in">read</span>(),x=<span class="built_in">read</span>();</span><br><span class="line">        a[x<span class="number">-3</span>*v+<span class="number">1</span>]++;</span><br><span class="line">        a[x<span class="number">-2</span>*v+<span class="number">1</span>]-=<span class="number">2</span>;</span><br><span class="line">        a[x+<span class="number">1</span>]+=<span class="number">2</span>;</span><br><span class="line">        a[x+<span class="number">2</span>*v+<span class="number">1</span>]-=<span class="number">2</span>;</span><br><span class="line">        a[x+<span class="number">3</span>*v+<span class="number">1</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">-40000</span>;i&lt;=m+<span class="number">40000</span>;++i)a[i]+=a[i<span class="number">-1</span>],b[i]+=b[i<span class="number">-1</span>]+a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P4868-Preprefix-sum"><a href="#P4868-Preprefix-sum" class="headerlink" title="P4868 Preprefix sum"></a><a href="https://www.luogu.com.cn/problem/P4868">P4868 Preprefix sum</a></h3><p>又到了<code>OIer</code>优良传统，<del>丧心病狂</del>的推柿子时间</p><p>$S_i= {\textstyle \sum_{k=1}^{i}}a_k$</p><p>$SS_i$=$ {\textstyle \sum_{i=1}^{n}}S_i$=$(n+1){\textstyle \sum_{i=1}^{n}}a_i$-${\textstyle \sum_{i=1}^{n}}i*a_i$</p><p>$ps:LaTex真sb$</p><p>接着拿两个树状数组，一个维护${\textstyle \sum_{i=1}^{n}}a_i$,另一个维护${\textstyle \sum_{i=1}^{n}}i*a_i$就行了</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n,m,x,y;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> ans,len;</span><br><span class="line"><span class="type">int</span> a[N],c1[N&lt;&lt;<span class="number">1</span>],c2[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">char</span> s[<span class="number">101</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">char</span> ch;<span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch=<span class="built_in">getchar</span>()))</span><br><span class="line">&#123;(ch==<span class="string">&#x27;-&#x27;</span>)&amp;&amp;(f=-f);&#125;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))</span><br><span class="line">&#123;x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(ch^<span class="number">48</span>);ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> x&amp;(-x);&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x;i&lt;=(N&lt;&lt;<span class="number">1</span>);i+=<span class="built_in">lowbit</span>(i))c1[i]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add2</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x;i&lt;=(N&lt;&lt;<span class="number">1</span>);i+=<span class="built_in">lowbit</span>(i))c2[i]+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x;i;i-=<span class="built_in">lowbit</span>(i))res+=c1[i];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask2</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=x;i;i-=<span class="built_in">lowbit</span>(i))res+=c2[i];</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)cin&gt;&gt;a[i],<span class="built_in">add1</span>(i,a[i]),<span class="built_in">add2</span>(i,a[i]*i);</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;s&gt;&gt;x;</span><br><span class="line"><span class="keyword">if</span>(s[<span class="number">0</span>]==<span class="string">&#x27;Q&#x27;</span>)cout&lt;&lt;((x+<span class="number">1</span>)*<span class="built_in">ask1</span>(x)-<span class="built_in">ask2</span>(x))&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> cin&gt;&gt;y,<span class="built_in">add1</span>(x,y-a[x]),<span class="built_in">add2</span>(x,(y-a[x])*x),a[x]=y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="Knight-Tournament"><a href="#Knight-Tournament" class="headerlink" title="Knight Tournament"></a><a href="https://www.luogu.com.cn/problem/CF356A">Knight Tournament</a></h3><p>此题是明显的倒推</p><p>每次区间推平</p><p>最后收尾就交给Chotholly吧</p><p>我永远喜欢珂朵莉</p><details>    <summary>AC Code</summary>    <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> a[N],b[N],c[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Chtholly</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r;</span><br><span class="line"><span class="keyword">mutable</span> <span class="type">int</span> v;</span><br><span class="line"><span class="built_in">Chtholly</span>(<span class="type">int</span> a,<span class="type">int</span> b=<span class="number">-1</span>,<span class="type">int</span> c=<span class="number">0</span>):<span class="built_in">l</span>(a),<span class="built_in">r</span>(b),<span class="built_in">v</span>(c)&#123;&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Chtholly &amp;res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> l&lt;res.l;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;Chtholly&gt;s;</span><br><span class="line"><span class="keyword">inline</span> set&lt;Chtholly&gt;::<span class="function">iterator <span class="title">split</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">set&lt;Chtholly&gt;::iterator it=s.<span class="built_in">lower_bound</span>(<span class="built_in">Chtholly</span>(x));</span><br><span class="line"><span class="keyword">if</span>(it!=s.<span class="built_in">end</span>()&amp;&amp;it-&gt;l==x) <span class="keyword">return</span> it;</span><br><span class="line">--it;</span><br><span class="line">Chtholly t=*it;</span><br><span class="line">s.<span class="built_in">erase</span>(it);</span><br><span class="line">s.<span class="built_in">insert</span>(<span class="built_in">Chtholly</span>(t.l,x<span class="number">-1</span>,t.v));</span><br><span class="line"><span class="keyword">return</span> s.<span class="built_in">insert</span>(<span class="built_in">Chtholly</span>(x,t.r,t.v)).first;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">assign</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">set&lt;Chtholly&gt;::iterator it2=<span class="built_in">split</span>(r+<span class="number">1</span>),it1=<span class="built_in">split</span>(l);</span><br><span class="line">s.<span class="built_in">erase</span>(it1,it2);</span><br><span class="line">s.<span class="built_in">insert</span>(<span class="built_in">Chtholly</span>(l,r,v));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">set&lt;Chtholly&gt;::iterator it2=<span class="built_in">split</span>(r+<span class="number">1</span>),it1=<span class="built_in">split</span>(l);</span><br><span class="line"><span class="keyword">for</span>(;it1!=it2;++it1) it1-&gt;v+=v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">s.<span class="built_in">insert</span>(<span class="built_in">Chtholly</span>(<span class="number">1</span>,n));</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) cin&gt;&gt;a[i]&gt;&gt;b[i]&gt;&gt;c[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=m;i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i]!=c[i]) <span class="built_in">assign</span>(a[i],c[i]<span class="number">-1</span>,c[i]);</span><br><span class="line"><span class="keyword">if</span>(b[i]!=c[i]) <span class="built_in">assign</span>(c[i]+<span class="number">1</span>,b[i],c[i]);</span><br><span class="line">&#125;</span><br><span class="line">set&lt;Chtholly&gt;::iterator it2=<span class="built_in">split</span>(n+<span class="number">1</span>),it1=<span class="built_in">split</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(;it1!=it2;++it1)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=it1-&gt;l;i&lt;=it1-&gt;r;++i) cout&lt;&lt;it1-&gt;v&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h2 id="蓝题"><a href="#蓝题" class="headerlink" title="蓝题"></a>蓝题</h2><h3 id="P4748-CERC2017-Justified-Jungle"><a href="#P4748-CERC2017-Justified-Jungle" class="headerlink" title="P4748 [CERC2017]Justified Jungle"></a><a href="https://www.luogu.com.cn/problem/P4748">P4748 [CERC2017]Justified Jungle</a></h3><p><del>出师不利，开局就看题解</del></p><p>一道挺好的思维题</p><p>考虑能删k条边，则分成了k+1个联通块，每块的大小为u=n/(k+1),(如果有余数则一定不满足)</p><p>考虑删去边(f[x],x)，则分出一个大小为s[x]的联通块，则必须满足<code>u|s[x]</code></p><p>所以记录s[x]的个数，对一个u满足u的倍数的个数和为k+1，则是可满足的</p><p>下面是喜闻乐见的代码</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> ne[N&lt;&lt;<span class="number">1</span>],head[N],to[N&lt;&lt;<span class="number">1</span>],tot=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=head[x],head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> s[N],n,cnt[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=fa) <span class="built_in">dfs</span>(y,x),s[x]+=s[y];</span><br><span class="line">++cnt[s[x]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(n%x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>,u=n/x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=u;i&lt;=n;i+=u) res+=cnt[i];</span><br><span class="line"><span class="keyword">return</span> res==x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i)</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">check</span>(i+<span class="number">1</span>)) cout&lt;&lt;i&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P2564-SCOI2009-生日礼物"><a href="#P2564-SCOI2009-生日礼物" class="headerlink" title="P2564 [SCOI2009]生日礼物"></a><a href="https://www.luogu.com.cn/problem/P2564">P2564 [SCOI2009]生日礼物</a></h3><p><del>Ex.<a href="https://www.luogu.com.cn/problem/P1638">P1638 逛画展</a></del></p><p>我们发现此题与P1638最大的不同是一个位置上可能有多个珠子</p><p><del>好难搞啊</del></p><p>但是好像同样位置的话先后顺序对答案没有影响</p><p><del>建议评黄</del></p><p><del>附上双倍经验<a href="https://www.luogu.com.cn/problem/P3029">P3029 [USACO11NOV]Cow Lineup S</a></del></p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,v;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node res)<span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> x&lt;res.x;</span><br><span class="line">&#125;</span><br><span class="line">&#125;a[N];</span><br><span class="line"><span class="type">int</span> n,m,tot,T;</span><br><span class="line"><span class="type">int</span> cnt[<span class="number">65</span>],k,ans=<span class="number">2147483647</span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;T;</span><br><span class="line"><span class="keyword">while</span>(T--) cin&gt;&gt;a[++tot].x,a[tot].v=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(a+<span class="number">1</span>,a+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> l=<span class="number">1</span>,r=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(;r&lt;=n;++r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(++cnt[a[r].v]==<span class="number">1</span>) ++k;</span><br><span class="line"><span class="keyword">while</span>(cnt[a[l].v]&gt;<span class="number">1</span>&amp;&amp;l&lt;r) --cnt[a[l++].v];</span><br><span class="line"><span class="keyword">if</span>(k==m) ans=<span class="built_in">min</span>(a[r].x-a[l].x,ans);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P4427-BJOI2018-求和"><a href="#P4427-BJOI2018-求和" class="headerlink" title="P4427 [BJOI2018]求和"></a><a href="https://www.luogu.com.cn/problem/P4427">P4427 [BJOI2018]求和</a></h3><p><del>渐入佳境</del></p><p>本来一看，区间k次幂和，<del>珂朵莉树？</del></p><p>后来发现$k&lt;=50$ ，可以预处理每个点的k次幂</p><p>再看标签，前缀和</p><p>树上前缀和后差分，比较板</p><p>时间复杂度$O(50n+mlogn)$</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>,mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="type">int</span> ne[N&lt;&lt;<span class="number">1</span>],head[N],to[N&lt;&lt;<span class="number">1</span>],tot=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> f[N][<span class="number">20</span>],tin[N],tout[N],idx,dep[N]=&#123;<span class="number">-1</span>&#125;;</span><br><span class="line"><span class="type">int</span> n,m,k;</span><br><span class="line"><span class="type">int</span> g[N][<span class="number">51</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=head[x],head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dep[x]=dep[fa]+<span class="number">1</span>,f[x][<span class="number">0</span>]=fa;</span><br><span class="line">tin[x]=++idx;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;f[x][i];++i) f[x][i+<span class="number">1</span>]=f[f[x][i]][i];</span><br><span class="line"><span class="type">int</span> res=dep[x];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">50</span>;++i) g[x][i]=(g[fa][i]+res)%mod,(res*=dep[x])%=mod;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=fa) <span class="built_in">dfs</span>(y,x);</span><br><span class="line">tout[x]=++idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">pd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> tin[x]&lt;=tin[y]&amp;&amp;tout[x]&gt;=tout[y];&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(x,y)) <span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">pd</span>(y,x)) <span class="keyword">return</span> y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line"><span class="keyword">if</span>(f[x][i]&amp;&amp;!<span class="built_in">pd</span>(f[x][i],y)) x=f[x][i];</span><br><span class="line"><span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x,y,z;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">lca</span>(x,y),v=g[x][z]+g[y][z]-g[k][z]-g[f[k][<span class="number">0</span>]][z];</span><br><span class="line">cout&lt;&lt;(v%mod+mod)%mod&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P1456-Monkey-King"><a href="#P1456-Monkey-King" class="headerlink" title="P1456 Monkey King"></a><a href="https://www.luogu.com.cn/problem/P1456">P1456 Monkey King</a></h3><p>左偏树板子题，<del>但我不会</del></p><p>写了个$O(nlog^{2}n)$的启发式合并</p><p>左偏树可以做到$O(nlogn)$</p><details>    <summary>AC Code(启发式合并)</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line">priority_queue&lt;<span class="type">int</span>&gt;q[N];</span><br><span class="line"><span class="type">int</span> f[N],n,m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x==f[x]?x:f[x]=<span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(!q[i].<span class="built_in">empty</span>()) q[i].<span class="built_in">pop</span>();</span><br><span class="line">cin&gt;&gt;x,f[i]=i,q[i].<span class="built_in">push</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">cin&gt;&gt;m;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">x=<span class="built_in">find</span>(x),y=<span class="built_in">find</span>(y);</span><br><span class="line"><span class="keyword">if</span>(x==y)</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="number">-1</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> k1=q[x].<span class="built_in">size</span>(),k2=q[y].<span class="built_in">size</span>();</span><br><span class="line"><span class="type">int</span> v1=q[x].<span class="built_in">top</span>()/<span class="number">2</span>,v2=q[y].<span class="built_in">top</span>()/<span class="number">2</span>;</span><br><span class="line">q[x].<span class="built_in">pop</span>(),q[y].<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">if</span>(k1&lt;k2) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="keyword">while</span>(!q[y].<span class="built_in">empty</span>()) q[x].<span class="built_in">push</span>(q[y].<span class="built_in">top</span>()),q[y].<span class="built_in">pop</span>();</span><br><span class="line">q[x].<span class="built_in">push</span>(v1),q[x].<span class="built_in">push</span>(v2),f[y]=x;</span><br><span class="line">cout&lt;&lt;q[x].<span class="built_in">top</span>()&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P2796-Facer的程序"><a href="#P2796-Facer的程序" class="headerlink" title="P2796 Facer的程序"></a><a href="https://www.luogu.com.cn/problem/P2796">P2796 Facer的程序</a></h3><p>看到计数问题 <del>再加上窝觉得可能推不出式子</del></p><p>考虑DP，我们发现给的数据满足一棵树，那应该是树形DP</p><p>分析题意，我们发现要求的是树上有多少联通块</p><p>我们设以<code>x</code>为子树的联通块数量为<code>f[x]</code>对于一个<code>x</code>，他的一个子节点<code>v</code>可以取的方案数为<code>f[v]+1</code>，所以$\large{}f[x]=\Large\prod\limits_{v\text{是x的子节点}}(f[v]+1)$</p><p>如果<code>x</code>为叶节点，则<code>f[x]=1</code>，答案就是$\sum\limits_{i=1}^nf[i]$</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> ne[N&lt;&lt;<span class="number">1</span>],head[N],to[N&lt;&lt;<span class="number">1</span>],tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=head[x],head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[N],ans,n;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">f[x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>((y=to[i])!=fa) <span class="built_in">dp</span>(y,x),(f[x]*=(<span class="number">1ll</span>*f[y]+<span class="number">1</span>))%=mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x,y,i=<span class="number">1</span>;i&lt;n;++i) cin&gt;&gt;x&gt;&gt;y,<span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line"><span class="built_in">dp</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) (ans+=f[i])%=mod;</span><br><span class="line">cout&lt;&lt;ans;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P3986-斐波那契数列"><a href="#P3986-斐波那契数列" class="headerlink" title="P3986 斐波那契数列"></a><a href="https://www.luogu.com.cn/problem/P3986">P3986 斐波那契数列</a></h3><p>是的，<del>万恶的</del>数学来了</p><p>先咕着</p><h3 id="感觉不错-Feel-Good"><a href="#感觉不错-Feel-Good" class="headerlink" title="感觉不错 Feel Good"></a><a href="https://www.luogu.com.cn/problem/UVA1619">感觉不错 Feel Good</a></h3><p>一道见过的单调栈好题，对每个数维护左右比他小的第一个数</p><p><del>UVA的格式怎么这么阴间啊</del> </p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> a[N],l[N],r[N];</span><br><span class="line"><span class="type">int</span> st[N],top,n;</span><br><span class="line"><span class="type">int</span> ans,s[N];</span><br><span class="line"><span class="type">int</span> ansl,ansr,first=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">st[top=<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(top&amp;&amp;a[st[top]]&gt;=a[i]) --top;</span><br><span class="line">l[i]=st[top]+<span class="number">1</span>;</span><br><span class="line">st[++top]=i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">st[top=<span class="number">0</span>]=n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i;--i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(top&amp;&amp;a[st[top]]&gt;=a[i]) --top;</span><br><span class="line">r[i]=st[top]<span class="number">-1</span>;</span><br><span class="line">st[++top]=i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> k=(<span class="type">int</span>)a[i]*(s[r[i]]-s[l[i]<span class="number">-1</span>]);</span><br><span class="line"><span class="keyword">if</span>(ans&lt;k||(ans==k&amp;&amp;r[i]-l[i]&lt;ansr-ansl)) ans=k,ansl=l[i],ansr=r[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;n)!=EOF)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!first) <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">first=<span class="number">0</span>,ans=<span class="number">0</span>,ansl=ansr=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;a[i]),s[i]=s[i<span class="number">-1</span>]+a[i];</span><br><span class="line"><span class="built_in">pre1</span>();</span><br><span class="line"><span class="built_in">pre2</span>();</span><br><span class="line"><span class="built_in">work</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n%lld %lld\n&quot;</span>,ans,ansl,ansr);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="DZY-Loves-Fibonacci-Numbers"><a href="#DZY-Loves-Fibonacci-Numbers" class="headerlink" title="DZY Loves Fibonacci Numbers"></a><a href="https://www.luogu.com.cn/problem/CF446C">DZY Loves Fibonacci Numbers</a></h3><p>一道神仙题</p><p>本来想的是线段树开vector维护离L的下标，然后</p><p><img src="/images/CF446C.png"></p><p>只好借助题解的力量</p><p>然后发现此题不仅可以用线段树，还可以定期重构</p><p>当修改操作达到lim次时，用$O(n)$的时间重构序列</p><p>没有重构的部分暴力统计</p><p>放上代码</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">3e5</span>+<span class="number">5</span>,mod=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"><span class="type">int</span> v[N],val[N];</span><br><span class="line"><span class="type">int</span> l[N],r[N],tot;</span><br><span class="line"><span class="type">int</span> n,m,lim;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;st[N],ed[N];</span><br><span class="line"><span class="type">int</span> f[N]=&#123;<span class="number">0</span>,<span class="number">1</span>&#125;,s[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">md</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x&lt;<span class="number">0</span>?x+mod:x&gt;mod?x-mod:x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m,lim=<span class="built_in">sqrt</span>(n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) f[i]=<span class="built_in">md</span>(f[i<span class="number">-1</span>]+f[i<span class="number">-2</span>]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s[i]=<span class="built_in">md</span>(f[i]+s[i<span class="number">-1</span>]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;val[i],v[i]=<span class="built_in">md</span>(val[i]+v[i<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">rebuild</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i)</span><br><span class="line">st[l[i]].<span class="built_in">push_back</span>(i),</span><br><span class="line">ed[r[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line"><span class="type">int</span> a=<span class="number">0</span>,b=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c=<span class="built_in">md</span>(a+b);</span><br><span class="line">val[i]=<span class="built_in">md</span>(val[i]+c);</span><br><span class="line">a=b,b=c;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> x:st[i]) b=<span class="built_in">md</span>(b+<span class="number">1</span>),val[i]=<span class="built_in">md</span>(val[i]+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> x:ed[i]) a=<span class="built_in">md</span>(a-f[r[x]-l[x]]),b=<span class="built_in">md</span>(b-f[r[x]-l[x]+<span class="number">1</span>]);</span><br><span class="line">v[i]=<span class="built_in">md</span>(v[i<span class="number">-1</span>]+val[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i)</span><br><span class="line">st[l[i]].<span class="built_in">clear</span>(),</span><br><span class="line">ed[r[i]].<span class="built_in">clear</span>();</span><br><span class="line">tot=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">pre</span>();</span><br><span class="line"><span class="type">int</span> opt,x,y;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">l[++tot]=x,r[tot]=y;</span><br><span class="line"><span class="keyword">if</span>(tot==lim) <span class="built_in">rebuild</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> ans=<span class="built_in">md</span>(v[y]-v[x<span class="number">-1</span>]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tot;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> L=<span class="built_in">max</span>(x,l[i]),R=<span class="built_in">min</span>(y,r[i]);</span><br><span class="line"><span class="keyword">if</span>(L&lt;=R) ans=<span class="built_in">md</span>(ans+s[R-l[i]+<span class="number">1</span>]-s[L-l[i]]);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>MLE Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span>+<span class="number">9</span>,N=<span class="number">3e5</span>+<span class="number">5</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;add[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> s[N]=&#123;<span class="number">0</span>,<span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,len,v;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) s[i]=(s[i<span class="number">-1</span>]+s[i<span class="number">-2</span>])%mod;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) (s[i]+=s[i<span class="number">-1</span>])%=mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].v=(t[k1].v+t[k2].v)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].l=l,t[k].r=r,t[k].len=r-l+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> (<span class="type">void</span>)(cin&gt;&gt;t[k].v);</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid);</span><br><span class="line"><span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ad</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">(t[k].v+=s[x+t[k].len<span class="number">-1</span>]-s[x<span class="number">-1</span>])%=mod;</span><br><span class="line">add[k].<span class="built_in">push_back</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> x=add[k].<span class="built_in">size</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;x;++i) <span class="built_in">ad</span>(k1,add[k][i]),<span class="built_in">ad</span>(k2,add[k][i]+t[k1].len);</span><br><span class="line">add[k].<span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(t[k].l&gt;=l&amp;&amp;t[k].r&lt;=r) <span class="keyword">return</span> <span class="built_in">ad</span>(k,t[k].l-l+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">push</span>(k);</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k1].r) <span class="built_in">change</span>(k1,l,r);</span><br><span class="line"><span class="keyword">if</span>(r&gt;=t[k2].l) <span class="built_in">change</span>(k2,l,r);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(t[k].l&gt;=l&amp;&amp;t[k].r&lt;=r) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="built_in">push</span>(k);</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=t[k1].r) res+=<span class="built_in">ask</span>(k1,l,r);</span><br><span class="line"><span class="keyword">if</span>(r&gt;=t[k2].l) (res+=<span class="built_in">ask</span>(k2,l,r))%=mod;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="built_in">pre</span>();</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="type">int</span> opt,l,r;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;l&gt;&gt;r;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) <span class="built_in">change</span>(<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">else</span> cout&lt;&lt;(<span class="built_in">ask</span>(<span class="number">1</span>,l,r)%mod+mod)%mod&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="ABC256G-Black-and-White-Stones"><a href="#ABC256G-Black-and-White-Stones" class="headerlink" title="[ABC256G] Black and White Stones"></a><a href="https://www.luogu.com.cn/problem/AT_abc256_g">[ABC256G] Black and White Stones</a></h3><p>不会，先咕着</p><h3 id="P7297-USACO21JAN-Telephone-G"><a href="#P7297-USACO21JAN-Telephone-G" class="headerlink" title="P7297 [USACO21JAN] Telephone G"></a><a href="https://www.luogu.com.cn/problem/P7297">P7297 [USACO21JAN] Telephone G</a></h3><p>分层图最短路好题</p><p>第$k$行代表品种为$k$的牛能传递出去</p><p>看代码吧</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e7</span>+<span class="number">5</span>,NN=<span class="number">5e4</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> head[N],ne[N],to[N],e[N],tot=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> n,k;</span><br><span class="line"><span class="type">int</span> a[NN];</span><br><span class="line"><span class="type">char</span> s[<span class="number">55</span>][NN];</span><br><span class="line"><span class="type">int</span> d[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">to[++tot]=y,ne[tot]=head[x],e[tot]=z,head[x]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">id</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (x<span class="number">-1</span>)*n+y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=k+<span class="number">1</span>;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;n;++j) <span class="built_in">add</span>(<span class="built_in">id</span>(i,j),<span class="built_in">id</span>(i,j+<span class="number">1</span>),<span class="number">1</span>),<span class="built_in">add</span>(<span class="built_in">id</span>(i,j+<span class="number">1</span>),<span class="built_in">id</span>(i,j),<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">add</span>(i,<span class="built_in">id</span>(a[i]+<span class="number">1</span>,i),<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=k;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j) </span><br><span class="line"><span class="keyword">if</span>(s[i][a[j]]==<span class="string">&#x27;1&#x27;</span>) <span class="built_in">add</span>(<span class="built_in">id</span>(i+<span class="number">1</span>,j),j,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">deque&lt;<span class="type">int</span>&gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(d,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line">d[s]=<span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push_back</span>(s);</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> x=q.<span class="built_in">front</span>();q.<span class="built_in">pop_front</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> y,i=head[x];i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>(d[y=to[i]]&gt;d[x]+e[i])</span><br><span class="line">&#123;</span><br><span class="line">d[y]=d[x]+e[i];</span><br><span class="line"><span class="keyword">if</span>(e[i]) q.<span class="built_in">push_back</span>(y);</span><br><span class="line"><span class="keyword">else</span> q.<span class="built_in">push_front</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;k;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=k;++i) cin&gt;&gt;s[i]+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>();</span><br><span class="line"><span class="built_in">bfs</span>(<span class="number">1</span>);</span><br><span class="line">cout&lt;&lt;(d[n]==<span class="number">0x3f3f3f3f</span>?<span class="number">-1</span>:d[n]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="CF33C-Wonderful-Randomized-Sum"><a href="#CF33C-Wonderful-Randomized-Sum" class="headerlink" title="CF33C - Wonderful Randomized Sum"></a><a href="https://www.luogu.com.cn/problem/SP7507">CF33C - Wonderful Randomized Sum</a></h3><p>水题，我们发现两次取反如果有相交部分便相当于不变</p><p>设前面取反的数字和为$x$，后面为$y$，数列总和为$sum,z=sum-x-y$</p><p>取反后$sum’=sum-x-y+(-x)+(-y)=2z-sum$</p><p>因为$z$为最大连续字段和，所以这题就$O(n)$做完了</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n,x,sum,res,ans,T;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;T;</span><br><span class="line"><span class="keyword">while</span>(T--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line">ans=res=sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">cin&gt;&gt;x,res=<span class="built_in">max</span>(<span class="number">0</span>,res+x),ans=<span class="built_in">max</span>(ans,res),sum+=x;</span><br><span class="line">cout&lt;&lt;ans*<span class="number">2</span>-sum&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P2698-USACO12MAR-Flowerpot-S"><a href="#P2698-USACO12MAR-Flowerpot-S" class="headerlink" title="P2698 [USACO12MAR]Flowerpot S"></a><a href="https://www.luogu.com.cn/problem/P2698">P2698 [USACO12MAR]Flowerpot S</a></h3><p>先咕着</p><h3 id="The-Battle-of-Chibi"><a href="#The-Battle-of-Chibi" class="headerlink" title="The Battle of Chibi"></a><a href="https://www.luogu.com.cn/problem/UVA12983">The Battle of Chibi</a></h3><p>暴力DP很好写 $dp[i][j]={\textstyle \sum_{k=1}^{i-1}} (a[k]&lt;a[i])*dp[k][j-1]$</p><p>但时间复杂度是$O(n^{2}m)$</p><p>考虑数据结构优化</p><p>用个树状数组能做到$O(nmlogn)$</p><p>贴个代码</p><details>    <summary>AC Code</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e3</span>+<span class="number">5</span>,mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n,m,a[N],v,c[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=n;x+=<span class="built_in">lowbit</span>(x)) (c[x]+=v)%=mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x)) (res+=c[x])%=mod;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[N][N],T,te,num[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;T;</span><br><span class="line"><span class="keyword">while</span>(++te&lt;=T)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][<span class="number">1</span>]=<span class="number">1</span>,cin&gt;&gt;a[i],num[i]=a[i];</span><br><span class="line"><span class="built_in">sort</span>(num+<span class="number">1</span>,num+n+<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> M=<span class="built_in">unique</span>(num+<span class="number">1</span>,num+n+<span class="number">1</span>)-num<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="built_in">lower_bound</span>(num+<span class="number">1</span>,num+M+<span class="number">1</span>,a[i])-num;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">2</span>;j&lt;=m;++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) c[i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][j]=<span class="built_in">ask</span>(a[i]<span class="number">-1</span>),<span class="built_in">add</span>(a[i],f[i][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) (ans+=f[i][m])%=mod;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;Case #&quot;</span>&lt;&lt;te&lt;&lt;<span class="string">&quot;: &quot;</span>&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="SUMMUL-Sum-of-products"><a href="#SUMMUL-Sum-of-products" class="headerlink" title="SUMMUL - Sum of products"></a><a href="https://www.luogu.com.cn/problem/SP6286">SUMMUL - Sum of products</a></h3><p>咕着，人太菜了</p><h3 id="NGM2-Another-Game-With-Numbers"><a href="#NGM2-Another-Game-With-Numbers" class="headerlink" title="NGM2 - Another Game With Numbers"></a><a href="https://www.luogu.com.cn/problem/SP6285">NGM2 - Another Game With Numbers</a></h3><p>容斥原理板子题</p><details>    <summary>AC Code</summary> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> m,n,ans;</span><br><span class="line"><span class="type">int</span> a[<span class="number">20</span>],tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> y?<span class="built_in">gcd</span>(y,x%y):x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lcm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x*y/<span class="built_in">gcd</span>(x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;m&gt;&gt;n)</span><br><span class="line">&#123;</span><br><span class="line">tot=<span class="number">1</span>&lt;&lt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;++i) cin&gt;&gt;a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;tot;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">1</span>,f=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;++j)</span><br><span class="line"><span class="keyword">if</span>((i&gt;&gt;j)&amp;<span class="number">1</span>) f*=<span class="number">-1</span>,res=<span class="built_in">lcm</span>(res,a[j]);</span><br><span class="line">ans+=m/res*f;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;m-ans&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="Blood-Cousins"><a href="#Blood-Cousins" class="headerlink" title="Blood Cousins"></a><a href="https://www.luogu.com.cn/problem/CF208E">Blood Cousins</a></h3><p>一道好的数据结构题</p><p>我们考虑一个$v$的$p$级表亲就是他的$p$级祖先的$p$级子孙数量$-1$</p><p>由于同级子孙的深度相同，我们用主席树维护一个节点的子孙深度集合</p><p>好像还能dsu，但太菜了，还不会</p><details>    <summary>AC Code</summary>    <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> f[N][<span class="number">20</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;g[N];</span><br><span class="line"><span class="type">int</span> id[N],nid[N],sz[N],idx,n,m;</span><br><span class="line"><span class="type">int</span> root[N],tot,dep[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc;</span><br><span class="line"><span class="type">int</span> v;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">6</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">g[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">id[x]=++idx,nid[idx]=x,sz[x]=<span class="number">1</span>,dep[x]=dep[f[x][<span class="number">0</span>]]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;f[x][i];++i) f[x][i+<span class="number">1</span>]=f[f[x][i]][i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> y:g[x]) <span class="built_in">dfs</span>(y),sz[x]+=sz[y];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">19</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line"><span class="keyword">if</span>(y&gt;=(<span class="number">1</span>&lt;&lt;i)) x=f[x][i],y-=<span class="number">1</span>&lt;&lt;i;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k=++tot]=t[p];</span><br><span class="line">t[k].v+=v;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ins</span>(t[k].lc,t[p].lc,l,mid,x,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">ins</span>(t[k].rc,t[p].rc,mid+<span class="number">1</span>,r,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">ins</span>(root[i],root[i<span class="number">-1</span>],<span class="number">1</span>,n,dep[nid[i]],<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[k].v-t[p].v;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="keyword">return</span> <span class="built_in">ask</span>(t[k].lc,t[p].lc,l,mid,x);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">ask</span>(t[k].rc,t[p].rc,mid+<span class="number">1</span>,r,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">y=<span class="built_in">find</span>(x,y);</span><br><span class="line"><span class="keyword">return</span> y?<span class="built_in">ask</span>(root[id[y]+sz[y]<span class="number">-1</span>],root[id[y]<span class="number">-1</span>],<span class="number">1</span>,n,dep[x])<span class="number">-1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;f[i][<span class="number">0</span>],<span class="built_in">add</span>(f[i][<span class="number">0</span>],i);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(!f[i][<span class="number">0</span>]) <span class="built_in">dfs</span>(i);</span><br><span class="line">cin&gt;&gt;m;</span><br><span class="line"><span class="built_in">pre</span>();</span><br><span class="line"><span class="type">int</span> x,y;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">cout&lt;&lt;<span class="built_in">query</span>(x,y)&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="P6011-SCOI2006-动态最值"><a href="#P6011-SCOI2006-动态最值" class="headerlink" title="P6011 [SCOI2006]动态最值"></a><a href="https://www.luogu.com.cn/problem/P6011">P6011 [SCOI2006]动态最值</a></h3><p>线段树进阶题，考虑定位的不是下标而是子树大小</p><p>改天写个Splay</p><details>    <summary>AC Code</summary>    <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (k&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (k&lt;&lt;1|1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>,INF=<span class="number">1e9</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l,r,cnt;</span><br><span class="line"><span class="type">int</span> v1,v2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="title">tree</span><span class="params">(<span class="type">int</span> _x=<span class="number">0</span>,<span class="type">int</span> _y=<span class="number">0</span>)</span></span>&#123;l=_x,r=_y;&#125;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k].v1=<span class="built_in">max</span>(t[k1].v1,t[k2].v1);</span><br><span class="line">t[k].v2=<span class="built_in">min</span>(t[k1].v2,t[k2].v2);</span><br><span class="line">t[k].cnt=t[k1].cnt+t[k2].cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t[k]=<span class="built_in">tree</span>(l,r);</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>(<span class="type">void</span>)(cin&gt;&gt;t[k].v1,t[k].v2=t[k].v1,t[k].cnt=<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(k1,l,mid);<span class="built_in">build</span>(k2,mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(t[k].l==t[k].r) <span class="keyword">return</span>(<span class="type">void</span>)(t[k].v1=-INF,t[k].v2=INF,t[k].cnt=<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(x&lt;=t[k1].cnt) <span class="built_in">change</span>(k1,x);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(k2,x-t[k1].cnt);</span><br><span class="line"><span class="built_in">up</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> v1,v2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==<span class="number">1</span>&amp;&amp;r==t[k].cnt)  <span class="keyword">return</span> (<span class="type">void</span>)(v1=<span class="built_in">max</span>(v1,t[k].v1),v2=<span class="built_in">min</span>(v2,t[k].v2));</span><br><span class="line"><span class="keyword">if</span>(r&lt;=t[k1].cnt) <span class="built_in">ask</span>(k1,l,r);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(l&gt;t[k1].cnt) <span class="built_in">ask</span>(k2,l-t[k1].cnt,r-t[k1].cnt);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">ask</span>(k1,l,t[k1].cnt),<span class="built_in">ask</span>(k2,<span class="number">1</span>,r-t[k1].cnt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="type">int</span> opt,l,r;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;l;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="number">1</span>) <span class="built_in">change</span>(<span class="number">1</span>,l);</span><br><span class="line"><span class="keyword">else</span> cin&gt;&gt;r,v1=-INF,v2=INF,<span class="built_in">ask</span>(<span class="number">1</span>,l,r),cout&lt;&lt;v2&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;v1&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="RACETIME-Race-Against-Tim"><a href="#RACETIME-Race-Against-Tim" class="headerlink" title="RACETIME - Race Against Tim"></a><a href="https://www.luogu.com.cn/problem/SP3261">RACETIME - Race Against Tim</a></h3><p><del>话说这个题是不是$n$倍经验</del></p><p>做法较多，有时间$O(n\sqrt{n}logn)$，空间$O(n)$的分块，时空都是$O(n\sqrt{n})$的分块</p><p>时空都是$O(nlog^{2}n)$的树套树，时间$O(n^{\frac{5}{3}})$，空间$O(n)$的带修莫队</p><p>然后我发现树套树代码比分块短，emm</p><details>    <summary>AC Code(分块)</summary>    <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,SN=<span class="number">800</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> L[SN],R[SN];</span><br><span class="line"><span class="type">int</span> b[N],a[N];</span><br><span class="line"><span class="type">int</span> block,belong[N],num,m;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">a[x]=val;</span><br><span class="line"><span class="type">int</span> p=belong[x];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[p];i&lt;=R[p];++i) b[i]=a[i];</span><br><span class="line"><span class="built_in">sort</span>(b+L[p],b+R[p]+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> p=belong[l],q=belong[r];</span><br><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(p==q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i)</span><br><span class="line"><span class="keyword">if</span>(a[i]&lt;=val) ++ans;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=R[p];++i)</span><br><span class="line"><span class="keyword">if</span>(a[i]&lt;=val) ++ans;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=L[q];i&lt;=r;++i)</span><br><span class="line"><span class="keyword">if</span>(a[i]&lt;=val) ++ans;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>;i&lt;q;++i)</span><br><span class="line">ans+=<span class="built_in">upper_bound</span>(b+L[i],b+R[i]+<span class="number">1</span>,val)-b-L[i];</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">block=<span class="built_in">sqrt</span>(n),num=(n<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],b[i]=a[i],belong[i]=(i<span class="number">-1</span>)/block+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i) L[i]=R[i<span class="number">-1</span>]+<span class="number">1</span>,R[i]=i*block;</span><br><span class="line">R[num]=n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=num;++i) <span class="built_in">sort</span>(b+L[i],b+R[i]+<span class="number">1</span>);</span><br><span class="line"><span class="type">char</span> opt;</span><br><span class="line"><span class="type">int</span> l,r,x;</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;l&gt;&gt;r;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;x;</span><br><span class="line">cout&lt;&lt;<span class="built_in">ask</span>(l,r,x)&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(l,r);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>AC Code(树套树)</summary>    <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) x&amp;-x</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k1 (t[k].lc)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> k2 (t[k].rc)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> lc,rc,v;</span><br><span class="line">&#125;t[N*<span class="number">550</span>];</span><br><span class="line"><span class="type">int</span> root[N],tot,a[N],n,m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k) k=++tot;</span><br><span class="line">t[k].v+=v;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">change</span>(k1,l,mid,x,v);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(k2,mid+<span class="number">1</span>,r,x,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!k||l==r) <span class="keyword">return</span> t[k].v;</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="keyword">return</span> <span class="built_in">ask</span>(k1,l,mid,x);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> t[k1].v+<span class="built_in">ask</span>(k2,mid+<span class="number">1</span>,r,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=n;x+=<span class="built_in">lowbit</span>(x))</span><br><span class="line"><span class="built_in">change</span>(root[x],<span class="number">0</span>,INF,y,v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=<span class="built_in">lowbit</span>(x))</span><br><span class="line">res+=<span class="built_in">ask</span>(root[x],<span class="number">0</span>,INF,v);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">cin.<span class="built_in">tie</span>(<span class="number">0</span>);cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="type">int</span> x,y,v;</span><br><span class="line"><span class="type">char</span> opt;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;a[i],<span class="built_in">add</span>(i,a[i],<span class="number">1</span>);</span><br><span class="line"><span class="keyword">while</span>(m--)</span><br><span class="line">&#123;</span><br><span class="line">cin&gt;&gt;opt&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">if</span>(opt==<span class="string">&#x27;C&#x27;</span>) cin&gt;&gt;v,cout&lt;&lt;<span class="built_in">query</span>(y,v)-<span class="built_in">query</span>(x<span class="number">-1</span>,v)&lt;&lt;endl;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">add</span>(x,a[x],<span class="number">-1</span>),a[x]=y,<span class="built_in">add</span>(x,a[x],<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="MDIGITS-Counting-Digits"><a href="#MDIGITS-Counting-Digits" class="headerlink" title="MDIGITS - Counting Digits"></a><a href="https://www.luogu.com.cn/problem/SP3928">MDIGITS - Counting Digits</a></h3><p>数位DP板子，但我不会</p>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 做题记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>做题反思2022.8.16 ~ 8.19</title>
      <link href="//OI/%E5%81%9A%E9%A2%98%E5%8F%8D%E6%80%9D2022-8-16-8-19/"/>
      <url>//OI/%E5%81%9A%E9%A2%98%E5%8F%8D%E6%80%9D2022-8-16-8-19/</url>
      
        <content type="html"><![CDATA[<p>被吊打了</p><span id="more"></span><h2 id="CSP2021-95pts-0pts-0pts-40pts-135pts-rk-n"><a href="#CSP2021-95pts-0pts-0pts-40pts-135pts-rk-n" class="headerlink" title="CSP2021(95pts+0pts+0pts+40pts=135pts)($rk$  $n$)"></a>CSP2021(95pts+0pts+0pts+40pts=135pts)($rk$  $n$)</h2><p>T1 水题 线段树上二分(求前缀和时注意上限是n)或贪心(使用优先队列)</p><p>T2 状态较多的区间DP</p><p>$f[l][r][0,1,2,3,4,5]$为$l$到$r$区间不同形式的数量</p><p>1代表S 2代表A 3代表SA 4代表AS 5代表ASA</p><p>T3 四指针扫描法,从$a[1]$对应数的位置前后扫,如果和外围指针对应就移动</p><p>T4 用dinic跑最大流（最小割）可得60pts,正解还不会,似乎是在对偶图上跑最短路并区间DP</p><p>贺题解后得分:100pts+100pts+100pts+0pts=300pts</p><h2 id="NOIP2021-100pts-0pts-12pts-0pts-112pts-rk-n"><a href="#NOIP2021-100pts-0pts-12pts-0pts-112pts-rk-n" class="headerlink" title="NOIP2021(100pts+0pts+12pts+0pts=112pts)($rk$  $n$)"></a>NOIP2021(100pts+0pts+12pts+0pts=112pts)($rk$  $n$)</h2><p>T1 预处理/埃氏筛</p><p>T2 DP $f$[$i$][$j$][$k$][$p$] 表示前$i$个数中选了$j$个,有$k$个1,此时进位了$p$个1的方案数,刷表法,组合计数预处理,预处理$n$次幂</p><p>T3 推出答案公式为$n$*(∑$a_i$)^2-∑($a_i$^2)交换差分数组,推(猜)出单谷性质(可以打暴力验证),DP,将差分数组排序,$f[i][j]$表示前i个数中和的平方为j时平方和的最大值,从第i个数插入前面和后面中取最大值,填表法,并要使用滚动数组优化空间</p><p>T4 骗不到分</p><p>贺题解后得分:100pts+100pts+100pts+0pts=300pts</p><h2 id="NOIP2020-64pts-4pts-0pts-0pts-68pts-rk-n"><a href="#NOIP2020-64pts-4pts-0pts-0pts-68pts-rk-n" class="headerlink" title="NOIP2020(64pts+4pts+0pts+0pts=68pts)($rk$  $n$)"></a>NOIP2020(64pts+4pts+0pts+0pts=68pts)($rk$  $n$)</h2><p>T1 $a$/$b$+$c$/$d$=(a<em>d+b</em>c)/(b*d),注意约分和高精,或者__$int128$</p><p>T2 $kmp$预处理$ne$数组,求每个AB的循环,预处理前缀和后缀出现为奇数的数量,用数组记录A数量的数量,类似于某些莫队题的记录,对每个可能的C累加</p><p>T3 很妙的构造题,虽然我只看懂了一篇题解,Dzhao写的分治,个人觉得较为详细</p><p>T4 dfs+cout&lt;&lt;-1 骗分</p><p>贺题解后得分:100pts+100pts+0pts+0pts=200pts</p><h2 id="最近看的DP"><a href="#最近看的DP" class="headerlink" title="最近看的DP"></a>最近看的DP</h2><p>1.关路灯 蓝题中的基础题,比合唱队形还简单一点,只要想到数组开三维和DP就很容易,适合初学者</p><p>2.CSP-2019 Emiya家今天的饭(我绝对不会告诉你我贺了题解)<br>我这种蒟蒻觉得比较难,此题是套容斥原理的计数DP,直接求合法方案有难度,于是我们将其转化成总方案数-不合法方案数,</p><p>$f[i][j]$表示前$i$列中选了$j$个数的方案数(总方案),枚举超过一半的列,$g[i][j][k]$表示前$i$行中此列选了$j$个数,其他列选了$k$个数,最后记录$j&gt;k$的方案数,空间可以用滚动数组优化至($n^2$),但时间是($mn^3$)的</p><p>我们考虑优化,然后我们发现我们只关心$j和k$的大小关系,并不在乎其具体大小,我们可以仿照lyd的算法进阶中的Jury Compromise(陪审团)此题,将第三维删去,用$j-k$作为第二维,不过要将第二维下标平移$n$,时间复杂度为($mn^2$)</p><p>总结:CSP,NOIP反正全是DP,像我这种根本想不出方程的人就只能去世,准备爆零-&gt;退役-&gt;去世一条龙</p><p>update 2022.11.24<br>我错了，图论才是恶心的远古势力</p>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 做题记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>新博客</title>
      <link href="//uncategorized/%E6%96%B0%E5%8D%9A%E5%AE%A2/"/>
      <url>//uncategorized/%E6%96%B0%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>Hello,World</p><span id="more"></span><p>在经历多次尝试，并在$Eternal$和$KevinLive$巨佬的帮助下，我<del>成功地</del>建起了这个$blog$，以后估计会在这儿更一些<del>奇奇怪怪</del>的东西吧</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
